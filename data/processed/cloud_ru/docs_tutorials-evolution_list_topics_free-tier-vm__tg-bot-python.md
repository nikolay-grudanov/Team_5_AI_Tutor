---
source_image: docs_tutorials-evolution_list_topics_free-tier-vm__tg-bot-python.jpg
page_number: 0
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 82.84
tokens: 9935
characters: 5770
timestamp: 2025-12-24T05:45:47.918659
finish_reason: stop
---

Запуск Telegram-бота на Python на виртуальной машине

С помощью этого руководства вы запустите Telegram-бота на Python на виртуальной машине.

Вы будете использовать следующие сервисы:

• Виртуальная машина free tier — сервис, в рамках которого предоставляется бесплатная виртуальная машина с готовой конфигурацией.
• Публичный IP-адрес для организации работы с Telegram через webhook.
• Бесплатный сервис nip.io для получения публичного доменного имени и сертификата. Вы также можете использовать собственное зарегистрированное доменное имя и SSL-сертификат для организации доступа.

Шаги:

1. Создайте виртуальную машину.
2. Настройте группу безопасности.
3. Зарегистрируйте бота в Telegram.
4. Подготовьте и запустите код бота.
5. Протестируйте работу бота.

Перед началом работы

Зарегистрируйтесь в личном кабинете Cloud.ru.

Если вы уже зарегистрированы, войдите под своей учетной записью.

1. Создайте виртуальную машину

Создайте бесплатную виртуальную машину со следующими параметрами:

1. В поле Название укажите название виртуальной машины, например telegram-bot-server.
2. На вкладке Публичные выберите образ Ubuntu 22.04.
3. Назначьте публичный IP-адрес виртуальной машины — оставьте включенной опцию Подключить публичный IP. Для виртуальной машины будет арендован и назначен прямой публичный IP.
4. В поле Логин укажите логин пользователя виртуальной машины, например user1.
5. Выберите метод аутентификации — пароль.
6. В поле Имя хоста укажите уникальное имя устройства, по которому можно идентифицировать виртуальную машину в сети, например telegram-bot-server.

Убедитесь, что в личном кабинете на странице сервиса «Виртуальные машины»:
• отображается виртуальная машина telegram-bot-server;
• статус виртуальной машины — «Запущена»;
• виртуальной машине назначен публичный IP-адрес.

2. Настройте группу безопасности

Группы безопасности в облаке Evolution позволяют контролировать входящий и исходящий трафик для создаваемых ресурсов.

Вы настройте правила фильтрации трафика — разрешите весь исходящий трафик. Создайте новую группу безопасности со следующими параметрами:

1. Выберите Зону доступности, в которой необходимо разместить группу безопасности. Укажите ту же зону доступности, что выбрана для виртуальной машины telegram-bot-server.
2. Укажите Название группы безопасности, например telegram-bot-server.
3. Добавьте правило исходящего трафика:
   a. Протокол — любой
   b. Порт — оставьте пустым
   c. Тип адресата — IP-адрес
   d. Адресат — 0.0.0.0/0
4. Назначьте созданную группу безопасности виртуальной машине telegram-bot-server. Если в группе безопасности присутствуют другие виртуальные машины, исключите их из группы.

Убедитесь, что в личном кабинете на странице сервиса «Виртуальные машины», в разделе Сетевые параметры отображается группа безопасности telegram-bot-server.

3. Зарегистрируйте бота в Telegram

На этом шаге вы зарегистрируете в Telegram нового бота и получите его токен.

1. В Telegram найдите бота BotFather.
2. Выполните команду /newbot .
3. Задайте имя (name) и имя пользователя (username) для бота.
   Имя пользователя должно заканчиваться на _Bot или _bot .
   В результате регистрации BotFather сообщит токен бота. Сохраните его, он понадобится далее.
4. Убедитесь, что созданный бот отображается в Telegram при поиске по имени.

4. Подготовьте и запустите код бота

Для настройки виртуальной машины вы будете использовать серийную консоль в браузере.

1. Подключитесь к виртуальной машине telegram-bot-server через серийную консоль.
2. Обновите индекс пакетов ОС, установите обновления пакетов и необходимые зависимости:

```sh
sudo apt update -y
sudo apt upgrade -y
sudo apt-get install python3 python3-pip -y
pip3 install python-telegram-bot
```

3. Создайте отдельную папку для размещения бота и перейдите в нее:

```sh
mkdir .app
cd .app
```

4. Создайте файл bot.py :

```sh
nano bot.py
```

5. Скопируйте код бота в файл.

6. В строке 57 замените TOKEN на токен бота, полученный от BotFather.

```python
def main() -> None:
    """Start the bot."""
    # Create the Application and pass it your bot's token.
    application = Application.builder().token(TOKEN).build()
```

7. Измененный код вставьте в серийную консоль.

8. Нажмите Ctrl + X , затем y , чтобы сохранить изменения.

Теперь вы запустите бота в качестве службы. Бот будет работать постоянно и запускаться автоматически при старте или перезагрузке виртуальной машины.

1. Подключитесь к виртуальной машине telegram-bot-server через серийную консоль.
2. Создайте файл python-bot.service :

```sh
sudo nano /etc/systemd/system/python-bot.service
```

3. Вставьте код в файл:

```ini
[Unit]
Description=My Python Bot
Wants=network-online.target
After=network-online.target

[Service]
Type=simple
User=VM_username>
ExecStart=/usr/bin/python3 /home/user1/app/bot.py
WorkingDirectory=/home/user1/app

[Install]
WantedBy=multi-user.target
```

Где User — имя пользователя виртуальной машины telegram-bot-server.

4. Нажмите Ctrl + X , затем y , чтобы сохранить изменения.

5. Перезапустите systemd:

```sh
sudo systemctl daemon-reload
```

6. Включите службу python-bot.service:

```sh
sudo systemctl enable python-bot
```

7. Запустите службу python-bot.service:

```sh
sudo systemctl start python-bot
```

8. Выполните команду:

```sh
sudo systemctl status python-bot
```

В результате должен отобразиться статус службы — «Active (running)».

Вывод команды

5. Протестируйте работу бота

1. Найдите в Telegram вашего бота и напишите ему. Бот поздоровается с вами в начале диалога, а затем будет повторять ваши сообщения.
2. Перезагрузите виртуальную машину.
3. Напишите сообщение в бота — бот должен ответить несмотря на перезагрузку сервера.

Результат

Вы запустили Telegram-бота на Python в качестве службы, используя виртуальную машину.