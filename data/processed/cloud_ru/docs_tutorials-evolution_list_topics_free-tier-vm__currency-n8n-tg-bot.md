---
source_image: docs_tutorials-evolution_list_topics_free-tier-vm__currency-n8n-tg-bot.jpg
page_number: 8
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 170.02
tokens: 16082
characters: 10871
timestamp: 2025-12-24T05:42:08.364441
finish_reason: stop
---

<h2>No-code автоматизация рассылки курса валют в Telegram с помощью n8n</h2>
<p>С помощью этого руководства вы научитесь разворачивать no-code платформу n8n на виртуальной машине, настраивать процессы автоматизации и создавать Telegram-бота.</p>
<p>Вы будете использовать следующие сервисы:</p>
<ul>
<li>Виртуальная машина free tier — сервис, в рамках которого предоставляется бесплатная виртуальная машина с готовой конфигурацией.</li>
<li>Публичный IP-адрес для доступа к машине из интернета и организации работы с Telegram.</li>
<li>Docker — система контейнеризации.</li>
<li>Docker Compose — инструмент для запуска и управления Docker-контейнерами.</li>
<li>n8n — платформа с открытым кодом для автоматизации рабочих процессов и интеграции сервисов. Подходит для экспериментов и пет-проектов.</li>
<li>BotFather — Telegram-бот для создания ботов.</li>
</ul>
<p>Шаги:</p>
<ol>
<li>Разверните ресурсы в облаке.</li>
<li>Настройте окружение виртуальной машины.</li>
<li>Разверните Docker-контейнер с n8n для проекта.</li>
<li>Зарегистрируйте бота в Telegram.</li>
<li>Создайте поток для отправки сообщения на портале n8n.</li>
<li>Протестируйте работу бота.</li>
</ol>
<h3>Перед началом работы</h3>
<p>Зарегистрируйтесь в личном кабинете Cloud.ru.</p>
<p>Если вы уже зарегистрированы, войдите под своей учетной записью.</p>
<h4>1. Разверните ресурсы в облаке</h4>
<p>На этом шаге вы создадите бесплатную виртуальную машину и назначите ей публичный IP-адрес с заданными настройками трафика.</p>
<ol>
<li><b>Создайте бесплатную виртуальную машину</b> со следующими параметрами:
<ul>
<li>Название — например currency-bot-server .</li>
<li>Публичный образ с Ubuntu 22.04.</li>
<li>Публичный IP — оставьте Арендовать новый или выберите IP-адрес из списка арендованных.</li>
<li>Логин — оставьте значение по умолчанию или укажите новый.</li>
<li>Метод аутентификации — Публичный ключ и Пароль .</li>
<li>Публичный ключ — укажите ключ, созданный ранее.</li>
<li>Пароль — задайте пароль пользователя.</li>
<li>Имя хоста — currencybot .</li>
<li>Остальные параметры оставьте по умолчанию или выберите на свое усмотрение.</li>
</ul>
</li>
<li>Убедитесь, что в личном кабинете на странице Инфраструктура → Виртуальные машины отображается виртуальная машина со статусом «Запущена» и назначенным публичным IP-адресом.</li>
<li>Уточните зону доступности, в которой была создана виртуальная машина.</li>
<li><b>Создайте группу безопасности</b> с названием currency-bot в той же зоне доступности и добавьте в нее правила:</li>
<table>
<tr>
<th>Трафик</th>
<th>Протокол</th>
<th>Порт</th>
<th>Тип источника/адресата</th>
<th>Источник/Адресат</th>
</tr>
<tr>
<td>Входящий</td>
<td>TCP</td>
<td>22</td>
<td>IP-адрес</td>
<td>0.0.0.0/0</td>
</tr>
<tr>
<td>Входящий</td>
<td>TCP</td>
<td>5678</td>
<td>IP-адрес</td>
<td>0.0.0.0/0</td>
</tr>
<tr>
<td>Исходящий</td>
<td>TCP</td>
<td>80</td>
<td>IP-адрес</td>
<td>0.0.0.0/0</td>
</tr>
<tr>
<td>Исходящий</td>
<td>TCP</td>
<td>443</td>
<td>IP-адрес</td>
<td>0.0.0.0/0</td>
</tr>
</table>
</ol>
<li>Назначьте созданную группу безопасности виртуальной машине.</li>
<h4>2. Настройте окружение виртуальной машины</h4>
<p>На этом шаге вы установите необходимые пакеты и подготовите среду для n8n.</p>
<ol>
<li>Подключитесь к виртуальной машине по SSH.</li>
<li>Обновите систему и установите утилиты:</li>
</ol>
<pre>sudo apt update &amp;&amp; sudo apt upgrade -y</pre>
<p>Добавьте настройки DNS для разрешения доменных имен:</p>
<ol>
<li>Откройте файл /etc/resolv.conf для редактирования:</li>
</ol>
<pre>sudo nano /etc/resolv.conf</pre>
<ol start="2">
<li>Добывте следующие настройки и сохраните файл:</li>
</ol>
<pre>nameserver 8.8.8.8
nameserver 8.8.4.4</pre>
<ol start="3">
<li>Перезагрузите виртуальную машину и подключитесь к ней по SSH.</li>
</ol>
<p>Подготовьте систему к безопасной установке Docker, добавив официальный репозиторий и настроив механизмы проверки подлинности пакетов:</p>
<pre>sudo apt-get install ca-certificates curl -y
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsS https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg</pre>
<ol>
<li>Установите Docker, Docker Compose и сопутствующее ПО:</li>
</ol>
<pre>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</pre>
<ol start="2">
<li>Добавьте текущего пользователя виртуальной машины в группу Docker:</li>
</ol>
<ol>
<li>Выполните команду:</li>
</ol>
<pre>sudo usermod -aG docker $USER
newgrp docker</pre>
<ol start="2">
<li>Перезагрузите систему.</li>
<li>Проверьте работоспособность Docker:</li>
</ol>
<pre>docker run hello-world</pre>
<p>Появится сообщение, подтверждающее успешность установки и настройки.</p>
<div class="note">
<b>Примечание</b>
<p>В некоторых случаях права на использование Docker без префикса sudo не сохраняются и командная строка возвращает ошибку permission denied . В этом случае вы можете продолжить работу с Docker, добавляя в начало каждой команды префикс sudo .</p>
</div>
<h4>3. Разверните Docker-контейнер с n8n для проекта</h4>
<p>На этом шаге вы развернете n8n.</p>
<ol>
<li>Создайте папку проекта и перейдите в нее:</li>
</ol>
<pre>mkdir ~/n8n &amp;&amp; cd ~/n8n</pre>
<ol start="2">
<li>Создайте файл манифеста для Docker-контейнера:</li>
</ol>
<pre>nano docker-compose.yml</pre>
<ol start="3">
<li>Вставьте следующую конфигурацию:</li>
</ol>
<pre>
services:
  n8n:
    image: n8nio/n8n:latest
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=adminpass
      - N8N_BASIC_AUTH_COOKIE=false
    volumes:
      - n8n_data:/home/node/n8n

volumes:
  n8n_data:
</pre>
<ol start="4">
<li>Запустите n8n, выполнив команду:</li>
</ol>
<pre>docker compose up -d</pre>
<ol start="5">
<li>Проверьте работу n8n.</li>
</ol>
<ol>
<li>В браузере перейдите по ссылке http://<ip_address>:5678 , где <ip_address> — это публичный IP-адрес вашей виртуальной машины.</li>
<li>Создайте учетную запись n8n или войдите под уже существующей.</li>
</ol>
<p>После создания учетной записи открывается портал n8n.</p>
<h4>4. Зарегистрируйте бота в Telegram</h4>
<p>На этом шаге вы зарегистрируете в Telegram нового бота и получите его токен.</p>
<ol>
<li>В Telegram найдите бота BotFather.</li>
<li>Выполните команду /newbot .</li>
<li>Задайте имя (name) и имя пользователя (username) для бота.
<p>Имя пользователя должно заканчиваться на _Bot или _bot .</p>
<p>В результате регистрации BotFather сообщит токен бота. Сохраните его, он понадобится далее.</li>
<li>Убедитесь, что созданный бот отображается в Telegram при поиске по имени.</li>
<li>Откройте диалог с созданным ботом и нажмите Start или напишите в диалог сообщение /start , чтобы запустить его.</li>
<li>В диалог с ботом отправьте любое сообщение, например привет . Если бот не возвращает ответ, отправьте еще несколько сообщений.</li>
<li>В терминале вашей виртуальной машины выполните запрос:</li>
</ol>
<pre>curl https://api.telegram.org/bot<your_token>/getUpdates</pre>
<p>Полученный ответ должен выглядеть следующим образом:</p>
<pre>[{"ok":true,"result":[{"update_id":654369611,"message":{"from":{"id":989698711,"is_bot":false</pre>
<ol start="8">
<li>Скопируйте и сохраните числовой идентификатор с признаком is_bot — в примере это 989698711 .</li>
</ol>
<h4>5. Создайте поток для отправки сообщения на портале n8n</h4>
<p>На этом шаге вы создадите рабочий сценарий, в результате которого сервер n8n будет получать актуальный курс валют с сайта ЦБ РФ и отправлять в Telegram.</p>
<ol>
<li>В браузере перейдите по ссылке http://<ip_address>:5678 .</li>
<li>Нажмите Create Workflow .</li>
<li>Добавьте узел, который будет определять расписание отправки сообщений.
<ul>
<li>Нажмите Add First Step и выберите On a schedule .</li>
<li>В поле Trigger Interval выберите Custom (Cron) .</li>
<li>В открывшемся поле введите значение 0 9 * * * для запуска каждый день в 09:00.</li>
<li>В верхней части окна настройки расписания нажмите activate, чтобы включить выполнение запроса по расписанию.</li>
<li>В левом верхнем углу нажмите Back to canvas.</li>
</ul>
</li>
<li>Добавьте узел, который будет получать информацию с сайта ЦБ РФ.
<ul>
<li>Справа от предыдущего элемента нажмите + и выберите HTTP Request .</li>
<li>В поле URL введите значение: https://www.cbr-xml-daily.ru/daily.json.js . Выполнение этого запроса возвращает данные от ЦБ РФ о курсах валют в формате JSON.</li>
<li>Нажмите Add option и выберите Response .</li>
<li>В поле ResponseFormat выберите JSON .</li>
<li>В левом верхнем углу нажмите Back to canvas.</li>
</ul>
</li>
<li>Добавьте узел, который будет обрабатывать и форматировать полученные данные.
<ul>
<li>Справа от предыдущего элемента нажмите + и выберите Code → Code in JavaScript.</li>
<li>В поле Code вставьте код:</li>
</ul>
<pre>// Receive data from the previous node
const response = $input.all()[0].json;

// Extract exchange rates
const usdRate = response.Valute.USD.Value;
const eurRate = response.Valute.EUR.Value;

// Format the result
return [
  {text: 'Курс валют от ЦБ РФ: USD: ${usdRate.toFixed(2)}\nEUR: ${eurRate.toFixed(2)}'}
]</pre>
<li>В левом верхнем углу нажмите Back to canvas.</li>
<li>Добавьте узел, который будет отправлять сообщение в Telegram.
<ul>
<li>Справа от предыдущего элемента нажмите + и выберите Telegram → Send a text message .</li>
<li>В поле Credential to connect with выберите Create new credentials .</li>
<li>В поле Access Token вставьте API-токен вашего бота, полученный от BotFather.</li>
<li>В правом верхнем углу нажмите Save и закройте окно добавления токена.</li>
<li>В поле Resource выберите Message .</li>
<li>В поле Operation выберите Send Message .</li>
<li>В поле Chat ID укажите числовой идентификатор чата, полученный на предыдущем шаге. В примере это 989698711 .</li>
<li>В поле Text выберите режим Expression и введите {{ $json["text"] }} .</li>
<li>В левом верхнем углу нажмите Back to canvas.</li>
</ul>
</li>
</ol>
<p>Созданный поток будет выглядеть следующим образом:</p>
<p><img src="https://example.com/image.png" alt="Созданный поток"></p>
<h4>6. Протестируйте работу бота</h4>
<p>Чтобы протестировать работу потока, в нижней части рабочей области n8n нажмите Execute workflow . В бот придет сообщение с курсом валют от ЦБ РФ:</p>
<p><img src="https://example.com/image.png" alt="Сообщение бота"></p>
<h4>Результат</h4>
<p>Вы развернули и настроили платформу для автоматизации n8n на виртуальной машине, создали Telegram-бот для отправки сообщений и рабочий сценарий, в результате которого сервер n8n получает курсы валют с сайта ЦБ РФ и отправляет их в Telegram.</p>
<p>В дальнейшем вы можете развить этот проект, добавив возможность запрашивать через Telegram-бот курс Bitcoin, который нужно будет получать из другого источника.</p>