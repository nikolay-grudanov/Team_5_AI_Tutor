---
source_image: docs_tutorials-evolution_list_topics_free-tier-vm__nextcloud.jpg
page_number: 0
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 48.48
tokens: 11561
characters: 7662
timestamp: 2025-12-24T05:42:56.864239
finish_reason: stop
---

### Организация хранения файлов через Nextcloud с доступом через веб-интерфейс и мобильное приложение

С помощью этого руководства вы развернете решение для работы с личными файлами на основе продукта Nextcloud. После развертывания продукта вы сможете работать с файлами через веб-интерфейс или с помощью приложений (Windows, MacOS X, Linux, Android и iOS).

Вы будете использовать следующие сервисы:

• Виртуальная машина free tier — сервис, в рамках которого предоставляется бесплатная виртуальная машина с готовой конфигурацией.

• Публичный IP-адрес для доступа к веб-интерфейсу хранилища.

• Object Storage — объектное S3-хранилище с бесплатным хранением файлов, объемом до 15 ГБ.

• (Опционально) Бесплатный сервис nip.io для получения публичного доменного имени и сертификата. Вы также можете использовать собственное зарегистрированное доменное имя и SSL-сертификат для организации доступа.

Шаги:

1. Разверните ресурсы в облаке.
2. Установите и настройте Nextcloud.
3. Настройте доменное имя.
4. Загрузите файлы в хранилище через Nextcloud.
5. Проверьте отображение файлов в Object Storage.

Перед началом работы

1. Зарегистрируйтесь в личном кабинете Cloud.ru.
   Если вы уже зарегистрированы, войдите под своей учетной записью.
2. Получите ключи доступа Key ID и Key Secret.

1. Разверните ресурсы в облаке

На этом шаге вы создадите бесплатную виртуальную машину и бакет в хранилище Object Storage.

1. Создайте виртуальную машину со следующими параметрами:
   • Название — nextcloud-server .
   • Образ — на вкладке Публичные выберите образ с Ubuntu 22.04.
   • Публичный IP — оставьте Арендовать новый или выберите IP-адрес из списка арендованных.
   • Логин — оставьте значение по умолчанию или укажите новый.
   • Метод аутентификации — Публичный ключ и Пароль .
   • Пароль — задайте пароль пользователя.
   • Остальные параметры оставьте по умолчанию или выберите на свое усмотрение.
2. Уточните зону доступности, в которой была создана виртуальная машина.
3. Создайте группу безопасности с названием nextcloud-server в той же зоне доступности и добавьте в нее правила:

<table>
  <tr>
    <th>Трафик</th>
    <th>Протокол</th>
    <th>Порт</th>
    <th>Тип источника/адресата</th>
    <th>Источник/Адресат</th>
  </tr>
  <tr>
    <td>Входящий</td>
    <td>TCP</td>
    <td>443</td>
    <td>IP-адрес</td>
    <td>0.0.0.0/0</td>
  </tr>
  <tr>
    <td>Входящий</td>
    <td>TCP</td>
    <td>80</td>
    <td>IP-адрес</td>
    <td>0.0.0.0/0</td>
  </tr>
  <tr>
    <td>Исходящий</td>
    <td>Любой</td>
    <td>—</td>
    <td>IP-адрес</td>
    <td>0.0.0.0/0</td>
  </tr>
</table>

4. Назначьте созданную группу безопасности виртуальной машине.
5. Создайте бакет в сервисе Object Storage со следующими параметрами:
   • Название — название бакета в формате <name>-nextcloud-data , например ivan-nextcloud-data .
   • Доменное имя — название домена в формате <name>-nextcloud-data , например ivan-nextcloud-data .
   • Класс хранения по умолчанию — стандартный.
   • (Опционально) Максимальный размер — включите опцию и укажите максимальный размер бакета. При выключеной опции размер бакета не будет ограничен.
6. Проверьте создание ресурсов:
   a. Убедитесь, что в личном кабинете на странице Сети → Группы безопасности отображается группа безопасности nextcloud-server со статусом «Создана».
   b. Убедитесь, что в личном кабинете на странице Инфраструктура → Виртуальные машины отображается виртуальная машина nextcloud-server со статусом «Запущена». Виртуальной машине назначен публичный IP-адрес.
   c. Скопируйте и сохраните публичный IP-адрес, он понадобится далее.
   d. Убедитесь, что в личном кабинете на странице Хранение данных→ Object Storage отображается бакет <name>-nextcloud-data .
   e. Скопируйте и сохраните ID тенанта, он понадобится далее.

2. Установите и настройте Nextcloud

На этом шаге вы установите и настроите Nextcloud на виртуальной машине, а также настроите хранение данных в Object Storage.

1. Подключитесь к виртуальной машине через серийную консоль.
2. Обновите систему и установите утилиты:

   sudo apt update && sudo apt upgrade -y

3. Установите пакет NextCloud:

   sudo snap install nextcloud

4. Выделите объем памяти для Nextcloud:

   sudo snap set nextcloud php.memory-limit=2048M

5. Включите компрессию HTTP:

   sudo snap set nextcloud http.compression=true

6. Создайте пользователя — укажите <username> и <password> :

   sudo nextcloud.manual-install <username> <password>

Когда установка закончится, в консоли отобразится сообщение «Nextcloud was successfully installed».

7. Выполните построчно команды для настройки хранения данных в Object Storage:

   sudo nextcloud.occ config:system:set objectstore class --value="OC\\Files\\ObjectStore\\S3"
   sudo nextcloud.occ config:system:set objectstore arguments bucket --value="<bucket_name>"
   sudo nextcloud.occ config:system:set objectstore arguments key --value="<tenant_id>:<key_id>"
   sudo nextcloud.occ config:system:set objectstore arguments secret --value="<key_secret>"
   sudo nextcloud.occ config:system:set objectstore arguments hostname --value="a3.cloud.ru"
   sudo nextcloud.occ config:system:set objectstore arguments port --value="443"
   sudo nextcloud.occ config:system:set objectstore arguments use_ssl --value=true
   sudo nextcloud.occ config:system:set objectstore arguments region --value="ru-central-1"

Где:
• <bucket_name> — название бакета, созданного на предыдущем шаге, в формате <name>-nextcloud-data .
• <tenant_id> — идентификатор тенанта в Object Storage.
• <key_id> , <key_secret> — ключи доступа.

8. Проверьте корректность настройки:

   snap changes nextcloud

В ответе вернется информация об установке Nextcloud и изменении его конфигурации.

3. Настройте доменное имя

На этом шаге вы создадите доменное имя и получите SSL-сертификат, используя сервис nip.io.

Вы также можете использовать собственный домен и SSL-сертификат.

1. Подготовьте доменное имя вида <ip_address>.nip.io , где <ip_address> — публичный IP-адрес виртуальной машины nextcloud-server .
2. Настройте доверенное доменное имя:

   sudo nextcloud.occ config:system:set trusted_domains 1 --value=<ip_address>.nip.io

3. Настройте SSL-сертификат:
   a. Выполните команду:

      sudo nextcloud.enable-https lets-encrypt

   b. Нажмите y в ответ на вопрос «Have you met these requirements?».
   c. Укажите свой email.
   d. Укажите домен <ip_address>.nip.io , подготовленный ранее.

4. Загрузите файлы в хранилище через Nextcloud

Для проверки работы системы загрузите файл через браузер:

1. Откройте браузер и перейдите по адресу <ip_address>.nip.io .

Откроется страница авторизации Nextcloud.

2. Авторизуйтесь в Nextcloud, используя username и password , которые вы задавали на шаге 2.
3. Перейдите в раздел Все файлы и загрузите любой файл.
4. Убедитесь, что файл появился в Nextcloud.

Для работы с Nextcloud через мобильное устройство:

1. Скачайте приложение Nextcloud.
2. Нажмите Войти и укажите в адрес сервера <ip address>.nip.io .

В приложении отобразится загруженный через веб-интерфейс файл.

5. Проверьте отображение файлов в Object Storage

Проверьте, что в качестве хранилища для файлов используется Object Storage.

1. В личном кабинете на верхней панели слева нажмите и выберите Хранение данных→ Object Storage.
2. Выберите бакет, созданный на шаге 1.

В бакете отображаются служебные и загруженные файлы. Реальные имена файлов при этом заменены на служебные.

Результат

Вы настроили и запустили собственный сервер для работы и обмена файлами на базе Nextcloud, а также проверили его работу в браузере и на мобильном устройстве.

Теперь вы можете загружать и работать с файлами через браузер и мобильные приложения.