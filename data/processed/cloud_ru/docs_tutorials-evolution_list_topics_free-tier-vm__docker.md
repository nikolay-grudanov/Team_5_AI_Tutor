---
source_image: docs_tutorials-evolution_list_topics_free-tier-vm__docker.jpg
page_number: 0
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 79.43
tokens: 9971
characters: 5548
timestamp: 2025-12-24T05:40:58.220093
finish_reason: stop
---

Запуск контейнеризированного приложения на виртуальной машине с помощью Docker и Docker Compose

С помощью этого руководства вы соберете контейнерное приложение и запустите его на виртуальной машине.

Вы будете использовать следующие сервисы:

• Виртуальная машина free tier — сервис, в рамках которого предоставляется бесплатная виртуальная машина с готовой конфигурацией.
• Публичный IP-адрес для доступа к приложению из интернета.
• Docker — система контейнеризации.
• Docker Compose — инструмент для запуска и управления Docker-контейнерами.

Шаги:

1. Создайте виртуальную машину.
2. Настройте группу безопасности.
3. Установите Docker Engine.
4. Создайте и запустите контейнер с помощью средств Docker.
5. Создайте приложение с помощью Docker Compose.

Перед началом работы

Зарегистрируйтесь в личном кабинете Cloud.ru.

Если вы уже зарегистрированы, войдите под своей учетной записью.

1. Создайте виртуальную машину
1. Сгенерируйте ключевую пару.
2. Загрузите публичный ключ в облако.
3. Создайте бесплатную виртуальную машину со следующими параметрами:
   a. В поле Название укажите название виртуальной машины, например docker-server.
   b. На вкладке Публичные выберите образ Ubuntu 22.04.
   c. Назначьте публичный IP-адрес виртуальной машины — оставьте включенной опцию Подключить публичный IP. Для виртуальной машины будет арендован и назначен прямой публичный IP.
   d. В поле Логин укажите логин пользователя виртуальной машины, например user1.
   e. Выберите метод аутентификации — публичный ключ.
   f. В поле Публичный ключ выберите ключ, загруженный на предыдущем шаге.
Убедитесь, что в личном кабинете на странице сервиса «Виртуальные машины»:
• отображается виртуальная машина docker-server;
• статус виртуальной машины — «Запущена»;
• виртуальной машине назначен публичный IP-адрес.

2. Настройте группу безопасности
Группы безопасности в облаке Evolution позволяют контролировать входящий и исходящий трафик для создаваемых ресурсов.

Вы настроите правила фильтрации трафика — разрешите весь входящий трафик по порту 80 и весь исходящий трафик. Создайте новую группу безопасности со следующими параметрами:
1. Выберите Зону доступности, в которой необходимо разместить группу безопасности. Укажите ту же зону доступности, что выбрана для виртуальной машины docker-server.
2. Укажите Название группы безопасности, например docker-server.
3. Добавьте правила входящего и исходящего трафика.
Правило входящего трафика:
• Протокол — TCP.
• Порт — 80.
• Типисточника — IP-адрес.
• Источник — 0.0.0.0/0.
Правило исходящего трафика:
• Протокол — Любой.
• Порт — оставьте пустым.
• Тип адресата — IP-адрес.
• Адресат — 0.0.0.0/0.
4. Назначьте созданную группу безопасности виртуальной машине docker-server. Если в группе безопасности присутствуют другие виртуальные машины, исключите их из группы.
Убедитесь, что в личном кабинете на странице сервиса «Виртуальные машины» в разделе Сетевые параметры отображается группа безопасности.

3. Установите Docker Engine
1. Подключитесь к виртуальной машине по SSH.
2. В командной строке выполните команду:
   curl -fsSL get.docker.com -o get-docker.sh && sudo sh get-docker.sh

4. Создайте и запустите контейнер с помощью средств Docker
1. Создайте директорию containerapp и перейдите в нее. В командной строке выполните команду:
   mkdir containerapp && cd containerapp
2. Создайте файл Dockerfile:
   sudo nano Dockerfile
3. В открывшемся редакторе nano вставьте текст:
   FROM tiangolo/uwsgi-nginx-flask:python3.12
   COPY ./app /app
4. Нажмите комбинацию клавиш Ctrl + O , чтобы сохранить файл.
5. Нажмите комбинацию клавиш Ctrl + X , чтобы выйти из редактора nano.
6. Создайте директорию для приложения app и перейдите в нее:
   mkdir app && cd app
7. Создайте python-файл приложения:
   sudo nano main.py
8. В открывшемся окне редактора вставьте код:
   from flask import Flask
   app = Flask(__name__)
   @app.route("/")
   def hello():
       return "Hello World from Flask"
   if __name__ == "__main__":
       app.run(host="0.0.0.0", debug=True, port=80)
9. Вернитесь на уровень выше — в директорию containerapp :
   cd ..
10. Соберите образ контейнера:
    sudo docker build -t containerapp .
11. После того как сборка образа закончится, запустите контейнер на виртуальной машине:
    sudo docker run --name containerapp -p 80:80 containerapp
12. Убедитесь, что созданный мини-сайт доступен по публичному адресу виртуальной машины. В браузере перейдите по адресу http://<публичный_IP_виртуальной_машины> — откроется страница с текстом «Hello World from Flask».

5. Создайте приложение с помощью Docker Compose
1. Остановите и удалите контейнер Docker. В командной строке выполните команду:
   sudo docker rm -f containerapp
2. Установите docker-compose:
   sudo apt install docker-compose
3. Создайте файл docker-compose в директории containerapp :
   sudo nano docker-compose.yml
4. Вставьте в созданный файл описание создаваемого контейнера:
   version: '3.8'
   services:
     flask-app:
       image: tiangolo/uwsgi-nginx-flask:python3.12
       ports:
         - "80:80"
       volumes:
         - ./app/main.py:/app/main.py
5. Запустите контейнер с помощью docker-compose:
   sudo docker-compose up -d flask-app
6. Убедитесь, что приложение успешно запущено, — в браузере перейдите по адресу http://<публичный_IP_виртуальной_машины> . Если все предыдущие шаги были выполнены корректно, на странице браузера отобразится следующий текст:

Hello World from Flask

Результат
Вы создали виртуальную машину и запустили контейнерное приложение с помощью Docker и Docker Compose.