---
source_image: page_437.png
page_number: 437
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 64.16
tokens: 11623
characters: 2252
timestamp: 2025-12-24T06:41:00.634128
finish_reason: stop
---

<table>
  <tr>
    <th>Операция</th>
    <th>Число затронутых объектов</th>
  </tr>
  <tr>
    <td>MAKE-SET\((x_1)\)</td>
    <td>1</td>
  </tr>
  <tr>
    <td>MAKE-SET\((x_2)\)</td>
    <td>1</td>
  </tr>
  <tr>
    <td>...</td>
    <td>...</td>
  </tr>
  <tr>
    <td>MAKE-SET\((x_n)\)</td>
    <td>1</td>
  </tr>
  <tr>
    <td>UNION\((x_1, x_2)\)</td>
    <td>1</td>
  </tr>
  <tr>
    <td>UNION\((x_2, x_3)\)</td>
    <td>2</td>
  </tr>
  <tr>
    <td>UNION\((x_3, x_4)\)</td>
    <td>3</td>
  </tr>
  <tr>
    <td>...</td>
    <td>...</td>
  </tr>
  <tr>
    <td>UNION\((x_{n-1}, x_n)\)</td>
    <td>\(n - 1\)</td>
  </tr>
</table>

Рисунок 22.2  22.3 Время выполнения квадратично зависит от числа операций.

ций будет пропорциональна

\[
n + \sum_{i=1}^{n-1} i = \Theta(n^2).
\]

Весовая эвристика
Простейшая реализация операции UNION работает медленно из-за того, что при добавлении длинного списка к короткому приходится присваивать новые значения большому количеству указателей. Дела пойдут лучше, если поступить так: хранить вместе с каждым списком информацию о числе элементов в нём, а при выполнении операции UNION добавлять более короткий список в конец более длинного (если длины равны, порядок может быть любым). Такой приём называется весовой эвристикой (weighted-union heuristic). Если объединяемые множества содержат примерно поровну элементов, то большого выигрыша не будет, но в целом, как показывает следующая теорема, мы добиваемся экономии.

Теорема 22-1
Предположим, что система непересекающихся множеств реализована с помощью списков, а в операции UNION использована весовая эвристика. Тогда стоимость последовательности из \(m\) операций MAKE-SET, UNION и FIND-SET, среди которых \(n\) операций MAKE-SET, есть \(O(m + n \lg n)\) (подразумевается, что первоначально система непересекающихся множеств была пуста).

Доказательство.
Стоимость каждой из операций MAKE-SET и FIND-SET, а также стоимость сравнения размеров, соединения списков и обновления записи о размере множества (все эти действия выполняются при операции UNION), есть \(O(1)\), так что суммарная стоимость указанных действий есть \(O(m)\).

Остаётся оценить стоимость обновления указателей на начало списка. Для этого мы зафиксируем один из элементов (обозначим