---
source_image: page_853.png
page_number: 853
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 77.92
tokens: 11970
characters: 2882
timestamp: 2025-12-24T07:00:43.987990
finish_reason: stop
---

36.17 Граф G, построенный по формуле \( \varphi = (\neg x_1 \lor x_2 \lor \neg x_3) \land (x_1 \lor \neg x_2 \lor x_3) \land (x_1 \lor x_2 \lor \neg x_3) \). Для этой формулы имеется выполняющий набор \( x_1 = 0, x_2 = 1, x_3 = 1 \). Соответствующий гамильтонов цикл показан серым. Отметим, что если в наборе \( x_m = 1 \), то в цикл входит ребро \( e_m \), а если \( x_m = 0 \), то \( \bar{e}_m \).

из нескольких блоков типа A и B (рис. 36.17).
Предположим, что формула \( \varphi \) составлена из k дизъюнкций \( C_1, C_2, \ldots, C_k \), каждая из которых содержит ровно 3 литерала. Для каждой дизъюнкции \( C_i \) изготовим блок типа B; обозначим через \( b_{i,j} \) соответствующие копии вершин \( b_j \). Соединим вершины \( b_{i,4} \) и \( b_{i+1,1} \) для \( i = 1, 2, \ldots, k-1 \).

Далее, каждой переменной \( x_m \) формулы \( \varphi \) мы сопоставим пару вершин \( x'_m, x''_m \). Эти вершины мы соединим двумя рёбрами \( e_m \) и \( e'_m \). (На самом деле, как мы увидим, это будут не рёбра, а более сложные конструкции, так что кратных рёбер не будет.) Идея здесь в том, что гамильтонов цикл будет проходить через ребро \( e_m \), если в выполняющем наборе переменная \( x_m \) принимает значение 1, и через \( e'_m \), если эта переменная принимает значение 0.

Чтобы дать гамильтонову циклу возможность пройти по \( e_m \) или \( e'_m \), добавим в граф рёбра \( (x''_m, x'_{m+1}) \) для \( m = 1, 2, \ldots, m-1 \) и также ещё два ребра: \( (b_{1,1}, x'_1) \) и \( (b_{k,4}, x''_n) \) (верхнее и нижнее рёбра, рис. 36.17).

Построение графа ещё не окончено, мы должны связать блоки графа, соответствующие переменным формулы, с блоками, соответствующими её дизъюнкциям. Если j-ый литерал дизъюнкции \( C_i \) есть \( x_m \), соединим ребро \( (b_{i,j}, b_{i,j+1}) \) с ребром \( e_m \) с помощью A-блока. Если же j-ым литералом дизъюнкции \( C_i \) является \( \neg x_m \), мы соединим с помощью A-блока рёбра \( (b_{i,j}, b_{i,j+1}) \) и \( \bar{e}_m \). Так, в примере рис. 36.17 имеем \( C_2 = x_1 \lor \neg x_2 \lor x_3 \), поэтому мы размещаем три A-блока между рёбрами
\[
(b_{2,1}, b_{2,2}) \text{ и } e_1;
(b_{2,2}, b_{2,3}) \text{ и } \bar{e}_2;
(b_{2,3}, b_{2,4}) \text{ и } e_3.
\]
Отметим, что слова "соединить два рёбра с помощью A" означают, что каждое из них заменяется на цепочку из пяти новых рёбер и добавляются связывающие их рёбра и вершины, как это предусмотрено конструкцией A-блока (рис. 36.15).

Один литерал \( l_m \) может встречаться в нескольких дизъюнкциях (например, \( \neg x_3 \) на рис. 36.17). В этих случаях требуется "подключить" к соответствующему рёbru несколько A-блоков; это можно сделать, если входящие в A-блоки цепочки из пяти рёбер соединить последовательно, как показано на рис. 36.18.

Мы утверждаем, что формула \( \varphi \) выполнима, если и только если построенный граф G имеет гамильтонов цикл. Предположим сна-