---
source_image: page_808.png
page_number: 808
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.26
tokens: 11578
characters: 2071
timestamp: 2025-12-24T06:58:13.636931
finish_reason: stop
---

35.7
Работа процедуры textscGraham-Scan для множества Q (рис. 35.6).
Для каждого из шагов текущее содержимое стека S показано серым.
(a) Точки \( \langle p_1, p_2, ... p_m \rangle \) отсортированы по полярному углу относительно \( p_0 \); в стеке — первые три точки \( (p_0, p_1, p_2) \).
(b) — (k) Стек S после очередной итерации цикла for (строки 7 — 10 ). Пунктирными линиями показаны повороты, которые не являются левыми; в этом случае вершина угла поворота удаляется из стека. Например, на этапе (h) из стека сначала удаляется точка \( p_8 \) (правый поворот \( p_7 p_8 p_9 \)), а затем точка \( p_7 \) (правый поворот \( p_6 p_7 p_9 \)).
(l) Результат работы алгоритма — выпуклая оболочка — совпадает с приведённой на рис. 35.6.

Q из (не менее чем трёх) точек. Процедура использует функцию Top(S), которая возвращает точку, находящуюся в вершине стека S (не меняя содержимого стека), а также функцию Next-To-Top(S), которая возвращает следующий за вершиной элемент стека, также не меняя содержимого. Мы докажем, что по окончании работы в стеке (от дна к вершине) идут как раз вершины CH(Q) (в порядке обхода против часовой стрелки).

Graham-Scan(Q)
1 пусть $p_0$ --- точка из множества $Q$ с наименьшей ординатой
    (если таковых несколько --- самая левая)
2 пусть $\langle p_1, p_2, ... p_m \rangle$ --- остальные точки
    множества $Q$, отсортированные в порядке возрастания полярного угла (против часовой стрелки) относительно точки $p_0$
    Если есть несколько точек с одинаковым полярным углом,
        то оставляем только самую удалённую от $p_0$.
3 сделать стек $S$ пустым
4 $Push(S, p_0)$
5 $Push(S, p_1)$
6 $Push(S, p_2)$
7 \emph{for} $i \leftarrow 3 \emph{to} m$
8     \emph{do while} при движении по ломаной
         $Next-To-Top(S) \rightarrow Top(S) \rightarrow p_i$
         мы двигаемся прямо или направо
9         \emph{do} $Pop(S)$
10     $Push(S, p_i)$
11 \emph{return} $S$

На рисунке 35.7 показаны шаги выполнения алгоритма GRAHAM-SCAN. В строке 1 мы находим точку p0; все остальные точки множества Q находятся выше неё (или на одном уровне,