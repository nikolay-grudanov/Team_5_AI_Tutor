---
source_image: page_500.png
page_number: 500
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.40
tokens: 11740
characters: 2672
timestamp: 2025-12-24T06:43:57.193881
finish_reason: stop
---

\((u, v)\) имеем

\[
d[v] \leq d[u] + w(u, v) = \delta(s, u) + w(u, v) = \delta(s, v)
\]

(последнее равенство — по следствию 25.2). Поскольку, с другой стороны, \(d[v] \geq \delta(s, v)\) по лемме 25.5, получаем, что \(d[v] = \delta(s, v)\) сразу после релаксации (а значит, и позже).

Деревья кратчайших путей

Посмотрим, что происходит при наших операциях с подграфом предшествования \(G_{\pi}\).

Лемма 25.8
Пусть \(G = (V, E)\) — взвешенный ориентированный граф с весовой функцией \(w\) и исходной вершиной \(s\), причем в графе \(G\) нет циклов отрицательного веса, достижимых из \(s\). Тогда после операции INITIALIZE-SINGLE-SOURCE\((G, s)\), за которой следует произвольная последовательность релаксаций рёбер, подграф предшественников \(G_{\pi}\) является деревом с корнем \(s\).

Доказательство
Напомним, что вершинами графа \(G_{\pi}\) являются те вершины \(v \in V\), для которых \(\pi[v] \neq NIL\), а также вершина \(s\). Другими словами, в него входят те вершины \(v\), для которых \(d[v]\) конечно (чтобы убедиться в этом, достаточно посмотреть на процедуру релаксации: при уменьшении \(d[v]\) происходит присваивание переменной \(\pi[v])\). Для каждой вершины \(v\) графа \(G_{\pi}\) в этот граф включается ребро с началом \(\pi[v]\) и концом \(v\). По построению это ребро является ребром исходного графа \(G\).

Сразу после инициализации граф \(G_{\pi}\) состоит только из начальной вершины и тем самым является деревом. Мы будем доказывать по индукции, что он остаётся деревом после выполнения произвольной последовательности операций релаксации.

Когда в нём появляются новые вершины? Это происходит при выполнении операции релаксации ребра \((u, v)\), до которой \(d[v]\) было бесконечным (а стало конечным — после релаксации любого ребра \((x, y)\) значение \(d[y]\) обязательно конечно). В этот момент \(\pi[v]\) становится равным \(u\), то есть к дереву \(G_{\pi}\) добавляется лист. При этом оно остаётся деревом.

Остаётся проверить, что граф \(G_{\pi}\) остаётся деревом и в том случае, когда при релаксации ребра \((u, v)\) значение \(d[v]\) уменьшается от одного конечного значения до другого. Давайте посмотрим, что происходит с \(G_{\pi}\) при релаксации такого ребра \((u, v)\). Поддерево с корнем в \(v\) отрезается (от прежнего родителя вершины \(v\)) и прививается к вершине \(u\) (\(\pi[v]\) становится равным \(u\)). Это может нарушить структуру дерева только в том случае, если вершина \(u\) была потомком вершины \(v\), то есть лежала в поддереве с корнем \(v\) (при этом образуется цикл, см. рис. 25.4)

Нам остаётся убедиться, что такого произойти не может. Проверим, что в этом случае образующийся цикл (от \(v\) к \(u\) в дереве