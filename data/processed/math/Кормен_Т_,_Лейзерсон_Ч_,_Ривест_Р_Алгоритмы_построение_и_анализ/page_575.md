---
source_image: page_575.png
page_number: 575
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.11
tokens: 11638
characters: 2325
timestamp: 2025-12-24T06:47:36.267668
finish_reason: stop
---

Поскольку \( h \) — высотная функция, то \( h(u) \leq h(v) + 1 \) для любого остаточного ребра \((u, v)\). Если в и невозможно проталкивание, то для всех остаточных рёбер \((u, v)\) выполнено неравенство \(h(u) < h(v) + 1\), из чего следует, что \(h(u) \leq h(v)\), и в вершине и возможен подъём.

Корректность метода
Корректность метода проталкивания предпотока мы докажем в два этапа. Сначала мы докажем, что если алгоритм остановится, то предпоток \(f\) в этот момент будет максимальным потоком. Затем мы докажем, что алгоритм действительно остановится. Начнём с такого замечания (очевидного следующего из описания процедуры подъёма).

Лемма 27.15 (Высота вершины не убывает)
При исполнении программы Generic-Preflow-Push высота \(h[u]\) любой вершины \(u \in V\) может только возрастать (при каждом подъёме этой вершины по меньшей мере на единицу).

Лемма 27.16
Во время выполнения программы Generic-Preflow-Push функция \(h\) остаётся высотной функцией.

Доказательство
Посмотрим, что происходит при проталкивании и при подъёме.
При подъёме вершины и мы заботимся о том, чтобы выходящие из и остаточные рёбра не нарушили определение высотной функции. Что же касается входящих рёбер, то с ними не может быть проблем, так как высота вершины и только возрастает.
Рассмотрим теперь процедуру Push\((u, v)\). Легко понять, что круто идущие вниз ненасыщенные рёбра появиться не могут. Более формально, эта процедура может добавить ребро \((v, u)\) в \(E_f\), а также удалить ребро \((u, v)\) из \(E_f\). В первом случае \(h[v] = h[u] - 1\) и \(h\) остаётся высотной функцией. Во втором случае удалению ребра сопутствует отмена соответствующего ограничения и \(h\) снова остаётся высотной функцией.

Докажем одно важное свойство высотной функции.
Лемма 27.17
Пусть \(G = (V, E)\) — сеть с истоком \(s\) и стоком \(t\). Пусть \(f\) — предпоток в \(G\), а \(h\) — высотная функция для \(f\). Тогда в остаточной сети \(G_f\) не существует пути из истока в сток.

Доказательство
Пусть это не так и такой путь существует. Устраняя циклы, можно считать, что он простой и потому длина его меньше \(|V|\). При этом высота падает от \(|V|\) до нуля. Следовательно, в пути есть ребро, где высота падает по крайней мере на 2 — а такое ребро не может входить в остаточную сеть.

Теорема 27.18 (Корректность метода проталкивания предпотока)