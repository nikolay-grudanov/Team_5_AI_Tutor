---
source_image: page_419.png
page_number: 419
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.44
tokens: 11571
characters: 2279
timestamp: 2025-12-24T06:40:13.137980
finish_reason: stop
---

**Fib-Heap-Extract-Min(H)**

1. \( z \leftarrow min[H] \)
2. **if** \( z \neq NIL \)
3. **then for** (для) каждого ребёнка \( x \) вершины \( z \)
4. do добавить \( x \) в корневой список \( H \)
5. \( p[x] \leftarrow NIL \)
6. удалить \( z \) из корневого списка \( H \)
7. **if** \( z = right[z] \)
8. **then** \( min[H] \leftarrow NIL \)
9. **else** \( min[H] \leftarrow right[z] \)
10. CONSOLIDATE(\( H \))
11. \( n[H] \leftarrow n[H] - 1 \)
12. **return** \( z \)

Процедура Fib-Heap-Extract-Min перемещает всех детей удаляемой (минимальной) вершины в корневой список кучи \( H \), а саму минимальную вершину удаляет из корневого списка. Затем производится уплотнение корневого списка с помощью процедуры CONSOLIDATE.

В строке 1 указатель на минимальную вершину сохраняется в переменной \( z \) (этот указатель возвращается процедурой в строке 12). Если \( z = NIL \), исходная куча пуста, и работа заканчивается. В противном случае мы удаляем \( z \) из корневого списка \( H \) (строка 6), предварительно поместив в него всех детей вершины \( z \) (строки 3–5). Если после этого \( z = right[z] \), то вершина \( z \) не только была единственной вершиной в корневом списке, но и не имела потомков, так что теперь остается лишь сделать кучу пустой (строка 8) и возвратить \( z \). В противном случае мы меняем значение указателя \( min[H] \) так, чтобы он указывал на какую-либо вершину корневого списка, отличную от \( z \) (в данном случае — на вершину \( right[z] \)). На рис. 21.3б показано состояние кучи рис. 21.3а после выполнения строки 9.

Остаётся вызвать процедуру CONSOLIDATE (о которой мы говорим дальше) для уплотнения (consolidating) кучи. Уплотнение происходит за счёт того, что два дерева с вершинами одинаковой степени соединяются в одно (его вершина будет иметь на единицу большую степень). Эта операция (процедура Fib-Heap-Link) производится до тех пор, пока в корневом списке не останется вершин одинаковой степени.

При соединении двух вершин с помощью операции Fib-Heap-Link вершина с большим ключом (назовём её \( y \)) становится ребёнком вершины с меньшим ключом (назовём её \( x \)). При этом \( degree[x] \) увеличивается, а вершина \( y \) перестаёт быть отмеченной (если была таковой).

Процедура CONSOLIDATE использует вспомогательный массив