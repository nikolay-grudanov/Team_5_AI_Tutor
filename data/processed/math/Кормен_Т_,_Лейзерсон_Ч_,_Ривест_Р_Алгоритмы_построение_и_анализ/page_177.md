---
source_image: page_177.png
page_number: 177
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 87.58
tokens: 11763
characters: 2609
timestamp: 2025-12-24T06:29:03.994177
finish_reason: stop
---

Задачи к главе 9

\( P\{X \leq x\} \). Предположим, что на вход алгоритма поступает последовательность из \( n \) чисел, которые являются независимыми случайными величинами с функцией распределения \( P \). Функция \( P \) непрерывна и может быть вычислена за время \( O(1) \). Как отсортировать такую последовательность, чтобы среднее время сортировки линейно зависело от \( n \)?

Задачи

9-1 Нижние оценки для среднего числа сравнений

В этой задаче мы докажем, что среднее время работы любого детерминированного или вероятностного алгоритма сортировки \( n \) чисел, основанного на сравнениях, есть \( \Omega(n \lg n) \). Начнем с того, что рассмотрим детерминированный алгоритм \( A \), основанный на сравнениях; пусть \( T_A \) — его разрешающее дерево. Мы предполагаем, что все перестановки входной последовательности равновероятны.

а. Напишем на каждом листе дерева \( T_A \) вероятность того, что алгоритм завершится в этом листе. Покажите, что в \( n! \) листах написано \( 1/n! \), а в остальных листах написан нуль.

б. Обозначим через \( D(T) \) сумму глубин всех листьев в двоичном дереве \( T \) (мы предполагаем, что каждая вершина либо является листом, либо имеет двух детей — так устроены разрешающие деревья). Пусть \( T \) — дерево с \( k > 1 \) листьями, и пусть через \( LT \) и \( RT \) обозначены левое и правое поддеревья. Покажите, что \( D(T) = D(LT) + D(RT) + k \).

в. Пусть \( d(m) \) — наименьшее значение числа \( D(T) \) среди всех деревьев \( T \) с \( m \) листьями. Покажите, что \( d(k) = \min_{1 \leq i \leq k-1} \{d(i) + d(k-i) + k\} \). (Указание: дерево \( LT \) может содержать от 1 до \( k-1 \) листьев.)

г. Покажите, что для фиксированного \( k \) выражение \( i \lg i + (k-i) \lg (k-i) \) достигает минимума на отрезке от 1 до \( k-1 \) в точке \( i = k/2 \). Выведите отсюда, что \( d(k) = \Omega(k \lg k) \).

д. Покажите, что \( D(T_A) = \Omega(n! \lg(n!)) \), и выведите отсюда, что время сортировки \( n \) чисел с помощью разрешающего дерева \( T_A \), усреднённое по всем перестановкам на входе, есть \( \Omega(n \lg n) \).

Теперь рассмотрим вероятностный алгоритм \( B \), основанный на сравнениях. Его можно описать с помощью разрешающего дерева, в котором бывают узлы двух типов: соответствующие сравнениям и случайным выборам. В узлах второго типа происходит вызов процедуры RANDOM\((1, r)\); у такого узла \( r \) детей, каждый из которых выбирается с равной вероятностью. (Для разных узлов число \( r \) может быть разным.)

е. Пусть имеется вероятностный алгоритм сортировки \( B \). Для каждой перестановки на входе найдём математическое ожидание