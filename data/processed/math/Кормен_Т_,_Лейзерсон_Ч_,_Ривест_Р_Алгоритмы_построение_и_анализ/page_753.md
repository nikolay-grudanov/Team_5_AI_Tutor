---
source_image: page_753.png
page_number: 753
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 72.58
tokens: 11890
characters: 2888
timestamp: 2025-12-24T06:56:04.075762
finish_reason: stop
---

Этот случай несколько более сложен. Покажем прежде всего, что n не может быть степенью простого числа. Пусть это не так и \( n = p^e \) для нечётного простого \( p \) и для целого \( e > 1 \). Тогда по теореме 33.32 группа \( \mathbb{Z}_n^* \) является циклической, то есть содержит элемент \( g \), для которого \( ord_n(g) = |\mathbb{Z}_n^*| = \varphi(n) = (p-1)p^{e-1} \). По теореме 33.33 из сравнения (33.44) следует, что \( n - 1 \equiv 0 \pmod{\varphi(n)} \), но это невозможно, так как правая часть делится на \( p \) (и даже на \( p^{e-1} \), а левая на единицу меньше числа \( n \), делящегося на \( p \).

Итак, \( n \) является составным числом, которое не есть степень никакого простого числа, и потому содержит несколько разных простых множителей. Поэтому мы можем разложить \( n \) в произведение двух взаимно простых чисел \( n_1, n_2 > 1 \) (например, включив в \( n_1 \) один простой множитель, а в \( n_2 \) — все остальные).

Число \( n - 1 \) чётно. Выделим из него наибольшую степень двоички \( 2^t \), то есть запишем его в виде \( n - 1 = 2^t u \), где \( u \) нечётно. Для каждого \( a \in \mathbb{Z}_n^+ \) рассмотрим последовательность

\[
\hat{a} = \langle a^u, a^{2u}, a^{2^2 u}, \ldots, a^{2^t u} \rangle.
\]

состоящую из вычетов по модулю \( n \); каждый следующий её элемент получается из предыдущего возведением в квадрат, а последний элемент есть \( a^{n-1} \). Заметим, что двоичная запись числа \( n - 1 \) оканчивается на \( n \) нулей, и потому все элементы этой последовательности встретятся в качестве промежуточных результатов при вычислениях в процедуре WITNESS (которые заканчиваются \( t \) возведениями в квадрат).

Какой вид может иметь последовательность \( \hat{a} \) при различных \( a \)? Для каждого \( j = 0, 1, \ldots, t \) посмотрим, какие члены могут появляться на \( j \)-ом месте в последовательности \( a \) (для удобства начинаем нумерацию с нуля, считая \( a^u \) нулевым членом последовательности \( \hat{a} \)). Последним членом (\( j = t \)) может быть только единица (иначе мы имели бы уже рассмотренный случай 1). С другой стороны, в начале последовательности \( \hat{a} \) (то есть для \( j = 0 \)) может стоять не только 1, но и \( -1 \) (при \( a = -1 \) имеем \( a^u = -1 \), так как и нечётно), а также, возможно, и другие числа.

Рассмотрим наибольшее значение \( j \in \{0, 1, \ldots, t\} \), для которого существует такой элемент \( v \in \mathbb{Z}_n^* \), что \( v^{2^j u} \equiv -1 \pmod{n} \). (При \( j = 0 \), как мы видели, такой элемент \( v \) найдётся.) Пусть \( v \in \mathbb{Z}_n^* \) — один из таких элементов, то есть \( v^{2^j u} \equiv -1 \pmod{n} \). (Этот элемент пригодится нам чуть позже.)

Положим

\[
B = \{ x \in \mathbb{Z}_n^* : x^{2^j u} \equiv \pm 1 \pmod{n} \}.
\]

Поскольку \( B \) замкнуто относительно умножения по модулю \( n \), оно является подгруппой группы \( \mathbb{Z}_n^* \).