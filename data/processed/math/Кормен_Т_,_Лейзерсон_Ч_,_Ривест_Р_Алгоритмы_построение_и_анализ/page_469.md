---
source_image: page_469.png
page_number: 469
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 70.02
tokens: 11711
characters: 2543
timestamp: 2025-12-24T06:42:44.818424
finish_reason: stop
---

типом. Рис. 23.5(с) показывает граф рис. 23.5(а), нарисованный так, чтобы прямые рёбра и рёбра деревьев вели вниз, а обратные — вверх.

Алгоритм DFS может быть дополнен классификацией рёбер по их типам. Идея здесь в том, что тип ребра \((u, v)\) можно определить по цвету вершины \(v\) в тот момент, когда ребро первый раз исследуется (правда, прямые и перекрестные ребра при этом не различаются): белый цвет означает ребро дерева, серый — обратное ребро, чёрный — прямое или перекрёстное ребро.

Чтобы убедиться в этом, надо заметить, что к моменту вызова DFS-Visit\((v)\) серыми являются вершины на пути от корня дерева к вершине \(v\) и только они (индукция по глубине вложенности вызова). Чтобы отличить прямые рёбра от перекрёстных, можно воспользоваться полем \(d\): ребро \((u, v)\) оказывается прямым, если \(d[u] < d[v]\), и перекрёстным, если \(d[u] > d[v]\) (упр. 23.3-4).

Неориентированный требует особого рассмотрения, так как одно и то же ребро \((u, v) = (v, u)\) обрабатывается дважды, с двух концов, и может попасть в разные категории. Мы будем относить его в той категории, которая стоит раньше в нашем перечне четырёх категорий. Тот же самый результат получится, если мы будем считать, что тип ребра определяется при его первой обработке и не меняется при второй.

Оказывается, что при таких соглашениях прямых и перекрёстных ребер в неориентированном графе не будет.

Теорема 23.9
При поиске в глубину в неориентированном графе \(G\) любое ребро оказывается либо прямым, либо обратным.

Доказательство.
Пусть \((u, v)\) — произвольное ребро графа \(G\), и пусть, например, \(d[u] < d[v]\). Тогда вершина \(v\) должна быть обнаружена и обработана прежде, чем закончится обработка вершины \(u\), так как \(v\) содержится в списке смежных с \(u\) вершин. Если ребро \((u, v)\) первый раз обрабатывается в направлении от \(u\) к \(v\), то \((u, v)\) становится ребром дерева. Если же оно первый раз обрабатывается в направлении от \(v\) к \(u\), то оно становится обратным ребром (когда оно исследуется, вершина \(u\) — серая).

Эта теорема будет не раз использована в следующих разделах.

Упражнения.
23.3-1
Нарисуйте таблицу \(3 \times 3\), строки и столбцы которой отмечены как БЕЛЫЙ, СЕРЫЙ и ЧЁРНЫЙ. В каждой клетке \((i, j)\) пометьте, может ли в процессе поиска в глубину на ориентированном графе найти ребро из вершины цвета \(i\) в вершину цвета \(j\), и какого типа может быть такое ребро. Сделайте аналогичную таблицу для неориентированных графов.
23.3-2
Примените алгоритм поиска в глубину для графа рис. 23.6. Счи-