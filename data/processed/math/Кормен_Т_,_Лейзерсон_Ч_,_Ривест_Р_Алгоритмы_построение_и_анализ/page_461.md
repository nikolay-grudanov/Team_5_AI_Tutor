---
source_image: page_461.png
page_number: 461
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 56.53
tokens: 11387
characters: 1831
timestamp: 2025-12-24T06:42:09.643695
finish_reason: stop
---

(Обратите внимание, что здесь существенно используется правило работы очереди: первым пришёл --- первым ушёл.)
В этот момент мы мысленно прервём выполнение процедуры и убедимся, что выполнены все условия леммы для на единицу большего значения $k$.

Просматриваемые вершины --- это вершины, которые были в очереди; по предположению они находятся на расстоянии $k$.

Добавляемые вершины находятся на расстоянии $k+1$. В самом деле,
они являются смежными с просматриваемыми вершинами, находящимися на расстоянии $k$, и потому по лемме 23.1 расстояние будет не
больше $k+1$. С другой стороны, добавляются только белые вершины, и потому по предположению индукции расстояние до них
больше $k$.

Будут добавлены все вершины, находящиеся на расстоянии $k+1$. В самом деле, если вершина $v$ находится на расстоянии $k+1$, то по лемме 23.2 существует вершина $u$ на расстоянии $k$, для которой она смежная. Вершина $u$ должна быть среди просматриваемых, и во время её обработки вершина $v$ будет добавлена. Надо только иметь в виду, что вершин $u$ может быть
несколько --- но это не мешает делу, так как во время просмотра первой из них вершина $v$ будет добавлена (после чего она будет серой и условие в строке 12 будет ложно, так что второй раз её не добавят).

Поэтому в конце рассматриваемого нами этапа в очереди будут все
вершины, находящиеся на расстоянии $k+1$. Поскольку при добавлении они делаются серыми, а после просмотра вершина делается чёрной, то условие о цветах будет выполнено.

Строки 14 и 15 обеспечивают выполнение пунктов леммы о расстоянии и о массиве $\pi$, что завершает доказательство.

Теперь для доказательства правильности процедуры \textsc{BFS} достаточно взять большое $k$ (больше максимального расстояния от начальной вершины до всех вершин графа). Тогда вершин на расстоянии $k$ (серых, они же вершины в оче-