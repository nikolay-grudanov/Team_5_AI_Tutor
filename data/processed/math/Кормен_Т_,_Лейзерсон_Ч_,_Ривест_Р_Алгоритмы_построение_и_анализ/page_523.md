---
source_image: page_523.png
page_number: 523
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 60.46
tokens: 11699
characters: 2646
timestamp: 2025-12-24T06:45:09.386930
finish_reason: stop
---

В разделе 26.1 рассматривается алгоритм решения задачи о кратчайших расстояниях для всех пар вершин, в основе которого лежит умножение матриц. Время работы этого алгоритма — \( \Theta(V^3 \lg V) \); он вычисляет степень матрицы, многократно возводя её в квадрат.

Более быстрый (\( O(V^3) \)) алгоритм Флойда–Уоршолла, также использующий технику динамического программирования, излагается в разделе 26.2. В этом же разделе рассматривается задача о транзитивном замыкании ориентированного графа, которая оказывается тесно связанной с задачей нахождения кратчайших путей для всех пар вершин.

В разделе 26.3 излагается алгоритм Джонсона. В отличие от других алгоритмов этой главы, он использует в своей работе списки смежных вершин, а не матрицу смежности. Время работы этого алгоритма есть \( O(V^2 \lg V + VE) \); таким образом, он эффективен для разреженных графов.

В последнем разделе (26.4) мы исследуем алгебраическую структуру (замкнутое полукольцо), позволяющую применить алгоритмы нахождения кратчайших путей для решения других задач с графами, в которых также требуется определить что-либо для всех пар вершин.

Всюду в этой главе мы рассматриваем граф \( G = (V, E) \) с \( n \) вершинами, так что \( |V| = n \). Мы будем обозначать матрицы большими буквами (например, \( W \) или \( D \)) а отдельные элементы матриц соответствующими маленькими буквами (\( w_{ij}, d_{ij} \)). Кроме того, мы будем использовать верхний индекс в скобках (например, \( D^{(m)} = (d_{ij}^{(m)}) \)), роль которого будет аналогична степени матрицы (см. ниже). Наконец, размер \( n \) квадратной \( n \times n \)-матрицы \( A \) мы будем иногда записывать как \( rows[A] \) (rows — строки).

26.1 Кратчайшие пути и умножение матриц

В этом разделе мы рассмотрим алгоритм динамического программирования решения задачи нахождения кратчайших путей для всех пар вершин ориентированного графа \( G = (V, E) \). На каждом шаге он будет почти что умножать матрицы — только не вполне обычным образом. Сначала мы построим алгоритм со сложностью (временем работы) \( \Theta(V^4) \), а затем улучшим его, получив оценку \( \Theta(V^3 \lg V) \). Наше изложение будет следовать схеме алгоритма динамического программирования (глава 16)

Структура кратчайшего пути
Убедимся, что части решения являюятся решениями аналогичных подзадач. В нашем случае это означает, что отрезки кратчайшего пути сами являются кратчайшими путями между соответствующими вершинами (лемма 25.1).

Рекурсивная формула для длины кратчайшего пути
Пусть \( d_{ij}^{(m)} \) обозначает минимальный вес пути из вершины \( i \) в вершину \( j \), если рассматривать пути с не более чем \( m \) рёбрами.