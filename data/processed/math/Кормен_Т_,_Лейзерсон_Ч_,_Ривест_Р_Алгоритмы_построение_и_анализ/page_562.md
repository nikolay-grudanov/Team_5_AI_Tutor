---
source_image: page_562.png
page_number: 562
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 52.07
tokens: 11591
characters: 2211
timestamp: 2025-12-24T06:46:59.585428
finish_reason: stop
---

Метод Форда–Фалкерсона

Рисунок 27.7  27.6 Работа процедуры Ford-Fulkerson. (a)-(d) Шаги выполнения цикла. Слева изображена остаточная сеть \( G_f \) (дополняющий путь \( p \) выделен серым), справа показан увеличенный поток. Вначале (a) роль остаточной сети играет исходная сеть \( G \). (e) Остаточная сеть более не содержит дополняющего пути; поток максимален.

Ford-Fulkerson($G,s,t$)

1 for (для) каждого ребра $(u,v)$ из $E[G]$
2 do $f[u,v]\leftarrow 0$
3 $f[v,u]\leftarrow 0$
4 while (пока) в остаточной сети $G_f$ существует путь $p$ из $s$ в $t$
5 do $c_f(p)\leftarrow\min\{c_f(u,v)|(u,v) \text{ входит в } p\}$
6 for (для) каждого ребра $(u,v)$ пути $p$
7 do $f[u,v]\leftarrow f[u,v]+c_f(p)$
8 $f[v,u]\leftarrow -f[u,v]$

Процедура Ford-Fulkerson следует описанной выше схеме (Ford-Fulkerson-Method). Строки 1–3 задают первоначальное значение потока; цикл в строках 4–8 на каждом шаге находит дополняющий путь \( p \) в \( G_f \) и увеличивает поток \( f \). Если дополняющего пути нет, найденный поток максимален. Пример работы программы изображен на рис.27.6.

Анализ алгоритма Форда–Фалкерсона
Время работы процедуры Ford-Fulkerson зависит от того, как ищется путь \( p \) (строка 4). В принципе алгоритм может вообще не остановиться, если значение потока будет расти всё более мелкими шагами, так и не достигнув максимума. Однако если выбирать дополняющий путь при помощи поиска в ширину (раздел 23.2), то алгоритм работает полиномиальное время. Прежде чем доказать это, мы установим простую верхнюю оценку для случая целых пропускных способностей. (Этот случай часто встречается на практике. Случай рациональных пропускных способностей сводится к нему умножением на число.)

Для указанного случая (пропускные способности — целые числа), процедура Ford-Fulkerson выполняется за время \( O(E|f^*|) \), где \( f^* \) — максимальный поток. В самом деле, выполнение строк 1–3 требует времени \( \Theta(E) \). Цикл в строках 4–8 выполняется не более \( |f^*| \) раз, так как после каждого выполнения величина потока увеличивается по крайней мере на единицу. Осталось оценить время одного шага, которое зависит от того, как мы храним данные о потоке. Рассмотрим ориентированный граф \( G' = (V,E') \), в