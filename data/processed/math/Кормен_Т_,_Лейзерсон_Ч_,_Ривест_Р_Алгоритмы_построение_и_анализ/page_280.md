---
source_image: page_280.png
page_number: 280
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.43
tokens: 11370
characters: 1854
timestamp: 2025-12-24T06:33:11.692747
finish_reason: stop
---

15 Пополнение структур данных

Далеко не во всех ситуациях можно обойтись лишь классическими структурами данных (двоичными деревьями поиска, двусторонне связанными списками, хеш-таблицами и т. п.) Однако редко требуется придумать что-то совсем новое: в большинстве случаев достаточно расширить какую-либо из классических структур данных, храня вместе с её объектами дополнительную информацию. Эффективное обновление этой информации при выполнении операций иногда требует немалой изобретательности.

В качестве примера в этом разделе рассматриваются красно-чёрные деревья. Храня в вершинах дополнительную информацию, мы сможем быстро находить i-й по порядку элемент, а также выполнять обратное действие: находить порядковый номер данного элемента множества (разд. 15.1). В разделе 15.2 обсуждается общая схема работы с дополнительной информацией и доказывается теорема, которая облегчает пополнение для красно-чёрных деревьев. В разделе 15.3 эта же теорема используется для построения структуры данных, хранящей динамическое множество промежутков (на числовой прямой) и позволяющей быстро находить элемент множества, перекрывающийся с заданным промежутком.

15.1 Динамические порядковые статистики

Порядковые статистики уже обсуждались в главе 10, где мы искали i-й по порядку элемент множества из n элементов, что требовало O(n) операций (если множество предварительно не упорядочено). В данном разделе мы покажем, как с помощью пополненных красно-чёрных деревьев найти i-й элемент за O(log n) операций. Кроме того, за то же время можно будет найти порядковый номер заданного элемента.

Подходящая структура данных показана на рис. 15.1. Порядковым деревом (order-statistic tree) мы называем красно-чёрное дерево T, каждая вершина x которого, помимо обычных полей key[x], color[x], p[x], left[x] и right[x] имеет поле size[x]. В нём хранится размер (ко-