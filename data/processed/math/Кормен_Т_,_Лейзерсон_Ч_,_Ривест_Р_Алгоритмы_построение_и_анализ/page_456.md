---
source_image: page_456.png
page_number: 456
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 56.91
tokens: 11503
characters: 1870
timestamp: 2025-12-24T06:41:49.006737
finish_reason: stop
---

то \( v \) — серая или чёрная вершина. Таким образом, только серые вершины могут иметь смежные необнаруженные вершины.

Вначале дерево поиска состоит только из корня — начальной вершины \( s \). Как только алгоритм обнаруживает новую белую вершину \( v \), смежную с ранее найденной вершиной \( u \), вершина \( v \) (вместе с ребром \( (u, v) \)) добавляется к дереву поиска, становясь ребёнком (child) вершины \( u \), а \( u \) становится родителем (parent) \( v \). Каждая вершина обнаруживается только однажды, так что двух родителей у неё быть не может. Понятия предка (ancestor) и потомка (descendant) определяются как обычно (потомки — это дети, дети детей, и т.д.). Двигаясь от вершины к корню, мы проходим всех её предков.

Приведенная ниже процедура BFS (breadth-first search — поиск в ширину) использует представление графа \( G = (V, E) \) списками смежных вершин. Для каждой вершины \( u \) графа дополнительно хранятся её цвет \( color[u] \) и её предшественник \( \pi[u] \). Если предшественника нет (например, если \( u = s \) или \( u \) ещё не обнаружена), \( \pi[u] = NIL \). Кроме того, расстояние от \( s \) до \( u \) записывается в массив \( d[u] \). Процедура использует также очередь \( Q \) (FIFO, раздел 11.1) для хранения множества серых вершин.

BFS$(G, s)$

1 for (для) всех вершин $u\in V[G]-\{s\}$
2 do $color[u] \leftarrow$ БЕЛЫЙ
3 $d[u] \leftarrow \infty$
4 $\pi [u] \leftarrow$ NIL
5 $color[s] \leftarrow$ СЕРЫЙ
6 $d[s] \leftarrow 0$
7 $\pi [s] \leftarrow$ NILL
8 $Q\leftarrow \{s\}$
9 while $Q\neq \emptyset$
10 do $u\leftarrow head[Q]$
11 for (для) всех $v\in Adj[u]$
12 do if $color[v]=\text{БЕЛЫЙ}$
13 then $color[v]\leftarrow$ СЕРЫЙ
14 $d[v]\leftarrow d[u]+1$
15 $\pi[v]\leftarrow u$
16 Enqueue($Q,v$)
17 Dequeue($Q$)
18 $color[u]\leftarrow$ ЧЕРНЫЙ

На рис.~23.3 приведён пример исполнения процедуры \textsc{BFS}.

\begin{figure}