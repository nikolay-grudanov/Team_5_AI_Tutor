---
source_image: page_467.png
page_number: 467
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.56
tokens: 11674
characters: 2577
timestamp: 2025-12-24T06:42:30.116467
finish_reason: stop
---

Рисунок 23.4  23.5 Свойства поиска в глубину. (а) Результат поиска (в обозначениях рис. 23.4). (б) Промежутки между обнаружением и окончанием обработки для каждой из вершин, изображённые в виде прямоугольников. Стрелки указывают структуру деревьев поиска в глубину. (с) Отмечены рёбра исходного графа с указанием их типов (рёбра дерева и прямые рёбра ведут вниз, обратные ведут вверх).

правильно построенным выражением в том смысле (скобки с одинаковыми пометками считаем парными). Например, поиску в глубину на рис. 23.5 (а) соответствует расстановка скобок, изображённая на рисунке 23.5(б).

Чтобы доказать эти и другие свойства, мы должны рассуждать по индукции. При этом, доказывая требуемое свойство рекурсивной процедуры DFS-Visit, мы предполагаем, что рекурсивные вызовы этой процедуры обладают выбранным свойством.

Убедимся вначале, что вызов DFS-Visit(u) для белой вершины u делает чёрной эту вершину и все белые вершины, доступные из неё по белым путям (в которых все промежуточные вершины также белые), и оставляет серые и чёрные вершины без изменений.

В самом деле, рекурсивные вызовы в строке 6 выполняются лишь для белых вершин, являющихся смежными с u. Если какая-то вершина w была закрашена в ходе этих вызовов, то (по индуктивному предположению) она была доступна по белому пути из одной из белых вершин, смежных с u, и потому доступна по белому пути из u.

Напротив, если вершина w доступна по белому пути из u, то этот она доступна по белому пути из какой-то белой вершины v, смежной с u (посмотрим на первый шаг пути). Будем считать, что v — первая из таких вершин (в порядке просмотра в строке 3). В этом случае все вершины белого пути из v в w останутся белыми к моменту вызова DFS-Visit(v), поскольку они недоступны по белым путям из предшествующих v вершин (иначе w была бы также доступна). По индуктивному предположению w станет чёрной после вызова DFS-Visit(v).

Кроме того, сама вершина u станет сначала серой, а потом чёрной. (Заметим, что мы могли бы сразу сделать её чёрной, поскольку программа никак не различает серые и чёрные вершины, однако это различие нам пригодится в дальнейшем.)

Ясно также, что цвета серых и чёрных вершин остаются без изменений (поскольку это верно для рекурсивных вызовов по индуктивному предположению).

Аналогичные рассуждения по индукции позволяют установить, что вызов DFS-Visit(u) меняет поля π[v] для всех окрашиваемых вершин v, отличных от u, тем самым формируя из них дерево с корнем в u, а также добавляет к описанному выше протоколу из скобок с пометками правильное скобочное выражение, внешние скобки ко-