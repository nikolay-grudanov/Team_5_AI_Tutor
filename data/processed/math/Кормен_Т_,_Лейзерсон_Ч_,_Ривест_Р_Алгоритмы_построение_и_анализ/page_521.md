---
source_image: page_521.png
page_number: 521
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.34
tokens: 11506
characters: 2132
timestamp: 2025-12-24T06:44:55.679712
finish_reason: stop
---

Кратчайшие пути для всех пар вершин

В этой главе мы займёмся задачей о нахождении кратчайших путей для всех пар вершин графа. Таблица расстояний между всевозможными парами городов в атласе дорог получается в результате решения именно такой задачи. Как и в главе 25, будем рассматривать ориентированный взвешенный граф \( G = (V, E) \) с вещественной весовой функцией \( w : E \to \mathbb{R} \). Для каждой пары вершин \( u, v \in V \) мы должны найти кратчайший путь \( u \) в \( v \), точнее, путь наименьшей длины (длина пути определяется как сумма весов всех его рёбер). Таким образом, ответом в задаче о кратчайших путях можно считать таблицу, в которой на пересечении строки \( u \) и столбца \( v \) которой находится вес кратчайшего пути из \( u \) в \( v \) (дополненную некоторой информацией о самих этих путях, см. ниже).

Разумеется, можно решить эту задачу, если \( |V| \) раз применить алгоритм для поиска кратчайших путей из одной вершины (ко всем вершинам графа по очереди). Если все ребра графа имеют неотрицательные веса, то разумно использовать алгоритм Дейкстры; при простой реализации очереди с приоритетами с помощью массива общее время работы алгоритма составит \( O(V^3 + VE) = O(V^3) \).

Если очередь реализовать с помощью двоичной кучи, то общая стоимость составит \( O(VE \lg V) \), что даёт выигрыш для разрежённых графов. Обе эти оценки можно улучшить, использовав фибоначчиевы кучи, для которых общее время работы алгоритма есть алгоритма будет \( O(V^2 \lg V + VE) \).

Если в графе есть рёбра с отрицательными весами, то алгоритм Дейкстры применить нельзя. Если вместо него использовать более медленный алгоритм Беллмана-Форда, выполняя его для каждой вершины графа, общее время работы составит \( O(V^2 E) \) — для плотных графах это будет \( O(V^4) \). Алгоритмы, описанные ниже, работают быстрее. Кроме того, в этой главе мы установим связь между задачей о нахождении кратчайших путей для всех пар вершин графа и умножением матриц, а также исследуем ее алгебраическую структуру.

В большинстве алгоритмов этой главы графы представляются матрицами смежности. Исключением является алгоритм Джонсона