---
source_image: page_809.png
page_number: 809
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 60.30
tokens: 11743
characters: 2578
timestamp: 2025-12-24T06:58:25.208989
finish_reason: stop
---

Глава 35 Вычислительная геометрия

рисунок совпадает с 35.8 (b), только нет точки \( p_i \), пунктирных линий \( p_0 p_i p_j \) и серой области
35.8 Если точки \( p_1, \ldots, p_k, p_j \) идут в порядке возрастания полярных углов (относительно точки \( p_0 \)), которые меняются в промежутке от \([0, \pi)\), и при движении по ломаной \( p_0 p_1 \ldots p_k p_j \) мы в каждой вершине поворачиваем налево, то выпуклой оболочкой точек \( p_0, p_1, \ldots, p_k, p_l \) будет многоугольник, вершинами которого будут все эти точки, а границей будет ломаная \( p_0 p_1 \ldots p_k p_j p_0 \)

но правее), и потому она заведомо входит в \( CH(Q) \). В строке 2 оставшиеся точки множества \( Q \) упорядочиваются полярному углу относительно точки \( p_0 \). Каждое сравнение можно выполнить за время \( O(1) \) с помощью произведений (упр. 35.1-2); из точек с одинаковым углом остаётся самая дальняя (остальные заведомо не принадлежат выпуклой оболочке). Полярный углы точек множества \( Q \) находятся в пределах промежутка \([0, \pi)\). Заметим, что точки \( p_1 \) и \( p_m \) являются вершинами \( CH(Q) \) (упр. 35.3-1).

Затем (строки 3-6) мы помещаем в стек три первые точки \( p_0, p_1, p_2 \), после чего можем утверждать, что стек содержит выпуклую оболочку множества \( p_0, p_1, \ldots, p_k \) при \( k = 2 \). Это свойство будет поддерживаться и в дальнейшем, а \( k \) будет расти, пока не станет равным \( m \). При движении от дна стека к его вершине мы всё время поворачиваем налево. Если просто так добавить очередную точку в стек, мы нарушим это свойство, поэтому предварительно мы выбрасываем несколько верхних вершин стека.

Теорема 35.2 (алгоритм Грэхема правилен)
После исполнения процедуры GRAHAM-SCAN для множества точек \( Q \), содержащего по меньшей мере три точки, в стеке \( S \) содержится выпуклая оболочка множества \( Q \) (в порядке обхода против часовой стрелки).
Доказательство.
По-настоящему строгое доказательство выходит за рамки книги (строгое определение внутренности многоугольника — уже непростая задача), поэтому мы лишь укажем два наглядно очевидных факта, которые гарантируют правильность алгоритма; они показаны на рис. 35.8 и 35.9

ВНИМАНИЕ: ЗДЕСЬ НОВЫЕ РИСУНКИ!!!

Покажем теперь, что время работы алгоритма GRAHAM-SCAN есть \( O(n \lg n) \), где \( n = |Q| \). Сортировка укладывается в эти границы, если использовать сортировку слиянием или с помощью кучи. Остальная часть алгоритма требует времени \( O(n) \). Это не сразу очевидно, поскольку очередная итерация цикла for, помимо добавления одной новой точки, может потребовать удале-