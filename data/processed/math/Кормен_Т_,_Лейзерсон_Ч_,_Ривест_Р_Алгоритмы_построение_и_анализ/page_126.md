---
source_image: page_126.png
page_number: 126
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 94.13
tokens: 11849
characters: 2617
timestamp: 2025-12-24T06:26:46.328314
finish_reason: stop
---

жде чем в каждой урне появится по шару.

6.6.3 Участки повторяющихся исходов

Пусть мы бросаем симметричную монету \( n \) раз. Какое максимальное число идущих подряд орлов мы ожидаем увидеть? Оказывается, ответ на этот вопрос — \( \Theta(\lg n) \).

Сначала докажем, что ожидаемая длина наибольшего участка есть \( O(\lg n) \). Пусть событие \( A_{ik} \) состоит в том, что имеется участок из \( k \) или более орлов, начинающийся с \( i \)-го бросания. Очевидно,

\[
\mathrm{P}\{A_{ik}\} = 1/2^k.
\]

При \( k = 2[\lg n] \) вероятность появления \( k \) орлов в данных позициях не превосходит \( 1/n^2 \), а возможных мест (значений \( i \)) меньше чем \( n \), так что вероятность появления \( k \) орлов подряд (где-нибудь) не больше \( 1/n \). Теперь математическое ожидание максимального числа идущих подряд орлов оценивается так: это число никогда не превосходит \( n \) и почти всегда (с вероятностью \( 1 - 1/n \)) не превосходит \( 2[\lg n] \), поэтому ожидание не больше \( [2 \lg n] + n \cdot (1/n) = O(\lg n) \).

Вероятность образования участка орлов длины не менее \( r[\lg n] \) быстро уменьшается с ростом \( r \) (для фиксированной позиции она не больше \( 2^{-r \lg n} = n^{-r} \), а для всех позиций в сумме она не превосходит \( n \cdot n^{-r} = n^{-(r-1)} \)). Например, для \( n = 1000 \) вероятность появления участка из по меньшей мере \( 2[\lg n] = 20 \) орлов не превосходит \( 1/n = 1/1000 \), а вероятность появления участка \( 3[\lg n] = 30 \) орлов не больше \( 1/n^2 = 10^{-6} \).

Теперь докажем оценку снизу: ожидаемая длина наибольшего участка есть \( \Omega(\lg n) \). Для этого рассмотрим участки длины \( \lfloor (\lg n)/2 \rfloor \). Согласно (6.47) вероятность появления такого участка в данной позиции не меньше \( 1/2^{\lfloor (\lg n)/2 \rfloor} \geq 1/\sqrt{n} \), а вероятность его непоявления не больше \( 1 - 1/\sqrt{n} \). Разобьём всю последовательность бросаний на непересекающиеся группы, состоящие из \( \lfloor (\lg n)/2 \rfloor \) бросаний каждая. (Несколько членов окажутся вне групп, если при делении будет остаток.) Число групп не меньше \( 2n/\lg n - 1 \).

События в разных группах независимы, поэтому вероятность того, что ни одна из этих групп не состоит из одних орлов, не больше

\[
(1 - 1/\sqrt{n})^{2n/\lg n - 1} \leq e^{-(2n/\lg n - 1)/\sqrt{n}}
= O(e^{-\lg n}) = O(1/n)
\]

Мы использовали тот факт, что \( 1 + x \leq e^x \) (2.7), а также то, что \( (2n/\lg n - 1)/\sqrt{n} \geq \lg n - O(1) \).

Итак, с вероятностью не менее \( 1 - O(1/n) \) длина наибольшего участка подряд идущих орлов не меньше \( \lfloor \lg n/2 \rfloor = \Omega(\lg n) \), по-