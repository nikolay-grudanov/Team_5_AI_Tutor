---
source_image: page_418.png
page_number: 418
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 52.81
tokens: 11361
characters: 1626
timestamp: 2025-12-24T06:39:56.408895
finish_reason: stop
---

Операции, предусмотренные для сливаемых куч

Fib-Heap-Union(H₁, H₂)
1   H ← Make-Fib-Heap()
2   min[H] ← min[H₁]
3   соединить корневой список H₂ с корневым списком H
4   if (min[H₁] = NIL) or (min[H₂] ≠ NIL and min[H₂] < min[H₁])
5     then min[H] ← min[H₂]
6   n[H] ← n[H₁] + n[H₂]
7   освободить память, занятую под заголовки объектов H₁ и H₂
8   return H

Строки 1–3 объединяют корневые списки куч H₁ и H₂ в корневой список новой кучи H. Строки 2, 4 и 5 заполняют min[H], а строка 6 устанавливает n[H] равным суммарному количеству вершин. Объекты H₁ и H₂ освобождаются в строке 7, а строка 8 возвращает результирующую фибоначчиеву кучу H. Отметим, что (как и в процедуре Fib-Heap-Insert) соединения деревьев не происходит. Потенциал не меняется (общее число вершин в корневых списках и общее число помеченных вершин остаётся тем же). Поэтому учётная стоимость операции Fib-Heap-Union равна её фактической стоимости, т.е. O(1).

Изъятие минимальной вершины

Именно при этой операции происходит преобразование структуры кучи (разные деревья соединяются в одно), поэтому она существенно сложнее предыдущих операций этого раздела. План действий таков: после изъятия минимальной вершины то дерево, где она была корнем, рассыпается в набор своих поддеревьев, которые добавляются к корневому списку. Затем запускается процедура Consolidate, соединяющая деревья, после чего в корневом списке остаётся не более одного дерева каждой степени.

Мы считаем, что при удалении вершины из связанного списка (строка 6) поля left и right этой вершины остаются неизменными (но поля её соседей, которые указывали на эту вершину, обновляются).