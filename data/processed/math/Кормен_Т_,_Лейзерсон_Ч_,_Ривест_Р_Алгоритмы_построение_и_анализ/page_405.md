---
source_image: page_405.png
page_number: 405
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.22
tokens: 11580
characters: 2091
timestamp: 2025-12-24T06:39:33.856188
finish_reason: stop
---

вым ребёнком вершины \( x \).

В случае 4 (рис. 20.6г) меньший ключ имеет вершина next-х, поэтому вершина \( x \) подвешивается к вершине next-х. Строки 16–18 удаляют вершину \( x \) из корневого списка; важно различать, является ли вершина \( x \) первой в списке (строка 17) или нет (строка 18). Строка 19 делает вершину \( x \) левым ребёнком вершины next-х, а строка 20 обновляет \( x \) для следующей итерации.

В случаях 3 и 4 образовалось новое \( B_{k+1} \)-дерево, на которое указывает \( x \). За ним может находиться от нуля до двух деревьев такого же размера. На следующей итерации цикла это приведёт к случаям 1, 3–4 и 2 соответственно.

Время работы процедуры Binomial-Heap-Union есть \( O(\lg n) \), где \( n \) — суммарное число вершин в кучах \( H_1 \) и \( H_2 \): в самом деле, размеры корневых списков в кучах \( H_1 \) и \( H_2 \) суть \( O(\lg n) \) (количество элементов в обеих кучах не больше \( n \)), и после слияния в списке \( H \) будет \( O(\lg n) \) элементов. И время работы процедуры Binomial-Merge, и число итераций цикла в строках 9–21 пропорционально начальной длине списка \( H \). Каждая итерация требует времени \( O(1) \), так что общее время действительно есть \( O(\lg n) \).

Добавление вершины

Следующая процедура добавляет элемент \( x \) в биномиальную кучу \( H \). Предполагается, что элемент \( x \) уже размещён в памяти, и поле ключа \( key[x] \) заполнено.

Binomial-Heap-Insert\((H, x)\)

1 \( H' \leftarrow \text{Make-Binomial-Heap}() \)
2 \( p[x] \leftarrow \text{NIL} \)
3 \( child[x] \leftarrow \text{NIL} \)
4 \( sibling[x] \leftarrow \text{NIL} \)
5 \( degree[x] \leftarrow 0 \)
6 \( head[H'] \leftarrow x \)
7 \( H \leftarrow \text{Binomial-Heap-Union}(H, H') \)

Идея проста: за время \( O(1) \) мы создаём биномиальную кучу \( H' \) из одной вершины \( x \) и за время \( O(\lg n) \) объединяем её с биномиальной кучей \( H \), состоящей из \( n \) вершин. (После этого память, временно отведённая для \( H' \), освобождается). Реализация процедуры Binomial-Heap-Insert без ссылки на Binomial-Heap-Union составляет упр. 20.2-8.