---
source_image: page_284.png
page_number: 284
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 49.74
tokens: 11405
characters: 1835
timestamp: 2025-12-24T06:33:25.610475
finish_reason: stop
---

Рисунок 15.2 Обновление поля size при вращениях вокруг ребра (x, y). Это поле необходимо обновить только у вершин x и y. Для того, чтобы узнать новое значение, достаточно обладать информацией, хранящейся в x, y и в корнях поддеревьев, изображенных в виде треугольников.

На рис. 15.2 показано, как меняется поле size. Аналогичные изменения внесём и в процедуру Right-Rotate.

Так как при добавлении элемента в красно-чёрное дерево выполняется не больше двух вращений, то коррекция поля size после вращений требует O(1) операций (а перекрашивание вообще не влияет на размеры). Таким образом, добавление элемента в порядковое дерево из n вершин требует времени O(log n), как и для обычного красно-чёрного дерева.

Удаление элемента из красно-чёрного дерева также состоит из двух частей — сначала мы удаляем вершину y, а затем делаем (самое большое) три вращения (см. разд. 14.4). После выполнения первой части, мы уменьшим на единицу поле size у всех вершин на пути из y к корню. Длина этого пути O(log n), поэтому дополнительно нам потребуется время O(log n). Что происходит с вращениями, мы уже видели. Таким образом, обновление поля size, не ухудшает (асимптотически) время, необходимое для удаления и добавления элемента.

Упражнения

15.1-1 Пусть T — дерево на рис. 15.1. Покажите, как работает процедура OS-Select(T, 10).

15.1-2 Пусть T — дерево на рис. 15.1. Покажите, как работает процедура OS-Rank(T, x), где x — вершина с ключом 35.

15.1-3 Перепишите процедуру OS-Select, не используя рекурсии.

15.1-4 Реализуйте рекурсивную процедуру OS-Key-Rank(T, k), которая получает на входе порядковое дерево T с попарно различными ключами, а также ключ k, и возвращает порядковый номер ключа k в этом дереве.

15.1-5 Дана вершина x порядкового дерева из n вершин и натуральное число i. Как найти i-й по порядку элемент, считая от вер-