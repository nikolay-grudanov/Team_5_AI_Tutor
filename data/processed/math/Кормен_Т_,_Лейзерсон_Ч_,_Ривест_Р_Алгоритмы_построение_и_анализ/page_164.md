---
source_image: page_164.png
page_number: 164
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.22
tokens: 11472
characters: 1940
timestamp: 2025-12-24T06:27:50.494520
finish_reason: stop
---

**STOOGESORT(A, i, j)**
1 if \( A[i] > A[j] \)
2 then поменять \( A[i] \leftrightarrow A[j] \)
3 if \( i + 1 \geq j \)
4 then return
5 \( k \leftarrow \lfloor (j - i + 1)/3 \rfloor \) ▷ Округление с недостатком.
6 STOOGESORT(A, i, j - k) ▷ Первые две трети.
7 STOOGESORT(A, i + k, j) ▷ Последние две трети.
8 STOOGESORT(A, i, j - k) ▷ Опять первые две трети.

а. Докажите, что процедура STOOGESORT действительно сортирует массив.
б. Найдите рекуррентное соотношение для наибольшего времени работы процедуры STOOGESORT и получите из него оценку этого времени.
в. Сравните наибольшее время работы процедуры STOOGESORT с наибольшим временем для других вариантов сортировки (вставками, слиянием, с помощью кучи и быстрой сортировки). Стоит ли продлевать контракт с профессором?

**8-4 Размер стека при быстрой сортировке**

Процедура QUICKSORT два раза рекурсивно вызывает себя (для левой и для правой части). В действительности без второго рекурсивного вызова можно обойтись, заменив его циклом (именно так хорошие компиляторы обрабатывают ситуацию, когда последним оператором процедуры является рекурсивный вызов; для такой ситуации есть термин tail recursion):

**QUICKSORT'(A, p, r)**
1 while \( p < r \)
2 do ▷ Разбить и отсортировать левую часть.
3 \( q \leftarrow \text{PARTITION}(A, p, r) \)
4 QUICKSORT'(A, p, q)
5 \( p \leftarrow q + 1 \)

а. Докажите, что процедура QUICKSORT' действительно сортирует массив.
Как правило, компиляторы реализуют рекурсию с помощью стека, где хранятся копии локальных переменных для каждого рекурсивного вызова. Вершина стека содержит информацию, относящуюся к текущему вызову; когда он завершается, информация удаляется из стека. В нашем случае для каждого рекурсивного вызова локальные переменные занимают объём \( O(1) \), так что необходимый размер стека (stack depth) пропорционален глубине рекурсии.
б. Покажите, что в некоторых случаях процедура QUICKSORT' требует стека размера \( \Theta(n) \).