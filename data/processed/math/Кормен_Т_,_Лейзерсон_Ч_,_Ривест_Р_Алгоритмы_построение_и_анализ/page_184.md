---
source_image: page_184.png
page_number: 184
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.97
tokens: 11524
characters: 1733
timestamp: 2025-12-24T06:28:54.556467
finish_reason: stop
---

сив. Отсюда имеем:

\[
T(n) \leq \frac{1}{n} \left( T(\max(1, n-1)) + \sum_{k=1}^{n-1} T(\max(k, n-k)) \right) + O(n)
\]
\[
\leq \frac{1}{n} \left( T(n-1) + 2 \sum_{k=\lceil n/2 \rceil}^{n-1} T(k) \right) + O(n)
\]
\[
= \frac{2}{n} \sum_{k=\lceil n/2 \rceil}^{n-1} T(k) + O(n)
\]

(мы сгруппировали одинаковые слагаемые при переходе от первой строки ко второй и отбросили \( T(n-1)/n \) при переходе от второй строки к третьей, так как в худшем случае \( T(n-1) = O(n^2) \), и тем самым слагаемое \( T(n-1)/n \) можно включить в \( O(n) \)).

Теперь докажем, что \( T(n) \leq cn \), рассуждая по индукции (как выбрать \( c \), мы скажем после). В самом деле, пусть неравенство \( T(j) \leq cj \) верно для всех \( j < n \). Тогда, используя формулу для суммы арифметической прогрессии, получаем, что

\[
T(n) \leq \frac{2}{n} \sum_{k=\lceil n/2 \rceil}^{n-1} ck + O(n)
\]
\[
\leq \frac{2c}{n} \cdot \frac{n}{2} \cdot \frac{n/2+1+n-1}{2} + O(n)
\]
\[
= \frac{3cn}{4} + O(n) \leq cn,
\]

если выбрать \( c \) столь большим, чтобы \( c/4 \) превосходило константу, подразумеваемую в слагаемом \( O(n) \).

Стало быть, любая порядковая статистика, и медиана в том числе, может быть найдена за линейное в среднем время.

Упражнения

10.2-1 Напишите версию процедуры RANDOMIZED-SELECT, не использующую рекурсии.

10.2-2 Предположим, что мы используем алгоритм RANDOMIZED-SELECT для выбора наименьшего элемента из массива \( A = \langle 3, 2, 9, 0, 7, 5, 4, 8, 6, 1 \rangle \). Опишите последовательность разбиений, соответствующую худшему случаю.

10.2-3 Будет ли алгоритм RANDOMIZED-SELECT правильно работать, если в массиве \( A \) есть равные элементы (как мы помним, в этом случае процедура RANDOMIZED-PARTITION разбивает \( A[p..r] \)