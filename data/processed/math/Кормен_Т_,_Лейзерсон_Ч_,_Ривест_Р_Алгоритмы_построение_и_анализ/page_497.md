---
source_image: page_497.png
page_number: 497
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.51
tokens: 11869
characters: 2673
timestamp: 2025-12-24T06:43:57.265283
finish_reason: stop
---

ном уточнении верхней оценки на вес кратчайшего пути в данную вершину — пока неравенство не превратится в равенство.

При первом чтении вы можете разобрать только формулировки результатов (обратите особое внимание на лемму 25.7; леммы 25.8 и 25.9 при первом чтении можно пропустить), после чего перейти к алгоритмам разд. 25.2 и 25.3.

Свойство оптимальности для подзадач

Любая часть кратчайшего пути сама есть кратчайший путь. Это значит, что задача о кратчайших путях обладает свойством оптимальности для подзадач — признак того, что к ней может быть применено динамическое программирование (глава 16) или жадный алгоритм (глава 17). И действительно, алгоритм Дейкстры является жадным алгоритмом, а алгоритм Флойда-Уоршолла для нахождения кратчайших путей между всеми парами вершин (глава 26) основан на динамическом программировании. Следующая лемма и ее следствие уточняют, в чем конкретно состоит свойство оптимальности для подзадач в задаче о кратчайших путях.

Лемма 25.1 (Отрезки кратчайших путей являются кратчайшими)
Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весовой функцией \( w : E \to \mathbb{R} \). Если \( p = \langle v_1, v_2, \ldots, v_k \rangle \) — кратчайший путь из \( v_1 \) в \( v_k \) и \( 1 \leq i \leq j \leq k \), то \( p_{ij} = \langle v_i, v_{i+1}, \ldots, v_j \rangle \) есть кратчайший путь из \( v_i \) в \( v_j \).

Доказательство
Если путь \( p_{ij} \) не кратчайший, то, заменяя в пути \( p \) участок от \( v_i \) до \( v_j \) на более короткий путь из \( v_i \) в \( v_j \), мы уменьшим вес пути из \( p_1 \) в \( p_k \) — противоречие. (Здесь "более короткий" означает "с меньшим весом".)

Следствие из доказанной леммы обобщает лемму 23.1.

Следствие 25.2
Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весовой функцией \( w : E \to \mathbf{R} \). Рассмотрим кратчайший путь \( p \) из \( s \) в \( v \). Пусть \( u \to v \) — последнее ребро этого пути (\( p \) есть \( s \xrightarrow{p'} u \to v \)). Тогда \( \delta(s, v) = \delta(s, u) + w(u, v) \).

Доказательство
По лемме 25.1 путь \( p' \) является кратчайшим, так что \( \delta(s, v) = w(p') + w(u, v) = \delta(s, u) + w(u, v) \).

Следующая лемма проста, но полезна.
Лемма 25.3 Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весовой функцией \( w : E \to \mathbb{R} \); пусть \( s \in V \). Тогда для всякого ребра \( (u, v) \in E \) имеем \( \delta(s, v) \leq \delta(s, u) + w(u, v) \).

Доказательство.
Вес кратчайшего пути из \( s \) в \( v \) не превосходит веса любого пути из \( s \) в \( v \), в том числе и проходящего на последнем шаге через \( u \).

Релаксация
Техника релаксации, которая уже упоминалась выше, состоит в