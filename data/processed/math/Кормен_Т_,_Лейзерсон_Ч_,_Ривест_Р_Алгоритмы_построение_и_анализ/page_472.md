---
source_image: page_472.png
page_number: 472
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 59.03
tokens: 11628
characters: 2324
timestamp: 2025-12-24T06:42:39.267214
finish_reason: stop
---

Топологическая сортировка выполняется за время \( \Theta(V + E) \), потому что столько времени занимает поиск в глубину, а добавить каждую из \( |V| \) вершин к списку можно за время \( O(1) \).

Правильность этого алгоритма доказывается с помощью такой леммы:

Лемма 23.10
Ориентированный граф не имеет циклов тогда и только тогда, когда поиск в глубину не находит в нём обратных рёбер.

Доказательство.
\( \Rightarrow \): Обратно ребро соединяет потомка с предком и потому замыкает цикл, образованный рёбрами дерева.
\( \Leftarrow \): Пусть в графе имеется цикл с. Докажем, что в этом случае поиск в глубину обязательно найдёт обратное ребро. Среди вершин цикла выберем вершину \( v \), которая будет обнаружена первой, и пусть \( (u, v) \) — ведущее в неё ребро цикла. Тогда в момент времени \( d[v] \) из \( v \) в \( u \) ведёт путь из белых вершин. По теореме о белом пути \( u \) станет потомком \( v \) в лесе поиска в глубину, поэтому \( (u, v) \) будет обратным ребром.

Теорема 23.11
Процедура Topological-Sort\((G)\) правильно выполняет топологическую сортировку ориентированного графа \( G \) без циклов.

Доказательство.
Нужно доказать, что для любого ребра \( (u, v) \) выполнено неравенство \( f[v] < f[u] \). В момент обработки этого ребра вершина \( v \) не может быть серой (это означало бы, что она является предком \( u \) и \( (u, v) \) является обратным ребром, что противоречит лемме 23.10). Поэтому \( v \) в этот момент должна быть белой или чёрной. Если \( v \) — белая, то она становится ребёнком \( u \), так что \( f[v] < f[u] \). Если она уже чёрная, то тем более \( f[v] < f[u] \).

Упражнения
23.4-1
В каком порядке расположит вершины графа рис. 23.8 алгоритм Topological-Sort? (Порядок просмотра вершин алфавитный.)
23.4-2
Результат работы алгоритма Topological-Sort зависит от порядка просмотра вершин. Покажите, что различные упорядочения списков смежных вершин могут привести к одному и тому же результату.
23.4-3
Придумайте алгоритм, определяющий, имеется ли в данном неориентированном графе \( G = (V, E) \) цикл. Можно ли сделать это за время \( O(V) \) (с константой, не зависящей от \( |E| \))?
23.4-4
Верно ли, что для ориентированного графа с циклами алгоритм Topological-Sort находит порядок, при котором число "плохих" рёбер (идущих в неправильном направлении) будет минимально?