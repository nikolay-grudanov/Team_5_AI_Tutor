---
source_image: page_621.png
page_number: 621
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.98
tokens: 11711
characters: 2386
timestamp: 2025-12-24T06:49:52.528247
finish_reason: stop
---

рис. 29.16), так что

\[
D(n) = \begin{cases}
0 & \text{если } n \leq 2, \\
1 & \text{если } n = 3, \\
D(\lceil 2n/3 \rceil) + 1 & \text{если } n \geq 4
\end{cases}
\]

Отсюда в силу теоремы 4.1 (случай 2) имеем \( D(n) = \Theta(\lg n) \). Частичные произведения могут быть вычислены за время \( \Theta(1) \), каждый из шагов сложения с запоминанием переносов также требует времени \( \Theta(1) \), а сложение двух слагаемых размера \( \Theta(n) \) (последний шаг) требует времени \( \Theta(\lg n) \). Поэтому общее время работы составляет \( \Theta(\lg n) \).

Покажем теперь, что размер схемы равен \( \Theta(n^2) \). Ясно, что он составляет не менее \( \Omega(n^2) \), поскольку уже на верхнем ярусе имеется \( \lceil 2n/3 \rceil \) блоков, каждый из которых содержит не менее \( n \) сумматоров. Оценим теперь размер схемы сверху. Поскольку результат сложения имеет \( 2n \) разрядов, число сумматоров в каждом из блоков не превосходит \( 2n \). Остаётся показать, что число блоков (обозначим его \( C(n) \)) не превосходит \( O(n) \). В самом деле,

\[
C(n) = \begin{cases}
1 & \text{если } n = 3, \\
C(\lceil 2n/3 \rceil) + \lfloor n/3 \rfloor & \text{если } n \geq 4
\end{cases}
\]

откуда в силу теоремы 4.1 (случай 3) следует, что \( C(n) = \Theta(n) \). Таким образом, общее число элементов во всех сумматорах дерева Уоллеса не превосходит \( \Theta(n^2) \). Так же оценка справедлива для элементов, вычисляющих частичные произведения, а сумматор с предвычислением переносов имеет размер \( \Theta(n) \). Значит, размер всего умножителя равен \( \Theta(n^2) \).

Хотя умножитель с помощью дерева Уоллеса имеет (асимптотически) тот же размер, что и матричный, и при этом работает (асимптотически) быстрее, он не столь удобен на практике, так как имеет нерегулярную структуру (и элементы трудно плотно разместить на плате). Поэтому используется промежуточный вариант: частичные произведения разбиваются на две половины, каждая складывается с помощью матричного умножителя, из 4 оставшихся чисел делает два с помощью двукратного использования сумматора с запоминанием переносов, наконец, два числа складываются с помощью сумматора с предвычислением переносов. Это почти вдвое уменьшает задержку по сравнению с одним матричным умножителем.

29.3.5 Упражнения

29.3-1 Докажите, что в матричном умножителе \( v_j^{(i)} = 0 \) при \( j = 0, 1, \ldots, i, i+n, i+n+1, \ldots, 2n-1 \).