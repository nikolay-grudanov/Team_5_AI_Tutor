---
source_image: page_292.png
page_number: 292
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.08
tokens: 11575
characters: 2069
timestamp: 2025-12-24T06:34:02.644511
finish_reason: stop
---

Рисунок 15.5 Отрезки в доказательстве теоремы 15.2. Пунктиром показано значение \( \max[\left[x\right]] \). (а) Случай 2: мы идем направо. Никакой интервал \( i' \) не перекрывается с \( i \). (б) Случай 1: мы идем налево. Выберем в левом поддереве отрезок \( i' \), для которого \( high[i'] = \max[\left[x\right]] \geq low[i] \). Тогда либо \( i' \) перекрывается с \( i \), либо \( i' \) лежит целиком справа от \( i \), и \( i \) не перекрывается ни с каким отрезком \( i'' \) из правого поддерева, потому что \( low[i'] \leq low[i''] \).

Рассмотрим теперь случай 1. Предположим, что в левом поддереве нет отрезков, перекрывающихся с \( i \). Тогда нужно доказать, что таких отрезков нет и в правом. Так как выполняется строка 4, то условие в строке 3 выполнено, и \( \max[\left[x\right]] \geq low[i] \). Поэтому в левом поддереве найдётся отрезок \( i' \), для которого

\[
high[i'] = \max[\left[i'\right]] \geq low[i]
\]

(см. рис. 15.5б). Но отрезки \( i \) и \( i' \) не перекрываются (по предположению — мы считаем, что в левом поддереве нет отрезков, перекрывающихся с \( i \)). Это означает, что отрезок \( i' \) лежит целиком справа от \( i \) (целиком слева он лежать не может), то есть \( high[i] < low[i'] \). В дереве \( T \) выполнено свойство упорядоченности левых концов, поэтому и все отрезки правого поддерева лежат целиком справа от \( i \): для произвольного отрезка \( i'' \) из правого поддерева выполнено

\[
high[i] < low[i'] \leq low[i'']
\]

Упражнения

15.3-1 Напишите процедуру LEFT-ROTATE для дерева промежутков, которая обновляет поля \( max \) за время \( O(1) \).

15.3-2 Перепишите процедуру INTERVAL-SEARCH для случая, когда в дереве промежутков хранятся не отрезки, а интервалы (то есть нас интересуют перекрытия ненулевой длины).

15.3-3 Постройте алгоритм, который по заданному отрезку возвращает перекрывающийся с ним отрезок с минимальным левым концом (или константу NIL, если таких отрезков нет).

15.3-4 Напишите программу, которая по заданному отрезку \( i \) и дереву промежутков \( T \) возвращает список всех отрезков де-