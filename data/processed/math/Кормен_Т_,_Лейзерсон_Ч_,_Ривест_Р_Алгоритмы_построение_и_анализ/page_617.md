---
source_image: page_617.png
page_number: 617
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.07
tokens: 11733
characters: 2313
timestamp: 2025-12-24T06:49:47.309741
finish_reason: stop
---

Рисунок 29.12  29.12 Параллельная префиксная схема для упражнения 29.2-6

29.2-7 Какова максимальная выходная степень каждого провода в схеме с предвычислением переносов? Постройте схему для сложения глубины \( O(\lg n) \) и размера \( \Theta(n) \), в которой все провода имеют выходную степень \( O(1) \).

29.2-8 Постройте счётчик единиц — схему с \( n \) входами и \( [\lg(n+1)] \) выходами, выдающую число единиц среди входов, записанное в двоичной системе. (Например, вход \( \langle 10011110 \rangle \) порождает выход \( \langle 101 \rangle \) (пять единиц). Глубина схемы должна составлять \( O(\lg n) \), размер — \( \Theta(n) \).

29.2-9* Постройте схему для сложения глубины 4 и полиномиально зависящего от \( n \) размера, используя элементы AND и OR с произвольным числом входов. (Дополнительный вопрос: сделайте то же самое для глубины 3.)

29.2-10* Пусть на каждом входе каскадного сумматора \( n \)-разрядных чисел с равной вероятностью появляются значения 0 и 1, причём разные входы независимы. Докажите, что с вероятностью не менее \( 1 - 1/n \) никакой перенос не распространяется далее чем на \( O(\lg n) \) разрядов.

29.3 Схемы для умножения

Наиболее простой алгоритм умножения "столбиком" состоит в сложении "сдвигов" одного из сомножителей: 2n-битовое произведение двух n-битовых чисел \( a = \langle a_{n-1}, a_{n-2}, \ldots, a_0 \rangle \) и \( b = \langle b_{n-1}, b_{n-2}, \ldots, b_0 \rangle \) может быть записано как

\[
p = a \cdot b = \sum_{i=0}^{n-1} m^{(i)},
\]

где \( m^{(i)} = a \cdot b_i \cdot 2^i \) получается из \( a \) сдвигом всех разрядов на \( i \) единиц влево (и заполнением освободившихся разрядов нулями), если \( b_i = 1 \), и равно 0, если \( b_i = 0 \) (рис. 29.13). Числа \( m_i \) называются частичными произведениями; каждое ненулевое частичное произведение соответствует ненулевому разряду в \( b \).

Рисунок 29.13  29.13 Умножение чисел \( a = \langle 1110 \rangle \) и \( b = \langle 1101 \rangle \) столбиком; произведение \( p = a \cdot b = \langle 10110110 \rangle \). Каждое частичное произведение \( m^{(i)} \) получается из \( a \) сдвигом на \( i \) разрядов влево, если \( b_i = 1 \). В противном случае оно равно нулю.

В этом разделе рассматриваются две схемы для умножения. Матричный умножитель работает за время \( \Theta(n) \) и имеет раз-