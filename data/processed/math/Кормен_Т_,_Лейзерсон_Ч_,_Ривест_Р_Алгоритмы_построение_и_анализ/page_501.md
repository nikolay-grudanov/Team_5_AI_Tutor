---
source_image: page_501.png
page_number: 501
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.67
tokens: 11804
characters: 2655
timestamp: 2025-12-24T06:44:05.263287
finish_reason: stop
---

Рис.25.4 НОВЫЙ: эскиз см. на полях книги

Рисунок 25.4 25.4. Плохой случай: релаксация ребра \((u, v)\), где вершина \(u\) является потомком \(v\) в дереве предшествования. Если такое происходит, возникает цикл, имеющий отрицательную сумму весов.

предшествования, а затем по ребру \((u, v))\) имеет отрицательную сумму весов.

Поскольку ребро \((u, v)\) подверглось релаксации, до её выполнения имело место неравенство \(d[u] + w(u, v) < d[v]\), или \((d[u] - d[v]) + w(u, v) < 0\). Мы сейчас покажем, что вес пути от \(v\) в \(u\) в графе \(G_{\pi}\) не превосходит \(d[u] - d[v]\), и тем самым найдём цикл отрицательного веса в графе \(G\), достижимый из \(s\), которого по предположению не существует.

Итак, почему же вес пути в \(G_{\pi}\) от вершины \(v\) к вершине \(u\) не превосходит разницы значений функции \(d\) в конце и начале пути? Очевидно, достаточно проверить это для одного ребра, то есть проверить, что если ребро \((p, q)\) в какой-то момент входит в \(G_{\pi}\), то в этот момент
\[
w(p, q) \leq d[q] - d[p]
\]
то есть \(d[q] \geq d[p] + w(p, q)\). Непосредственно после релаксации ребра \((p, q)\) это неравенство обращается в равенство. Затем величины \(d[p]\) и \(d[q]\) могут уменьшаться. Если уменьшается \(d[p]\), то неравенство не нарушается. Если уменьшается \(d[q]\), это значит, что происходит релаксация ребра, ведущего в \(q\), при этом меняется и \(\pi[q]\) и для нового ребра \((\pi[q], q)\) выполнено неравенство (25.1). Это рассуждение завершает доказательство леммы 25.8

Пусть в результате последовательности релаксаций мы добились того, что \(d[v] = \delta(s, v)\) для всех вершин \(v\). Покажем, что в этом случае граф \(G_{\pi}\) является деревом кратчайших путей.

Лемма 25.9
Пусть \(G = (V, E)\) — взвешенный ориентированный граф с весовой функцией \(w\) и исходной вершиной \(s\), причем в графе \(G\) нет циклов отрицательного веса, достижимых из \(s\). Предположим, что после операции Initialize-Single-Source\((G, s)\), за которой следует некоторая последовательность релаксаций ребер, оказалось, что \(d[v] = \delta(s, v)\) для всех \(v \in V\). Тогда подграф предшествования \(G_{\pi}\) является деревом кратчайших путей.

Доказательство
Согласно определению, нам надо проверить, что \(V[G_{\pi}]\) совпадает со множеством вершин графа \(G\), достижимых из \(s\), что \(G_{\pi}\) — дерево с корнем \(s\), и что пути в \(G_{\pi}\) из \(s\) в его вершины являются кратчайшими путями в \(G\).

Второе из этих утверждений есть лемма 25.8; из неё же следует, что все вершины \(G_{\pi}\) достижимы из \(s\) (даже в подграфе \(G_{\pi}\)); обратно, если вершина \(v \neq s\) достижима в графе \(G\) из \(s\), то