---
source_image: page_305.png
page_number: 305
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 76.29
tokens: 11783
characters: 2245
timestamp: 2025-12-24T06:34:54.034851
finish_reason: stop
---

Рисунок 16.1 Таблицы m и s, вычисляемые процедурой MATRIX-CHAIN-ORDER для n = 6 и матриц следующего размера:

<table>
  <tr>
    <th>матрица</th>
    <th>размер</th>
  </tr>
  <tr>
    <td>A₁</td>
    <td>30 × 35</td>
  </tr>
  <tr>
    <td>A₂</td>
    <td>35 × 15</td>
  </tr>
  <tr>
    <td>A₃</td>
    <td>15 × 5</td>
  </tr>
  <tr>
    <td>A₄</td>
    <td>5 × 10</td>
  </tr>
  <tr>
    <td>A₅</td>
    <td>10 × 20</td>
  </tr>
  <tr>
    <td>A₆</td>
    <td>20 × 25</td>
  </tr>
</table>

Таблицы повёрнуты так, что главная диагональ горизонтальна. В таблице m используются только клетки, лежащие не ниже главной диагонали, в таблице s — только клетки, лежащие строго выше. Минимальное количество умножений, необходимое для перемножения всех шести матриц, равно m[1, 6] = 15 125. Пары клеточек, заштрихованных одинаковой светлой штриховкой, совместно входят в правую часть формулы в процессе вычисления m[2, 5] (строка 9 процедуры MATRIX-CHAIN-ORDER):

\[
m[2, 5] = \min \left\{ 
\begin{array}{l}
m[2, 2] + m[3, 5] + p_1 p_2 p_5 = 0 + 2500 + 35 \cdot 15 \cdot 20 = 13000, \\
m[2, 3] + m[4, 5] + p_1 p_3 p_5 = 2625 + 1000 + 35 \cdot 5 \cdot 20 = 7125, \\
m[2, 4] + m[5, 5] + p_1 p_4 p_5 = 4375 + 0 + 35 \cdot 10 \cdot 20 = 11375.
\end{array} \right.
\]

сляются m[i, i+2] для i = 1, 2, ..., n−2 — минимальные стоимости перемножения последовательностей длины 3, и так далее. На каждом шаге значение m[i, j], вычисляемое в строках 9–12, зависит только от вычисленных ранее значений m[i, k] и m[k + 1, j].

На рис. 16.1 показано, как это происходит при n = 6. Поскольку мы определяем m[i, j] только для i ≤ j, используется часть таблицы, лежащая над главной диагональю. На рисунке таблицы повёрнуты (главная диагональ горизонтальна). Внизу выписана последовательность матриц. Число m[i, j] — минимальная стоимость перемножения подпоследовательности A_i A_{i+1} ... A_j — находится на пересечении диагоналей, идущих вправо-вверх от матрицы A_i и влево-вверх от матрицы A_j. В каждом горизонтальном ряду собраны стоимости перемножения подпоследовательностей фиксированной длины. Для заполнения клетки m[i, j] нужно знать произведения p_{i-1} p_k p_j для k = i, i + 1, ..., j − 1 и содержимое клеток, лежащих слева-внизу и справа-внизу от m[i, j].