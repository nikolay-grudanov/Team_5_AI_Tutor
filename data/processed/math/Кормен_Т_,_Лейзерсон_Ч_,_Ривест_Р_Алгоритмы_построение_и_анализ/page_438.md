---
source_image: page_438.png
page_number: 438
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.88
tokens: 11484
characters: 2014
timestamp: 2025-12-24T06:40:52.027187
finish_reason: stop
---

его \( x \) и проследим, сколько раз у него этот указатель менялся.

Весовая эвристика гарантирует, что представитель меняется, лишь если \( x \) входит в меньшее из объединяемых множеств. В этом случае число элементов в множестве, содержащем \( x \), возрастает по крайней мере вдвое. Поскольку окончательный размер множества, содержащего \( x \), не превосходит \( n \), количество таких удвоений не превосходит \( \lceil \lg n \rceil \). Общее количество элементов равно \( n \), так что суммарная стоимость обновления указателей на начало списка есть \( O(n \lg n) \), а общее число операций есть \( O(m) + O(n \lg n) \).

Упражнения

22.2-1
Напишите процедуры Make-Set, Find-Set и Union, используя реализацию с помощью списков и весовую эвристику. Считайте, что каждый элемент \( x \) имеет поля \( rep[x] \) (указатель на представителя), а также \( last[x] \) (указатель на последний элемент списка) и \( size[x] \) (число элементов); два последних поля важны только для элемента, являющегося представителем множества.

22.2-2
Изобразите списки, получающиеся в результате работы приведённой ниже программы, и объясните, какой ответ дадут вызовы Find-Set (если используется представление в виде списков и весовая эвристика).

1 for i \gets 1 to 16
2 do Make-Set(x_i)
3 for i \gets 1 to 15 by 2
4 do Union(x_i, x_{i+1})
5 for i \gets 1 to 13 by 4
6 do Union(x_i, x_{i+2})
7 Union(x_1, x_5)
8 Union(x_{11}, x_{13})
9 Union(x_1, x_{10})
10 Find-Set(x_2)
11 Find-Set(x_9)

22.2-3
Покажите, что при реализации непересекающихся множеств с помощью списков с весовой эвристикой учетную стоимость операций Make-Set и Find-Set можно считать равной \( O(1) \), а учётную стоимость Union можно считать равной \( O(\lg n) \).

22.2-4
Укажите точную асимптотическую оценку стоимости последовательности операций рис. 22.3 (если используются списки и весовая эвристика).

22.3 Лес непересекающихся множеств
Для системы непересекающихся множеств существует более эффективная реализация (по сравнению с рассмотренными). Именно,