---
source_image: page_495.png
page_number: 495
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 64.21
tokens: 11744
characters: 2499
timestamp: 2025-12-24T06:43:49.411900
finish_reason: stop
---

Рисунок 25.1  25.1 Ориентированный граф с рёбрами отрицательного веса. У каждой вершины указан вес кратчайшего пути из s в эту вершину. Поскольку вершины e и f образуют цикл отрицательного веса, достижимый из вершины s, веса кратчайших путей в каждую из этих вершин равны −∞. Сделав несколько циклов, можно пойти в g, так что вес кратчайшего пути в g также равен −∞. Вершины h, i и j недостижимы из s, так что (хоть они и лежат на цикле отрицательного веса), вес кратчайшего пути в эти вершины есть ∞.

Зуют это и применимы лишь для графов с неотрицательными весами. Другие (например, алгоритм Беллмана-Форда) допускают рёбра отрицательного веса и даже дают верный результат, если из исходной вершины нельзя дойти до цикла отрицательного веса. Обычно алгоритм сообщает, если такой цикл отрицательного веса обнаружен.

Представление кратчайших путей в алгоритме
Часто требуется не просто подсчитать веса кратчайших путей, но и найти сами эти пути. Мы будем использовать для их представления тот же приём, что и в деревьях поиска в ширину в разд. 23.2. Именно, пусть G = (V, E) — заданный граф. Для каждой вершины v ∈ V мы будем помнить её предшественника (predecessor) π[v]. Предшественник вершины — это либо другая вершина (указатель на неё), либо NIL. По завершении работы алгоритмов, рассматриваемых в этой главе, цепочка предшественников, начинаящаяся с произвольной вершины v, будет представлять собой кратчайший путь из s в v (в обратном порядке), так что, если π[v] ≠ NIL, процедура Print-Path(G, s, v) из разд. 23.2 напечатает кратчайший путь из s в v.

В процессе работы алгоритмов цепочки, получаемые итерациями π, не обязательно будут кратчайшими путями, но всё равно можно рассмотреть ориентированный подграф предшествования (predecessor subgraph) G_π = (V_π, E_π), определённый так: вершины G_π — это те вершины G, у которых предшественник отличен от NIL, плюс исходная вершина:

\[
V_π = \{ v \in V : π[v] \neq NIL \} \cup \{ s \}.
\]

Рёбра G_π — это стрелки, указывающие из π[v] ≠ NIL в v:

\[
E_π = \{ (π[v], v) \in E : v \in V_π \setminus \{ s \} \}.
\]

Мы докажем, что по окончании работы наших алгоритмов граф G_π будет "деревом кратчайших путей" — деревом с корнем s, содержащим кратчайшие пути из s во все достижимые из s вершины. Деревья кратчайших путей аналогичны деревьям поиска в ширину из разд. 23.2, с той разницей, что на сей раз кратчайшими объявляются пути с наименьшим весом, а не наименьшим числом ребер. Точное определение выглядит так. Пусть G = (V, E) — взвешен-