---
source_image: page_498.png
page_number: 498
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 48.96
tokens: 11595
characters: 2100
timestamp: 2025-12-24T06:43:41.716669
finish_reason: stop
---

Рисунок 25.3  25.3 Релаксация ребра \((u, v)\). В вершинах указаны оценки кратчайшего пути. (а) Поскольку перед релаксацией было \(d[v] > d[u] + w(u, v)\), в результате релаксации \(d[v]\) уменьшается. (б) Уже до релаксации имеем \(d[v] \leq d[u] + w(u, v)\). Релаксация ничего не меняет.

следующем. Для каждого ребра \(v \in V\) мы храним некоторое число \(d[v]\), являющееся верхней оценкой веса кратчайшего пути из \(s\) в \(v\); для краткости мы будем называть его просто *оценкой кратчайшего пути* (shortest-path estimate). Начальное значение оценки кратчайшего пути (и предшественников) даётся следующей процедурой:

Initialize-Single-Source(G,s)
1 for (для) всех вершин \(v \in V[G]\)
2 do \(d[v] \gets \infty\)
3 \(\pi[v] \gets \text{\sc nil}\)
4 \(d[s] \gets 0\)

Иными словами, первоначально \(\pi[v] = \text{NIL}\) для всех \(v\); при этом \(d[s] = 0\) и \(d[v] = \infty\) для остальных вершин \(v\).

Релаксация ребра \((u, v) \in E\) состоит в следующем: значение \(d[v]\) уменьшается до \(d[u] + w(u, v)\) (если второе значение меньше первого): при этом \(d[v]\) остаётся верхней оценкой в силу леммы 25.3. Мы хотим, чтобы \(\pi[v]\) указывали на путь, использованный при получении этой верхней оценки, поэтому одновременно мы меняем значение \(\pi[v]\):

Relax(u,v,w)
1 if \(d[v] > d[u] + w(u, v)\)
2 then \(d[v] \gets d[u] + w(u, v)\)
3 \(\pi[v] \gets u\)

На рис. 25.3 приведены два примера релаксации: в одном случае оценка кратчайшего пути уменьшается, в другом ничего не происходит.

Алгоритмы, описываемые в этой главе, устроены так: они вызывают процедуру Initialize-Single-Source, а затем производят релаксацию рёбер. Разные алгоритмы отличаются порядком, в котором рёбра подвергаются релаксации. В алгоритме Дейкстры и алгоритме для ациклических графов каждое ребро подвергается релаксации лишь единожды. В алгоритме Беллмана-Форда рёбра подвергаются релаксации по нескольку раз.

Свойства релаксации

Леммы, доказываемые в этом и следующем разделах, будут использованы при доказательстве правильности алгоритмов поиска кратчайших путей.

Следующая лемма очевидна.
Лемма 25.4