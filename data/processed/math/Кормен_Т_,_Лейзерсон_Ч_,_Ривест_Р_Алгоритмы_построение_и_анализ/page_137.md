---
source_image: page_137.png
page_number: 137
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.61
tokens: 11305
characters: 1529
timestamp: 2025-12-24T06:26:19.066259
finish_reason: stop
---

Рисунок 7.1 Кучу можно рассматривать как дерево (а) или как массив (б). Внутри вершины показано её значение. Около вершины показан её индекс в массиве.

PARENT(i)
    return ⌊i/2⌋

LEFT(i)
    return 2i

RIGHT(i)
    return 2i + 1

Элемент A[1] является корнем дерева.
В большинстве компьютеров для выполнения процедур LEFT и PARENT можно использовать команды левого и правого сдвига (LEFT, PARENT); RIGHT требует левого сдвига, после которого в младший разряд помещается единица.
Элементы, хранящиеся в куче, должны обладать основным свойством кучи (heap property): для каждой вершины i, кроме корня (т.е. при \(2 \leq i \leq \text{heap-size}[A]\)),

\[
A[\text{PARENT}(i)] \geq A[i].
\]

Отсюда следует, что значение потомка не превосходит значения предка. Таким образом, наибольший элемент дерева (или любого поддерева) находится в корневой вершине дерева (этого поддерева).
Высотой (height) вершины дерева называется высота поддерева с корнем в этой вершине (число рёбер в самом длинном пути с началом в этой вершине вниз по дереву к листу). Высота дерева, таким образом, совпадает с высотой его корня. В дереве, составляющем кучу, все уровни (кроме, быть может, последнего), заполнены полностью. Поэтому высота этого дерева равна \( \Theta(\lg n) \), где \( n \) — число элементов в куче (см. упр. 7.1-2). Как мы увидим ниже, время работы основных операций над кучей пропорционально высоте дерева и, следовательно, составляет \( O(\lg n) \). Оставшаяся часть главы посвящена анализу этих операций и применению кучи в задачах