---
source_image: page_429.png
page_number: 429
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 71.25
tokens: 11630
characters: 1918
timestamp: 2025-12-24T06:40:51.476572
finish_reason: stop
---

не более чем на 1, достаточно доказать, что у вершины (реальной) степени \( k \) дети имеют модифицированную степень не менее \( 0, 1, 2, \ldots, k-1 \). Ясно, что это свойство сохраняется при удалении одного из детей. Кроме того, оно сохраняется при добавлении к вершине степени \( k \) другой вершины степени \( k \) (при подчинении одной вершины корневого списка другой первая делается непомеченной, так что её реальная степень равна модифицированной).

Теперь оценим число потомков для вершины степени \( k \), используя числа Фибоначчи. Напомним, что \( k \)-е число Фибоначчи \( F_k \) определяется так:

\[
F_k = \begin{cases}
0 & \text{если } k = 0, \\
1 & \text{если } k = 1, \\
F_{k-1} + F_{k-2} & \text{если } k \geq 2.
\end{cases}
\]

Лемма 21.2.

\[
F_{k+2} = 1 + \sum_{i=0}^k F_i
\]
для любого \( k \geq 0 \).

Доказательство. При \( k = 0 \) это верно: \( 1 + \sum_{i=0}^0 F_i = 1 + F_0 = 1 + 0 = 1 = F_2 \).
Рассуждая по индукции, предполагаем, что \( F_{k+1} = 1 + \sum_{i=0}^{k-1} F_i \).
Тогда

\[
F_{k+2} = F_k + F_{k+1} = F_k + \left( 1 + \sum_{i=0}^{k-1} F_i \right) = 1 + \sum_{i=0}^k F_i.
\]

Теперь мы уже можем оценить число вершин в поддереве, если известна степень его корня. Напомним, что \( F_{k+2} \geq \varphi^k \), где \( \varphi = (1 + \sqrt{5})/2 = 1.61803 \ldots \) — "золотое сечение" (2.14). (Это неравенство доказано в упр. 2.2-8.)

Лемма 21.3. Пусть \( x \) — вершина фибоначчиевой кучи, имеющая степень \( k \) или больше. Тогда \( \operatorname{size}(x) \geq F_{k+2} \geq \varphi^k \), где \( \varphi = (1 + \sqrt{5})/2 \).

Доказательство. По лемме 21.1 вершина \( x \) имеет среди своих детей вершины степени не менее \( 0, 0, 1, 2, 3, \ldots, k-2 \). Рассуждая по индукции, мы можем считать, что для детей доказываемое утверждение верно. (При \( k = 0 \) число \( F_{k+2} \) равно 1 и оценка очевидна.) Складывая число вершин в поддеревьях и прибавляя саму вершину \( x \),