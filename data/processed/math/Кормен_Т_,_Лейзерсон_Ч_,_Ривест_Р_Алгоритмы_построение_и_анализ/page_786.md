---
source_image: page_786.png
page_number: 786
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 56.67
tokens: 11675
characters: 2503
timestamp: 2025-12-24T06:57:18.132513
finish_reason: stop
---

**Эвристикой стоп-символа** и "эвристикой безопасного суффикса" (см. рис. 34.11). Эти эвристики позволяют не рассматривать некоторые (на практике — весьма многие) значения сдвига s. Обе эвристики действуют независимо и используются одновременно. Если при проверке сдвига s обнаруживается, что подстрока T[s + 1..s + m] не совпадает с образцом, то каждая из эвристик указывает значение, на которое можно увеличить s, не опасаясь пропустить допустимый сдвиг (это j − λ[T[s + j]] для эвристики стоп-символа и γ[j] для эвристики безопасного суффикса); алгоритм Бойера — Мура выбирает из двух сдвигов больший.

**34.5.1 Эвристика стоп-символа**

Стоп-символ, соответствующий данному сдвигу образца, — это первый справа символ в тексте, отличный от соответствующего символа в образце. Эвристика стоп-символа предлагает попробовать новое значение сдвига, исходя из того, где в образце встречается стоп-символ (если вообще встречается). В наиболее удачном случае стоп-символ выявляется при первом же сравнении (то есть P[m] ≠ T[s + m]) и не встречается ни где в образце (представьте себе, что вы ищете подстроку а^m в строке b^n). В этом случае сдвиг s можно сразу увеличить на m: любой меньший сдвиг заведомо не подойдет, так как стоп-символ в тексте окажется напротив какого-то символа из образца. Если этот наиболее удачный случай повторяется постоянно, то при поиске подстроки мы просмотрим всего лишь 1/m часть текста (вот как полезно сравнивать справа налево!).

В общем случае эвристика стоп-символа (bad-character heuristic) работает так. Предположим, что при сравнении справа налево мы наткнулись на первое несовпадение: P[j] ≠ T[s + j], где 1 ≤ j ≤ m. Пусть k — номер самого правого вхождения символа T[s + j] в образец P (если этот символ вообще не появляется в образце, считаем k равным 0). Мы утверждаем, что можно увеличить s на j − k, не упустив ни одного допустимого сдвига. В самом деле, если k = 0, то стоп-символ T[s + j] вообще не встречается в образце P, так что можно сразу сдвинуть образец на j − k = j позиций вправо (рис. 34.12 (a)); если 0 < k < j, то образец можно сдвинуть на j − k позиций вправо, так как при меньших сдвигах стоп-символ в тексте не совпадёт с соответствующим символом образца (рис. 34.12 (б)). Наконец, если k > j, то эвристика предлагает сдвигать образец не вправо, а влево; алгоритм Бойера-Мура эту рекомендацию игнорирует, поскольку эвристика безопасного суффикса всегда предлагает ненулевой сдвиг вправо.

Чтобы применять эвристику стоп-символа, полезно для ка-