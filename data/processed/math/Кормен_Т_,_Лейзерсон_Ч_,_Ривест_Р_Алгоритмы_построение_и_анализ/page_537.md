---
source_image: page_537.png
page_number: 537
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 67.38
tokens: 11878
characters: 2777
timestamp: 2025-12-24T06:45:57.161888
finish_reason: stop
---

Рисунок 26.5 26.6 Алгоритма Джонсона в применении к графу рис. 26.1. (а) Граф \( G' \) с исходной весовой функцией \( w \). Вспомогательная вершина \( s \) — чёрная. Внутри каждой вершины \( v \) записано значение \( h(v) = \delta(s, v) \). (б) Каждому ребру \( (u, v) \) приписан новый вес \( \hat{w}(u, v) = w(u, v) + h(u) - h(v) \). (с)-(г) Результаты работы алгоритма Дейкстры для всех вершин графа \( G \) с весовой функцией \( \hat{w} \). В каждом случае начальная вершина выделена чёрным. Внутри каждой вершины записаны величины \( \hat{\delta}(u, v)/\delta(u, v) \). Вес кратчайшего пути \( d_{uv} = \delta(u, v) \) равен \( \hat{\delta}(u, v) + h(v) - h(u) \).

Эта процедура следует описанной схеме. В строке 1 формируется граф \( G' \), затем в строке 2 к нему применяется алгоритм Беллмана-Форда (при этом используется весовая функция \( w \)). Если в \( G' \) (а значит, и в \( G \)) есть цикл отрицательного веса, то об этом сообщается в строке 3. Строки 4–11 выполняются, если в графе такого цикла нет. В строках 4–5 вычисляются значения функции \( h(v) \) для всех вершин \( v \in V' \) (веса кратчайших путей \( \delta(s, v) \), найденные алгоритмом Беллмана-Форда). В строках 6–7 вычисляются новые веса рёбер. В строках 8–11 для каждой вершины \( u \in V[G] \) вызывается алгоритм Дейкстры и определяются веса кратчайших путей \( \hat{\delta}(u, v) \) из этой вершины, а затем они пересчитываются в \( \delta(u, v) \) по формуле (26.10), и ответ помещается в массиве \( D \).

На рис. 26.6 показан пример выполнения алгоритма Джонсона.

Нетрудно подсчитать, что время работы алгоритма Джонсона составит \( O(V^2 \lg V + VE) \), если использовать фибоначчиеву кучу для хранения очереди с приоритетами в алгоритме Дейкстры. При более простой реализации очереди в виде двоичной кучи общее время работы составит \( O(VE \lg V) \), что меньше, чем оценка \( O(V^3) \) для алгоритма Флойда-Уоршолла, если только граф достаточно разрежен.

Упражнения
26.3-1 Примените алгоритм Джонсона к графу рис. 26.2, найдя значения \( h \) и \( \hat{w} \).
26.3-2 Каким образом используется вспомогательная вершина в алгоритме Джонсона?
26.3-3 Применим алгоритм Джонсона к графу, в котором исходная весовая функция сама неотрицательна. Что можно сказать о новой весовой функции в этом случае?
26.4* Замкнутые полукольца: общая схема для задач о путях
В этом разделе мы введём понятия замкнутого полукольца и дадим общую схему решения задач о путях в ориентированных графах. При этом алгоритм Флойда–Уоршолла и алгоритм построения транзитивного замыкания графа окажутся частными случаями этой общей схемы.
Определение замкнутого полукольца
Замкнутым полукольцом \( (S, \oplus, \odot, 0, 1) \) (по-английски closed semiring) называется множество \( S \) с определёнными на нем би-