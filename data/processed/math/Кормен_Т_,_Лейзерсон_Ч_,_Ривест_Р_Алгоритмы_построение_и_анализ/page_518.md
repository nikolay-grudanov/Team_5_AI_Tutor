---
source_image: page_518.png
page_number: 518
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 80.13
tokens: 11974
characters: 2724
timestamp: 2025-12-24T06:45:17.391608
finish_reason: stop
---

25-4 Алгоритм Габоу нахождения кратчайших путей с помощью масштабирования

Пусть нам дан взвешенный ориентированный граф \( G = (V, E) \), в котором веса всех ребер являются целыми неотрицательными числами, не превосходящими \( W \). Покажем, как можно найти кратчайшие пути из одной вершины за время \( O(E \lg W) \).

Пусть \( k = \lceil \lg(W + 1) \rceil \) — количество битов в двоичном представлении числа \( W \). Для \( i = 1, 2, \ldots, k \) положим \( w_i(u, v) = \lfloor w(u, v)/2^{k-i} \rfloor \) (иными словами, \( w_i(u, v) \) получается из \( w(u, v) \) отбрасыванием \( k - i \) младших битов в двоичном представлении числа \( w(u, v) \)). Например, если \( k = 5 \) и \( w(u, v) = 25 = \langle 11001 \rangle \), то \( w_3(u, v) = \langle 110 \rangle = 6 \). В частности, \( w_1 \) принимает только значения 0 и 1, определяемые старшим разрядом, а \( w_k = w \).

Пусть \( \delta_i(u, v) \) — вес кратчайшего пути из \( u \) в \( v \) относительно весовой функции \( w_i \) (в частности, \( \delta_k(u, v) = \delta(u, v) \)). Алгоритм, о котором пойдёт речь в этой задаче, найдёт сначала все \( \delta_1(s, v) \) (\( s \) — исходная вершина), затем все \( \delta_2(s, v) \), и так далее, пока не дойдёт до \( \delta_k(s, v) = \delta(s, v) \). Далее мы полагаем, что \( |E| \geq |V| - 1 \); как мы увидим, стоимость нахождения \( \delta_i \) при известном \( \delta_{i-1} \) есть \( O(E) \), так что алгоритм будет работать за время \( O(kE) = O(E \lg W) \).

Такой план решения задачи — замена исходных данных их двоичными приближениями с последовательным уточнением — называется масштабированием (scaling)

(а) Пусть \( \delta(s, v) \leq |E| \) для всех вершин \( v \in V \) (предполагается, что \( |E| \geq |V| - 1 \) и веса являются целыми неотрицательными числами). Покажите, что можно найти \( \delta(s, v) \) для всех \( v \in V \) за время \( O(E) \).

(б) Покажите, что можно подсчитать \( \delta_1(s, v) \) для всех \( v \in V \) за время \( O(E) \).

Теперь займемся вычислением \( \delta_i \) исходя из \( \delta_{i-1} \).

(в) Докажите, что (при \( i = 2, 3, \ldots, k \)) либо \( w_i(u, v) = 2w_{i-1}(u, v) \), либо \( w_i(u, v) = 2w_{i-1}(u, v) + 1 \). Выведите отсюда, что
\[
2\delta_{i-1}(u, v) \leq \delta_i(u, v) \leq 2\delta_{i-1}(u, v) + |V| - 1
\]
для всех \( v \in V \).

(г) Для \( i = 2, 3, \ldots, k \) и \( (u, v) \in E \) положим
\[
\hat{w}_i(u, v) = w_i(u, v) + 2\delta_{i-1}(s, u) - 2\delta_{i-1}(s, v).
\]
Покажите, что \( \hat{w}_i(u, v) \geq 0 \).

(д) Пусть \( \hat{\delta}_i(s, v) \) — вес кратчайшего пути относительно весовой функции \( \hat{w}_i \). Покажите, что
\[
\delta_i(s, v) = \hat{\delta}_i(s, v) + 2\delta_{i-1}(s, v)
\]
и что \( \hat{\delta}_i(s, v) \leq |E| \).