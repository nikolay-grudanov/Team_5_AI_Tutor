---
source_image: page_511.png
page_number: 511
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 59.62
tokens: 11657
characters: 2511
timestamp: 2025-12-24T06:44:34.693285
finish_reason: stop
---

ной вершиной s не содержит циклов. Тогда по окончании работы процедуры Dag-Shortest-Paths для всех v ∈ V будут выполнены равенства d[v] = δ(s, v), а подграф предшественников G_π будет деревом кратчайших путей.

Доказательство

Согласно лемме 25.9, достаточно доказать равенства d[v] = δ(s, v). Если вершина v недостижима из s, то d[v] = δ(s, v) = ∞ по следствию 25.6. Пусть теперь вершина v достижима из s и p = ⟨s = v_0, v_1, ..., v_k = v⟩ — кратчайший путь. После топологической сортировки вершины этого пути расположены как раз в указанном порядке, так что ребро, (v_0, v_1) подвергалось релаксации до ребра (v_1, v_2), которое предшествовало ребру (v_2, v_3) и т.д. Индукция по i с использованием леммы 25.7 (как в доказательстве корректности алгоритма Беллмана-Форда) показывает теперь, что d[v_i] = δ(s, v_i) для всех i, что и требовалось доказать.

Интересное приложение описанного алгоритма — нахождение критических путей в смысле так называемой "технологии PERT" (program evaluation and review technique). В этом приложении каждое ребро ациклического ориентированного графа обозначает какое-то дело, а вес ребра есть время, необходимое на его выполнение. Если имеются рёбра (u, v) и (v, x), то работа, соответствующая ребру (u, v), должна быть выполнена до начала работы, соответствующей ребру (v, x). Критический путь (critical path) — это длиннейший путь в графе; его вес равен времени, которое будет затрачено на выполнение всех работ, если мы по максимуму используем возможность выполнять некоторые работы параллельно. Чтобы найти критический путь, можно поменять знак у всех весов на противоположный и запустить алгоритм Dag-Shortest-Paths.

Упражнения

25-4.1 Примените алгоритм Dag-Shortest-Paths к графу рис. 25.8, выбрав вершину r в качестве исходной.

25-4.2 Докажите, что алгоритм Dag-Shortest-Paths останется правильным, если обрабатывать только первые |V| − 1 вершин.

25-4.3 В задаче о планировании работ по технологии PERT можно рисовать граф иначе, считая, что работы соответствуют не рёбрам, а вершинам графа. При этом каждой вершине присвоен вес (требуемое время), а стрелки указывают определяли последовательность работ (ребро (u, v) требует завершить работу u до начала работы v). Модифицируйте алгоритм Dag-Shortest-Paths так, чтобы он за линейное время находил в ациклическом ориентированном графе путь с максимальной суммой весов вершин.

25-4.4 Разработайте эффективный алгоритм, подсчитывающий общее число путей в ациклическом ориентированном графе, и оцените время его работы.