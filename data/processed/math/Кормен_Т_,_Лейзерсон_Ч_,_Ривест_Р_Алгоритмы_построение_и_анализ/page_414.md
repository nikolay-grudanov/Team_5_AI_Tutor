---
source_image: page_414.png
page_number: 414
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.76
tokens: 11432
characters: 1868
timestamp: 2025-12-24T06:39:45.551609
finish_reason: stop
---

Рисунок 21.1 (а) Фибоначчиева куча, содержащая 5 деревьев и 14 вершин. Пунктирной линией показан корневой список. Минимальная вершина содержит ключ 3. Три отмеченные вершины выделены чёрным цветом. Потенциал этой кучи равен \( 5 + 2 \cdot 3 = 11 \). (б) Та же куча вместе со стрелками, показывающими значения полей \( p \) (стрелки вверх), \( child \) (стрелки вниз) и \( left \) и \( right \) (стрелки в стороны). На остальных рисунках этой главы такие стрелки опущены, так как они восстанавливаются однозначно.

в списке (левого и правого). Если вершина \( y \) является единственным ребёнком своего родителя, то \( left[y] = right[y] = y \).

Двусторонние циклические списки (см. разд. 11.2) удобны по двум причинам. Во-первых, из такого списка можно удалить любую вершину за время \( O(1) \). Во-вторых, два таких списка можно соединить в один за время \( O(1) \).

Помимо указанной информации, каждая вершина имеет поле \( degree[x] \), где хранится её степень (число детей), а также поле \( mark[x] \). В этом поле хранится булевское значение. Смысл его таков: \( mark[x] \) истинно, если вершина \( x \) потеряла ребёнка после того, как она в последний раз сделалась чьим-либо потомком. Мы объясним позже, как и когда это поле используется.

Корни деревьев, составляющих фибоначчиеву кучу, связаны с помощью указателей \( left \) и \( right \) в двусторонний циклический список, называемый корневым списком (root list).

Доступ к фибоначчиевой куче \( H \) осуществляется с помощью атрибута \( min[H] \), который указывает на вершину корневого списка с минимальным ключом. Эта вершина называется минимальной вершиной (minimum node) кучи. Её ключ будет минимальным ключом в куче, поскольку минимальный ключ фибоначчиева дерева находится в его корне. Порядок вершин в корневом списке значения не имеет. Если фибоначчиева куча \( H \) пуста, то \( min[H] = NIL \).