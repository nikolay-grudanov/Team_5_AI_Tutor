---
source_image: page_782.png
page_number: 782
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 75.86
tokens: 11984
characters: 2741
timestamp: 2025-12-24T06:57:28.431000
finish_reason: stop
---

Рис. 34.10
Подпись:
Рис.34.10. К лемме 34.5 (\( P = ababababc, q = 8 \)). (а) Функция \( \pi \), связанная со строкой \( P \). Имеем \( \pi[8] = 6, \pi[6] = 4, \pi[4] = 2, \pi[2] = 0 \), так что \( \pi^*[8] = \{ 8, 6, 4, 2, 0 \} \). (б) Сдвигая строку \( P \) относительно самой себя слева направо, отмечаем моменты, когда префикс \( P_k \sqsubset P \) является суффиксом строки \( P_8 \) (совпадающие символы выделены серым и соединены вертикальными отрезками; пунктирная линия нарисована справа от \( P_8 \)). Это происходит при \( k = 8, 6, 4, 2, 0 \), что совпадает со множеством \( \pi^*[8] \).

что \( P_k \) является суффиксом \( P_q \). Именно, для данного \( q \) положим

\[
\pi^*[q] = \{ q, \pi[q], \pi^2[q], \pi^3[q], \ldots, \pi^t[q] \},
\]

где \( \pi^i[q] \) обозначает i-ую итерацию префикс-функции (то есть \( \pi^0[q] = q, \text{ а } \pi^i[q] = \pi[\pi^{i-1}[q]] \)) и \( \pi^t[q] = 0 \) (такое t найдется, так как \( \pi[j] < j \) для всех \( j \); на этом месте итерации обрываются).

Лемма 34.5 (Лемма об итерациях префикс-функции) Пусть \( P \) — строка длины \( m \) с префикс-функцией \( \pi \). Тогда для всех \( q = 1, 2, \ldots, m \) имеем \( \pi^*[q] = \{ k : P_k \sqsubset P_q \} \).

Доказательство.
Покажем сначала, что

\[
i \in \pi^*[q] \implies P_i \sqsubset P_q.
\]

В самом деле, \( P_{\pi(i)} \sqsubset P_i \), так что каждый следующий член последовательности \( P_q, P_{\pi[q]}, P_{\pi[\pi[q]]}, \ldots \) является суффиксом предыдущего (и, следовательно, всех предыдущих).

Покажем теперь, что и наоборот, \( \{ k : P_k \sqsubset P_q \} \subseteq \pi^*[q] \). Рассуждая от противного, обозначим через \( j \) наибольший элемент множества \( \{ k : P_k \sqsubset P_q \} \setminus \pi^*[q] \). Очевидно, \( j < q \); раз \( j \) не лежит в последовательности \( \pi^*[q] \), то \( j \) попадает между двумя её членами: \( j' > j > \pi[j'] \) для некоторого \( j' \in \pi^*[q] \).

Обе строки \( P_j \) и \( P_{j'} \) являются суффиксами \( P_q \): первая — по выбору \( j \), вторая — в силу соотношения (34.6). Стало быть, \( P_j \sqsubset P_{j'} \) по лемме 34.1, и \( P_j \) является префиксом строки \( P \), который является (собственным) суффиксом строки \( P_{j'} \) и имеет длину больше \( \pi[j'] \), что противоречит определению функции \( \pi \).

Рис. 34.10 иллюстрирует доказанную лемму.

Лемма 34.6
Пусть \( P \) — строка длины \( m \) с префикс-функцией \( \pi \). Тогда \( \pi[q] - 1 \in \pi^*[q-1] \) для всех \( q = 1, 2, \ldots, m \), для которых \( \pi[q] > 0 \).

Доказательство.
Если \( k = \pi[q] > 0 \), то \( P_k \sqsubset P_q \), откуда, отбрасывая последний символ, получаем, что \( P_{k-1} \sqsubset P_{q-1} \). По лемме 34.5 это означает, что \( \pi[q] - 1 \in \pi^*[q-1] \).