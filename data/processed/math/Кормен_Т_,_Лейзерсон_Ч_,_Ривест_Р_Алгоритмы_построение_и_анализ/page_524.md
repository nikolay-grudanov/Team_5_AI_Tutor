---
source_image: page_524.png
page_number: 524
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 65.17
tokens: 11733
characters: 2126
timestamp: 2025-12-24T06:45:14.277680
finish_reason: stop
---

При \( m = 0 \) допустимы лишь "пути" вовсе без рёбер, то есть

\[
d_{ij}^{(0)} = \begin{cases}
0 & \text{если } i = j, \\
\infty & \text{если } i \neq j.
\end{cases}
\]

Если же \( m \geq 1 \), то минимум \( d_{ij}^{(m)} \) достигается либо на пути из не более чем \( m - 1 \) ребра (и тогда равен \( d_{ij}^{(m-1)} \)), либо же на пути из \( m \) ребер. В последнем случае этот путь можно разбить на начальный отрезок из \( m - 1 \) рёбер, ведущий из начальной вершины \( i \) в некоторую вершину \( k \), и на последнее ребро \( (k, j) \). Мы приходим к формуле

\[
d_{ij}^{(m)} = \min(d_{ij}^{(m-1)}, \min_{1 \leq k \leq n} \{ d_{ik}^{(m-1)} + w_{kj} \}) =
= \min_{1 \leq k \leq n} \{ d_{ik}^{(m-1)} + w_{kj} \}
\]

(Последнее равенство использует равенство \( w_{jj} = 0 \).)

Если граф не содержит циклов с отрицательными весами, кратчайший путь можно выбрать без циклов; такой путь содержит не более \( n - 1 \) рёбер. Следовательно,

\[
\delta(i, j) = d_{ij}^{(n-1)} = d_{ij}^{(n)} = d_{ij}^{(n+1)} = \cdots \tag{26.3}
\]

Вычисление кратчайших путей "снизу вверх"

По заданной матрице весов \( W = (w_{ij}) \) мы будем последовательно вычислять матрицы \( D^{(1)}, D^{(2)}, \ldots, D^{(n-1)} \), где \( D^{(m)} = (d_{ij}^{(m)}) \). Как мы видели, последняя матрица \( D^{(n-1)} \) будет содержать веса кратчайших путей. Заметим, что матрица \( D^{(1)} \) (веса путей из одного ребра) совпадает с \( W \).

Шаг алгоритма состоит в вычислении \( D^{(m)} \) по \( D^{(m-1)} \) и \( W \).

{\sc Extend-Shortest-Paths}$(D,W)$\\
\verb|1 |$n \leftarrow rows[D]|\\
\verb|2 |пусть $D'=(d'_{ij})$ --- $n\times n$-матрица|
\verb|3 |for $i \leftarrow 1$ to $n$|\\
\verb|4 |do for $j \leftarrow 1$ to $n$|\\
\verb|5 |do $d'_{ij} \leftarrow \infty$|\\
\verb|6 |for $k \leftarrow 1$ to $n$|\\
\verb|7 |do $d'_{ij} \leftarrow \min(d'_{ij},\ ,d_{ik}+w_{kj})$|\\
\verb|8 |return $D'$|

Эта процедура вычисляет матрицу \( D' \) в соответствии с формулой (26.2) при этом роль матриц \( D \) и \( D' \) играют матрицы \( D^{(m-1)} \) и \( D^{(m)} \). Процедура содержит три вложенных цикла, так что время её работы есть \( \Theta(n^3) \).