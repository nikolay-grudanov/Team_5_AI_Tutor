---
source_image: page_148.png
page_number: 148
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.82
tokens: 11417
characters: 1861
timestamp: 2025-12-24T06:27:08.294788
finish_reason: stop
---

8 Быстрая сортировка

В этой главе рассмотрен так называемый алгоритм "быстрой сортировки". Хотя время его работы для массива из n чисел в худшем случае составляет \( \Theta(n^2) \), на практике этот алгоритм является одним из самых быстрых: математическое ожидание времени работы составляет \( \Theta(n \lg n) \), причём множитель при \( n \lg n \) довольно мал. Кроме того, быстрая сортировка не требует дополнительной памяти и сохраняет эффективность для систем с виртуальной памятью.

В разделе 8.1 описывается алгоритм в целом и процедура разделения массива на части. Оценка эффективности алгоритма довольно сложна; в разделе 8.2 приводятся интуитивные доводы, а строгий анализ отложен до раздела 8.4. В разделе 8.3 описаны варианты быстрой сортировки, использующие генератор случайных чисел. При этом время работы в худшем случае (при неудачном случайном выборе) составляет \( O(n^2) \), но среднее время работы составляет лишь \( O(n \lg n) \). (Говоря о среднем времени, мы имеем в виду не усреднение по всем входам, а математическое ожидание времени работы, которое для любого входа не превосходит \( O(n \log n) \).) Один из вариантов вероятностного алгоритма быстрой сортировки подробно анализируется в разделе 8.4, где доказаны оценки для среднего и наибольшего времени работы.

8.1 Описание быстрой сортировки

Быстрая сортировка (quicksort), как и сортировка слиянием, основана на принципе "разделяй и властвуй" (см. разд. 1.3.1). Сортировка участка \( A[p..r] \) происходит так:
• Элементы массива \( A \) переставляются так, чтобы любой из элементов \( A[p], \ldots, A[q] \) был не больше любого из элементов \( A[q+1], \ldots, A[r] \), где \( q \) — некоторое число в интервале \( p \leq q < r \). Эту операцию мы будем называть разделением (partition).
• Процедура сортировки рекурсивно вызывается для массивов \( A[p..q] \) и \( A[q+1..r] \).