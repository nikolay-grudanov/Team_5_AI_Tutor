---
source_image: page_774.png
page_number: 774
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 60.97
tokens: 11671
characters: 2412
timestamp: 2025-12-24T06:56:53.671810
finish_reason: stop
---

34.3.2 Автоматы для поиска подстрок

Для каждого образца \( P \) можно построить конечный автомат, ищущий этот образец в тексте (см. рис. 34.6, где изображен автомат, соответствующий образцу \( P = ababasa \)). Задаемся до конца этого раздела строку-образец \( P \).

Первым шагом в построении автомата, соответствующего строке-образцу \( P[1..m] \), будет построение по \( P \) вспомогательной функции \( \sigma : \Sigma^* \to \{0, 1, \ldots, m\} \), называемой суффикс-функцией (suffix function). По определению, \( \sigma \) сопоставляет строке \( x \) длину максимального суффикса \( x \), являющегося префиксом \( P \):

\[
\sigma(x) = \max\{ k : P_k \sqsupseteq x \}.
\]

Поскольку \( P_0 = \varepsilon \) является суффиксом любой строки, \( \sigma \) определена на всем \( \Sigma^* \). Пример: если \( P = ab \), то \( \sigma(\varepsilon) = 0, \sigma(ccasa) = 1, \sigma(ccab) = 2 \). Если длина \( P \) равна \( m \), то \( \sigma(x) = m \) тогда и только тогда, когда \( P \) — суффикс \( x \). Если \( x \sqsupseteq y \), то \( \sigma(x) \leq \sigma(y) \).

Теперь определим конечный автомат, соответствующий образцу \( P[1..m] \), следующим образом:

• Множество состояний есть \( Q = \{0, 1, \ldots, m\} \). Начальное состояние \( q_0 = 0 \), единственное допускающее состояние есть \( m \).
• Функция перехода \( \delta \) определена следующей формулой (\( q — состояние, a \in \Sigma — символ \)):

\[
\delta(q, a) = \sigma(P_q a).
\]

Объясним, откуда берётся формула (34.3). Мы хотим сконструировать автомат таким образом, чтобы при его действии на строку \( T \) соотношение

\[
\varphi(T_i) = \sigma(T_i)
\]

являлось инвариантом (тогда равенство \( \varphi(T_i) = m \) будет равносильно тому, что \( P \) входит в \( T \) со сдвигом \( i - m \), и автомат тем самым найдёт все допустимые сдвиги). Но в этом случае вычисление перехода по формуле (34.3) необходимо для поддержания истинности инварианта (см. теорему 34.4 ниже).

Например, в автомате рис. 34.6, имеем \( \delta(5, b) = 4 \): если \( q = 5 \), прочитанная часть входа кончается на \( ababa \), и после добавления входного символа \( b \) наибольший суффикс прочитанной части, являющийся префиксом \( P \), будет равен \( abab \).

Запишем действие конечного автомата, ищущего подстроку \( P \) длины \( m \) в данном тексте \( T \), в виде программы (\( \delta \) обозначает функцию перехода):

Finite-Automaton-Matcher(T,\delta,m)