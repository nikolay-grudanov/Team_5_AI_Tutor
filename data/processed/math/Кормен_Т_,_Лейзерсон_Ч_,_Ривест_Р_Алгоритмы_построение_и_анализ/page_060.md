---
source_image: page_060.png
page_number: 60
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.86
tokens: 11302
characters: 1235
timestamp: 2025-12-24T06:22:32.350980
finish_reason: stop
---

Рисунок 4.3 Дерево рекурсии для соотношения \( T(n) = aT(n/b) + f(n) \) является полным \( a \)-ичным деревом высоты \( \log_b n \) с \( n^{\log_b a} \). Сумма весов по уровням показана справа, а общая сумма даётся формулой (4.6).

Доказательство. Последовательно подставляя соотношение само в себя, получаем

\[
\begin{align*}
T(n) &= f(n) + aT(n/b) \\
&= f(n) + af(n/b) + a^2T(n/b^2) \\
&= f(n) + af(n/b) + a^2f(n/b^2) + \ldots \\
&\quad + a^{\log_b n - 1} f(n/b^{\log_b n - 1}) + a^{\log_b n} T(1).
\end{align*}
\]

Поскольку \( a^{\log_b n} = n^{\log_b a} \), последний член может быть записан как \( \Theta(n^{\log_b a}) \). Оставшиеся члены образуют сумму, фигурирующую в утверждении леммы.

Дерево рекурсии

Доказательство леммы 4.2 можно пояснить в терминах дерева рекурсии (рис. 4.3), если число \( a \) целое (хотя само доказательство этого не требует). В корне стоит число \( f(n) \), в каждом из \( a \) его детей стоит число \( f(n/b) \), в каждом из \( a^2 \) внуков стоит \( f(n/b^2) \) и т. д. На уровне \( j \) имеется \( a^j \) вершин; вес каждой — \( f(n/b^j) \). Листья находятся на расстоянии \( \log_b n \) от корня, и имеют положительный вес \( T(1) \); всего на дереве \( a^{\log_b n} = n^{\log_b a} \) листьев.