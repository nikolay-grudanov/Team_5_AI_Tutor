---
source_image: page_563.png
page_number: 563
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.82
tokens: 11794
characters: 2590
timestamp: 2025-12-24T06:47:22.761143
finish_reason: stop
---

Рисунок 27.8 27.7 (а) Сеть, для которой процедура Ford-Fulkerson требует времени \( \Theta(E|f^*|) \), где \( f^* \) — максимальный поток величины \( |f^*| = 2\ 000\ 000 \). Выделен дополняющий путь с пропускной способностью 1. (б) Полученная остаточная сеть. Выделен дополняющий путь с той же пропускной способностью. (с) Полученная остаточная сеть.

котором
\[
E' = \{ (u, v) | (u, v) \in E \text{ или } (v, u) \in E \},
\]
и будем хранить потоки и пропускные способности рядом с соответствующими рёбрами (рёбра сети \( G \) входят и в граф \( G' \), так что пропускные способности есть где хранить). Остаточная сеть (для текущего потока) состоит из тех рёбер \( (u, v) \) графа \( G' \), для которых \( c(u, v) - f[u, v] \neq 0 \). Поиск дополняющего пути в остаточной сети (в глубину или в ширину — пока это всё равно) займет время \( O(E) = O(E') \). Поэтому время работы процедуры будет \( O(E|f^*|) \).

Из доказанной оценки следует, что при небольшом значении \( |f^*| \) и целых пропускных способностях время работы процедуры Ford-Fulkerson невелико. Но при большом \( |f^*| \) время работы алгоритма может быть велико даже для простой сети, как показывает пример рис. 27.7. Значение максимального потока в этой сети равно 2,000,000 (если использовать рёбра, идущие слева направо). Если, как показано на рис. 27.7 (а) и 27.7 (б), на чётных шагах будет выбираться дополняющий путь \( s \to v \to u \to t \), а на нечётных — \( s \to u \to v \to t \), то потребуется 2,000,000 шагов, чтобы найти максимальный поток.

Можно получить лучшую оценку времени работы процедуры Ford-Fulkerson, если предположить, что в строке 4 используется поиск в ширину. В этом случае путь \( p \) будет кратчайшим из дополняющих путей (длину каждого ребра считаем равной единице). Эта реализация метода Форда-Фалкерсона называется алгоритмом Эдмондса-Карпа. Докажем, что время работы алгоритма Эдмондса-Карпа равно \( O(VE^2) \).

Обозначим длину кратчайшего пути в \( G_f \) между вершинами \( u \) и \( v \) через \( \delta_f(u, v) \).

Лемма 27.8

Рассмотрим работу алгоритма Эдмондса-Карпа на сети \( G = (V, E) \) с истоком \( s \) и стоком \( t \). Для любой вершины \( v \) из \( V \setminus \{s, t\} \) расстояние \( \delta_f(s, v) \) в остаточной сети между истоком и вершиной \( v \in V \setminus \{s, t\} \) монотонно неубывает на каждом шаге цикла.

Доказательство

Предположим противное: пусть после увеличения потока \( f \) (вдоль дополняющего пути) расстояние \( \delta_f(s, v) \) от истока \( s \) до некоторой вершины \( v \) из \( V \setminus \{s, t\} \) уменьшилось. Обозначив увели-