---
source_image: page_803.png
page_number: 803
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.54
tokens: 11448
characters: 1880
timestamp: 2025-12-24T06:57:45.355358
finish_reason: stop
---

Глава 35 Вычислительная геометрия

проверяем, нет ли совпадающих точек среди концов (если есть — возвращаем true)
3 \emph{for} (для) каждой точки $p$ из полученного списка
4 \emph{do} if $p$ --- левый конец некоторого отрезка $s$
5 \emph{then} Insert (T, s )
6 \emph{if} (Above (T, s) существует и пересекает s) или
(Below (T, s) существует и пересекает s)
7 \emph{then return} true
8 \emph{if} $p$ правый конец некоторого отрезка $s$
9 \emph{then if} определены Above (T, s) и Below (T, s) и (Above (T, s) пересекает Below (T, s)
10 \emph{then return} true
11 Delete(T, s)
12 \emph{return} false

На рис. 35.5 показано выполнение алгоритма. Изначально множество T пусто (строка 1). В строке 2 строится расписание ожидаемых событий, соответствующих концам отрезков (вообще-то критическими точками являются также моменты пересечения отрезков, но после обнаружения такого пересечения алгоритм заканчивает работу сразу же, так что эти моменты мы смело можем игнорировать.

Каждая итерация цикла for в строках 3–11 обрабатывает одну критическую точку. Если она соответствует левому концу некоторого отрезка s, то в строке 5 этот отрезок добавляется в упорядоченное множество, а в строках 6–7 проверяется, не пересекается ли он часом с одним из соседних отрезков (если да, то алгоритм кончает работу и даёт ответ TRUE). (Возможно, что критическая точка соответствует концам нескольких отрезков — в этом случае они добавляются один за другим.)

Если обрабатываемая критическая точка является правым концом некоторого отрезка s, то этот отрезок удаляется из T (строка 11); предварительно проверяется, не пересекаются ли отрезки, которые разделял удаляемый отрезок и которые теперь становятся соседними (строки 9–10)

Так делается для всех концов всех отрезков; если при этом пересечение так и обнаруживается, то алгоритм возвращает FALSE (строка 12).

Правильность алгоритма
Теорема 35.1