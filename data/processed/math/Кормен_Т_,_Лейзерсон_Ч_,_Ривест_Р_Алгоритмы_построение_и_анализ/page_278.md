---
source_image: page_278.png
page_number: 278
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 53.39
tokens: 11468
characters: 1863
timestamp: 2025-12-24T06:33:18.243468
finish_reason: stop
---

Рисунок 14.8 (а) Двоичное дерево поиска с ключами 2, 3, 4, 7, 8, 10. (б) Дерево с сохранением предыдущих версий после добавления ключа 5. Текущая версия состоит из вершин, доступных из текущего корня \( r' \), а предыдущая версия содержит вершины, доступные из старого корня \( r \). Тёмно-серые вершины добавлены при добавлении ключа 5.

дополнительные действия. Покажите, что в этом случае время работы и объём необходимой памяти будут \( \Omega(n) \), где \( n \) — количество вершин в дереве.

д Покажите, как можно использовать красно-чёрные деревья, чтобы гарантировать, что добавление и удаление элемента для множества с хранением предыдущих версий будут требовать времени \( O(\lg n) \) в худшем случае.

14-2 Операция объединения красно-чёрных деревьев

Операция объединения (join) применяется к двум динамическим множествам \( S_1 \) и \( S_2 \) и элементу \( x \), причём заранее известно, что \( key[x_1] \leq key[x] \leq key[x_2] \) для любых \( x_1 \in S_1 \) и \( x_2 \in S_2 \). Её результатом является множество \( S = S_1 \cup \{x\} \cup S_2 \). В этой задаче мы покажем, как реализовать операцию объединения для красно-чёрных деревьев.

а Мы будем хранить чёрную высоту красно-чёрного дерева \( T \) в специальной переменной \( bh[T] \). Убедитесь, что это значение можно поддерживать, не размещая никакой дополнительной информации в вершинах дерева и не ухудшая асимптотику времени работы процедур RB-INSERT и RB-DELETE. Покажите, что, спускаясь по дереву, можно вычислить чёрную высоту каждой вершины за время \( O(1) \) в расчёте на каждую просмотренную вершину.

Мы хотим реализовать операцию RB-Join\((T_1, x, T_2)\), которая из двух деревьев \( T_1 \) и \( T_2 \) формирует новое красно-чёрное дерево \( T = T_1 \cup \{x\} \cup T_2 \) (старые деревья при этом разрушаются). Пусть \( n \) — общее количество вершин в \( T_1 \) и \( T_2 \).