---
source_image: page_536.png
page_number: 536
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 52.08
tokens: 11662
characters: 2111
timestamp: 2025-12-24T06:45:39.448872
finish_reason: stop
---

Цикл отрицательного веса тогда и только тогда, такой цикл есть в исходном графе \( G \).

На рис. 26.6 (а) показан граф \( G' \), соответствующий графу \( G \) рис. 26.1.

Предположим теперь, что граф \( G \) (а потому и \( G' \)) не содержит цикла отрицательного веса. Положим \( h(v) = \delta(s, v) \) для \( \forall v \in V' \). Согласно лемме 25.3, для всех рёбер \( (u, v) \in E' \) выполнено неравенство \( h(v) \leq h(u) + w(u, v) \), которое можно переписать как \( w(u, v) + h(u) - h(v) \geq 0 \). Другими словами, новая весовая функция, определённая формулой (26.9), неотрицательна. На рис. 26.6(b) показаны новые веса рёбер графа \( G' \) рис. 26.6(a).

Вычисление кратчайших путей

Как мы видим, отыскание кратчайших путей для произвольного графа без циклов отрицательного веса можно сделать в два приёма: сначала мы ищем кратчайшие пути из одной вершины \( s \) (для чего годится алгоритм Беллмана–Форда), а после этого изменяем веса и получаем граф с неотрицательными весами, в котором ищем кратчайшие пути с помощью алгоритма Дейкстры, применённого последовательно ко всем вершинам.

Запишем соответствующую процедуру. Мы считаем, что граф задан с помощью списков смежных вершин. Процедура возвращает матрицу \( D = (d_{ij}) \) размера \( |V| \times |V| \), где \( d_{ij} = \delta_{ij} \), или же сообщает о наличии в графе циклов с отрицательными весами. (Мы предполагаем, что вершины графа \( G \) пронумерованы от 1 до \( |V| \).)

{\sc Johnson}$(G)$\\
\verb|1| создать граф $G'$$, для которого $V[G']$=V[G]\cup\{s\}$ и\\
\verb|2| if {\sc Bellmann-Ford}$(G',w,s)=${\sc false}\\
\verb|3| then print 'имеется цикл отрицательного веса'\\
\verb|4| else for (для) каждой вершины $v\in V[G']$\\
\verb|5| do $h(v)\leftarrow\delta(s,v)$,\\
\verb|6| (значение $\delta(s,v)$ вычислено алгоритмом Беллмана--Форда)\\
\verb|7| for (для) каждого ребра $(u,v)\in E[G']$\\
\verb|8| do $\hat{w}(u,v)\leftarrow w(u,v)+h(u)-h(v)$\\
\verb|9| for (для) каждой вершины $u\in V[G]$\\
\verb|10| do {\sc Dijkstra}$(G,\hat{w},u)$\\
\verb|11| (вычисление $\hat{w}\delta(u,v)$ для всех $v\in V[G]$)\\
\verb|12| return $D$