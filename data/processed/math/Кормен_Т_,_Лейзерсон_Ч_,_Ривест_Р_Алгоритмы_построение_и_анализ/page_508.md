---
source_image: page_508.png
page_number: 508
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 76.84
tokens: 11912
characters: 2890
timestamp: 2025-12-24T06:44:42.723516
finish_reason: stop
---

Рисунок 25.7  25.7 Алгоритм Беллмана-Форда. Исходная вершина — крайняя левая (z). Оценки кратчайшего пути указаны в вершинах. Серым цветом выделены рёбра (u, v), для которых \( \pi[v] = u \). В данном примере при каждой итерации цикла в строках 2–4 рёбра подвергаются релаксации в лексикографическом порядке: (u, v), (u, x), (u, y), (v, u), (x, v), (x, y), (y, v), (y, z), (z, u), (z, x). (а) Перед первым обходом рёбер. (б–д) Последовательные состояния после каждой обработки всех рёбер. Значения d на рисунке (д) — окончательные. В данном случае алгоритм Беллмана-Форда возвращает значение TRUE.

вой функцией w и исходной вершиной s, не содержащий циклов отрицательного веса, достижимых из s. Тогда по окончании работы процедуры BELLMAN-FORD равенство \( d[v] = \delta(s, v) \) будет выполняться для всех вершин v, достижимых из s.

Доказательство Пусть \( p = \langle s = v_0, v_1, \ldots, v_k = v \rangle \) — кратчайший путь из s в v. Можно считать, что этот путь не содержит циклов (они только увеличивают вес по предположению), поэтому \( k \leq |V| - 1 \). Докажем индукцией по i, что после i-ой итерации цикла (в строках 2–4) будет выполнено равенство \( d[v_i] = \delta(s, v_i) \): поскольку всего делается \( |V| - 1 \) итераций, лемма будет следовать из этого утверждения и леммы 25.5.

При \( i = 0 \) это очевидно, так как \( d[s] = \delta(s, s) = 0 \) при входе в цикл. Пусть после \( i - 1 \)-ой итерации было \( d[v_{i-1}] = \delta(s, v_{i-1}) \). При i-ой итерации произойдет релаксация ребра \( (v_{i-1}, v_i) \), после чего по лемме 25.7 установится равенство \( d[v_i] = \delta(s, v_i) \). (Другие релаксации могут также уменьшать \( d[v_i] \), но не могут сделать его меньше \( \delta(s, v_i) \).)

Следствие 25.13
Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весовой функцией w и исходной вершиной s. Тогда вершина \( v \in V \) достижима из s в том и только том случае, когда по окончании работы процедуры BELLMAN-FORD, применённой к этому графу, оказывается, что \( d[v] < \infty \).

Доказательство оставляется читателю (упр. 25.3-2).

Теорема 25.14 (Правильность алгоритма Беллмана-Форда)
Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весовой функцией w и исходной вершиной s. Если процедура BELLMAN-FORD, применённая к этому графу, возвращает значение TRUE, то в результате её работы для всех \( v \in V \) будут выполнены равенства \( d[v] = \delta(s, v) \) и подграф предшественников \( G_\pi \) будет деревом кратчайших путей с корнем s. Если же процедура BELLMAN-FORD возвращает значение FALSE, то в графе есть цикл отрицательного веса, достижимый из вершины s.

Доказательство Если цикла отрицательного веса, достижимого из вершины s, в графе нет, то в результате работы процедуры BELLMAN-FORD будем иметь \( d[v] = \delta(s, v) \) для всех \( v \in V \) (лемма 25.12 и следствие 25.13); следовательно, граф \( G_\pi \) будет де-