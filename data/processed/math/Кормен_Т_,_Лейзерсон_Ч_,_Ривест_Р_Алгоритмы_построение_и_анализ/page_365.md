---
source_image: page_365.png
page_number: 365
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 74.41
tokens: 11637
characters: 2602
timestamp: 2025-12-24T06:37:57.274541
finish_reason: stop
---

18.4.2 Расширение и сокращение таблицы

Теперь займемся операцией Table-Delete (удалить из таблицы). Помимо удаления ненужной записи из таблицы, желательно сократить (contract) таблицу, как только коэффициент заполнения станет слишком низок. Общая стратегия тут та же, что и при расширении таблицы: как только число записей падает ниже некоторого предела, мы выделяем память под новую таблицу меньшего размера, копируем в меньшую таблицы все записи из большей, после чего возвращаем операционной системе память, занимавшуюся старой таблицей. Мы построим алгоритм Table-Delete со следующими свойствами:

• коэффициент заполнения ограничен снизу положительной константой,
• учётная стоимость операций Table-Insert и Table-Delete есть \( O(1) \).

При этом мы по-прежнему будем считать, что стоимость алгоритма определяется количеством операций "записать в таблицу" (строки 6 и 10 алгоритма Table-Insert) и противоположных ей операций "убрать из таблицы"; стоимость каждой из этих элементарных операций примем за единицу.

Первое, что приходит в голову, — удваивать размер таблицы всякий раз, когда надо добавить запись к заполненной таблице, и сокращать размер таблицы вдвое всякий раз, когда в результате удаления записи коэффициент заполнения падает ниже 1/2. При такой стратегии коэффициент заполнения никогда не опустится ниже 1/2, но, к сожалению, стоимости операций оказываются слишком велики. В самом деле, пусть \( n \) — натуральное число, являющееся степенью двойки. Предположим, что сначала мы добавили к пустой (не содержащей ячеек) таблице \( n/2+1 \) записей, а затем провели ещё \( n/2 - 1 \) операцию в такой последовательности: два удаления, затем два добавления, затем опять два удаления, опять два добавления, и т. д. После \( n/2+1 \) добавлений размер таблицы станет равным \( n \) (и заполнено будет чуть больше половины ячеек); после двух удалений его придется сократить до \( n/2 \); после следующих двух добавлений размер опять возрастет до \( n \), после двух удалений — сократится до \( n/2 \), и т. д. Стоимость каждого сокращения и расширения есть \( \Theta(n) \), и количество сокращений и расширений также есть \( \Theta(n) \), так что стоимость \( n \) операций есть \( \Theta(n^2) \), а средняя стоимость в расчёте на одну операцию оказывается равной \( \Theta(n) \).

Причина неудачи понятна: истратив весь резерв на оплату расширения таблицы, мы тут же вынуждены ее сокращать, не успев накопить средства на оплату будущего сокращения. Та же история и с расширением таблицы: мы вынуждены предпринимать его сразу после сокращения, не успев накопить средства за счет доба-