---
source_image: page_749.png
page_number: 749
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.43
tokens: 11649
characters: 2413
timestamp: 2025-12-24T06:55:37.917901
finish_reason: stop
---

стоты числа. К задаче разложения на множители мы вернёмся в следующем разделе.

Псевдопростые числа.
Сейчас мы опишем "почти правильный" алгоритм проверки числа на простоту, приемлемый для многих практических приложений. (Небольшое усложнение этого алгоритма, делающее его совсем правильным, будет описано дальше.)

Обозначим через \( \mathbb{Z}_n^+ \) множество всех ненулевых вычетов по модулю \( n \):
\[
\mathbb{Z}_n^+ = \{1, 2, \ldots, n-1\}.
\]
Если число \( n \) простое, то \( \mathbb{Z}_n^+ = \mathbb{Z}_n^* \).

Назовём число \( n \) псевдопростым по основанию \( a \) (base-a pseudoprime), если выполнено утверждение малой теоремы Ферма:
\[
a^{n-1} \equiv 1 \pmod{n}.
\]
(33.42)

Любое простое число \( n \) является псевдопростым по любому основанию \( a \in \mathbb{Z}_n^+ \). Поэтому если нам удалось найти основание \( a \), по которому \( n \) не является псевдопростым, то мы можем быть уверены, что \( n \) — составное. Оказывается, что во многих случаях достаточно проверить основание \( a = 2 \)

Pseudoprime(n)
1 if Modular-Exponentiation(2,n-1,n) \not\equiv 1 \pmod{n}
2 then return composite      (заведомо)
3 else return prime          (возможно)

Эта процедура может совершать ошибки, но только в одну сторону: если она сообщает, что число \( n \) составное, то это действительно так, но она может принять составное число за простое (если оно является псевдопростым по основанию 2). Как часто такое происходит? Оказывается, не так уж часто — среди чисел до 10 000 есть только 22 числа, для которых процедура PSEUDOPRIME даёт неверный ответ (первые четыре из них — 341, 561, 645 и 1105). Можно показать, что доля таких "плохих" чисел среди \( \beta \)-значных чисел стремится к 0 при \( \beta \to \infty \). Используя оценки из работы Померанца [157], можно показать, что доля составных чисел среди 50-разрядных псевдопростых по основанию 2 чисел не превосходит \( 10^{-6} \), а среди 100-разрядных псевдопростых чисел — \( 10^{-13} \).

Нет никаких причин ограничиваться проверкой лишь основания 2; можно проверять соотношение (33.42) и при других \( a \). Но это не всегда помогает: существуют составные числа \( n \), которые являются псевдопростыми по любому основанию \( a \in \mathbb{Z}_n^* \). Такие числа называются числами Кармайкла (Carmichael numbers). Три первых числа Кармайкла таковы: 561, 1105 и 1729. Числа Кармайкла редки: среди первых ста миллионов положительных чисел их