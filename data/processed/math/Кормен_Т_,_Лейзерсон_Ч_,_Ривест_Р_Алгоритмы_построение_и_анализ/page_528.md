---
source_image: page_528.png
page_number: 528
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.90
tokens: 11744
characters: 2555
timestamp: 2025-12-24T06:45:28.614614
finish_reason: stop
---

время \( O(n^3) \).

26.1-6 С другой стороны, матрицы предшествования могут вычисляться параллельно с вычислением весов. Будем брать в качестве \( \pi_{ij}^{(m)} \) предшествующую \( j \) вершину на каком-нибудь кратчайшем пути из \( i \) в \( j \), состоящем не более чем из \( m \) ребер. Измените процедуры Extend-Shortest-Paths и Slow-All-Pairs-Shortest-Paths так, чтобы они в дополнение к \( D^{(1)}, D^{(2)}, \ldots, D^{(n-1)} \) вычисляли ещё и матрицы \( \Pi^{(1)}, \Pi^{(2)}, \ldots, \Pi^{(n-1)} \).

26.1-7 Процедура Faster-All-Pairs-Shortest-Paths (в её нынешнем виде) использует \( \lceil \lg(n-1) \rceil \) матриц (массивов) размером \( n \times n \). Общий объём памяти, таким образом, составляет \( \Theta(n^2 \lg n) \). Измените её так, чтобы использовать всего два массива размером \( n \times n \) (тем самым уменьшив объём памяти до \( \Theta(n^2) \)).

26.7-8 Измените алгоритм Faster-All-Pairs-Shortest-Paths так, чтобы он обнаруживал наличие в графе цикла с отрицательным весом.

26.1-9 Придумайте эффективный алгоритм определения минимального числа рёбер в цикле отрицательного веса (для данного графа; предполагается, что такой цикл существует).

26.1 Алгоритм Флойда-Уоршолла

В этом разделе мы рассмотрим другой способ решения задачи о кратчайших путях для всех пар вершин ориентированного взвешенного графа, также основанный на технике динамического программирования. Этот способ (алгоритм Флойда–Уоршолла) работает за время \( \Theta(V^3) \). Мы по-прежнему допускаем рёбра с отрицательным весом, но запрещаем циклы отрицательного веса.

Кроме того, мы рассмотрим алгоритм нахождения транзитивного замыкания графа, основанный на той же идее.

Строение кратчайшего пути

Алгоритмы предыдущего раздела выделяли последнее ребро пути. Алгоритм Флойда–Уоршолла действует иначе: для него важно, какие вершины используются в качестве промежуточных, и особую роль играют промежуточные вершины с максимальным номером (в некоторой нумерации вершин). Промежуточной (intermediate) вершиной простого пути \( p = \langle v_1, v_2, \ldots, v_l \rangle \) будем называть любую из вершин \( v_2, v_3, \ldots, v_{l-1} \).

Будем считать, что вершинами графа \( G \) являются числа \( 1, 2, \ldots, n \). Рассмотрим произвольное \( k \leq n \). Для данной пары вершин \( i, j \in V \) рассмотрим все пути из \( i \) в \( j \), у которых все промежуточные вершины принадлежат множеству \( \{1, 2, \ldots, k\} \). Пусть \( p \) — путь минимального веса среди всех таких путей. Он будет простым, так как в графе нет циклов с отрицательным весом. Как