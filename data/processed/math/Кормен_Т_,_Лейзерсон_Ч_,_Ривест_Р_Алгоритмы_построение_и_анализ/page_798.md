---
source_image: page_798.png
page_number: 798
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 70.40
tokens: 11888
characters: 2791
timestamp: 2025-12-24T06:58:04.375681
finish_reason: stop
---

ВНИМАНИЕ!!! Рисунок, требующий добавлений. В книге есть ошибка, и после её исправления рисунок, называвшийся (e), называется (f), а на его месте надо поместить новый (см. на полях оригинала) Пересекает ли отрезок \( \overline{p_3 p_4} \) прямую, содержащую отрезок \( \overline{p_1 p_2} \)? (а) Если да, то векторные произведения \( (p_3 - p_1) \times (p_2 - p_1) \) и \( (p_4 - p_1) \times (p_2 - p_1) \) имеют разные знаки. (b) Если нет, то эти произведения имеют один и тот же знак. (c)-(d) Граничные случаи, когда одно из векторных произведений равно нулю (и отрезок пересекает прямую). (e) Одно из векторных произведений равно нулю, ограничивающие прямоугольники пересекаются, но отрезки всё-таки не пересекаются (отрезок \( \overline{p_1 p_2} \) не пересекает прямую \( p_3 p_4 \)) (f) Отрезки лежат на одной прямой, но не пересекаются. Каждый из отрезков пересекает прямую, содержащую другой. Но сами отрезки не пересекаются — здесь это не страшно, так как этот случай отброшен на первом этапе.

то одна из точек \( p_3 \) или \( p_4 \) принадлежит прямой \( p_1 p_2 \). Два таких случая показаны на рисунках (рис. 35.3 (c),(d)). В обоих случаях отрезки пересекаются, однако возможен и другой случай: хотя отрезки проходят начальный тест и векторное произведение равно нулю, всё-таки пересечения нет (рис. 35.3 (e)) Поэтому условие "отрезок пересекает прямую" надо проверять для обоих отрезков. Заметим, что начальный тест нельзя опустить: на рис. 35.3 (f) каждый из отрезков пересекает прямую, содержащую другой (лежит на ней — мы считаем это пересечением), но сами отрезки не пересекаются.

Если один из отрезков, например, \( p_1 p_2 \), равен нулю, то вопрос о том, пересекает ли отрезок \( \overline{p_3 p_4} \) прямую \( p_1 p_2 \), лишён смысла (прямых много). Тем не менее можно вычислить векторные произведения \( (p_3 - p_1) \times (p_2 - p_1) \) и \( (p_4 - p_1) \times (p_2 - p_1) \), которые в данном случае равны нулю. Наш критерий пересечения применим и в этом случае, если условно принять, что \( \overline{p_3 p_4} \) пересекает прямую \( p_1 p_2 \).

Итак, критерий таков: отрезки \( p_1 p_2 \) и \( p_3 p_4 \) пересекаются тогда и только тогда, когда одновременно выполнены три условия:
(a) пересекаются ограничивающие их прямоугольники;
(b)
\[
[(p_3 - p_1) \times (p_2 - p_1)] \cdot [(p_4 - p_1) \times (p_2 - p_1)] \leq 0
\]
(c)
\[
[(p_1 - p_3) \times (p_4 - p_3)] \cdot [(p_2 - p_3) \times (p_4 - p_3)] \leq 0
\]

Другие применения векторного произведения.
Векторное произведение понадобится нам ещё не раз. В разделе 35.3 с его помощью мы будем сортировать точки по полярному углу относительно данного центра (см. упр. 35.1-2). В разделе 35.2 при построении красно-чёрного дерева отрезков, упорядоченных по месту их пересечения с данной вертикалью, мы будем ис-