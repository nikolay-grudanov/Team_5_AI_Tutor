---
source_image: page_243.png
page_number: 243
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 65.96
tokens: 11459
characters: 1904
timestamp: 2025-12-24T06:31:49.563246
finish_reason: stop
---

Рисунок 13.1 Двоичные деревья поиска. Левое поддерево произвольной вершины x содержит ключи, не превосходящие key[x], правое — не меньше key[x]. Разные двоичные деревья поиска могут представлять одно и то же множество. Время выполнения (в худшем случае) большинства операций пропорционально высоте дерева. (а) Двоичное дерево поиска высоты 2 с 6 вершинами. (б) Менее эффективное дерево высоты 4, содержащее те же ключи.

13.1 Что такое двоичное дерево поиска?

В двоичном дереве поиска (binary search tree; пример приведён на рис. 13.1) каждая вершина может иметь (или не иметь) левого и правого ребёнка; каждая вершина, кроме корня, имеет родителя. При представлении с использованием указателей мы храним для каждой вершины дерева, помимо значения ключа key и дополнительных данных, также и указатели left, right и p (левый ребёнок, правый ребёнок, родитель). Если ребёнка (или родителя — для корня) нет, соответствующее поле содержит NIL.

Ключи в двоичном дереве поиска хранятся с соблюдением свойства упорядоченности (binary-search-tree property):

Пусть x — произвольная вершина двоичного дерева поиска. Если вершина y находится в левом поддереве вершины x, то key[y] ≤ key[x]. Если y находится в правом поддереве x, то key[y] ≥ key[x].

Так, на рис. 13.1(а) в корне дерева хранится ключ 5, ключи 2, 3 и 5 левом поддереве корня не превосходят 5, а ключи 7 и 8 в правом — не меньше 5. То же самое верно для всех вершин дерева. Например, ключ 3 на рис. 13.1(а) не меньше ключа 2 в левом поддереве и не больше ключа 5 в правом.

Свойство упорядоченности позволяет напечатать все ключи в неубывающем порядке с помощью простого рекурсивного алгоритма (называемого по-английски inorder tree walk). Этот алгоритм печатает ключ корня поддерева после всех ключей его левого поддерева, но перед ключами правого поддерева. (Заметим в скобках, что порядок, при котором корень предшествует обоим поддеревьям, на-