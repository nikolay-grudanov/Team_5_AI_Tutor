---
source_image: page_416.png
page_number: 416
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.92
tokens: 11532
characters: 2043
timestamp: 2025-12-24T06:40:06.855318
finish_reason: stop
---

Операции, предусмотренные для сливаемых куч

получается из двух экземпляров деревьев \( U_{k-1} \), если корень одного добавить к числу детей корня другого. (Таким образом, дети корня в дереве \( U_k \) являются вершинами деревьев \( U_0, U_1, \ldots, U_{k-1} \).) Лемма 20.1 остается верной и для неупорядоченных биномиальных деревьев (надо только исключить в свойстве 4 упоминание о порядке).

В частности, степени всех вершин в фибоначчиевой куче размера \( n \), составленной из неупорядоченных биномиальных деревьев, ограничены величиной \( D(n) = \lg n \).

В отличие от биномиальных куч, теперь среди входящих в кучу деревьев может быть несколько деревьев с одной и той же степенью корня. Их "консолидация" откладывается до момента выполнения операции Extract-Min, когда деревья с корнями одинаковой степени объединяются.

Создание новой фибоначчиевой кучи

Процедура Make-Fib-Heap создает и возвращает объект \( H \), для которого \( n[H] = 0 \) и \( min[H] = NIL \): корневой список этой кучи пуст. При этом \( t(H) = 0 \) и \( m(H) = 0 \), так что потенциал кучи равен 0, а суммарный потенциал не меняется. Учётная стоимость операции Make-Fib-Heap равна её фактической стоимости \( O(1) \).

Добавление вершины

Следующая процедура добавляет вершину \( x \) в фибоначчиеву кучу \( H \) (предполагаем, что вершина \( x \) уже размещена в памяти и поле ключа \( key[x] \) заполнено).

Fib-Heap-Insert(\( H, x \))

1. \( degree[x] \leftarrow 0 \)
2. \( p[x] \leftarrow NIL \)
3. \( child[x] \leftarrow NIL \)
4. \( left[x] \leftarrow x \)
5. \( right[x] \leftarrow x \)
6. \( mark[x] \leftarrow FALSE \)
7. соединить полученный корневой список (состоящий из вершины \( x \)) с корневым списком кучи \( H \)
8. if \( min[H] = NIL \) or \( key[x] < key[min[H]] \)
9. then \( min[H] \leftarrow x \)
10. \( n[H] \leftarrow n[H] + 1 \)

Строки 1–6 формируют циклический список из единственной вершины \( x \), и в строке 7 эта вершина добавляется (за время \( O(1) \)) к корневому списку кучи \( H \), в которой появляется новое одноэлемент-