---
source_image: page_507.png
page_number: 507
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.46
tokens: 11572
characters: 2061
timestamp: 2025-12-24T06:44:08.820134
finish_reason: stop
---

Чтобы он искал кратчайшие пути из данной вершины за время \( O(WV + E) \).

25-2.6
Усовершенствуйте решение предыдущего упражнения, сделав время работы алгоритма равным \( O((V + E) \lg W) \). (Указание: сколько различных оценок кратчайшего пути для вершин из \( V \setminus S \) может встретиться одновременно?)

25.2 Алгоритм Беллмана-Форда

Алгоритм Беллмана-Форда (Bellman-Ford algorithm) решает задачу о кратчайших путях из одной вершины для случая, когда весам ребер разрешено быть отрицательными. Этот алгоритм возвращает значение TRUE, если в графе нет цикла отрицательного веса, достижимого из исходной вершины, и FALSE, если таковой цикл имеется. В первом случае алгоритм находит кратчайшие пути и их веса; во втором случае задача кратчайших путей (по крайней мере для некоторых вершин) не существует.

Подобно алгоритму Дейкстры, алгоритм Беллмана-Форда производит релаксацию рёбер, пока все значения \( d[v] \) не сравняются с \( \delta(s, v) \) (если все \( \delta(s, v) \) определены).

Bellman-Ford(G,w,s)
1 Initialize-Single-Source(G,s)
2 for i \gets 1 to |V[G]|-1
3   do for (для) каждого ребра (u,v) \in E[G]
4     do Relax(u,v,w)
5   for (для) каждого ребра (u,v) \in E[G]
6     do if d[v]>d[u]+w(u,v)
7       then return \textsc{false}
8 return \textsc{true}

На рис. 25.7 показана работа алгоритма Беллмана-Форда для графа с пятью вершинами. После инициализации (строка 1) алгоритм \( |V| - 1 \) раз делает одно и то же: перебирает по разу все рёбра графа и подвергает каждое из них релаксации (строки 2–4). После этого алгоритм проверяет, нет ли цикла отрицательного веса, достижимого из начальной вершины \( s \) (строки 5–8; вскоре мы увидим, почему эта проверка позволяет выявить такой цикл).

Время работы алгоритма Беллмана-Форда есть \( O(VE) \), поскольку общее число релаксаций есть \( O(VE) \), стоимость инициализации в строке 1 есть \( O(V) \), а стоимость цикла в строках 5–8 есть \( O(E) \).

Докажем, что алгоритм Беллмана-Форда работает правильно.
Лемма 25.12
Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весо-