---
source_image: page_443.png
page_number: 443
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.41
tokens: 11796
characters: 2566
timestamp: 2025-12-24T06:41:22.616660
finish_reason: stop
---

Глава 22 Системы непересекающихся множеств

расчёте на одну операцию есть \( \alpha(m, n) \). Если \( n \) фиксировано, а \( m \) растёт, то из-за сжатия путей дерева с каждым шагом всё более "упрощаются" (всё больше становится вершин, напрямую связанных с корнем), так что стоимость операции падает.

Во всех практических приложениях можно считать, что \( \alpha(m, n) \leq 4 \). В самом деле, поскольку функция Аккермана является возрастающей по каждому переменному и \( m \geq n \), имеем

\[
A(4, \lfloor m/n \rfloor) \geq A(4, 1) = A(3, 2) = 2^{2^{2^{\cdots^2}}} \Bigg\} 17,
\]

что много больше числа атомов в наблюдаемой части Вселенной (\( \approx 10^{80} \)). Поэтому для всех встречающихся на практике значений \( n \) имеем \( A(4, \lfloor m/n \rfloor) \geq \lg n \) и \( \alpha(m, n) \leq 4 \).

Мы не доказываем оценки, связанной с функцией Аккермана, а ограничиваемся более слабой оценкой \( O(m \lg^* n) \). Вспомним определение функции \( \lg^* \) (с. ??). По определению, \( \lg^* 1 = 0 \) и

\[
\lg^* n = \min \left\{ i : \underbrace{\lg \lg \ldots \lg}_{i \text{ раз}} n \leq 1 \right\}
\]

для \( n > 1 \). Неравенство в определении функции \( \lg^* \) можно переписать так: \( n \leq 2^{2^{2^{\cdots^2}}} \Bigg\} j \) (\( j \) — число двоек в формуле).

Оценка \( O(m \lg^* n) \), которую мы докажем ниже, слабее, чем сформулированная без доказательства оценка \( O(m \alpha(m, n)) \), но с практической точки зрения разница невелика. В самом деле, \( \lg^* 2^{2^{16}} = \lg^* 2^{65536} = 5 \), так что во всех практических вопросах можно считать, что \( \lg^* n \leq 5 \) — вряд ли нам встретится множество, в котором более \( 2^{65536} \) элементов.

Свойства рангов
Чтобы доказать оценку \( O(m \lg^* n) \) для времени работы с системой непересекающихся множеств, нам понадобятся некоторые свойства рангов. Напомним, что мы работаем с системой непересекающихся множеств, реализованной с помощью леса, с объединением по рангам и сжатием путей (см. разд. 22.3); через \( m \) обозначено суммарное число операций Make-Set, Find-Set и Union, а через \( n \) — число операций Make-Set.

Лемма 22.2
Для всякой вершины \( x \), кроме корня, \( rank[x] < rank[p[x]] \) (напомним, что для корня \( p[x] = x \)). При создании множества \( \{x\} \) имеем \( rank[x] = 0 \), далее \( rank[x] \) может только возрастать и перестаёт меняться, когда \( x \) перестаёт быть корнем в своём дереве.

Доказательство. Всё это непосредственно следует из описания процедур Make-Set, Union и Find-Set в разделе 22.3. Подробности мы оставляем читателю (упр. 22.4-1).