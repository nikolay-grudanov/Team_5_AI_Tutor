---
source_image: page_534.png
page_number: 534
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 65.62
tokens: 11868
characters: 2718
timestamp: 2025-12-24T06:45:48.412975
finish_reason: stop
---

П, если изменить формулу (26.7) так:

\[
\pi_{ij}^{(k)} = \begin{cases}
\pi_{ij}^{(k-1)} & \text{если } d_{ij}^{(k-1)} < d_{ik}^{(k-1)} + d_{kj}^{(k-1)}, \\
\pi_{kj}^{(k-1)} & \text{если } d_{ij}^{(k-1)} \geq d_{ik}^{(k-1)} + d_{kj}^{(k-1)}.
\end{cases}
\]

26.2-5 Как можно использовать результат работы алгоритм Флойда–Уоршолла, чтобы узнать, есть ли в графе цикл отрицательного веса?

26.2-6 Еще один способ построения кратчайших путей в алгоритме Флойда–Уоршолла таков. Пусть \( \varphi_{ij}^{(k)} (i, j, k = 1, 2, \ldots, n) \) есть промежуточная вершина с максимальным номером на кратчайшем пути из \( i \) в \( j \) с промежуточными вершинами из множества \( \{1, 2, \ldots, k\} \). Напишите рекуррентное соотношение для \( \varphi_{ij}^{(k)} \) и дополните процедуру FLOYD-WARSHALL вычислением значений \( \varphi_{ij}^{(k)} \).

Наконец, измените функцию PRINT-ALL-PAIRS-SHORTEST-PATHS так, чтобы входом для неё служила матрица \( \Phi = (\varphi_{ij}^{(n)}) \). Объясните аналогию между матрицей \( \Phi \) и таблицей \( s \) в задачи об оптимальной расстановке скобок в произведении матриц (раздел 16.1).

26.2-7 Придумайте алгоритм вычисления транзитивного замыкания ориентированного графа \( G = (V, E) \) с временем работы \( O(VE) \).

26.2-8 Предположим, что транзитивное замыкание ориентированного ациклического графа может быть построено за время \( f(V, E) \), где \( f(V, E) = \Omega(V + E) \) и \( f \) — монотонно возрастающая функция. Покажите, что тогда транзитивное замыкание произвольного ориентированного графа может быть построено за время \( O(f(V, E)) \).

Алгоритм Джонсона для разреженных графов

Алгоритм Джонсона находит кратчайшие пути для всех пар вершин за время \( O(V^2 \lg V + VE) \), и поэтому для достаточно разреженных графов эффективнее повторного возведения в квадрат матрицы смежности графа и алгоритма Флойда–Уоршолла.

Алгоритм Джонсона либо возвращает матрицу весов кратчайших путей, либо сообщает, что в графе имеется цикл отрицательного веса. Этот алгоритм содержит вызовы описанных в главе 25 алгоритмов Дейкстры и Беллмана-Форда.

Алгоритм Джонсона основан на идее изменения весов (reweighting). Если веса всех рёбер графа неотрицательны, то можно найти кратчайшие пути между всеми парами вершин, применив алгоритм Дейкстры к каждой вершине. Используя фибоначчиевы кучи, мы можем сделать это за время \( O(V^2 \lg V + VE) \). Если же в графе имеются ребра с отрицательным весом, то можно попытаться свести задачу к случаю неотрицательных весов, изменяя весовую функцию. При этом должны выполняться такие свойства:

1. Кратчайшие пути не изменились: для любой пары вершин \( u, v \in V \), кратчайший путь из \( u \) в \( v \) с точки зрения весовой функцией \( w \)