---
source_image: page_255.png
page_number: 255
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 81.49
tokens: 11819
characters: 2358
timestamp: 2025-12-24T06:32:35.804702
finish_reason: stop
---

13.4 Случайные двоичные деревья поиска

Это делается с помощью теоремы 6.6. Напомним, что математическое ожидание \( |S| \) есть \( \mu = H_n \geq \ln n \), и по теореме 6.6 мы имеем

\[
\mathbf{P}\{|S| \geq (\beta + 1)H_n\} = \mathbf{P}\{|S| - \mu \geq \beta H_n\} \leq
\]
\[
\leq \left( \frac{eH_n}{\beta H_n} \right)^{\beta H_n} =
\]
\[
= e^{(1-\ln \beta)\beta H_n} \leq
\]
\[
\leq e^{-(\ln \beta-1)\beta \ln n} =
\]
\[
= n^{-(\ln \beta-1)\beta} =
\]
\[
= 1/n^2
\]

согласно определению числа \( \beta \).

После такой подготовки вернёмся к деревьям поиска.

Теорема 13.6. Средняя высота случайного двоичного дерева поиска, построенного по \( n \) различным ключам, есть \( O(\lg n) \).

Доказательство. Пусть \( k_1, k_2, \ldots, k_n \) — случайная перестановка данных \( n \) ключей, \( T \) — дерево, полученное последовательным добавлением этих ключей к пустому. Для фиксированного номера \( j \) и для произвольного числа \( t \) рассмотрим вероятность того, что глубина \( d(k_j, T) \) ключа \( k_j \) не меньше \( t \). Согласно следствию 13.4, в этом случае хотя бы одно из множеств \( G_j \) и \( L_j \) должно иметь размер не менее \( t/2 \). Таким образом,

\[
\mathbf{P}\{d(k_j, T) \geq t\} \leq \mathbf{P}\{|G_j| \geq t/2\} + \mathbf{P}\{|L_j| \geq t/2\}.
\] (13.2)

Вначале рассмотрим \( \mathbf{P}\{|G_j| \geq t/2\} \). Оценим условную вероятность этого события при фиксированном множестве \( U = \{t : 1 \leq t \leq j-1 \text{ и } k_t > k_j\} \) (то есть когда известно, какие из элементов \( k_1, \ldots, k_{j-1} \) больше \( k_j \)). Мы находимся в ситуации леммы 13.5 (все перестановки элементов с индексами из \( U \) равновероятны), и поэтому условная вероятность события \( |G_j| \geq t/2 \) при данном \( U \) равна вероятности того, что в случайной перестановке из \( u = |U| \) элементов есть по крайней мере \( t/2 \) элементов, меньших всех предыдущих. С ростом \( u \) эта вероятность только растёт, так что все условные вероятности не превосходят \( \mathbf{P}\{|S| \geq t/2\} \), где \( S \) определено как в лемме 13.5. Поэтому и полная вероятность события \( \{|G_j| \geq t/2\} \) не превосходит \( \mathbf{P}\{|S| \geq t/2\} \).

Аналогичным образом

\[
\mathbf{P}\{|L_j| \geq t/2\} \leq \mathbf{P}\{|S| \geq t/2\}
\]

и, согласно неравенству (13.2),

\[
\mathbf{P}\{d(k_j, T) \geq t\} \leq 2\mathbf{P}\{|S| \geq t/2\}.
\]