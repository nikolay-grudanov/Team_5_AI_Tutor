---
source_image: page_616.png
page_number: 616
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 74.66
tokens: 11937
characters: 2789
timestamp: 2025-12-24T06:49:57.433064
finish_reason: stop
---

(для \( iu = 0, 1, \ldots, n-1 \); бит \( v_0 \) всегда равен 0). Рассмотрим числа \( u = \langle u_{n-1}, u_{n-2}, \ldots, u_0 \rangle \) и \( v = \langle v_n, v_{n-1}, \ldots, v_0 \rangle \). Легко видеть, что

\[
x + y + z = u + v
\]

Числа \( u \) и \( v \) могут быть вычислены за время \( O(1) \) с помощью \( n \) сумматоров \( FA_0, \ldots, FA_{n-1} \) (рис. 29.11). Для сложения чисел \( u \) и \( v \) используется сумматор с предвычислением переносов. Это требует времени \( O(\lg n) \), всего получается \( O(1) + O(\lg n) \), то есть \( O(\lg n) \). Хотя та же асимптотическая оценка получается при использовании двух сумматоров с предвычислением переносов, но на практике разница (примерно в два раза) существенна.

Аналогичный приём (сведение сложения трёх чисел к сложению двух) играет важную роль в быстрых схемах для умножения (см. раздел 29.3).

Рисунок 29.11 (а). Схема сложения с запоминанием переносов. Для сложения трёх \( n \)-битовых чисел \( x, y, z \) вычисляются числа \( u \) (\( n \) битов) и \( v \) (\( n+1 \) битов), для которых \( x + y + z = u + v \). (б) 8-разрядный сумматор с запоминанием переносов. Каждый из сумматоров \( FA_i \) получает на вход \( x_i, y_i, z_i \) и выдаёт бит суммы \( u_i \) и бит переноса \( v_i \). Мы полагаем \( v_0 = 0 \).

Упражнения
29.2-1 Пусть \( n = 8 \), \( a = \langle 01111111 \rangle \), \( b = \langle 00000001 \rangle \). Укажите биты переноса и типы переноса во всех разрядах, а также значения на всех проводах схемы рис. 29.9, включая выходы \( y_0, y_1, \ldots, y_8 \).
29.2-2 Докажите, что операция \( \otimes \) (заданная таблицей рис. 29.5) ассоциативна.
29.2-3 Объясните, как должна быть устроена параллельная префиксная схема, если \( n \) не является степенью двойки (например, рассмотрите случай \( n = 11 \)). Каково время работы такой схемы?
29.2-4 Покажите внутреннее устройство схемы KPG, если значения на входах и выходах кодируются так: на входах \( \langle 00 \rangle \) соответствует \( k \), \( \langle 11 \rangle - g \), \( \langle 01 \rangle \) или \( \langle 10 \rangle - p \); на выходах 0 соответствует \( k \), 1 — \( g \).
29.2-5 Укажите глубину каждого провода на рис. 29.9 (а). Найдите критический (самый длинный) путь (critical path) от входов к выходам и покажите, что его длина есть \( O(\lg n) \). Найдите узел, два элемента \( \otimes \) которого срабатывают с интервалом \( \Theta(\lg n) \). Есть ли узлы, в котором два элемента \( \otimes \) срабатывают одновременно?
29.2-6 Следуя образцу рис. 29.12, укажите способ построения схемы вычисления префиксов для любого числа входов, являющегося степенью двойки. Докажите, что схема имеет глубину \( \Theta(\lg n) \) и размер \( \Theta(n \lg n) \). Докажите, что схема работает правильно, разбив её на блоки и рассуждая индуктивно.