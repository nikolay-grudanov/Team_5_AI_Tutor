---
source_image: page_356.png
page_number: 356
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 56.98
tokens: 11422
characters: 2056
timestamp: 2025-12-24T06:37:08.506112
finish_reason: stop
---

Метод предоплаты

стоимость, причем эти стоимости могут быть как больше, так и меньше реальных. Если учетная стоимость превосходит реальную, разность рассматривается как резерв (credit), который считается связанным с каким-то объектом структуры данных и рассматривается как предоплата за будущую обработку этого объекта. За счет этого резерва компенсируется разница между учетной и реальной стоимостью для тех операций, у которых учетная стоимость ниже реальной.

Мы должны выбирать учётные стоимости так, чтобы фактическая стоимость не превосходила суммы учетных стоимостей, то есть чтобы резерв оставался неотрицательным в любой момент работы.

Операции со стеком

Проиллюстрируем метод предоплаты на уже известном примере со стеком. Напомним, что реальные стоимости операций со стеком мы считаем такими:

Push    1,
Pop     1,
MultiPop min(s, k),

где \( k \) — количество элементов, удаляемых из стека, \( s \) — размер стека. Присвоим этим операциям такие учётные стоимости:

Push    2,
Pop     0,
MultiPop 0.

В нашем примере учётные стоимости всех операций постоянны; возможны случаи, когда эти стоимости непостоянны и даже имеют различные асимптотики для разных операций.

Покажем теперь, что выбранные нами учетные стоимости позволяют полностью покрыть реальную стоимость операций со стеком. Будем считать, что единицей стоимости операций является доллар. Воспользуемся аналогией между стеком и стопкой тарелок (см. разд. 11.1). Первоначально ни одной тарелки в стопке нет (мы начинаем с пустого стека). Когда мы добавляем тарелку к стопке, мы должны заплатить 1 доллар за операцию Push (это ее реальная цена). Один доллар остается у нас в резерве, ведь учётная цена операции Push равна двум долларам. Будем всякий раз класть этот резервный доллар на соответствующую тарелку. Тогда в каждый момент на каждой тарелке в нашей стопке будет лежать по долларовой бумажке.

Доллар, лежащий на тарелке, — это предоплата за удаление тарелки из стопки. Когда мы производим операцию Pop, мы за нее ничего дополнительно не платим (учётная стоимость Pop равна