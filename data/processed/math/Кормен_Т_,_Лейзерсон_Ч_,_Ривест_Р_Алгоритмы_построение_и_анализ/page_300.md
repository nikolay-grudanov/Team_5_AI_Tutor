---
source_image: page_300.png
page_number: 300
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.89
tokens: 11480
characters: 2102
timestamp: 2025-12-24T06:34:23.357348
finish_reason: stop
---

же шаг 4 необходим, для построения оптимального решения иногда приходится получать и хранить дополнительную информацию в процессе выполнения шага 3.

В этой главе мы решим несколько оптимизационных задач с помощью динамического программирования. В разделе 16.1 мы выясним, как найти произведение нескольких матриц, сделав как можно меньше умножений. В разделе 16.2 мы обсудим, какие свойства задачи делают возможным применение динамического программирования. После этого мы расскажем (в разделе 16.3), как найти наибольшую общую подпоследовательность двух последовательностей. Наконец, в разделе 16.4 мы воспользуемся динамическим программированием для нахождения оптимальной триангуляции выпуклого многоугольника. (Удивительным образом эта задача оказывается похожей на задачу о перемножении нескольких матриц.)

16.1 Перемножение нескольких матриц

Мы хотим найти произведение

\[
A_1 A_2 \ldots A_n
\]

последовательности \( n \) матриц \( \langle A_1, A_2, \ldots, A_n \rangle \). Мы будем пользоваться стандартным алгоритмом перемножения двух матриц в качестве подпрограммы. Но прежде надо расставить скобки в (16.1), чтобы указать порядок умножений. Будем говорить, что в произведении матриц полностью расставлены скобки (product is fully parenthesized), если это произведение либо состоит из одной-единственной матрицы, либо является заключенным в скобки произведением двух произведений с полностью расставленными скобками. Поскольку умножение матриц ассоциативно, конечный результат вычислений не зависит от расстановки скобок. Например, в произведении \( A_1 A_2 A_3 A_4 \) можно полностью расставить скобки пятью разными способами:

\[
(A_1 (A_2 (A_3 A_4))); \quad (A_1 ((A_2 A_3) A_4)); \quad ((A_1 A_2) (A_3 A_4));
((A_1 (A_2 A_3)) A_4); \quad (((A_1 A_2) A_3) A_4);
\]

во всех случаях ответ будет один и тот же.

Не влияя на ответ, способ расстановки скобок может сильно повлиять на стоимость перемножения матриц. Посмотрим сначала, сколько операций требует перемножение двух матриц. Вот стандартный алгоритм (rows и columns обозначают количество строк и столбцов матрицы соответственно):