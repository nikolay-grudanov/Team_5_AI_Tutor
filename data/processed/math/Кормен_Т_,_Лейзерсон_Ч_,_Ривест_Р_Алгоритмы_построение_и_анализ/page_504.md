---
source_image: page_504.png
page_number: 504
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.94
tokens: 11676
characters: 2507
timestamp: 2025-12-24T06:44:08.842602
finish_reason: stop
---

В этом случае картинка осталась той же, но подпись переписана

Рисунок 25.6  25.6 В пути от s до u выделена часть (s–x), проходящая целиком внутри S, и первая вершина y, лежащая вне S (возможно, x = s или y = u).

сказать, что он относится к жадным алгоритмам ( гл. 17 ). Покажем, что в данном случае жадная стратегия даёт правильный результат.

Теорема 25.10 (Правильность алгоритма Дейкстры)
Пусть G = (V, E) — взвешенный ориентированный граф с неотрицательной весовой функцией w : E → ℝ и исходной вершиной s. Тогда после применения алгоритма Дейкстры к этому графу для всех вершин u ∈ V будут выполняться равенства d[u] = δ(s, u).
Доказательство
Проверим, что после любого числа итераций цикла textbf{while} выполнено следующее свойство:
(a) для вершин v ∈ S значение d[v] равно δ(s, v), причём существует путь из s в v веса δ(s, v), проходящий только по вершинам из S;
(b) для вершин v ∈ Q = V \ S значение d[v] равно наименьшему весу пути из s в v, если учитывать только те пути, в которых все вершины, кроме последней (v), лежат в S (если таких путей нет, d[v] = ∞).
После первой итерации цикла (когда в S лежит только вершина s и только что проведены релаксации всех рёбер, ведущих из s) это свойство выполнено. Проверим, что оно не нарушится и на следующих итерациях.
Пусть u — вершина Q с минимальным значением d[u]. Если d[u] = ∞, то не существует пути, в котором все вершины, кроме последней, лежат в S. Значит, из S вообще нельзя никак выйти (оборвав путь в момент выхода, мы получили бы путь с указанным свойством). Пусть теперь d[u] конечно. Тогда существует путь из s в u веса d[u], проходящий по вершинам S до последнего момента (до вершины u). Докажем, что он будет кратчайшим. (Тем самым вершину u можно добавить в S, не нарушая утверждения (a).)
Пусть есть какой-то другой путь из s в u (рис. 25.6). Посмотрим на первую вершину этого пути, лежащую вне S; обозначим её y (возможно, y = u). Часть пути от s до y проходит по S до последнего момента, поэтому вес этой части не меньше d[y] (по предположению (a)). Осталось заметить, что вес всего пути не меньше веса его части (веса рёбер неотрицательны) и что d[y] ≤ d[u], поскольку в Q вершина u имела наименьшее значение d[u].
Итак, условие (a) останется верным после добавления u к S. Остаётся проверить условие (b). Поскольку S увеличилось и стало равным S' = S ∪ {u}, путей, не выходящих из S до последнего момента, стало больше, и для соблюдения условия (b) значения d[v] для v ∈ Q надо уменьшать. Это и делается в процессе релаксации.