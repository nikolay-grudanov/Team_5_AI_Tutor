---
source_image: page_061.png
page_number: 61
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 64.45
tokens: 11698
characters: 2300
timestamp: 2025-12-24T06:23:01.397649
finish_reason: stop
---

4.4 Доказательство Теоремы 4.1

Равенство (4.6) получается, если сложить веса на всех уровнях: общий вес на j-м уровне есть \( a^j f(n/b^j) \), а общий вес внутренней части дерева есть
\[
\sum_{j=0}^{\log_b n - 1} a^j f(n/b^j).
\]
Если рекуррентное соотношение произошло из алгоритма типа "разделяй и властвуй", эта сумма отражает стоимость разбиения задачи на подзадачи и объединения решений. Суммарный вес всех листьев есть стоимость решения всех \( n^{\log_b a} \) задач размера 1, которая составляет \( \Theta(n^{\log_b a}) \).

В терминах дерева рекурсии легко объяснить, чему соответствуют три случая в формулировке основной теоремы. В первом случае основная часть веса сосредоточена в листьях, в третьем — в корне, во втором вес равномерно распределён по уровням дерева.

Теперь оценим величину суммы в формуле (4.6).

Лемма 4.3. Пусть \( a \geq 1,\ b > 1 \) — константы, \( f(n) \) — неотрицательная функция, определённая на натуральных степенях \( b \). Рассмотрим функцию \( g(n) \), определённую формулой
\[
g(n) = \sum_{j=0}^{\log_b n - 1} a^j f(n/b^j)
\]
(для \( n \), являющихся степенями \( b \)). Тогда
1. Если \( f(n) = O(n^{\log_b a - \varepsilon}) \) для некоторой константы \( \varepsilon > 0 \), то \( g(n) = O(n^{\log_b a}) \).
2. Если \( f(n) = \Theta(n^{\log_b a}) \), то \( g(n) = \Theta(n^{\log_b a} \lg n) \).
3. Если \( af(n/b) \leq cf(n) \) для некоторой константы \( c < 1 \) и для всех \( n \geq b \), то \( g(n) = \Theta(f(n)) \).

Доказательство. 1. В первом случае достаточно доказать утверждение леммы для функции \( f(n) = n^\alpha \), где \( \alpha = \log_b a - \varepsilon \). Для такой функции \( f \) равенство (4.7) может быть переписано так: (теперь \( \alpha = \log_b a \))
\[
g(n) = f(n) + af(n/b) + a^2 f(n/b^2) + \ldots + a^{k-1} f(n/b^{k-1})
\]
\[
= n^\alpha + a(n/b)^\alpha + a^2 (n/b^2)^\alpha + \ldots + a^{k-1} (n/b^{k-1})^\alpha;
\]
правая часть представляет собой геометрическую прогрессию длины \( k = \log_b n \) со знаменателем \( a/b^\alpha \); этот знаменатель больше 1, так как \( \alpha < \log_b a \) и \( b^\alpha < a \). Для такой прогрессии сумма по порядку равна последнему члену (отличается от него не более чем на константу раз). Этот последний член есть \( O(a^k) = O(n^{\log_b a}) \).

Для первого случая утверждение леммы доказано.