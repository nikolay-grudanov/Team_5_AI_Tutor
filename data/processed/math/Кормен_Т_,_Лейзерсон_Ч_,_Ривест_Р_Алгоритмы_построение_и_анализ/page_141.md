---
source_image: page_141.png
page_number: 141
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 68.32
tokens: 11523
characters: 1770
timestamp: 2025-12-24T06:27:03.100831
finish_reason: stop
---

Построение кучи

(выполнение основного свойства для поддеревьев) будут выполнены.

**BUILD-HEAP**(*A*)

1. *heap-size[A] ← length[A]*
2. **for** *i ← [length[A]/2]* **downto** 1
3. **do** HEAPIFY(*A, i*)

Пример работы процедуры BUILD-HEAP показан на рис. 7.3.

Ясно, что время работы процедуры BUILD-HEAP не превышает \( O(n \lg n) \). Действительно, процедура HEAPIFY вызывается \( O(n) \) раз, а каждое её выполнение требует времени \( O(\lg n) \). Однако эту оценку можно улучшить, чем мы сейчас и займёмся.

Дело в том, что время работы процедуры HEAPIFY зависит от высоты вершины, для которой она вызывается (и пропорционально этой высоте). Поскольку число вершин высоты \( h \) в куче из \( n \) элементов не превышает \( \lceil n/2^{h+1} \rceil \) (см. упр. 7.3-3), а высота всех кучи не превышает \( \lfloor \lg n \rfloor \) (упр. 7.1-2), время работы процедуры BUILD-HEAP не превышает

\[
\sum_{h=0}^{\lfloor \lg n \rfloor} \left\lceil \frac{n}{2^{h+1}} \right\rceil O(h) = O \left( n \sum_{h=0}^{\lfloor \lg n \rfloor} \frac{h}{2^h} \right)
\]

Полагая \( x = 1/2 \) в формуле (3.6), получаем верхнюю оценку для суммы в правой части:

\[
\sum_{h=0}^{\infty} \frac{h}{2^h} = \frac{1/2}{(1 - 1/2)^2} = 2.
\]

Таким образом, время работы процедуры BUILD-HEAP составляет

\[
O \left( n \sum_{h=0}^{\infty} \frac{h}{2^h} \right) = O(n).
\]

Упражнения

7.3-1 Покажите, следуя образцу рис. 7.3, как работает процедура BUILD-HEAP для массива \( A = \langle 5, 3, 17, 10, 84, 19, 6, 22, 9 \rangle \).

7.3-2 Почему в процедуре BUILD-HEAP существенно, что параметр \( i \) пробегает значения от \( \lfloor length[A]/2 \rfloor \) до 1 (а не наоборот)?

7.3-3 Докажите, что куча из \( n \) элементов содержит не более \( \lceil n/2^{h+1} \rceil \) вершин высоты \( h \).