---
source_image: page_772.png
page_number: 772
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.59
tokens: 11594
characters: 2165
timestamp: 2025-12-24T06:56:42.198191
finish_reason: stop
---

34.2.1 Упражнения

34.2-1
Сколько холостых срабатываний даст алгоритм Рабина-Карпа, если \( q = 11, T = 3141592653589793 \) и \( P = 26 \)?

34.2-2 Обобщите алгоритм Рабина — Карпа на случай, когда в тексте надо искать одну из \( k \) данных подстрок.

34-2.3 Обобщите алгоритм Рабина — Карпа на случай, когда надо искать квадрат размером \( m \times m \) в матрице размером \( n \times n \) с заданным содержимым (т.е. получающийся из образца параллельным переносом).

34-2.4 У Ани на компьютере есть \( n \)-битовый файл \( A = \langle a_{n-1}, a_{n-2}, \ldots, a_0 \rangle \), а у Бори — \( n \)-битовый файл \( B = \langle b_{n-1}, b_{n-2}, \ldots, b_0 \rangle \). Они хотят проверить, идентичны ли эти файлы, не пересылая их друг другу, следующим образом. Выбирается простое число \( q > 1000n \) и случайное целое число \( x \in \{0, 1, \ldots, q-1\} \). После этого Аня вычисляет выражение

\[
A(x) = \left( \sum_{i=0}^n a_i x^i \right) \bmod q,
\]

а Боря вычисляет аналогичное выражение \( B(x) \). Покажите, что, если \( A \neq B \), существует лишь один шанс из тысячи, что \( A(x) = B(x) \) (и уже конечно \( A(x) = B(x) \), если \( A = B \)). (Указание: воспользуйтесь упражнением 33.4-4).

34.3 Поиск подстрок с помощью конечных автоматов

Многие алгоритмы для поиска подстрок начинают с того, что строят конечный автомат, который находит в тексте \( T \) все вхождения образца \( P \). В этом разделе мы опишем, как можно построить такой автомат. Сам по себе поиск подстроки с помощью конечного автомата весьма эффективен: каждый символ поступает на вход конечного автомата только единожды, а обработка каждого символа занимает ограниченное время, так что общее время работы есть \( \Theta(n) \) — после того, однако, как автомат построен! К сожалению, время на построение конечного автомата может быть велико, если велик алфавит \( \Sigma \) (в разд. 34.4 мы обсудим остроумный способ обоить эту трудность).

В этом разделе мы дадим определение конечного автомата, затем рассмотрим специальный конечный автомат, предназначенный для поиска подстрок, и наконец покажем, как сконструировать этот автомат, исходя из подстроки, которую он призван искать.