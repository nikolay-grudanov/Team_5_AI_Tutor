---
source_image: page_401.png
page_number: 401
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.82
tokens: 11622
characters: 2500
timestamp: 2025-12-24T06:39:28.770108
finish_reason: stop
---

На рисунке 20.5 показан пример объединения двух куч, в котором встречаются все четыре случая, предусмотренные в тексте процедуры.

Работа процедуры Binomial-Heap-Union начинается с соединения корневых списков куч \( H_1 \) и \( H_2 \) в единый список \( H \), в котором корневые вершины идут в порядке возрастания их степеней (вызов Binomial-Heap-Merge).

В получившемся списке может быть до двух вершин одинаковой степени. Поэтому мы начинаем соединять деревья равной степени с помощью процедуры Binomial-Link и делаем это до тех пор, пока деревьев одинаковой степени не останется. Этот процесс соответствует сложению столбиком, и время его работы пропорционально числу корневых вершин.

Опишем работу процедуры более подробно. Сначала (строки 1–3) происходит слияние корневых списков биномиальных куч \( H_1 \) и \( H_2 \) в один корневой список \( H \). Процедура Binomial-Heap-Merge на каждом шаге своей работы сравнивает начала списков \( H_1 \) и \( H_2 \) и вершину с меньшей степенью добавляет в конец списка \( H \). При этом порядок сохраняется, так что в списке \( H \) степени корневых вершин идут в неубывающем порядке. Процедура Binomial-Heap-Merge требует времени \( O(m) \), где \( m \) — суммарная длина списков \( H_1 \) и \( H_2 \).

Если кучи \( H_1 \) и \( H_2 \) пусты, будет возвращена пустая куча (строки 4–5). Далее мы предполагаем, что список \( H \) содержит хотя бы одну вершину.

В цикле используются три указателя:
• \( x \) указывает на текущую корневую вершину;
• \( prev-x \) указывает на предшествующую вершину (\( sibling[prev-x] = x \));
• \( next-x \) указывает на вершину, следующую за \( x \) в списке (\( sibling[x] = next-x \)).

Изначально в списке \( H \) может быть не более двух вершин данной степени, так как каждая из биномиальных куч \( H_1 \) и \( H_2 \) содержит не более одной вершины данной степени. Поскольку степени не убывают, вершины одинаковой степени будут соседними.

При сложении двоичных чисел столбиком в одном разряде может быть три единицы (две в слагаемых и одна за счёт переноса). По аналогичным причинам в ходе выполнения процедуры Binomial-Heap-Union в списке \( H \) могут оказаться три вершины одинаковой степени.

Поэтому, видя в строке 10 две соседние вершины одинаковой степени, мы проверяем, не идёт ли за ними ещё одна вершина той же степени.

Заметим, что в начале каждой итерации цикла while (строки 9–21) ни один из указателей \( x \) и \( next-x \) не равен NIL.

Случай 1, изображенный на рисунке 20.6а, возникает, когда