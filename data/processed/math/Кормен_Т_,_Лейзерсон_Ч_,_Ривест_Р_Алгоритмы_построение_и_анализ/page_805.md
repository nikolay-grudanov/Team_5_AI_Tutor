---
source_image: page_805.png
page_number: 805
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 48.69
tokens: 11528
characters: 2210
timestamp: 2025-12-24T06:58:03.994816
finish_reason: stop
---

пересечение невозможно; а при прохождении движущейся прямой через конец отрезка пересечение также невозможно, так как некоторые пересекающиеся отрезки были бы соседними слева или справа от прямой.

Осталось разобраться, почему наше рассуждение применимо к случаю, когда несколько концов отрезков лежат на одной вертикали (но не совпадают — это проверяется при сортировке концов отрезков). Это можно объяснить так: представим себе, что движущаяся прямая чуть-чуть наклонена влево (против часовой стрелки). Тогда она будет пересекать концы отрезков в разные (хотя, возможно, очень близкие) моменты времени, и просматриваться они будут как раз в нужном порядке (точки с одинаковой абсциссой — в порядке возрастания ординат). Тем самым можно свести дело к уже разобранному случаю (проверяться на пересечение будут те же пары отрезков, что и с воображаемой наклонённой прямой).

Время работы.
Если множество S состоит из n отрезков, то время работы алгоритма ANY-Segment-Intersect есть O(n lg n). В самом деле, сортировку можно выполнить за такое время (сортировку слиянием или с помощью двоичной кучи), затем мы обрабатываем 2n концов отрезков, тратя на каждый время O(lg n) (таково время любой использованной нами операции с красно-чёрным деревом). Заметим, что для одной пары отрезков выяснение того, пересекаются они или нет, выполняется за время O(1).

Упражнения.
35.2-1
Показать, что n отрезков могут иметь \( \Theta(n^2) \) точек пересечения.
35.2-2
Даны два непересекающихся отрезка a и b, сравнимых относительно x. Используя векторное произведение, определить за время O(1), выполнено ли соотношение \( a >_x b \).
35.2-3
Профессор предлагает изменить программу ANY-Segment-Intersect так: найдя пересекающиеся отрезки, алгоритм не кончает работу, а продолжает выполнять цикл for. Получившийся алгоритм профессор называет Print-Intersecting-Segments и утверждает, что такой алгоритм напечатает все пересечения отрезков множества в порядке возрастания их абсцисс. Покажите, что профессор дважды неправ: во-первых, алгоритм может напечатать не все отрезки; во-вторых, первая напечатанная им точка может не быть самой левой точкой пересечения.
35.2-4
Постройте алгоритм, который за время O(n lg n) определяет,