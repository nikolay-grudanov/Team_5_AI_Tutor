---
source_image: page_445.png
page_number: 445
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.71
tokens: 11704
characters: 2648
timestamp: 2025-12-24T06:41:20.379171
finish_reason: stop
---

При доказательстве оценки нам будет удобнее работать с операцией LINK, а не UNION. Пусть дана последовательность \( S_1 \), состоящая из \( m_1 \) операций Make-Set, Find-Set и Union. Заменим каждую операцию Union на две операции Find-Set и одну операцию Link; получится последовательность \( S_2 \) из \( m_2 \) операций Make-Set, Find-Set и Link.

Лемма 22.6
Если стоимость выполнения последовательности \( S_2 \) в худшем случае есть \( O(m_2 \lg^* n) \), то стоимость выполнения последовательности \( S_1 \) в худшем случае есть \( O(m_1 \lg^* n) \), где \( n \) — число операций Make-Set.

Доказательство.
Немедленно следует из очевидного неравенства \( m_1 \leq m_2 \leq 3m_1 \).

Теорема 22.7
Предположим, что над системой непересекающихся множеств (первоначально пустой) произвели \( m \) операций Make-Set, Find-Set и Link, из которых \( n \) операций были операциями Make-Set. Тогда при использовании реализации с помощью леса со сжатием путей и объединением по рангам общая стоимость этой последовательности операций есть \( O(m \lg^* n) \).

Доказательство.
Стоимость каждой из операций Make-Set и Link есть, очевидно, \( O(1) \), а их суммарная стоимость есть тем самым \( O(m) \). Займемся операциями Find-Set. Очевидно, стоимость операции Find-Set\((x)\) пропорциональна длине пути поиска от \( x \) к корню (до сжатия). Стало быть, нам надо оценить суммарную длину путей поиска, возникавших в процессе выполнения всех операций Find-Set и доказать, что она есть \( O(m \lg^* n) \).

В процессе выполнения каждой из операций Find-Set мы двигаемся вверх по одному из деревьев, заканчивая поиск в его корне. Заметим, что на каждом шаге ранг вершины строго возрастает: если \( u \) — вершина, встретившаяся на пути поиска, а \( v \) — следующая вершина, то есть \( v = p[u] \), то \( rank[v] > rank[u] \). Вершина \( u \) может неоднократно встречаться в путях поиска при выполнении рассматриваемой в теореме последовательности операций. При этом за ней могут (и скорее всего будут) идти разные вершины: если в некоторый момент за \( u \) следовала вершина \( v \), которая не была корневой, то после сжатия путей за \( u \) будет следовать уже не \( v \), а корень дерева (на момент первого поиска), то есть вершина большего ранга, чем \( v \). (Это простое наблюдение играет к дальнейшем ключевую роль.)

Наблюдая за ростом ранга при переходе от вершины к её родителю, мы отдельно оценить количество шагов, при которых ранг сильно растёт, и количество шагов, когда он растёт не сильно. Выберем в качестве границы некоторую функцию \( \beta(k) \), определённую для неотрицательных целых \( k \). Мы предполагаем, что функция \( \beta \)