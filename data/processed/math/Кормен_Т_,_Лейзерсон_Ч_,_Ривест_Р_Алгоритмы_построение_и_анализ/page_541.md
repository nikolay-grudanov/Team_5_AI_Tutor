---
source_image: page_541.png
page_number: 541
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.04
tokens: 11786
characters: 2417
timestamp: 2025-12-24T06:46:12.875846
finish_reason: stop
---

Примеры замкнутых полуколец

Один такой пример мы уже рассмотрели: полукольцо \( S_1 = \{ \mathbb{R}^{>0} \cup \{ \infty \}, \min, +, \infty, 0 \} \). Мы можем расширить это полукольцо, разрешив отрицательные элементы, а также элемент \( -\infty \). Получится полукольцо \( S_2 = \{ \mathbb{R} \cup \{ +\infty \} \cup \{ -\infty \}, \min, +, +\infty, 0 \} \) (упр. 26.4-3). Это полукольцо можно использовать при доказательстве правильности алгоритма Флойда–Уоршалла для случая отрицательных весов. Отметим, что теперь

\[
a^* = \begin{cases}
0, & \text{если } a \geq 0, \\
-\infty, & \text{если } a < 0.
\end{cases}
\]

Второй случай (\( a < 0 \)) говорит нам, что цикл отрицательного веса можно проходить многократно, и веса будут стремиться к \( -\infty \).

Задаче о транзитивном замыкании соответствует замкнутое полукольцо \( S_3 = (\{0, 1\}, \vee, \wedge, 0, 1) \). При этом все рёбра исходного графа имеют пометку 1 (а отсутствующим соответствует значение \( \overline{0} = 0 \), как мы говорили). В этом полукольце значение \( l_{ij} \), вычисленное по формуле (26.11), равно 1, если пара \((i, j)\) принадлежит транзитивному замыканию (то есть есть путь из \(i\) в \(j\)), и равно 0 в противном случае. Отметим, что для этого кольца \(1^* = 0^* = 1\).

Динамическое программирование и сумма меток по путям

Покажем, как можно вычислить выражение (26.11) с помощью алгоритма, аналогичного алгоритму Флойда–Уоршалла и алгоритму вычисления транзитивного замыкания.

Напомним, что нам дано замкнутое полукольцо \(S\) и ориентированный граф \((G, V)\), рёбра которого помечены элементами \(S\). Мы хотим для каждой пары вершин \(i, j\) вычислить "сумму" (в смысле полукольца)

\[
l_{ij} = \bigoplus \lambda(p)
\]

где "суммирование" происходит по всем путям из \(i\) в \(j\), а \(\lambda(p)\) есть метка пути \(p\), то есть "произведение" меток на его рёбрах.

Рассмотрим величину \(l_{ij}^{(k)}\), которая получится, если ограничить суммирование только теми путями, в которых все промежуточные вершины лежат в множестве \(\{1, 2, \ldots, k\}\). Для \(l_{ij}^{(k)}\) можно написать рекуррентное соотношение:

\[
l_{ij}^{(k)} = l_{ij}^{(k-1)} \oplus (l_{ik}^{(k-1)} \odot (l_{kk}^{(k-1)})^* \odot l_{kj}^{(k-1)}).
\] (26.12)

Эта формула напоминает рекуррентные соотношения (26.5) и (26.8); разница в том, что в ней есть "множитель" \((l_{kk}^{(k-1)})^*\), соответствующий "сумме" меток всех циклов, начинающихся и