---
source_image: page_294.png
page_number: 294
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.73
tokens: 11289
characters: 1399
timestamp: 2025-12-24T06:34:01.998423
finish_reason: stop
---

15-2 Детская считалка

Задача о детской считалке (Josephus problem) состоит в следующем. Фиксируем два числа \( m \) и \( n \) (\( m \leq n \)). Вначале \( n \) детей стоят по кругу. Начав с кого-то, мы считаем "первый, второй, третий..." Как только доходим до \( m \)-го, он выходит из круга, и счёт продолжается дальше по кругу уже без него (начиная с единицы). Так продолжается, пока не останется ровно один человек. Нас будет интересовать зависящая от \( n \) и \( m \) последовательность ((\( n, m \))-Josephus permutation), в которой дети выходят из круга. Например, при \( n = 7 \) и \( m = 3 \) искомая последовательность выглядит так: \( \langle 3, 6, 2, 7, 5, 1, 4 \rangle \).

а Закрепим \( m \). Напишите программу, которая по данному \( n \) даёт эту последовательность за время \( O(n) \).

б Напишите программу, которая по произвольным \( n \) и \( m \) даёт искомую последовательность за время \( O(n \log n) \).

Замечания

Описания некоторых видов деревьев промежутков можно найти в Препарата и Шамос [160]. Наибольший теоретический интерес представляет здесь результат, к которому независимо пришли Эдельсбруннер (H. Edelsbrunner, 1980) и МакКрейт (Е. М. McCreight, 1981). Разработанная ими структура данных хранит \( n \) отрезков и позволяет перечислить те из них, которые перекрываются с заданным отрезком, за время \( O(k + \log n) \), где \( k \) — количество таких отрезков.