---
source_image: page_457.png
page_number: 457
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.96
tokens: 11387
characters: 1666
timestamp: 2025-12-24T06:41:34.771392
finish_reason: stop
---

\caption{
23.3
Исполнение процедуры \textsc{BFS} для неориентированного графа. Рёбра формируемого дерева показаны серыми.
Внутри каждой вершины $u$ указано значение $d[u]$.
Показано состояние очереди $Q$ перед каждым повторением цикла в строках 9--18. Рядом с элементами очереди показаны расстояния от корня.
}
\end{figure}

В строках 1--4 все вершины становятся белыми, все значения $d$
бесконечными, и родителем всех вершин объявляется \textsc{nil}.
Строки 5--8 красят вершину $s$ в серый цвет и выполняют связанные с этим действия: в строке 6 расстояние $d[s]$ объявляется равным $0$, а в строке $7$ говорится, что родителя у $s$ нет. Наконец, в строке $8$ вершина $s$ помещается в очередь $Q$, и с этого момента очередь будет содержать все серые вершины и только их.

Основной цикл программы (строки 9--18) выполняется, пока очередь непуста, то есть существуют серые вершины (вершины, которые уже обнаружены, но списки смежности которых еще не просмотрены). В строке 10 первая такая вершина помещается в $u$. Цикл \textbf{for} в строках 11--16 просматривает все смежные с ней вершины. Обнаружив среди них белую вершину, мы делаем её серой (строка 13), объявляем $u$ её родителем (строка 15) и устанавливаем расстояние равным $d[u]+1$ (строка 14). Наконец, эта вершина добавляется в хвост очереди $Q$ (строка 16). После этого уже можно удалить вершину $u$ из очереди $Q$, перекрасив эту вершину в чёрный цвет (строки 17--18).

Анализ

Начнём с более простого --- оценим время работы описанной процедуры. В процессе работы вершины только темнеют, так что каждая вершина кладётся в очередь не более одного раза (благодаря проверке в строке 12). Следовательно, и вы-