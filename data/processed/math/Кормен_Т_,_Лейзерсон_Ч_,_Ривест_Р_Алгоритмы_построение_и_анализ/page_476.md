---
source_image: page_476.png
page_number: 476
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.74
tokens: 11656
characters: 2510
timestamp: 2025-12-24T06:42:50.692159
finish_reason: stop
---

7. Вершина \( v \) является собственным предшественником: \( \varphi(v) = v \).
(Другая формулировка предыдущего утверждения.)

8. Вершина \( v \) является предшественником любой вершины \( u \) компоненты \( S \). (В самом деле, из \( u \) достижимы те же вершины, что из \( v \), и потому вершина с максимальным временем завершения будет той же самой).

Мы видим, что в каждой сильно связной компоненте есть вершина, которая обнаруживается первой, завершает обрабатываться последней и является предшественником всех вершин этой компоненты.

Таким образом, мы доказали следующие утверждения:
Теорема 23.14
В ориентированном графе \( G = (V, E) \) предшественник \( \varphi(u) \) любой вершины \( u \in V \) оказывается её предком в дереве поиска в глубину.

Следствие 23.15
При любом поиске в глубину на ориентированном графе \( G = (V, E) \) вершины \( u \) и \( \varphi(u) \) лежат в одной сильно связанной компоненте для любой \( u \in V \).

Теорема 23.16
В ориентированном графе \( G = (V, E) \) две вершины лежат в одной сильно связанной компоненте тогда и только тогда, когда они имеют общего предшественника при поиске в глубину.

Итак, задача о нахождении сильно связных компонент свелась к задаче отыскания предшественников всех вершин графа. Именно для этого используется поиск в глубину в строке 3 алгоритма Strongly-Connected-Components.

Чтобы понять, как это делается, рассмотрим сначала вершину \( r \) с максимальным значением \( f[v] \) среди всех вершин графа \( G \). (Говоря о значениях \( f[v] \), мы имеем в виду значения, вычисленные в строке 1 алгоритма.) Это вершина будет предшественником любой вершины, из которой она достижима (ни одна вершина графа не имеет большего значения \( f[v] \)). Таким образом, одну сильно связную компоненту мы нашли — это вершины, из которых достижима \( r \). Другими словами, это вершины, достижимые из \( v \) в транспонированном графе.

Отбросив все вершины найденной компоненты, возьмём среди оставшихся вершину \( r' \) с максимальным значением \( f[v] \). Любая оставшаяся вершина \( u \), из которой достижима \( r' \), будет иметь \( r' \) своим предшественником (ни одна из отброшенных вершин не достижима из \( u \), иначе и \( r \) была бы достижима из \( u \) и вершина \( u \) попала бы в число отброшенных). Таким образом мы найдём вторую сильно связную компоненту — в неё входят те из оставшихся вершин, из которых достижима вершина \( r' \) (другими словами, те из оставшихся, которые достижимы из \( r' \) в транспонированном графе).