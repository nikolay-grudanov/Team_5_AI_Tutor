---
source_image: page_788.png
page_number: 788
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.82
tokens: 11690
characters: 2422
timestamp: 2025-12-24T06:57:31.384220
finish_reason: stop
---

Алгоритм Бойера — Мура

жного возможного стоп-символа \( a \in \Sigma \) вычислить значение \( k \).
Это делается простой процедурой Compute-Last-Occurrence-Function ("найти последнее вхождение"), которая для каждого \( a \in \Sigma \) вычисляет \( \lambda[a] \) — номер крайнего правого вхождения \( a \) в \( P \), или нуль, если \( a \) в \( P \) не входит. В этих обозначениях приращение сдвига, диктуемое эвристикой стоп-символа, есть \( j - \lambda[T[s + j]] \), как и написано в строке 13 алгоритма Boyer-Moore-Matcher.

Compute-Last-Occurrence-Function(P,m,\Sigma)
1 for (для) каждого символа \( a \in \Sigma \)
2 do \( \lambda[a] \gets 0 \)
3 for \( j \gets 1 \) to \( m \)
4 do \( \lambda[P[j]] \gets j \)
5 return \( \lambda \)

Время работы процедуры Compute-Last-Occurrence-Function есть \( O(|\Sigma| + m) \).

34.5.2 Эвристика безопасного суффикса

Если \( Q \) и \( R \) — строки, будем говорить, что они сравнимы (обозначение: \( Q \sim R \)), если одна из них является суффиксом другой.
Если выровнять две сравнимые строки по правому краю, то символы, расположенные один под другим, будут совпадать. Отношение \( \sim \) симметрично: если \( Q \sim R \), то и \( R \sim Q \). Из леммы 34.1 следует, что

если \( Q \sqsupseteq R \) и \( S \sqsupseteq R \), то \( Q \sim S \). (34.7)

Эвристика безопасного суффикса (good-suffix heuristic) состоит в следующем: если \( P[j] \neq T[s + j] \), где \( j < m \) (и число \( j \) — наибольшее с таким свойством), то мы можем безбоязненно увеличить сдвиг на

\[
\gamma[j] = m - \max\{ k : 0 \leq k < m \text{ и } P[j + 1..m] \sim P_k \}.
\]

Иными словами, \( \gamma[j] \) — наименьшее расстояние, на которое мы можем сдвинуть образец без того, чтобы какой-то из символов, входящих в "безопасный суффикс" \( T[s + j + 1..s + m] \) оказался напротив не совпадающего с ним символа из образца. Поскольку строка \( P[j + 1..m] \) заведомо сравнима с пустой строкой \( P_0 \), число \( \gamma[j] \) корректно определено для всех \( j \). Стоит также заметить, что \( \gamma[j] > 0 \) для всех \( j \), так что на каждом шаге алгоритма Бойера — Мура образец будет сдвигаться вправо хотя бы на одну позицию.
Мы будем называть \( \gamma \) функцией безопасного суффикса (good-suffix function), ассоциированной со строкой \( P \).

Посмотрим, как можно вычислить функцию безопасного суффикса \( \gamma \). Для начала заметим, что \( P_{\pi[m]} \sqsupseteq P \), откуда, в