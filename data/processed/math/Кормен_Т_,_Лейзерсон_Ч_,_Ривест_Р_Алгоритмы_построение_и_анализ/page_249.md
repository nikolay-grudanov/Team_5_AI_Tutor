---
source_image: page_249.png
page_number: 249
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.61
tokens: 11252
characters: 1363
timestamp: 2025-12-24T06:31:38.848590
finish_reason: stop
---

Добывление и удаление элемента

Рисунок 13.3 Добавление элемента с ключом 13. Светло-серые вершины находятся на пути от корня до позиции нового элемента. Пунктир связывает новый элемент со старыми.

TREE-INSERT(T, z)
1   y ← NIL
2   x ← root[T]
3   while x ≠ NIL
4     do y ← x
5       if key[z] < key[x]
6         then x ← left[x]
7         else x ← right[x]
8   p[z] ← y
9   if y = NIL
10     then root[T] ← z
11     else if key[z] < key[y]
12       then left[y] ← z
13       else right[y] ← z

На рисунке 13.3 показано, как работает процедура TREE-INSERT. Подобно процедурам TREE-SEARCH и ITERATIVE-TREE-SEARCH, она двигается вниз по дереву, начав с его корня. При этом в вершине y сохраняется указатель на родителя вершины x (цикл в строках 3–7). Сравнивая key[z] с key[x], процедура решает, куда идти — налево или направо. Процесс завершается, когда x становится равным NIL. Этот NIL стоит как раз там, куда надо поместить z, что и делается в строках 8–13.

Как и остальные операции, добавление требует времени O(h) для дерева высоты h.

Удаление

Параметром процедуры удаления является указатель на удаляемую вершину. При удалении возможны три случая, показанные на рисунке 13.4. Если у z нет детей, для удаления z достаточно поместить NIL в соответствующее поле его родителя (вместо z). Если у z есть один ребёнок, можно "вырезать" z, соединив его родителя