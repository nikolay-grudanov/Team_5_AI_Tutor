---
source_image: page_751.png
page_number: 751
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.26
tokens: 11696
characters: 2531
timestamp: 2025-12-24T06:55:52.628162
finish_reason: stop
---

**Глава 33 Теоретико-числовые алгоритмы**

лишь, то продолжать дальше вычисление \( a^{n-1} \mod n \) нет смысла, мы и так знаем, что число \( n \) составное; процедура WITNESS возвращает значение TRUE. Если этого не произошло, возведение в степень заканчивается с результатом \( d \) и в строках 10–11 мы проверяем, равно ли \( d \) единице по модулю \( n \). Если нет, то число \( n \) также составное (процедура возвращает значение TRUE). Если нет, то возвращается значение FALSE ("число \( a \) не является свидетелем того, что \( n \) составное").

В каком случае процедура WITNESS\((a, n)\) возвращает значение TRUE? В двух — либо имеется непривильный корень из 1 по модулю \( n \), либо не выполнена малая теорема Ферма (число \( n \) не является псевдопростым по основанию \( a \)). В обоих случаях число \( n \) является составным.

Приведём теперь полностью вероятностный алгоритм Миллера — Рабина.

1 for j \gets 1 to s
2 do a \gets Random(1,n-1)
3 if Witness(a,n)
4 then return составное заведомо
5 return простое почти наверняка

Процедура MILLER-RABIN берёт \( s \) случайных чисел от 1 до \( n-1 \) и проверяет, не является ли какое-то из них свидетелем того, что \( n \) — составное (в описанном выше смысле). Если является, то число \( n \) заведомо является составным, и об этом можно сообщить в строке 4. Если ни одно из выбранных чисел не является свидетелем, то выдаётся ответ "простое", хотя гарантии тут нет. (Мы оценим далее, насколько вероятен такой ответ при составном \( n \)).

Для примера рассмотрим работу этого алгоритма для числа 561 (которое, как мы говорили, является числом Кармайкла 561). Для этого вернёмся к рис. 33.4, который соответствует вычислениям для \( a = 7 \). При последнем возведении в квадрат процедура обнаруживает непривильный корень из 1, поскольку \( 7^{280} \equiv 67 \pmod{561} \) и \( 7^{560} \equiv 1 \pmod{561} \). Тем самым значение \( a = 7 \) является свидетелем того, что число 561 составное: WITNESS\((7, 561) = \) TRUE. Если \( a = 7 \) встретится среди \( s \) случайных значений, выбранных в алгоритме MILLER-RABIN, то алгоритм выдаст ответ "составное".

Если двоичная запись \( n \) содержит \( \beta \) битов, то процедура MILLER-RABIN\((s, n)\) выполняет \( O(s \beta) \) арифметических (и \( O(s \beta^3) \) битовых) операций (производится не более \( s \) операций возведения в степень).

Оценка вероятности ошибки для теста Миллера — Рабина.
Сообщая, что число \( n \) является простым, процедура MILLER-RABIN (как и PSEUDOPRIME) может ошибаться. Но тут есть