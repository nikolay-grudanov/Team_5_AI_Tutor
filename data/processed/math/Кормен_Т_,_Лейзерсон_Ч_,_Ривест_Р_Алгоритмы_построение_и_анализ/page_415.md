---
source_image: page_415.png
page_number: 415
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 70.30
tokens: 11512
characters: 2044
timestamp: 2025-12-24T06:40:01.082457
finish_reason: stop
---

Наконец, атрибут \( n[H] \) содержит число вершин в куче \( H \).

Потенциал

При анализе учётной стоимости операций мы используем метод потенциала (раздел 18.3). Пусть \( t(H) \) — число деревьев в корневом списке кучи \( H \), а \( m(H) \) — количество отмеченных вершин. Потенциал определяется формулой

\[
\Phi(H) = t(H) + 2m(H).
\]

Например, потенциал кучи рис. 21.1 равен \( 5 + 2 \cdot 3 = 11 \). В каждый момент времени в памяти хранится несколько куч; общий потенциал по определению равен сумме потенциалов всех этих куч. В дальнейшем мы выберем "единицу измерения потенциала" так, чтобы единичного изменения потенциала хватало для оплаты \( O(1) \) операций (формально говоря, мы умножим потенциал на подходящую константу).

В начальном состоянии нет ни одной кучи, и потенциал равен 0. Как и положено (см. разд. 18.3), потенциал всегда неотрицателен.

Максимальная степень

Мы будем предполагать известной некоторую верхнюю границу \( D(n) \) для степеней вершин в кучах, которые могут появиться при выполнении наших процедур. (Аргументом функции \( D \) является общее число всех вершин в куче, обозначаемое через \( n \).) Если мы используем только операции, предусмотренные для сливаемых куч, то можно положить \( D(n) = \lfloor \lg n \rfloor \) (упр. 21.2-3). В разделе 21.3 мы докажем (для общего случая, когда разрешены также операции DECREASE-KEY и DELETE), что \( D(n) = O(\lg n) \).

21.2 Операции, предусмотренные для сливаемых куч

Для начала мы будем рассматривать лишь операции MAKE-HEAP, INSERT, MINIMUM, EXTRACT-MIN и UNION, предусмотренные для сливаемых куч. В этом случае кучи будут представлять собой набор "неупорядоченных биномиальных деревьев", корни которых связаны в циклический список.

Неупорядоченное биномиальное дерево (unordered binomial tree) получается из упорядоченного, если мы перестаём обращать внимание на порядок среди вершин, имеющих общего родителя. Другими словами, неупорядоченное биномиальное дерево \( U_0 \) состоит из единственной вершины, а неупорядоченное биномиальное дерево \( U_k \)