---
source_image: page_765.png
page_number: 765
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 71.73
tokens: 11856
characters: 2737
timestamp: 2025-12-24T06:56:37.247778
finish_reason: stop
---

Рис. 34.2
Подпись: Рис. 34.2. Доказательство леммы 34.1. Совпадающие символы соединены вертикальными линиями, а совпадающие части строк заштрихованы. Рис. (а) соответствует случаю \(|x| \leq |y|\), рис. (б) — случаю \(|x| \geq |y|\), рис. (в) — случаю \(|x| = |y|\).

худшем случае работает за время \(O((n - m + 1)m)\), но на практике он в среднем гораздо быстрее; кроме того, алгоритм Рабина — Карпа обобщается на другие задачи поиска образца. В разделе 34.3 мы описываем алгоритм поиска подстрок, который по заданному образцу строит конечный автомат, и затем пропускает через этот автомат текст \(T\). Время работы алгоритмов, основанных на этой идее, может быть доведено до \(O(n + m|\Sigma|)\). Аналогичный, но более изощрённый алгоритм Кнута — Морриса — Пратта (сокращенно КМР) работает за время \(O(m + n)\); этому алгоритму посвящен раздел 34.4. Наконец, в разделе 34.5 описывается алгоритм Бойера-Мура. Этот алгоритм зачастую оказывается наиболее удобным на практике, хотя, подобно алгоритму Рабина-Карпа, в худшем случае он не дает выигрыша по сравнению с простейшим алгоритмом.

34.0.1 Обозначения и терминология

Через \(\Sigma^*\) обозначается множество всех конечных строк над алфавитом \(\Sigma\), включая пустую строку (empty string), имеющую нулевую длину и обозначаемую \(\varepsilon\). Длина строки \(x\) обозначается \(|x|\). Соединение, или конкатенация (concatenation) строк \(x\) и \(y\) получится, если выписать строку \(x\), а за ней встык — строку \(y\). Конкатенация строк \(x\) и \(y\) обозначается \(xy\); очевидно, \(|xy| = |x| + |y|\).

Мы будем говорить, что строка \(w\) — префикс (prefix), или начало, строки \(x\), если \(x = wy\) для некоторого \(y \in \Sigma^*\). Будем говорить, что \(w\) — суффикс (suffix), или конец, строки \(x\), если \(x = yw\) для некоторого \(y \in \Sigma^*\). Будем писать \(w \sqsubset x\), если \(w\) — префикс \(x\), и \(w \sqsupset x\), если \(w\) — суффикс \(x\). Например, \(ab \sqsubset abcca\) и \(cca \sqsupset abcca\). [С этими обозначениями нужно обращаться осторожно: \(a \sqsubset b\) и \(b \sqsupset a\) означают совершенно разное!]

Пустая строка является префиксом и суффиксом любой строки; если \(w\) — префикс или суффикс \(x\), то \(|w| \leq |x|\). Для любых строк \(x\) и \(y\) и для любого символа \(a\) соотношения \(x \sqsubset y\) и \(xa \sqsubset ya\) равносильны; отношения \(\sqsubset\) и \(\sqsupset\) транзитивны. В дальнейшем мы будем пользоваться следующей леммой.

Лемма 34.1 (Лемма о двух суффиксах)
Пусть \(x\), \(y\) и \(z\) — строки, для которых \(x \sqsubset z\) и \(y \sqsubset z\). Тогда \(x \sqsubset y\), если \(|x| \leq |y|\); \(y \sqsubset x\), если \(|x| \geq |y|\), и \(x = y\), если \(|x| = |y|\).
Доказательство. См. рис. 34.2.