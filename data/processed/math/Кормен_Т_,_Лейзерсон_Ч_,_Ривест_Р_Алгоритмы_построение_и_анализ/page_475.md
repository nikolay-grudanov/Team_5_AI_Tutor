---
source_image: page_475.png
page_number: 475
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.54
tokens: 11790
characters: 2859
timestamp: 2025-12-24T06:42:58.618907
finish_reason: stop
---

Докажем теперь, что \( \varphi(\varphi(u)) = \varphi(u) \). В самом деле, для любых двух вершин \( u, v \in V \)

\[
u \leadsto v \Rightarrow f[\varphi(v)] \leq f[\varphi(u)],
\]

потому что \( \{w : v \leadsto w\} \subset \{w : u \leadsto w\} \) и предшественник любой вершины имеет максимальное время завершения обработки среди всех достижимых из неё вершин. Поскольку вершина \( \varphi(u) \) достижима из \( u \), из формулы (23.3) получаем, что \( f[\varphi(\varphi(u))] \leq f[\varphi(u)] \). Кроме того, из неравенства (23.2) имеем \( f[\varphi(u)] \leq f[\varphi(\varphi(u))] \). Следовательно \( f[\varphi(\varphi(u))] = f[\varphi(u)] \) и \( \varphi(\varphi(u)) = \varphi(u) \), так как две вершины с одним временем завершения обработки.

Как мы увидим, в каждой сильно связной компоненте есть вершина, являющаяся предшественником всех вершин этой компоненты. При поиске в глубину в \( G \) эта вершина обнаруживается первой и оказывается обработанной последней (среди вершин этой компоненты). При поиске в \( G^T \) она становится корнем дерева поиска в глубину. Давайте докажем эти свойства.

Фиксируем некоторую сильно связанную компоненту \( S \). Рассмотрим вершину \( v \) этой компоненты, которая обнаруживается (при поиске в глубину) первой, то есть имеет минимальное значение \( d[v] \) среди всех \( v \in S \). Изучим ситуацию, которая имеет место непосредственно перед вызовом DFS-Visit(V).

1. В этот момент все вершины из \( S \) белые. (Если это не так, вершина \( v \) не является первой обнаруженной вершиной из \( S \).)
2. Все вершины компоненты \( S \) достижимы из \( v \) по белым путям. (В самом деле, по лемме 23.12 пути не выходят за пределы \( S \).)
3. Ни одна серая вершина не достижима из \( v \). (В самом деле, в момент вызова DFS-Visit(v) серые вершины образуют путь из корня дерева поиска в \( v \), поэтому \( v \) достижима из любой серой вершины. Если бы некоторая серая вершина была достижима из \( v \), то она лежала бы в одной компоненте с \( v \), а все такие вершины белые.)
4. Любая белая вершина \( w \), достижимая из \( v \), достижима по белому пути. (В самом деле, на пути из \( v \) в \( w \) не может быть серых вершин, поэтому все вершины этого пути или белые, или чёрные. С другой стороны, при поиске в глубину никогда не возникает ребра из чёрной вершины в белую, поэтому на этом пути не может быть чёрных вершин.)
5. Все вершины компоненты \( S \) будут закрашены при вызове DFS-Visit(v) и будут потомками \( v \) в дереве поиска. (Следует из теоремы о белом пути.)
6. Все вершины, достижимые из \( v \), имеют меньше время завершения обработки, чем сама \( v \). (В самом деле, для чёрных вершин это очевидно, так как они уже были обработаны к моменту начала обработки \( v \). Для белых это тоже верно, поскольку они будут обработаны в ходе вызова DFS-Visit(v) до окончания обработки \( v \).)