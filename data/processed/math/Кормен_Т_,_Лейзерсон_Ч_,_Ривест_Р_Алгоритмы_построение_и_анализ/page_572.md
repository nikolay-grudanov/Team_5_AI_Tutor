---
source_image: page_572.png
page_number: 572
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 64.59
tokens: 11728
characters: 2296
timestamp: 2025-12-24T06:47:41.687475
finish_reason: stop
---

Алгоритм проталкивания предпотока

потока жидкости от истока) — и превратим предпоток в поток (который окажется максимальным).

Основные операции
Итак, алгоритм проталкивания предпотока использует две основные операции: проталкивание потока из вершины в соседнюю и подъём вершины. Дадим точные определения.
Пусть \( G = (V, E) \) — сеть с истоком \( s \) и стоком \( t \), а \( f \) — предпоток в \( G \). Функция \( h : V \to \mathbb{N} \) называется высотной функцией (height function) для предпотока \( f \), если \( h(s) = |V|, h(t) = 0 \) и
\[
h(u) \leq h(v) + 1
\]
для любого остаточного ребра \( (u, v) \in E_f \). Следующая лемма даёт очевидную переформулировку этого условия:
Лемма 27.13
Пусть \( f \) — предпоток в сети \( G = (V, E) \) и \( h \) — высотная функция. Тогда если для вершин \( u, v \in V \), выполнено \( h(u) > h(v) + 1 \), то остаточная сеть не содержит ребра \( (u, v) \) ("по круто идущим вниз трубам идёт максимально возможный поток").
Теперь определим основные операции.
Процедура Push\((u, v)\) применима, если вершина \( u \) переполнена (то есть \( c_f(u, v) > 0 \)) и если \( h(u) = h(v) + 1 \). При этом поток из вершины \( u \) в её соседа \( v \) растёт — его увеличение ограничено избытком жидкости в \( u \) и остаточной пропускной способностью ребра \( (u, v) \).
\textsc{Push}\((u, v)\)
1 $\triangleright$ дано: вершина $u$ переполнена, $c_f(u, v)>0$ и $h(u)=h(v)+1$.
2 $\triangleright$ надо: протолкнуть
$d_f(u, v)=\min(e[u], c_f(u, v))$ единиц потока из $u$ в $v$.
3 $d_f(u, v)\leftarrow\min(e[u], c_f(u, v))$
4 $f[u, v]\leftarrow f[u, v]+d_f(u, v)$
5 $f[v, u]\leftarrow -f[u, v]$
6 $e[u]\leftarrow e[u]-d_f(u, v)$
7 $e[v]\leftarrow e[v]+d_f(u, v)$

Мы предполагаем, что избыток в вершине равен \( e[u] > 0 \), и что остаточная пропускная способность ребра \( (u, v) \) также положительна. Поэтому мы можем направить \( \min(e[u], c_f(u, v)) > 0 \) единиц потока из \( u \) в \( v \) (мы вычисляем эту величину в строке 3), не превышив пропускной способности и не сделав избыток отрицательным. Следовательно, если функция \( f \) останется предпотоком (если он им была). Мы изменяем \( f \) в строках 4-5 и \( e \) в строках 6-7.

Условие \( h(u) = h(v) + 1 \) гарантирует, что мы направляем дополнительный поток лишь по рёбрам, идущим вниз с единичной