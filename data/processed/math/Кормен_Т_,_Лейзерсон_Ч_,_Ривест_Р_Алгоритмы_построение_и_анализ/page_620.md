---
source_image: page_620.png
page_number: 620
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 48.97
tokens: 11606
characters: 2219
timestamp: 2025-12-24T06:49:42.928617
finish_reason: stop
---

29.3.2 Характеристики схемы

Сложение с запоминанием переносов включает \( n - 1 \) шаг и требует времени \( \Theta(n) \). После этого готовы младшие биты произведения и слагаемые для последнего сложения, которое можно выполнять либо за время \( \Theta(n) \), либо за время \( \Theta(\lg n) \) — последнее не даёт большой экономии, так как суммарное время работы всё равно составляет \( \Theta(n) \).

Схема содержит \( n^2 \) элементов AND, примерно столько же суммирующих элементов и сумматор размера \( \Theta(n) \). Поэтому её размер составляет \( \Theta(n^2) \).

29.3.3 Умножение с помощью дерева Уоллеса

Дерево Уоллеса (Wallace tree) сводит задачу сложения \( n \) чисел размера \( n \) к сложению двух чисел размера \( \Theta(n) \). Это делается так: используя \( \lfloor n/3 \rfloor \) сумматоров с запоминанием переносов, мы сводим сложение \( n \) чисел к сложению \( \lceil 2n/3 \rceil \) чисел. Эта процедура повторяется до тех пор, пока не останется всего два слагаемых. На каждом этапе параллельно работающие сумматоры требуют времени \( O(1) \), этапов \( \Theta(\lg n) \), последнее сложение (с предвычислением переносов) тоже требует времени \( \Theta(\lg n) \), так что общее время будет \( \Theta(\lg n) \) при размере \( \Theta(n^2) \).

Дерево Уоллеса для \( n = 8 \) показано на рис. 29.16. На самом деле это не дерево, а ориентированный граф без циклов, но мы сохраняем традиционное название. Мы складываем 8 частичных произведений \( m^{(0)}, \ldots, m^{(7)} \), числа на стрелках указывают количество разрядов в складываемых числах (\( m^{(i)} \) содержит \( n + i \) битов, о числе битов на выходе сумматора с запоминанием переносов см. упражнение 29.3-3). Последнее сложение (слагаемые имеют длины \( 2n - 1 \) и \( 2n \), сумма имеет длину \( 2n \)) выполняется с помощью сумматора с предвычислением переносов.

Рисунок 29.16 29.16 Дерево Wallace’a для сложения частичных произведений \( m^{(0)}, \ldots, m^{(7)} \). Каждая стрелка обозначает число указанной разрядности.

29.3.4 Характеристики схемы

Обозначим глубину дерева Уоллеса для \( n \) слагаемых через \( D(n) \). На каждом уровне из каждого трёх чисел делается по два, да ещё два может остаться (как случилось на первом шаге на