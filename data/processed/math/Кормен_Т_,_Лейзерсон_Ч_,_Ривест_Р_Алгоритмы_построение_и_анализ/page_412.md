---
source_image: page_412.png
page_number: 412
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.28
tokens: 11437
characters: 1993
timestamp: 2025-12-24T06:39:45.550767
finish_reason: stop
---

21 Фибоначчиевы кучи

В главе 20 мы изучали биномиальные кучи, с помощью которых можно реализовать за время \( O(\lg n) \) (в худшем случае) операции INSERT, MINIMUM, EXTRACT-MIN, UNION, а также DECREASE-KEY и DELETE. (Структуры данных, поддерживающие первые четыре из перечисленных операций, называются "сливааемыми кучами".) В этой главе мы рассматриваем фибоначчиевы кучи, которые поддерживают те же шесть операций, но более эффективно: операции, не требующие удаления элементов, имеют учётную стоимость \( O(1) \).

Теоретически фибоначчиевы кучи особенно полезны, если число операций EXTRACT-MIN и DELETE мало по сравнению с остальными операциями. Такая ситуация возникает во многих приложениях. Например, алгоритм, обрабатывающий граф, может вызывать процедуру DECREASE-KEY для каждого ребра графа. Для плотных графов, имеющих много рёбер, переход от \( O(\lg n) \) к \( O(1) \) в оценке времени работы для операции DECREASE-KEY может привести к заметному уменьшению общего времени работы. Наиболее быстрые известные алгоритмы для задач построения минимального покрывающего дерева (глава 24) или поиска кратчайших путей из одной вершины (глава 25) существенно используют фибоначчиевы кучи.

К сожалению, скрытые константы в асимптотической записи велики, и использование фибоначчиевых куч редко оказывается целесообразным: обычные двоичные (или \( k \)-ичные) кучи на практике эффективнее. С практической точки зрения было бы очень желательно придумать структуру данных с теми же асимптотическими оценками, но с меньшими константами.

Используя биномиальные кучи для хранения набора множеств, мы хранили каждое из множеств набора в нескольких биномиальных деревьях, связанных в список. Сейчас мы будем поступать аналогичным образом, используя фибоначчиевы деревья (которые мы вскоре определим) вместо биномиальных.

Если мы никогда не выполняем операции DECREASE-KEY и DELETE, то возникающие фибоначчиевы деревья будут иметь ту же структуру, что и биномиальные деревья. Но в общем случае