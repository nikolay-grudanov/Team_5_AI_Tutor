---
source_image: page_263.png
page_number: 263
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 65.84
tokens: 11613
characters: 2116
timestamp: 2025-12-24T06:32:47.567878
finish_reason: stop
---

Рисунок 14.1 Красно-чёрное дерево. Чёрные вершины показаны как тёмные, красные — как серые. Каждая вершина либо красная, либо черная. Все NIL-листья чёрные. Дети красной вершины — чёрные. Для каждой вершины все пути от неё вниз к листьям содержат одинаковое количество чёрных вершин. Около каждой вершины (кроме листьев) записана её чёрная высота. Чёрная высота листьев равна 0.

3. Если вершина красная, оба её ребёнка чёрные.
4. Все пути, идущие вниз от корня к листьям, содержат одинаковое количество чёрных вершин.

Пример красно-чёрного дерева показан на рисунке 14.1.
Рассмотрим произвольную вершину \( x \) красно-чёрного дерева и пути, ведущие вниз от неё к листьям. Все они содержат одно и то же число чёрных вершин (добавим к ним путь из корня в \( x \) и применим свойство 4). Число чёрных вершин в любом из них (саму вершину \( x \) мы не считаем) будем называть чёрной высотой (black-height) вершины \( x \) и обозначать \( bh(x) \). Чёрной высотой дерева будем считать чёрную высоту его корня.

Следующая лемма показывает, что красно-чёрные деревья хороши как деревья поиска.

Лемма 14.1. Красно-чёрное дерево с \( n \) внутренними вершинами (т. е. не считая NIL-листьев) имеет высоту не больше \( 2 \lg(n+1) \).

Доказательство. Сначала покажем, что поддерево с корнем в \( x \) содержит по меньшей мере \( 2^{bh(x)} - 1 \) внутренних вершин. Доказательство проведём индукцией от листьев к корню. Для листьев чёрная высота равна 0, и поддерево в самом деле содержит не менее \( 2^{bh(x)} - 1 = 2^0 - 1 = 0 \) внутренних вершин. Пусть теперь вершина \( x \) не является листом и имеет чёрную высоту \( k \). Тогда оба её ребёнка имеют чёрную высоту не меньше \( k - 1 \) (красный ребёнок будет иметь высоту \( k \), чёрный — \( k - 1 \)). По предположению индукции левое и правое поддеревья вершины \( x \) содержат не менее \( 2^{k-1} - 1 \) вершин, и потому поддерево с корнем в \( x \) содержит по меньшей мере \( 2^{k-1} - 1 + 2^{k-1} - 1 + 1 = 2^k - 1 \) внутренних вершин.

Чтобы завершить доказательство леммы, обозначим высоту дерева через \( h \). Согласно свойству 3, по меньшей мере половину