---
source_image: page_748.png
page_number: 748
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 67.31
tokens: 11811
characters: 2746
timestamp: 2025-12-24T06:55:46.537734
finish_reason: stop
---

Проверка чисел на простоту

чисел)

\[
\lim_{n \to \infty} \frac{\pi(n)}{n / \ln n} = 1.
\]

Выражение \( n / \ln n \) даёт неплохое приближение к \( \pi(n) \) даже при небольших значениях \( n \). Уже при \( n = 10^9 \) (небольшое число с точки зрения специалистов по теории чисел) погрешность приближения не превосходит 6% (\( \pi(10^9) = 50\,847\,478, 10^9 / 10^9 \ln 10^9 \approx 48\,254\,942 \)).

Асимптотический закон позволяет оценить вероятность, с которой целое число, наугад выбранное из отрезка от 1 до \( n \), является простым — это примерно \( 1 / \ln n \). Тем самым для отыскания простого числа от 1 до \( n \) нужно проверить на простоту порядка \( \ln n \) случайно выбранных чисел. Например, чтобы найти простое число из 100 десятичных знаков, надо перебрать порядка \( \ln 10^{100} \approx 230 \) случайных чисел от 1 до \( 10^{100} \). (Эта оценка по очевидным причинам может быть уменьшена вдвое: проверять на простоту стоит только нечётные числа. Заметим также, что число десятичных знаков в наугад взятом числе от 1 до \( 10^{100} \) с большой вероятностью близко к 100 — около 90% всех чисел в этом диапазоне имеют 100 знаков, около 99% — 99 или более знаков, около 99,9% — 98 или более знаков и т.д.)

Нам остаётся объяснить, каким образом можно проверить, будет ли простым данное большое число \( n \). Другими словами, мы хотим узнать, состоит ли разложение числа \( n \) на простые множители

\[
n = p_1^{e_1} p_2^{e_2} \cdots p_r^{e_r},
\]

\((r \geq 1; \) числа \( p_1, p_2, \ldots, p_r \) — различные простые делители \( n \)) из единственного простого числа (\( r = 1, e_1 = 1 \)).

Самый простой способ проверки — перебор делителей (trial division). Будем пытаться разделить \( n \) на 2, 3, ..., \( \lfloor \sqrt{n} \rfloor \) (чётные числа, большие 2, можно пропускать). Если \( n \) не делится ни на одно из этих чисел, то оно простое (если \( n \) разлагается в произведение двух или более множителей, то один из множителей не превосходит \( \sqrt{n} \)). Но дело это долгое — уже число делений есть \( \Theta(\sqrt{n}) \), и время работы экспоненциально зависит от длины записи числа \( n \) (напомним, что двоичное представление \( n \) занимает \( \beta = \lceil \lg(n+1) \rceil \) битов, так что \( \sqrt{n} = \Theta(2^{\beta/2}) \)). Таким образом, такой подход применим, лишь есть число \( n \) мало, или имеет небольшой делитель.

Если при переборе делителей мы обнаруживаем, что число \( n \) составное, то одновременно находится и делитель числа \( n \). Для других способов проверки простоты это не так — можно убедиться, что число составное, так и не указав никакого его делителя. Это не удивительно, так как задача разложения числа на множители, по-видимому, гораздо сложнее задачи проверки про-