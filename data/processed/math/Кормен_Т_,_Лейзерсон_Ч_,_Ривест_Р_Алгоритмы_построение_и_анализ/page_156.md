---
source_image: page_156.png
page_number: 156
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.59
tokens: 11428
characters: 1943
timestamp: 2025-12-24T06:27:27.089946
finish_reason: stop
---

нутого при предыдущих хороших (как мы видели в разделе 8.2, для алгоритма быстрой сортировки это так).

Вместо того, чтобы предварительно переставлять элементы массива, мы можем внести элемент случайности в процедуру PARTITION. Именно, перед разбиением массива \( A[p..r] \) будем менять элемент \( A[p] \) со случайно выбранным элементом массива. Тогда каждый элемент с равной вероятностью может оказаться граничным, и в среднем разбиения будут получаться достаточно сбалансированными.

Этот подход заменяет разовую случайную перестановку входов в начале использованием случайных выборов на всём протяжении работы алгоритма. В сущности это то же самое, и оба алгоритма имеют математическое ожидание времени работы \( O(n \lg n) \), но небольшие технические различия делают анализ нового варианта проще, и именно он будет рассматриваться в разделе 8.4.

Изменения, которые нужно внести в процедуры, совсем невелики:

RANDOMIZED-PARTITION(\( A, p, r \))
1 \( i \leftarrow \text{RANDOM}(p, r) \)
2 поменять \( A[p] \leftrightarrow A[i] \)
3 return PARTITION(\( A, p, r \))

В основной процедуре теперь будет использоваться RANDOMIZED-PARTITION вместо PARTITION:

RANDOMIZED-QUICKSORT(\( A, p, r \))
1 if \( p < r \)
2 then \( q \leftarrow \text{RANDOMIZED-PARTITION}(A, p, r) \)
3 RANDOMIZED-QUICKSORT(\( A, p, q \))
4 RANDOMIZED-QUICKSORT(\( A, q + 1, r \))

Анализом этого алгоритма мы займёмся в следующем разделе.

Упражнения

8.3-1 Почему для вероятностного алгоритма важно не максимальное время работы (для данного входа), а математическое ожидание этого времени?

8.3-2 Сколько раз при выполнении процедуры RANDOMIZED-QUICKSORT может происходить обращение к генератору случайных чисел RANDOM в худшем случае? Изменится ли ответ для наилучшего случая?

8.3-3* Реализуйте процедуру RANDOM(\( a, b \)), используя бросания монеты, т.е. датчик, с равной вероятностью выдающий 0 или 1. Каково математическое ожидание времени работы вашей проце-