---
source_image: page_574.png
page_number: 574
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 42.47
tokens: 11484
characters: 1763
timestamp: 2025-12-24T06:47:23.401357
finish_reason: stop
---

\textsc{Initialize-Preflow}($G,s$)
1 for (для) каждой вершины $u \in V[G]$
2 do $h[u] \leftarrow 0$
    $e[u] \leftarrow 0$
4 for (для) каждого ребра $(u,v) \in E[G]$
5 do $f[u,v] \leftarrow 0$
6     $f[v,u] \leftarrow 0$
7     $h[s] \leftarrow |V[G]|$
8 for (для) каждой вершины $u \in Adj[s]$
9 do $f[s,u] \leftarrow c(s,u)$
10 $f[u,s] \leftarrow -c(s,u)$
11 $e[u] \leftarrow c(s,u)$

В массиве $h$ хранятся высоты, в массиве $e$ — избытки, $c(u,v)$ — пропускные способности (считаем, что они заданы так, что вычисление $c(u,v)$ требует времени $O(1)$). Поток записывается в массив $f$.

Поток по каждому ребру, выходящему из истока $s$, становится равным пропускной способности этого ребра. По остальным рёбрам поток равен 0. В каждой смежной с истоком вершине $v$ появляется избыток $e[v] = c(s,v)$. Начальная высота задается формулой
\[
h[u] = \begin{cases}
|V|, & \text{если } u = s, \\
0, & \text{в противном случае.}
\end{cases}
\]
Это действительно высотная функция, так как рёбра $(u,v)$, для которых $h[u] > h[v] + 1$, выходят только из истока ($u = s$), но эти рёбра насыщены и их нет в остаточной сети.

Программа Generic-Preflow-Push даёт общую схему алгоритма, основанного на проталкивании предпотока.

\textsc{Generic-Preflow-Push}
1 \textsc{Initialize-Preflow}
2 while (пока) возможны операции подъёма или проталкивания
3 до выполнить одну из этих операций

Следующая лемма показывает, что пока есть хоть одна переполненная вершина, какая-то из операций подъёма или проталкивания возможна.

Лемма 27.14 (В переполненной вершине возможно либо проталкивание, либо подъём)
Пусть $f$ — предпоток в сети $G = (V, E)$. Пусть $h$ — высотная функция для $f$ и вершина $u$ переполнена. Тогда в $u$ возможно либо проталкивание, либо подъём.

Доказательство