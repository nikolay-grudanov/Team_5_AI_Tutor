---
source_image: page_413.png
page_number: 413
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 77.20
tokens: 11607
characters: 2350
timestamp: 2025-12-24T06:40:07.022764
finish_reason: stop
---

Глава 21 Фибоначчиевы кучи

фибоначчиевы деревья обладают большей гибкостью, чем биномиальные (из них можно удалять некоторые вершины, откладывая перестройку дерева до удобного случая).

Как и динамические таблицы раздела 18.4, фибоначчиевы кучи являются примером структуры данных, разработанной с учётом амортизационного анализа (см. гл. 18, особенно разд. 18.3 о методе потенциала).

Мы предполагаем, что вы прочли предыдущую главу (о биномиальных кучах). Там была приведена таблица (рис. 20.1), где указаны оценки времени работы различных операций с биномиальными и фибоначчиевыми кучами.

Как и биномиальные кучи, фибоначчиевы кучи не обеспечивают эффективного выполнения поиска (SEARCH). Поэтому передавая вершину в качестве параметра, мы указываем не ключ вершины, а указатель на неё.

В разделе 21.1 мы определим фибоначчиевы кучи, обсудим их представление в программе и введём потенциальную функцию. В разделе 21.2 мы покажем, как реализовать операции, присущие сливаемым кучам, с оценками учётной стоимости, указанными в таблице (рис. 20.1). Оставшиеся две операции (DECREASE-KEY и DELETE) описаны в разделе 21.3. Наконец, в разделе 21.4 мы доказываем лемму, использованную при анализе построенных процедур.

21.1 Строение фибоначчиевой кучи

При использовании фибоначчиевых куч для хранения набора множеств каждое множество занимает несколько деревьев, корни которых связаны в список. Такой конгломерат мы будем называть фибоначчиевой кучей (Fibonacci heap). Таким образом, каждая фибоначчиева куча состоит из нескольких деревьев; для каждого хранимого множества отводится своя куча.

В каждом из деревьев, входящих в кучу, выполнено такое свойство: ключ каждой вершины не больше ключей её детей. Деревья, однако, более не обязаны быть биномиальными. Пример фибоначчиевой кучи приведён на рис. 21.1а.

В биномиальных деревьях на детях любой вершины фиксирован порядок; в фибоначчиевых деревьях такого порядка нет (дети любой вершины связаны в круговой двусторонний список, но порядок в нём несуществен). Как показано на рис. 21.1б, каждая вершина x содержит указатель p[x] на своего родителя и указатель child[x] на какого-нибудь из своих детей.

Дети вершины x связаны в двусторонний циклический список, называемый списком детей (child list) вершины x. Каждая вершина y этого списка имеет поля left[y] и right[y], указывающие на её соседей