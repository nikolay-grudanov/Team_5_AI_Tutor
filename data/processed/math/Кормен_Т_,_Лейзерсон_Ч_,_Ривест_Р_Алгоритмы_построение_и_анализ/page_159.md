---
source_image: page_159.png
page_number: 159
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 52.75
tokens: 11471
characters: 1424
timestamp: 2025-12-24T06:27:33.013026
finish_reason: stop
---

значение 1 и с вероятностью \(1/n\) — значения \(2, \ldots, n-1\). Поэтому

\[
T(n) = \frac{1}{n} \left( T(1) + T(n-1) + \sum_{q=1}^{n-1} (T(q) + T(n-q)) \right) + \Theta(n)
\]

(слагаемое, соответствующее \(q = 1\), входит дважды). Поскольку \(T(1) = \Theta(1)\) и \(T(n) = O(n^2)\), имеем

\[
\frac{1}{n}(T(1) + T(n-1)) = \frac{1}{n}(\Theta(1) + O(n^2)) = O(n).
\]

Поэтому слагаемые \(T(1)\) и \(T(n-1)\) в первой скобке (8.2) можно включить в \(\Theta(n)\). С учётом этого получаем

\[
T(n) = \frac{1}{n} \sum_{q=1}^{n-1} (T(q) + T(n-q)) + \Theta(n).
\]

Поскольку каждое слагаемое \(T(k)\), где \(k = 1, \ldots, n-1\), встречается в сумме дважды, её можно переписать так:

\[
T(n) = \frac{2}{n} \sum_{k=1}^{n-1} T(k) + \Theta(n).
\]

Решение рекуррентного соотношения

Соотношение (8.4) можно решить, используя метод подстановки. Предположим, что \(T(n) \leq an \lg n + b\), где константы \(a > 0\) и \(b > 0\) пока неизвестны, и попытаемся доказать это по индукции. При \(n = 1\) это верно, если взять достаточно большие \(a\) и \(b\). При \(n > 1\) имеем

\[
\begin{align*}
T(n) &= \frac{2}{n} \sum_{k=1}^{n-1} T(k) + \Theta(n) \\
&\leq \frac{2}{n} \sum_{k=1}^{n-1} (ak \lg k + b) + \Theta(n) \\
&= \frac{2a}{n} \sum_{k=1}^{n-1} k \lg k + \frac{2b}{n}(n-1) + \Theta(n).
\end{align*}
\]

Ниже мы покажем, что первую сумму можно оценить так:

\[
\sum_{k=1}^{n-1} k \lg k \leq \frac{1}{2} n^2 \lg n - \frac{1}{8} n^2.
\]