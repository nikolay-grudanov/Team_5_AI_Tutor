---
source_image: page_576.png
page_number: 576
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.87
tokens: 11726
characters: 2493
timestamp: 2025-12-24T06:47:46.073480
finish_reason: stop
---

Если программа Generic-Preflow-Push, применённая к сети \( G = (V, E) \) с истоком \( s \) и стоком \( t \) останавливается, то получающийся предпоток \( f \), будет максимальным потоком для \( G \).

Доказательство
Лемма 27.14 гарантирует, что в момент остановки переполненных вершин в сети нет (избыток в каждой равен нулю). Значит, в этот момент предпоток является потоком. По лемме 27.16 функция \( h \) будет высотной функцией, и потому (лемма 27.17) в остаточной сети \( G_f \) нет пути из \( s \) в \( t \). По теореме о максимальном потоке и минимальном разрезе поток \( f \) максимален.

Анализ метода
Чтобы убедить, что алгоритм проталкивания предпотока останавливается, укажем верхние границы отдельно для числа подъёмов, насыщающих и ненасыщающих проталкиваний. После этого станет ясно, что время работы алгоритма есть \( O(V^2 E) \).

Начнём с такой важной леммы:
Лемма 27.19
Пусть \( G = (V, E) \) — сеть с истоком \( s \) и стоком \( t \), а \( f \) — предпоток в \( G \). Тогда для любой переполненной вершины и найдется простой путь из \( u \) в \( s \) в остаточной сети \( G_f \).

Доказательство.
Жидкость, сливающаяся в вершине \( u \), попадает туда из истока \( s \) по какому-то пути: существует путь из \( s \) в \( u \), по рёбрам которого идёт положительный поток. (Формально можно рассуждать так: рассмотрим множество \( U \) тех вершин, из которых в \( u \) можно пройти по рёбрам с положительным потоком. Если среди них нет истока, то в \( U \) ни по каким рёбрам жидкость не выходит. Отсюда следует, что \( e(U) \) (сумма всех избытков вершин в \( U \)), равная \( f(V, U) = f(V \setminus U, U) + f(U, U) = f(V \setminus U, U) \leq 0 \), так что все избытки равны 0.)

Итак, возьмём путь из \( s \) в \( u \), по всем рёбрам которого идёт положительный поток, и обратим его рёбра. Обратные рёбра входят в остаточную сеть. Для доказательства утверждения леммы остаётся удалить циклы (если они есть).

Следующая лемма ограничивает высоту вершины, и тем самым число возможных подъёмов.
Лемма 27.20
При исполнении программы Generic-Preflow-Push высота любой вершины \( v \in V \) никогда не превзойдёт \( 2|V| - 1 \).

Доказательство
По определению высоты \( h[s] = |V| \) и \( h[t] = 0 \). Подъём применим только к переполненным вершинам — посмотрим, на какой высоте они могут быть. Пусть \( u \) — переполненная вершина. По лемме 27.19, в \( G_f \) существует простой путь \( p \) из этой вершины в \( s \). По определению высотной функции, высота не может убывать