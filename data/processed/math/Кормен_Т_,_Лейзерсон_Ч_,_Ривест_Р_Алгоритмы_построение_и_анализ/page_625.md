---
source_image: page_625.png
page_number: 625
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.94
tokens: 11691
characters: 2109
timestamp: 2025-12-24T06:49:57.363417
finish_reason: stop
---

стеме: при этом становится ясным, что он представляет собой вариант умножения в столбик. Строки, в которых слева появляется нечётное число, соответствуют единичным разрядам в \(a\), их вклад в сумму есть умноженное на соответствующую степень двойки число \(b\) (см. рис. 29.18 (b)).

Рисунок 29.18 29.18 Умножение 19 на 29 с помощью русского народного алгоритма. В колонке \(a\) каждое следующее число получается из предыдущего делением на 2 (остаток отбрасывается), а в колонке \(b\)-умножением на 2. Складываются числа из правой колонки, напротив которых стоят нечётные числа в левой (выделены серым цветом). (а) Сложение в десятичной системе. (б) То же в двоичной системе.

29.4.5 Простая реализация

Простой вариант реализации русского народного алгоритма в виде тактированной схемы умножения \(n\)-битовых чисел показан на рис. 29.19 (а). В нём используется \(2n\) групп по 3 регистра. Верхние регистры хранят биты сомножителя \(a\), средние отвечают за сомножитель \(b\), а в нижних постепенно формируется произведение \(p\). Содержимое \(i\)-го \(a\)-registра перед \(j\)-м шагом обозначается \(a_i^{(j)}\); аналогично для \(b\) и \(p\). Вместе все биты в \(a\)-registрах образуют двоичную запись числа, которое обозначается \(a^{(j)}\) (по состоянию перед \(j\)-м шагом); обозначения \(b^{(j)}, p^{(j)}\) имеют аналогичный смысл.

Шаги работы нумеруются числами от 0 до \(n-1\). Вначале \(a^{(0)} = a,\ b^{(0)} = b\) и \(p^{(0)} = 0\). Поддерживается инвариант

\[
a^{(j)} \cdot b^{(j)} + p^{(j)} = a \cdot b
\]

(см. упражнение 29.4-2). На \(j\)-м шаге производятся следующие действия:

1. Если \(a_0^{(j)} = 1\) (т. е. \(a^{(j)}\) нечётно), то \(p^{(j+1)} = p^{(j)} + b^{(j)}\), иначе \(p^{(j+1)} = p^{(j)}\).

2. Число \(a\) сдвигается вправо на одну позицию (делится на 2 с остатком):

\[
a_i^{(j+1)} = \begin{cases}
a_{i+1}^{(j)} & \text{если } 0 \leq i \leq 2n-2 \\
0 & \text{если } i = 2n-1
\end{cases}
\]

3. Число \(b\) сдвигается влево на одну позицию (умножается на 2):

\[
b_i^{(j+1)} = \begin{cases}
a_{i-1}^{(j)} & \text{если } 1 \leq i \leq 2n-1 \\
0 & \text{если } i = 0
\end{cases}
\]