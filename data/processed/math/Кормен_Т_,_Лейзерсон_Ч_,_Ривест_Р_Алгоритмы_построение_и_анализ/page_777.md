---
source_image: page_777.png
page_number: 777
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 46.26
tokens: 11507
characters: 1960
timestamp: 2025-12-24T06:56:46.447349
finish_reason: stop
---

**Глава 34 Поиск подстрок**

подстроки \( P[1..m] \). Если \( T[1..n] \) — произвольный текст, то

\[
\varphi(T_i) = \sigma(T_i)
\]

для \( i = 0, 1, \ldots, n \).

Доказательство.
Для \( i = 0 \) это соотношение очевидно. Лемма 34.3 и формула (34.3) для функции перехода показывают, что оно сохраняется при прочтении автоматом очередного символа.

В силу доказанной теоремы, автомат после прочтения \( i \) символов текста находится в состоянии \( q \) тогда и только тогда, когда \( P_q \) является самым длинным суффиксом строки \( T_i \), являющимся одновременно префиксом строки \( P \). В частности, \( q = m \) означает, что автомат только что прочёл подстроку \( P \).
Это доказывает правильность алгоритма Finite-Automaton-Matcher.

**34.3.3 Вычисление функции перехода**

Функцию перехода \( \delta \), соответствующую образцу \( T[1..m] \), можно вычислить так:

Compute-Transition-Function(P,\Sigma)
1 m \gets length[P]
2 for q \gets 0 to m
3   do for (для) всех символов a \in \Sigma
4     do k \gets \min(m+1, q+2)
5     repeat k \gets k-1
6     until P_k \sqsupseteq P_qa
7     \delta(q,a) \gets k
8 return \delta

Эта процедура вычисляет функцию \( \delta \) "в лоб": циклы, начинающиеся в строках 2 и 3, перебирают все пары \( (q, a) \), а в строках 4–7 наибольшее значение \( k \), при котором для данной пары \( (q, a) \) выполнено соотношение \( P_k \sqsupseteq P_qa \), находится прямым перебором, начиная с наибольшего априори возможного значения \( k \), то есть \( \min(m, q + 1) \).

Время работы этого алгоритма есть \( O(m^3|\Sigma|) \): в самом деле, два внешних цикла дают множитель \( m|\Sigma| \), внутренний цикл repeat может выполняться не более \( m + 1 \) раз, и сравнение в строке 6 требует \( O(m) \) операций. На самом деле функцию перехода можно вычислить гораздо быстрее, за время \( O(m|\Sigma|) \) (см. упр. 34.4-6). В этом случае время поиска образца длины \( m \) в тексте длины \( n \) будет \( O(n + m|\Sigma|) \).