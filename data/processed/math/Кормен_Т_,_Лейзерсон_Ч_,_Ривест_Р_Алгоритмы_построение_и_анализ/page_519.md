---
source_image: page_519.png
page_number: 519
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.44
tokens: 11843
characters: 2389
timestamp: 2025-12-24T06:45:06.771348
finish_reason: stop
---

(e) Объясните, как за время \( O(E) \) вычислить все значения \( \delta_i(s, v) \), зная \( \delta_{i-1}(s, v) \). Как вычислить \( \delta(s, v) \) (для всех \( v \in V \)) за время \( O(E \lg W) \)?

25-5 Алгоритм Карпа для отыскания цикла с минимальным средним весом

Пусть \( G = (V, E) \) — ориентированный граф с весовой функцией \( w : E \to \mathbb{R} \), и пусть \( n = |V| \). Средним весом (mean weight) цикла \( c = \langle e_1, e_2, \ldots, e_k \rangle \), где \( e_j \) — ребра графа, назовем число

\[
\mu(c) = \frac{1}{k} \sum_{i=1}^k w(e_i).
\]

Пусть \( \mu^* = \min_c \mu(c) \), где \( c \) пробегает все (ориентированные) циклы. В этой задаче мы опишем эффективный алгоритм для вычисления \( \mu^* \).

Не ограничивая общности, будем считать, что каждая вершина \( v \in V \) достижима из некоторой вершины \( s \). Через \( \delta(s, v) \) обозначим вес кратчайшего пути из \( s \) в \( v \); пусть \( \delta_k(s, v) \) — вес кратчайшего пути из \( s \) в \( v \), состоящего в точности из \( k \) рёбер (если такого пути нет, полагаем \( \delta_k(s, v) = \infty \)).

(а) Пусть \( \mu^* = 0 \). Покажите, что \( G \) не содержит циклов отрицательного веса и что \( \delta(s, v) = \min_{0 \leq k \leq n-1} \delta_k(s, v) \) для всех \( v \in V \).

(б) Пусть \( \mu^* = 0 \). Покажите, что

\[
\max_{0 \leq k \leq n-1} \frac{\delta_n(s, v) - \delta_k(s, v)}{n - k} \geq 0
\]

для любой вершины \( v \in V \) (Указание: воспользуйтесь двумя утверждениями предыдущего пункта.)

(в) Пусть \( u \) и \( v \) — две вершины, лежащие на цикле нулевого веса. Пусть вес участка этого цикла от \( u \) до \( v \) равен \( x \). Покажите, что \( \delta(s, v) = \delta(s, u) + x \) (Указание: вес участка от \( v \) до \( u \) равен \( -x \)).

(г) Пусть \( \mu^* = 0 \). Покажите, что существует вершина \( v \), лежащая на цикле с минимальным средним весом, такая, что

\[
\max_{0 \leq k \leq n-1} \frac{\delta_n(s, v) - \delta_k(s, v)}{n - k} = 0
\]

(Указание: покажите, что кратчайший путь от \( s \) до вершины, лежащей на цикле с нулевым весом, можно продолжить вдоль этого цикла так, что он останется кратчайшим.)

(д) Пусть \( \mu^* = 0 \). Покажите, что

\[
\min_{v \in V} \max_{0 \leq k \leq n-1} \frac{\delta_n(s, v) - \delta_k(s, v)}{n - k} = 0.
\]

(е) Покажите, что

\[
\mu^* = \min_{v \in V} \max_{0 \leq k \leq n-1} \frac{\delta_n(s, v) - \delta_k(s, v)}{n - k}
\]