---
source_image: page_754.png
page_number: 754
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.19
tokens: 11687
characters: 2301
timestamp: 2025-12-24T06:55:52.751868
finish_reason: stop
---

Покажем, что любой плохой элемент а принадлежит В. Посмотрим на последовательность \( \hat{a} \), порождённую плохим элементом, и двигаясь справа налево. На её последнем месте стоит единица. Перед единицей может стоять либо ещё одна единица, либо число \(-1\) (иначе был бы обнаружен нетривиальный корень из единицы и элемент а не был бы плохим). При этом число \(-1\) может появиться лишь в позиции \(j\) или левее (так как \(j\) было выбрано максимальным). Значит, в \(j\)-ой позиции находится либо 1, либо \(-1\), то есть \(a \in B\).

Теперь мы воспользуемся существованием элемента \(v\), чтобы показать, что \(B\) является собственной подгруппой, построив \(w \in \mathbb{Z}_n^* \setminus B\). По следствию 33.29 из \(v^{2^j u} \equiv -1 \pmod{n}\) следует, что \(v^{2^j u} \equiv -1 \pmod{n_1}\). По следствию 33.28 найдётся элемент \(w\), для которого одновременно выполнены условия

\[
\begin{align*}
w &\equiv v \pmod{n_1}, \\
w &\equiv 1 \pmod{n_2}.
\end{align*}
\]

Тогда

\[
\begin{align*}
w^{2^j u} &\equiv -1 \pmod{n_1}, \\
w^{2^j u} &\equiv 1 \pmod{n_2},
\end{align*}
\]

откуда видно (следствие 33.29), что

\[
w^{2^j u} \not\equiv \pm 1 \pmod{n},
\]

(33.46)

Из двух последних сравнений по модулям \(n_1\) и \(n_2\) видно, что \(w\) взаимно просто с \(n_1\) и с \(n_2\) и тем самым взаимно просто с \(n\). Следовательно, \(w\) принадлежит \(\mathbb{Z}_n^* \setminus B\), что завершает доказательство теоремы — мы установили, что все плохие элементы принадлежат собственной подгруппе, и потому их число не превосходит \((n-1)/2\).

Теорема 33.39
Для нечётного \(n > 2\) нечётно и для любого целого положительного \(s\) вероятность ошибки процедуры Miller-Rabin\((n, s)\) не превосходит \(2^{-s}\).

Доказательство
Для простого \(n\) вообще не может быть ошибки. Если же \(n\) составное, то по теореме 33.38 при каждом случайном выборе \(a\) в строке 2 мы с вероятностью \(1/2\) или более обнаружим свидетеля того, что \(n\) составное. Поэтому вероятность того, что этого не произойдёт при \(s\) (независимых) попытках, не превосходит \(2^{-s}\).

Взяв, например, \(s = 50\), мы получим вероятность ошибки \(2^{-50}\). Такими малыми вероятностями на практике обычно пренебрегают. Если применять тест к случайно выбранному числу, то вероятность ошибки будет ещё меньше. Дело в том, что