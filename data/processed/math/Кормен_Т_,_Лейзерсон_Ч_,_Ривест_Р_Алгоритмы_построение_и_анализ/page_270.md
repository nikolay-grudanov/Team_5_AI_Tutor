---
source_image: page_270.png
page_number: 270
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.17
tokens: 11461
characters: 1950
timestamp: 2025-12-24T06:32:50.808209
finish_reason: stop
---

Рисунок 14.6 Случаи 2 и 3 в процедуре RB-INSERT. Как и для случая 1, нарушено свойство 3 красно-чёрных деревьев, так как вершина x и её родитель p[x] — красные. Корни деревьев \( \alpha, \beta, \gamma \) и \( \delta \) — чёрные; эти деревья имеют одинаковую чёрную высоту. Оба вращения, показанные на рисунке, не меняют число чёрных вершин на пути от корня к листьям. После этого мы выходим из цикла: RB-свойства выполнены всюду.

правым. Если правым, исполняются строки 12–13 (случай 2). В этом случае выполняется левое вращение, которое сводит случай 2 к случаю 3. когда x является левым ребёнком (рис. 14.6), Так как и x, и p[x] красные, после вращения количества чёрных вершин на путях остаются прежними.

Итак, осталось рассмотреть случай 3: красная вершина x является левым ребёнком красной вершины p[x], которая является левым ребёнком чёрной вершины p[p[x]], правым ребёнком которой является чёрная вершина y. В этом случае достаточно произвести правое вращение и перекрасить две вершины, чтобы устранить нарушение RB-свойств. Цикл больше не выполняется, так как вершина p[x] теперь чёрная.

Каково время выполнения процедуры RB-INSERT? Высота красно-чёрного дерева есть \( O(\lg n) \), если в дереве n вершин, поэтому вызов Tree-Insert требует времени \( O(\lg n) \). Цикл повторяется, только если мы встречаем случай 1, и при этом x сдвигается вверх по дереву. Таким образом, цикл повторяется \( O(\lg n) \) раз, и общее время работы есть \( O(\lg n) \). Интересно, что при этом выполняется не более двух вращений (после которых мы выходим из цикла).

Упражнения

14.3-1 В строке 2 процедуры RB-INSERT мы красим новую вершину x в красный цвет. Если бы мы покрасили её в черный цвет, свойство 3 не было бы нарушено. Почему же мы этого не сделали?

14.3-2 В строке 18 мы красим корень дерева в чёрный цвет. Зачем это делается?

14.3-3 Нарисуйте красно-чёрные деревья, которое получаются при последовательном добавлении к пустому дереву ключей