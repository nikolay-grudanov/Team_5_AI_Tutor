---
source_image: page_262.png
page_number: 262
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.92
tokens: 11323
characters: 1614
timestamp: 2025-12-24T06:32:16.837384
finish_reason: stop
---

14 Красно-чёрные деревья

В главе 13 мы показали, что основные операции с двоичным деревом поиска высоты \( h \) могут быть выполнены за \( O(h) \) действий. Деревья эффективны, если их высота мала — но малая высота не гарантируется, и в худшем случае деревья не более эффективны, чем списки. Красно-чёрные деревья — один из типов "сбалансированных" деревьев поиска, в которых предусмотрены операции балансировки, гарантирующие, что высота дерева не превзойдёт \( O(\lg n) \).

14.1 Свойства красно-чёрных деревьев

Красно-чёрное дерево (red-black tree) — это двоичное дерево поиска, вершины которого разделены на красные (red) и чёрные (black). Таким образом, каждая вершина хранит один дополнительный бит — её цвет.

При этом должны выполняться определённые требования, которые гарантируют, что глубины любых двух листьев отличаются не более чем в два раза, поэтому дерево можно назвать сбалансированным (balanced).

Каждая вершина красно-чёрного дерева имеет поля color (цвет), key (ключ), left (левый ребёнок), right (правый ребёнок) и p (родитель). Если у вершины отсутствует ребёнок или родитель, соответствующее поле содержит NIL. Для удобства мы будем считать, что значения NIL, хранящиеся в полях left и right, являются ссылками на дополнительные (фиктивные) листья дерева. В таком пополненном дереве каждая старая вершина (содержащая ключ) имеет двух детей.

Двоичное дерево поиска называется красно-чёрным деревом, если оно обладает следующими свойствами (будем называть их RB-свойствами, по-английски red-black properties):

1. Каждая вершина — либо красная, либо чёрная.
2. Каждый лист (NIL) — чёрный.