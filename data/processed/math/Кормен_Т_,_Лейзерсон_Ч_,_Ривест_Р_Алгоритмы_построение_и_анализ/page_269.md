---
source_image: page_269.png
page_number: 269
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.26
tokens: 11522
characters: 2087
timestamp: 2025-12-24T06:32:55.174403
finish_reason: stop
---

Добывление вершины

Рисунок 14.5 Случай 1. Нарушен свойство 3: x и его родитель — красные. Наши действия не зависят от того, является ли x правым (а) или левым (б) сыном. Все поддеревья \( \alpha, \beta, \gamma, \delta \) и \( \varepsilon \) имеют чёрный корень и одинаковую чёрную высоту. Процедура меняет цвет вершины \( p[p[x]] \) и её детей. Цикл продолжается после присваивания \( x \leftarrow p[p[x]] \); свойство 3 может быть нарушено только между красной вершиной \( p[p[x]] \) и её родителем (если он тоже красный).

Внутри цикла рассматриваются шесть случаев, но три из них симметричны трём другим, различия лишь в том, является ли родитель вершины x левым или правым ребёнком своего родителя. Эти случаи разделяются в строке 4. Мы выписали фрагмент процедуры для случая, когда \( p[x] \) — левый ребёнок своего родителя. (Симметричные случаи относятся к строке 17.)

Мы будем предполагать, что во всех рассматриваемых нами красно-чёрных деревьях корень чёрный (и поддерживать это свойство — для этого используется строка 18). Поэтому в строке 4 красная вершина \( p[x] \) не может быть корнем (\( p[p[x]] \) существует).

Операции внутри цикла начинаются с нахождения вершины y, которая является "дядей" вершины x (имеет того же родителя, что и вершина \( p[x] \)). Если вершина y красная, имеет место случай 1, если чёрная — то один из случаев 2 и 3. Во всех случаях вершина \( p[p[x]] \) чёрная, так как пара \( x—p[x] \) была единственным нарушением RB-свойств.

Случай 1 (строки 7–10) показан на рис. 14.5. Эта часть текста исполняется, если и \( p[x] \), и y красные. При этом вершина \( p[p[x]] \) — чёрная. Перекрасим \( p[x] \) и y в чёрный цвет, а \( p[p[x]] \) — в красный. При этом число чёрных вершин на любом пути из корня к листьям останется прежним. Нарушение RB-свойства возможно в единственном месте нового дерева: у \( p[p[x]] \) может быть красный родитель. Поэтому надо продолжить выполнение цикла, присвоив x значение \( p[p[x]] \).

В случаях 2 и 3 вершина y чёрная. Эти два случая различаются тем, каким ребёнком x приходится своему родителю — левым или