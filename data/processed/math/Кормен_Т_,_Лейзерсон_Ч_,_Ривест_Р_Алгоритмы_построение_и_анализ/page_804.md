---
source_image: page_804.png
page_number: 804
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 43.27
tokens: 11544
characters: 2401
timestamp: 2025-12-24T06:57:54.591871
finish_reason: stop
---

Есть ли пересекающиеся отрезки?

Процедура ANY-SEGMENT-INTERSECT(S) возвращает TRUE в том и только том случае, когда среди отрезков множества S есть пересекающиеся.
Доказательство.
Заметим, что значение TRUE возвращается лишь после того, как обнаружены два пересекающихся отрезка. Поэтому надо лишь проверить, что если в S есть пара пересекающихся отрезков, то она будет обнаружена.
Предположим теперь, что алгоритм не возвращает значения TRUE, а просматривает по очереди все концы отрезков, не находит пересечения и возвращает значение FALSE. Покажем, что в таком случае отрезки не пересекаются.
Рассмотрим сначала случай, когда концы всех отрезков имеют различные абсциссы. Тогда на каждой итерации цикла рассматривается новое значение абсциссы. Докажем, что при этом остаются верными такие свойства:
(a) множество T соответствует положению прямой непосредственно справа от последней обработанной абсциссы;
(b) соседние в множестве T отрезки не пересекаются.
Вначале эти свойства выполнены (T пусто, движущаяся прямая не пересекает ни одного из отрезков, находясь слева от всех них). Проверим, что они остаются выполненными после прохода через один из концов (другими словами, после очередной итерации цикла).
Если очередная точка есть левый конец отрезка, то появляется новая точка пересечения с движущейся прямой. Начинающийся в ней отрезок не пересекается с соседними (в смысле текущего состояния множества T) отрезками, иначе это было бы обнаружено. Остальные пары соседних отрезков были соседними раньше, так что мы уже знаем, что они не пересекаются.
Раз соседние отрезки не пересекаются, то на участке до следующего значения абсциссы в списке относительный порядок сохраняется (точка пересечения может быть только у нesоседних отрезков и только после конца того отрезка, который их разделял).
Пусть теперь очередная точка есть правый конец отрезка. Тогда из множества T удаляется элемент (как и полагается, если мы хотим, чтобы T соответствовало положению прямой справа от очередной точки). Появляется новая пара соседних отрезков — про которую алгоритм проверяет, что они не пересекаются. По тем же причинам, что и раньше, можно утверждать, что до следующего значения абсциссы относительный порядок сохраняется.
Итак, свойства (a) и (b) проверены, и заодно доказано, что никакие два отрезка не пересекаются. В самом деле, раз между рассматриваемыми абсциссами порядок сохраняется, между ними