---
source_image: page_557.png
page_number: 557
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 60.74
tokens: 11633
characters: 2154
timestamp: 2025-12-24T06:46:49.804799
finish_reason: stop
---

**Глава 27 Максимальный поток**

Поиск максимального потока методом Форда-Фалкерсона проводится последовательно. Вначале поток нулевой (и величина его равна нулю). На каждом шаге мы увеличиваем значение потока. Для этого мы находим "дополняющий путь", по которому можно пропустить ещё немного вещества, и используем его для увеличения потока. Этот шаг повторяется, пока есть дополняющие пути. Как покажет теорема о максимальном потоке и минимальном разрезе, полученный поток будет максимальным. Запишем этот план с помощью псевдокода:

Ford-Fulkerson-Method($G,s,t$)

1 положить поток $f$ равным $0$
2 while (пока) существует дополняющий путь $p$
3 do дополнить $f$ вдоль $p$
4 return $f$

**Остаточные сети**
Пусть дана сеть и поток в ней. Неформально говоря, остаточная сеть состоит из тех рёбер, поток по которым можно увеличить. Строгое определение таково: пусть $G = (V, E)$ — сеть с истоком $s$ и стоком $t$. Пусть $f$ — поток в этой сети. Для любой пары вершин $u$ и $v$ рассмотрим остаточную пропускную способность (residual capacity) из $u$ в $v$, определяемую как

\[
c_f(u, v) = c(u, v) - f(u, v).
\]

Она определяет, сколько ещё потока можно направить из $u$ в $v$. Например, если $c(u, v) = 16$, а $f(u, v) = 11$ то мы можем переслать ещё $c_f(u, v) = 5$ единиц по ребру $(u, v)$. Остаточная пропускная способность $c_f(u, v)$ может превосходить $c(u, v)$, если в данный момент поток $f(u, v)$ отрицателен. Например, если $c(u, v) = 16$, а $f(u, v) = -4$, то $c_f(u, v) = 20$. В самом деле, мы можем увеличить поток на 4, отменив встречный поток, и ещё отправить 16 единиц, не превышая пропускной способности ребра $(u, v)$.

Сеть $G_f = (V, E_f)$, где

\[
E_f = \{(u, v) \in V \times V : c_f(u, v) > 0\}
\]

назовём остаточной сетью (residual network) сети $G$, порождённой потоком $f$. Её рёбра, называемые остаточными рёбрами (residual edges) допускают положительный поток. На рис. 27.4 (a) изображён поток $f$ в сети $G$ (взятый с рис. 27.1 (b)), а на рис. 27.4 (b) изображена остаточная сеть $G_f$.

Заметим, что остаточное ребро $(u, v)$ не обязано быть ребром сети $G$. Иными словами, может оказаться, что $E_f \not\subseteq E$. Рёбер