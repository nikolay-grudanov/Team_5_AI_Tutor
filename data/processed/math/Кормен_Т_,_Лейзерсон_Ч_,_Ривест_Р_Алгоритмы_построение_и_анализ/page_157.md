---
source_image: page_157.png
page_number: 157
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.83
tokens: 11454
characters: 1670
timestamp: 2025-12-24T06:27:28.974217
finish_reason: stop
---

8.4 Анализ быстрой сортировки

В этом разделе мы превратим "интуитивные" соображения раздела 8.2 в строгое рассуждение. Сначала мы рассмотрим наихудший случай (рассуждения будут одинаковы и для алгоритма Quicksort, и для алгоритма Randomized-Quicksort), а затем найдём среднее время работы алгоритма Randomized-Quicksort.

8.4.1 Анализ наихудшего случая

В разделе 8.2 мы видели, что если разбиение на каждом шаге наиболее несбалансировано, то время работы составляет \( \Theta(n^2) \). Интуитивно ясно, что это наихудший (в смысле времени работы) случай. Сейчас мы строго докажем это.

Для доказательства того, что время работы составляет \( O(n^2) \), мы используем метод подстановки (см. разд. 4.1). Пусть \( T(n) \) — наибольшее время работы алгоритма для массива длины \( n \). Тогда, очевидно,

\[
T(n) = \max_{1 \leq q \leq n-1} (T(q) + T(n-q)) + \Theta(n)
\]

(мы рассматриваем все возможные разбиения на первом шаге). Предположим, что \( T(q) \leq cq^2 \) для некоторой константы \( c \) и для всех \( q \), меньших некоторого \( n \). Тогда

\[
T(n) \leq \max_{1 \leq q \leq n-1} (cq^2 + c(n-q)^2) + \Theta(n) = c \cdot \max_{1 \leq q \leq n-1} (q^2 + (n-q)^2) + \Theta(n).
\]

Квадратный трёхчлен \( q^2 + (n-q)^2 \) достигает максимума на отрезке \( 1 \leq q \leq n-1 \) в его концах (вторая производная по \( q \) положительна, поэтому функция выпукла вниз, см. упр. 8.4-2). Этот максимум равен \( 1^2 + (n-1)^2 = n^2 - 2(n-1) \). Отсюда получаем

\[
T(n) \leq cn^2 - 2c(n-1) + \Theta(n) \leq cn^2,
\]

если константа \( c \) выбрана так, чтобы последнее слагаемое было меньше предпоследнего. Итак, время работы в худшем случае составляет \( \Theta(n^2) \).