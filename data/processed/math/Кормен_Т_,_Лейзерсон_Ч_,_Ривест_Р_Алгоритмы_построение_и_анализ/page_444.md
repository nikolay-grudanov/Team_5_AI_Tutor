---
source_image: page_444.png
page_number: 444
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 53.36
tokens: 11671
characters: 2359
timestamp: 2025-12-24T06:41:13.044146
finish_reason: stop
---

Пусть \( x \) — вершина одного из наших деревьев. Число вершин в поддереве с корнем \( x \) (включая саму \( x \)) назовем ее размером (size) и обозначим \( \mathrm{size}(x) \).

Лемма 22.3
Если \( x \) — корень одного из деревьев, то \( \mathrm{size}(x) \geq 2^{rank[x]} \).
Доказательство.
Достаточно проверить, что каждая из операций Make-Set, Find-Set и Link сохраняет истинность утверждения " \( \mathrm{size}(x) \geq 2^{rank[x]} \) для всех корней \( x \)". Операция Find-Set не меняет ни размеров корней, ни рангов каких бы то ни было вершин. Операция Make-Set(\( x \)) также не нарушает утверждения леммы: не меняя рангов и размеров уже существующих деревьев, она создаёт новое дерево с единственной вершиной, для которой неравенство очевидным образом выполнено.

Рассмотрим операцию Link(\( x, y \)) (не ограничивая общности, можно считать, что \( rank[x] \leq rank[y] \)). В результате этой операции ранг или размер может измениться только у вершины \( y \). Если \( rank[x] < rank[y] \), то размер \( y \) увеличивается, а ранг не меняется, так что неравенство \( \mathrm{size}(y) \geq 2^{rank[y]} \), остаётся верным. Если же \( rank[x] = rank[y] \), то, обозначая через \( \mathrm{size}'[y] \) и \( rank'[y] \) размер и ранг \( y \) после операции Link, имеем \( \mathrm{size}'[y] = \mathrm{size}[x] + \mathrm{size}[y] \) и \( rank'[y] = rank[y] + 1 \). Отсюда

\[
\mathrm{size}'[y] = \mathrm{size}[x] + \mathrm{size}[y] \geq 2^{rank[x]} + 2^{rank[y]} = 2^{rank[y]+1} = 2^{rank'[y]}.
\]

Лемма 22.4
Число вершин ранга \( r \) не превосходит \( n/2^r \) (для любого целого \( r \geq 0 \)).
Доказательство.
Зафиксируем число \( r \). Всякий раз, когда какой-либо вершине \( y \) присваивается ранг \( r \) (в строке 2 процедуры Make-Set или в строке 5 процедуры Link), будем привешивать метку ко всем вершинам поддерева с вершиной \( y \). Поскольку вершина \( y \) в этот момент является корнем одного из деревьев, лемма 22.3 показывает, что число помечаемых вершин не меньше \( 2^r \). Наши процедуры устроены так, что каждая вершина будет помечена не более одного раза. Стало быть,

\[
n \geq (\text{число меток}) \geq 2^r \cdot (\text{число вершин ранга } r),
\]
откуда всё и следует.

Следствие 22.5
Ранг любой вершины не превосходит \( \lfloor \lg n \rfloor \).
Доказательство.
См. лемму 22.3 или 22.4
Доказательство оценки для времени работы