---
source_image: page_619.png
page_number: 619
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 71.39
tokens: 11877
characters: 2274
timestamp: 2025-12-24T06:49:57.958228
finish_reason: stop
---

\[
v^{n-1} \text{ по } (2n-1) \text{ битов в каждом, при этом}
\]
\[
u^{(n-1)} + u^{(n-1)} = \sum_{i=0}^{n-1} m^{(i)} =
\]
\[
= p.
\]

Не все разряды чисел \( v^{(i)} \) используются: поскольку \( m_j^{(i)} = 0 \) при \( j = 0, \ldots, i-1, i+n, \ldots, 2n-1 \) и \( v_j^{(i)} = 0 \) при \( j = 0, \ldots, i, i+n, i+n+1, \ldots, 2n-1 \) (см. упражнение 29.3-1), на \( i \)-м шаге необходимо работать только с \( n-1 \) разрядами \( (i, i+1, \ldots, i+n-2) \). Вернёмся к матричному умножителю (рис. 29.14). Элементы AND (обозначенные \( G_j^{(i)} \)) вычисляют частичные произведения. Выходом элемента \( G_j^{(i)} \) будет бит \( m_j^{(i)} \), то есть \( j \)-ый бит \( i \)-го частичного произведения, так что \( i \)-ая строка AND-матрицы даёт \( n \) значащих битов частичного произведения \( m^{(i)} \) (с индексами \( n+i-1, n+i-2, \ldots, i \)).

Каждый ряд сумматоров \( FA_1^{(i)}, \ldots, FA_{n-1}^{(i)} \) совершает \( i \)-й шаг сложения с запоминанием переносов, вычисляя \( u^{(i)} \) и \( v^{(i)} \); элемент \( FA_j^{(i)} \) получает на вход биты \( m_j^{(i)}, u_j^{(i-1)} \) и \( v_j^{(i-1)} \) и выдаёт два бита \( u_j^{(i)} \) и \( v_{j+1}^{(i)} \). Заметьте, что в левой колонке \( u_{i+n-1}^{(i)} = m_{i+n-1}^{(i)} \), поэтому этот бит не нужно специально вычислять. На входах сумматоров в верхнем ряду фиксировано значение 0, так как одно из слагаемых равно нулю.

Теперь о выходных битах матричного умножителя. Как мы уже отмечали, \( v_j^{(n-1)} = 0 \) для \( j = 0, 1, \ldots, n-1 \). Поэтому \( p_j = u_j^{(n-1)} \) для \( j = 0, 1, \ldots, n-1 \). Более того, раз \( m_0^{(1)} = 0 \), то \( u_0^{(1)} = m_0^{(0)} \); поскольку \( i \) младших битов у чисел \( m^{(i)} \) и \( v^{(i-1)} \) равны 0, мы имеем \( u_j^{(i)} = u(i-1)_j \) для \( i = 2, 3, \ldots, n-1 \) и \( j = 0, 1, \ldots, i-1 \).

Следовательно, \( p_0 = m_0^{(0)} \) и далее \( p_i = u_i^i \) при \( i = 1, 2, \ldots, n-1 \).
Так определяются \( n \) младших разрядов произведения. Старшие разряды произведения вычисляются с помощью одной из схем предыдущего раздела:

\[
\langle p_{2n-1}, p_{2n-2}, \ldots, p_n \rangle =
\]
\[
= \langle u_{2n-2}^{(n-1)}, u_{2n-3}^{(n-1)}, \ldots, u_n^{(n-1)} \rangle + \langle v_{2n-2}^{(n-1)}, v_{2n-3}^{(n-1)}, \ldots, v_n^{(n-1)} \rangle.
\]