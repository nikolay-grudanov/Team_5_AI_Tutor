---
source_image: page_275.png
page_number: 275
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 68.49
tokens: 11614
characters: 2293
timestamp: 2025-12-24T06:33:25.394798
finish_reason: stop
---

Удаление

В случае 3 (строки 13–16, рис. 14.7в) вершина w чёрная, её левый ребёнок — красный, а правый — чёрный. Мы можем поменять цвета w и её левого ребёнка и потом применить правое вращение так, что RB-свойства будут сохранены. Новым братом вершины x теперь будет чёрная вершина с красным правым ребёнком, и мы свели случай 3 к случаю 4.

Наконец, в случае 4 (строки 17–21, рис. 17.4г) вершина w (брат вершины x) является чёрной, а её правый ребёнок — красный. Меняя некоторые цвета и производя левое вращение вокруг p[x], мы можем удалить излишнюю черноту у x, не нарушая RB-свойств. Присваивание x ← root[T] выводит нас из цикла.

Каково время выполнения процедуры RB-DELETE? Высота красно-чёрного дерева с n вершинами есть O(lg n), поэтому время исполнения RB-DELETE без учёта RB-DELETE-FIXUP есть O(lg n). Сколько времени требует цикл в процедуре RB-DELETE-FIXUP? Как только обнаруживается случай 1, 3 или 4, мы выходим из цикла (при этом выполняется O(1) операций и самое большое три вращения). До этого возможно несколько повторений случая 2, но при каждом повторении указатель x перемещается вверх по дереву и никакие вращения не производятся, так что число таких шагов есть O(lg n). Таким образом, процедура RB-DELETE-FIXUP требует времени O(lg n), и общее время работы процедуры RB-DELETE также есть O(lg n) (отметим ещё раз, что при этом производится не более трёх вращений).

Упражнения

14.4-1 Убедитесь, что после выполнения процедуры RB-DELETE корень дерева остаётся чёрным, если он таковым был.

14.4-2 В упр. 14.3-3 построено красно-чёрное дерево, которое получается добавлением ключей 41, 38, 31, 12, 19, 8 в пустое дерево. Нарисуйте деревья, которые получатся из него при последовательном удалении ключей 8, 12, 19, 31, 38, 41.

14.4-3 В каких строках процедуры RB-DELETE-FIXUP мы можем читать или изменять фиктивный элемент nil[T]?

14.4-4 Упростите процедуру LEFT-ROTATE, используя фиктивный элемент для представления NIL и ещё один фиктивный элемент, содержащий указатель на корень дерева.

14.4-5 Для каждого из случаев на рисунке 14.7 подсчитайте количество чёрных вершин от корня поддерева на рисунке до каждого из поддеревьев \( \alpha, \beta, \ldots, \zeta \) и убедитесь, что оно не меняется при преобразованиях. Используйте обозначение count(c) для "степени чер-