---
source_image: page_441.png
page_number: 441
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.02
tokens: 11667
characters: 2452
timestamp: 2025-12-24T06:41:08.112084
finish_reason: stop
---

но уже с параметром — родителем x, после чего делает родителем x корень дерева, найденный этим новым вызовом FIND-SET (строка 2). Если же x — корень, то строка 2 не исполняется, и сразу возвращается указатель на x.

Что дают эвристики

Даже будучи применёнными по отдельности, объединение по рангу и сжатие путей дают выигрыш во времени. Если применить объединение по рангу без сжатия путей, то оценка времени работы будет примерно такой же, как при списочной реализации с весовой эвристикой, а именно O(m lg n) (m — общее количество операций, n — количество операций Make-Set (упр. 22.4-3). Эта оценка неулучшаема (упр. 22.3-3). Если применить сжатие путей без объединения по рангу, то время исполнения последовательности операций, включающей n операций Make-Set и f операций Find-Set, есть (в худшем случае) \( \Theta(f \log_{1+f/n} n) \) при \( f \geq n \) и \( \Theta(n + f \lg n) \) при \( f < n \) (эти оценки мы доказывать не будем).

Еще большая экономия получится, если применить обе эвристики совместно. При этом время работы в худшем случае есть \( O(m \alpha(m, n)) \), где \( \alpha \) — чрезвычайно медленно растущая "обратная функция Аккермана", определяемая ниже в разделе 22.4. В любых мыслимых приложениях выполнено неравенство \( \alpha(m, n) \leq 4 \), так что на практике можно считать время работы линейным по m. В разд. 22.4 мы докажем чуть более слабую оценку \( O(m \lg^* n) \).

Упражнения
22.3-1
Сделайте упражнение 22.2-2, пользуясь реализацией с помощью леса со сжатием путей и объединением по рангам.
22.3-2
Напишите нерекурсивный вариант процедуры Find-Set.
22.3-3
Приведите пример последовательности m операций Make-Set, Union и Find-Set (в том числе n операций Make-Set, для которой время работы (при использовании объединения по рангу без сжатия путей) будет \( \Omega(m \lg n) \).
22.3-4*
Рассмотрим последовательность m операций Make-Set, Link и Find-Set, в которой все операции Find-Set идут после всех операций Link. Докажите, что при использовании объединения по рангам со сжатием путей время работы этой последовательности операций есть \( O(m) \). Что будет, если пользоваться только сжатием путей?
22.4* Объединение по рангам со сжатием путей: анализ
В этом разделе мы дадим определение "обратной функции Аккермана" \( \alpha(m, n) \), входящей в оценку \( O(m \alpha(m, n)) \) для стоимости m операций с системой непересекающихся множеств, реализованной с помощью леса с объединением по рангам и сжатием путей