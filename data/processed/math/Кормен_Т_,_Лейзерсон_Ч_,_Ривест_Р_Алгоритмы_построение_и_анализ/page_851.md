---
source_image: page_851.png
page_number: 851
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 49.80
tokens: 11592
characters: 2163
timestamp: 2025-12-24T07:00:08.875514
finish_reason: stop
---

Глава 36 NP-полнота

рядов заполнены двоиками. Более точно,

\[
t = k \cdot 4^{|E|} + \sum_{j=0}^{|E|-1} 2 \cdot 4^j.
\]

Все построенные числа имеют двоичное представление полиномиального размера и строятся за полиномиальное время.

Теперь нужно проверить, что граф G имеет вершинное покрытие размера k тогда и только тогда, когда в S существует подмножество S' с суммой t. Пусть дано вершинное покрытие V' \( \subseteq V \) требуемого размера, содержащее вершины i_1, i_2, ..., i_k. Включим в множество S' числа, соответствующие этим вершинам. Тогда сумма элементов множества S', записанная по основанию 4, будет выглядеть так: в старших разрядах стоит число k, а во всех младших разрядах стоят цифры 1 или 2 (в зависимости от того, оба конца ребра вошли в вершинное покрытие или только один). Взяв те рёбра, у которых только один конец вошёл в вершинное покрытие и добавив соответствующие им числа в множество S', мы превратим единицы в двойки, то есть получим в сумме число t. (На рис. 36.14 (c) потребовалось добавить четыре строки y_0, y_2, y_3, y_4, чтобы обеспечить недостающие двойки в младших разрядах.)

Обратное рассуждение аналогично. Пусть имеется множество S', сумма элементов которого равна t. Это значит, что в младших разрядах суммы стоят двойки. Поскольку строки, соответствующие рёбрам, могут дать в каждом разряде максимум единицу, но никак не двойку, это значит, что недостающая единица приходит от "вершинных" строк. Следовательно, вершины, соответствующие входящим в S' строкам, образуют вершинное покрытие. А старшие разряды гарантируют, что число вершин в этом покрытии равно k.

36.4.3 Задача о гамильтоновом цикле

Вернёмся к задаче о гамильтоновом цикле (HAM-CYCLE; мы говорили о ней в разделе 36.2).

Теорема 36.14
Задача HAM-CYCLE является NP-полной.
Доказательство
Мы уже объясняли, почему эта задача принадлежит классу NP (гамильтонов цикл можно считать сертификатом).
Чтобы доказать NP-полноту задачи HAM-CYCLE, мы покажем, что 3-CNF-SAT \( \leq_m \) PHAM-CYCLE. Другими словами, мы опишем алгоритм, преобразующий формулу \( \varphi \) из класса 3-CNF с переменными \( x_1, x_2, ..., x_n \) в граф \( G = (V, E) \), который имеет