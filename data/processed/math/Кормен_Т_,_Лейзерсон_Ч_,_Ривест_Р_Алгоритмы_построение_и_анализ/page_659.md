---
source_image: page_659.png
page_number: 659
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 73.43
tokens: 11855
characters: 2663
timestamp: 2025-12-24T06:51:54.913696
finish_reason: stop
---

Если \( r \) битами, то на \((k+1)\)-ом шаге они будут записываться всего \([\lg r] + 1\) битами. Если \( r \geq 4 \), то при этом число битов уменьшается. Если же \( r = 3 \), то два цвета могут различаться в разрядах 0, 1 или 2, поэтому на следующем шаге номер любого цвета будет начинаться с \( \langle 00 \rangle, \langle 01 \rangle \) или \( \langle 10 \rangle \) и оканчиваться нулем либо единицей. При этом из восьми цветов получается не более шести, так что мы приходим к 6-раскраске.

Если предположить, что операция поиска может найти нужный индекс и совершить левый сдвиг за время \( O(1) \), то каждый шаг занимает время \( O(1) \). Алгоритм можно реализовать на EREW-машине, так как каждому процессору необходим доступ лишь к двум объектам — х и next[x].

Покажем теперь, что число шагов до получения 6-раскраски составляет \( O(\lg^* n) \). Напомним, что \( \lg^* n \) определялось как число применений к \( n \) функции \( \lg \), после которых результат будет не больше 1. Более точно, если через \( \lg^{(i)} n \) обозначить \( i \)-кратное применение логарифма, то

\[
\lg^* n = \min \left\{ i \geq 0 : \lg^{(i)} n \leq 1 \right\}
\]

В нашем случае число битов на каждом шаге также логарифмируется, но затем округляется (с избытком) и увеличивается на 1. Проверим, что всё равно число шагов есть \( O(\lg^* n) \).

Пусть \( r_i \) — число битов, которыми записываются цвета перед \( i \)-м шагом. Мы докажем по индукции, что \( r_i \leq [\lg^{(i)} n] + 2 \) при \( [\lg^{(i)} n] \geq 2 \). Изначально \( r_1 \leq [\lg n] \). Пусть утверждение верно для \((i-1)\)-го шага. Поскольку \( r_i = [\lg r_{i-1}] + 1 \), имеем

\[
r_i = [\lg r_{i-1}] + 1 \leq [\lg([\lg^{(i-1)} n] + 2)] + 1 \leq [\lg(\lg^{(i-1)} n + 3)] + 1 \leq [\lg(2 \lg^{(i-1)} n)] + 1 = [\lg(\lg^{(i-1)} n) + 1] + 1 = [\lg^{(i)} n] + 2
\]

Четвёртое неравенство получается так: если \( [\lg^{(i)} n] \geq 2 \), то \( [\lg^{(i-1)} n] \geq 3 \), так что увеличение на 3 можно заменить умножением на 2. Поэтому для \( m = \lg^* n - 1 \) имеем \( r_m \leq [\lg^{(m-1)}] + 2 \leq 4 \), так как \( \lg^{(m+1)} n \leq 1 \) и \( \lg^{(m)} n \leq 2 \) по определению \( \lg^* n \). Значит, \( r_{m+1} \leq 3 \), и ещё через шаг процесс закончится. Таким образом, общее количество шагов составляет \( O(\lg^* n) \).

30.5.3 Получение максимального независимого множества из 6-раскраски

Пусть дан список из \( n \) объектов и его раскраска \( C \) в \( c \) цветов. Опишем EREW-алгоритм, который позволяет найти по этой раскраске максимальное независимое множество (MIS) за время \( O(c) \). В частности, зная 6-раскраску, можно найти максимальное независимое множество за время \( O(1) \).