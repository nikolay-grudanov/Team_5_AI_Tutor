---
source_image: page_054.png
page_number: 54
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.20
tokens: 11630
characters: 2148
timestamp: 2025-12-24T06:22:51.697209
finish_reason: stop
---

ответствующий \(3^{\log_4 n}\) задачам ограниченного размера):

\[
T(n) \leq n + 3n/4 + 9n/16 + 27n/64 + \ldots + 3^{\log_4 n} \Theta(1)
\]
\[
\leq n \sum_{i=0}^{\infty} \left(\frac{3}{4}\right)^i + \Theta(n^{\log_4 3})
\]
\[
= 4n + o(n) = O(n)
\]

(Мы заменили конечную сумму из не более чем \(\log_4 n + 1\) членов на сумму бесконечного ряда, а также переписали \(3^{\log_4 n}\) как \(n^{\log_4 3}\), что есть \(o(n)\), так как \(\log_4 3 < 1\).)

Часто преобразование рекуррентного соотношения в сумму приводит к довольно сложным выкладкам. При этом важно следить за двумя вещами: сколько шагов подстановки требуется и какова сумма членов, получающихся на данном шаге. Иногда несколько первых шагов позволяют отгадать ответ, который затем удаётся доказать по индукции (с меньшим количеством вычислений).

Особенно много хлопот доставляют округления (переход к целой части). Для начала стоит предположить, что значения параметра таковы, что округления не требуются (в нашем примере при \(n = 4^k\) ничего округлять не придётся). Вообще говоря, такое предположение не вполне законно, так как оценку надо доказать для всех достаточно больших целых чисел, а не только для степеней четвёрки. Мы увидим в разделе 4.3, как можно обойти эту трудность (см. также задачу 4-5).

Деревья рекурсии

Процесс подстановки соотношения в себя можно изобразить в виде дерева рекурсии (recursion tree). Как это делается, показано на рис. 4.1 на примере соотношения

\[
T(n) = 2T(n/2) + n^2.
\]

Для удобства предположим, что \(n\) — степень двойки. Двигаясь от (а) к (г), мы постепенно разворачиваем выражение для \(T(n)\), используя выражения для \(T(n), T(n/2), T(n/4)\) и т.д. Теперь мы можем вычислить \(T(n)\), складывая значения вершин на каждом уровне. На верхнем уровне получаем \(n^2\), на втором — \((n/2)^2 + (n/2)^2 = n^2/2\), на третьем — \((n/4)^2 + (n/4)^2 + (n/4)^2 + (n/4)^2 = n^2/4\). Получается убывающая геометрическая прогрессия, сумма которой отличается от её первого члена не более чем на постоянный множитель. Итак, \(T(n) = \Theta(n^2)\).

На рис. 4.2 показан более сложный пример — дерево для соотношения

\[
T(n) = T(n/3) + T(2n/3) + n
\]