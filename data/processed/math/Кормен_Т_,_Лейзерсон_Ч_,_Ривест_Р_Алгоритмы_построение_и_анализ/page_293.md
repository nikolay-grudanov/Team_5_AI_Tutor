---
source_image: page_293.png
page_number: 293
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.08
tokens: 11491
characters: 2123
timestamp: 2025-12-24T06:34:09.362223
finish_reason: stop
---

рева \( T \), перекрывающихся с \( i \). Время работы должно быть \( O(\min(n, k \log n)) \), где \( k \) — число элементов возвращаемого списка. (Дополнительный вопрос: как сделать это, не меняя дерева?)

15.3-5 Какие надо внести изменения в определение дерева промежутков, чтобы дополнительно реализовать процедуру Interval-Search-Exactly\((T, i)\), которая либо возвращает вершину \( x \) дерева \( T \), для которой \( low[int[x]] = low[i] \) и \( high[int[x]] = high[i] \), либо выдаёт константу NIL, если таких вершин нет (ищет отрезок, равный \( i \), а не просто перекрывающийся с \( i \)). Время работы процедуры Interval-Search-Exactly, а также всех прежних процедур промежутков должно оставаться равным \( O(\log n) \).

15.3-6 Рассмотрим множество \( Q \) натуральных чисел. Определим Min-Gap как расстояние между двумя ближайшими числами в \( Q \). Например, если \( Q = \{1, 5, 9, 15, 18, 22\} \), то \( \operatorname{Min-Gap}(Q) \) равно \( 18 - 15 = 3 \). Реализуйте структуру данных, эффективно реализующую добавление, удаление и поиск элемента, а также операцию Min-Gap. Каково время работы этих операций?

15.3-7* При разработке интегральных схем информация часто представляется в виде списка прямоугольников. Пусть даны \( n \) прямоугольников со сторонами, параллельными осям координат. Каждый прямоугольник задаётся четырьмя числами: координатами левого нижнего и правого верхнего углов. Написать программу, которая за время \( O(n \log n) \) выясняет, есть ли среди этих прямоугольников два перекрывающихся (но не требуется найти все перекрывающиеся прямоугольники). Обратите внимание, что границы перекрывающихся прямоугольников могут не пересекаться, если один лежит внутри другого. (Указание. Двигаем горизонтальную прямую снизу вверх и смотрим, как меняется её пересечение с прямоугольниками.)

Задачи

15-1 Точка максимальной кратности
Мы хотим следить за точкой максимальной кратности (point of maximum overlap) множества промежутков — точкой, которая принадлежит максимальному числу промежутков из этого множества. Как нам обновлять информацию об этой точке при добавлении и удалении элемента?