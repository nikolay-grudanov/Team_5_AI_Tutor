---
source_image: page_627.png
page_number: 627
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 56.18
tokens: 11629
characters: 1921
timestamp: 2025-12-24T06:50:09.603162
finish_reason: stop
---

Если же \( a_0^{(j)} = 0 \), то \( b^{(j)} \) заменяется на 0:

\[
u_i^{(j+1)} = parity(0, u_i^{(j)}, v_i^{(j)})
\]

при \( i = 0, 1, 2, \ldots, 2n-1 \) и

\[
v_i^{(j+1)} = \begin{cases}
majority(0, u_{i-1}^{(j)}, v_{i-1}^{(j)}) & \text{если } 1 \leq i \leq 2n-1 \\
0 & \text{если } i = 0
\end{cases}
\]

Всего производится \( 2n-1 \) шаг, причём при \( j \geq n \) имеем \( a^{(j)} = 0 \) и \( u^{(j)} + v^{(j)} = a \cdot b \). С этого момента сумма \( u + v \) не меняется, а лишь перераспределяется между \( u \) и \( v \). Наконец, \( v \) становится равным 0 и сумма оказывается в \( u \): поскольку \( v^{(2n-1)} = 0 \) (см. упражнение 29.4.3), \( u^{(2n-1)} = a \cdot b \). (Таким образом, начиная с \( n \)-го шага по существу происходит сложение двух чисел.)

Так как каждый шаг занимает время \( \Theta(1) \), общее время работы составляет \( (2n-1)\Theta(1) = \Theta(n) \). Размер схемы по-прежнему равен \( \Theta(n) \).

Упражнения
29.4-1 Используя русский народный алгоритм, перемножьте \( a = \langle 101101 \rangle \) и \( b = \langle 011110 \rangle \). Как это выглядит в двоичной и десятичной системах?
29.4-2 Докажите инварианты (29.6) и (29.7).
29.4-3 Докажите, что при быстрой реализации одномерного умножителя \( v^{(2n-1)} = 0 \).
29.4-4 Объясните, почему матричный умножитель можно рассматривать как развернутый (в пространстве вместо времени) вариант быстрого одномерного умножителя.
29.4-5 Пусть на вход поступают значения \( x_1, x_2, \ldots \) (по одному за такт), а в нашем распоряжении имеется функциональные элементы, вычисляющие максимум своих двух входов, и регистры. Для фиксированного \( n \) постройте схему размера \( O(n) \), которая за время \( O(1) \) вычисляет

\[
y_t = \max_{t-n+1 \leq i \leq t} x_i
\]

(максимум из \( n \) наиболее свежих элементов)
29.4-6* (Продолжение) То же самое, если есть только \( O(\lg n) \) элементов "максимум".

29.5 Задачи

29-1. Схемы для деления