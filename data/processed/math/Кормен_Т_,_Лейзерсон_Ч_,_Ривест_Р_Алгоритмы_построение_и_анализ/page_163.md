---
source_image: page_163.png
page_number: 163
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 53.89
tokens: 11454
characters: 1897
timestamp: 2025-12-24T06:27:49.941450
finish_reason: stop
---

Задачи к главе 8

а. В процессе работы процедуры индексы \( i \) и \( j \) не выходят за пределы отрезка \([p..r]\).

б. В момент окончания работы процедуры индекс \( j \) не может быть равен \( r \) (т.е. обе части разбиения непусты).

в. В момент окончания работы процедуры любой элемент массива \( A[p..j] \) не больше любого элемента массива \( A[j+1..r] \).

8-2 Алгоритм Ломуто для разбиения

Вариант процедуры Partition, который мы сейчас рассмотрим, принадлежит Н. Ломуто (N. Lomuto). В процессе работы строятся куски \( A[p..i] \) и \( A[i+1..j] \), причём элементы первого куска не больше \( x = A[r] \), а элементы второго куска — больше \( x \).

LOMUTO-PARTITION(\( A, p, r \))

1 \( x \leftarrow A[r] \)
2 \( i \leftarrow p - 1 \)
3 for \( j \leftarrow p \) to \( r \)
4 do if \( A[j] \leq x \)
5 then \( i \leftarrow i + 1 \)
6 поменять \( A[i] \leftrightarrow A[j] \)
7 if \( i < r \)
8 then return \( i \)
9 else return \( i - 1 \)

а. Докажите, что процедура LOMUTO-PARTITION работает правильно.

б. Сколько раз процедуры Partition и LOMUTO-PARTITION могут перемещать один и тот же элемент? (Укажите наибольшие значения.)

в. Докажите, что процедура LOMUTO-PARTITION, как и процедура Partition, требует времени \( \Theta(n) \), где \( n \) — число элементов в массиве.

г. Заменим в тексте процедуры Quicksort процедуру Partition на LOMUTO-PARTITION. Как изменится время быстрой сортировки для массива, все элементы которого равны?

д. Рассмотрим процедуру RANDOMIZED-LOMUTO-PARTITION, которая меняет \( A[r] \) со случайно выбранным элементом массива и затем вызывает процедуру LOMUTO-PARTITION. Докажите, что вероятность того, что процедура RANDOMIZED-LOMUTO-PARTITION вернёт значение \( q \), равна вероятности того, что процедура RANDOMIZED-PARTITION вернёт значение \( p + r - q \).

8-3 Сортировка по частям

Профессор предложил следующий "продвинутый" алгоритм сортировки: