---
source_image: page_145.png
page_number: 145
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 59.95
tokens: 11426
characters: 2017
timestamp: 2025-12-24T06:27:02.973323
finish_reason: stop
---

Очереди с приоритетами

EXTRACT-MAX(S): изъятие из множества наибольшего элемента.

Очередь с приоритетами может, например, использоваться в операционной системе с разделением времени. При этом хранится список заданий с приоритетами; как только выполнение очередного задания заканчивается, из очереди выбирается задание с наибольшим приоритетом (операция EXTRACT-MAX). Новые задания добавляются в очередь с помощью операции INSERT.

Другое применение той же структуры — управляемое событиями моделирование (event-driven simulation). В очереди находятся события, а приоритет определяется временем, когда событие должно произойти. Разумеется, события должны моделироваться в том порядке, в котором они происходят. Выбор очередного события производится с помощью операции EXTRACT-MIN (порядок здесь обратный), добавление событий — с помощью операции INSERT.

Опишем теперь реализацию очереди с приоритетами. Будем хранить элементы множества в виде кучи. При этом максимальный элемент находится в корне, так что операция MAXIMUM требует времени \( \Theta(1) \). Чтобы изъять максимальный элемент из очереди, нужно действовать так же, как и при сортировке:

HEAP-EXTRACT-MAX(A)
1 if heap-size[A] < 1
2 then ошибка: "очередь пуста"
3 max ← A[1]
4 A[1] ← A[heap-size[A]]
5 heap-size[A] ← heap-size[A] − 1
6 HEAPIFY(A, 1)
7 return max

Время работы составляет \( O(\lg n) \) (процедура HEAPIFY вызывается один раз).

Чтобы добавить элемент к очереди, его следует добавить в конец кучи (как лист), а затем дать ему "всплыть" до нужного места:

HEAP-INSERT(A, key)
1 heap-size[A] ← heap-size[A] + 1
2 i ← heap-size[A]
3 while i > 1 и A[PARENT(i)] < key
4 do A[i] ← A[PARENT(i)]
5 i ← PARENT(i)
6 A[i] ← key

Пример работы процедуры HEAP-INSERT показан на рис. 7.5. Время работы составляет \( O(\lg n) \), поскольку "подъём" нового листа занимает не более \( \lg n \) шагов (индекс \( i \) после каждой итерации цикла while уменьшается по крайней мере вдвое).

Итак, все операции над очередью с приоритетами из \( n \) элементов