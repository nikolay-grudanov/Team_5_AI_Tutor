---
source_image: page_417.png
page_number: 417
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.94
tokens: 11292
characters: 1431
timestamp: 2025-12-24T06:39:45.000016
finish_reason: stop
---

Рисунок 21.2 Добавление вершины. (а) Фибоначчиева куча \( H \). (б) Та же куча \( H \) после добавления вершины с ключом 21. (Эту вершину сделали одноэлементным деревом, а затем добавили в корневой список слева от минимальной вершины, которая в данном случае осталась минимальной.)

ное дерево. Вершина \( x \) не имеет потомков и не отмечена. В строках 8–9 обновляется (если необходимо) указатель на минимальную вершину. Наконец, строка 10 увеличивает значение \( n[H] \).

На рис. 21.2 показано добавление вершины с ключом 21 в фибоначчиеву кучу рис. 21.1.

В отличие от процедуры Binomial-Heap-Insert, процедура Fib-Heap-Insert не пытается соединять деревья с одинаковой степенью вершины. Если выполнить подряд \( k \) операций Fib-Heap-Insert, то в корневой список будут добавлены \( k \) деревьев по одной вершине в каждом.

Найдём учётную стоимость операции Fib-Heap-Insert. Её фактическая стоимость есть — \( O(1) \), и увеличение потенциала также есть \( O(1) \) (в корневой список добавилась одна вершина). Таким образом, учётная стоимость составляет \( O(1) \).

Поиск минимальной вершины

Указатель на неё хранится в \( min[H] \), так что фактическая стоимость этой операции есть \( O(1) \). Потенциал при этом не меняется, так что и учётная стоимость есть \( O(1) \).

Соединение двух фибоначчиевых куч

Следующая процедура из двух фибоначчиевых куч \( H_1 \) и \( H_2 \), делает одну (при этом исходные кучи исчезают).