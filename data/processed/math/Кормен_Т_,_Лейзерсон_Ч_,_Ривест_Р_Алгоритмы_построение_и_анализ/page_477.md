---
source_image: page_477.png
page_number: 477
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.86
tokens: 11621
characters: 2414
timestamp: 2025-12-24T06:42:52.695432
finish_reason: stop
---

Теперь понятен смысл строки 3 алгоритма Strongly-Connected-Components: поиск в глубину в транспонированном графе поочерёдно "отсекает" сильно связные компоненты. Скажем то же самое более формально:

Теорема 23.17
Алгоритм Strongly-Connected-Components правильно находит сильно связные компоненты ориентированного графа.

Доказательство.
В строке 3 алгоритма происходит вызов алгоритма DFS на транспонированном графе. Этот алгоритм просматривает вершины в порядке убывания параметра \( f[v] \), вычисленного в строке 1. При этом строятся деревья поиска, про которые мы хотим доказать, что они будут сильно связными компонентами.

На каждом шаге цикла рассматривается очередная (в порядке убывания параметра \( f \)) вершина \( v \). Вершины уже построенных деревьев поиска в этот момент чёрные, а остальные вершины — белые. (Заметим, что при этом всякая вершина, достижимая в графе \( G^T \) из чёрной, сама будет чёрной.)

Если очередная вершина \( u \) оказывается чёрной, то алгоритм DFS не делает ничего. Если же она белая, то вызов процедуры DFS-Visit(\( u \)) в строке 7 алгоритма DFS сделает её и все достижимые из неё в графе \( G^T \) вершины чёрными. Мы должны показать, что эти вершины образуют сильно связную компоненту.

Если какая-то белая вершина \( v \) достижима из \( u \) в графе \( G^T \), то \( u \) будет предшественником \( v \), поскольку \( u \) достижима из \( v \) в \( G \), никакие чёрные вершины не достижимы из \( v \) в \( G \) и \( u \) имеет максимальное значение параметра \( f \) среди всех белых вершин. С другой стороны, если белая вершина \( v \) не достижима из \( u \) в графе \( G^T \), то она не может иметь \( u \) своим предшественником. Чёрные вершины также не могут иметь \( u \) своим предшественником (их предшественники найдены на предыдущих шагах). Поэтому множество белых вершин, достижимых из \( u \) в графе \( G^T \), совпадает с множеством вершин, имеющих \( u \) своим предшественником, то есть является сильно связной компонентой.

Упражнения
23.5-1
Как может изменится количество сильно связных компонент графа при добавлении к нему одного ребра?
23.5-2
Примените алгоритм Strongly-Connected-Components к графу рис. 23.6. Найдите времена завершения, вычисляемые в строке 1, и лес, создаваемый строкой 7. Считайте, что цикл в строках 5-7 алгоритма DFS перебирает вершины в алфавитном порядке и что списки смежных вершин также упорядочены по алфавиту.
23.5-3