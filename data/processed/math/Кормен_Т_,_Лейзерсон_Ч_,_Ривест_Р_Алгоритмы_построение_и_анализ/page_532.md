---
source_image: page_532.png
page_number: 532
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 62.02
tokens: 11846
characters: 2410
timestamp: 2025-12-24T06:45:37.350118
finish_reason: stop
---

**Алгоритм Флойда-Уоршолла**

ли в графе путь из вершины \( i \) в вершину \( j \). **Транзитивным замыканием** ориентированного графа \( G \) называется граф \( G^* = (V, E^*) \), где

\[
E^* = \{ (i, j) : \text{в графе } G \text{ существует путь из } i \text{ в } j \}.
\]

Транзитивное замыкание графа можно вычислить за время \( \Theta(n^3) \) при помощи алгоритма Флойда–Уоршолла, считая, что все рёбра графа имеют вес 1: если существует путь из вершины \( i \) в вершину \( j \), то \( d_{ij} \) будет меньше \( n \), в противном случае \( d_{ij} = \infty \).

На практике более выгодно (в смысле времени и памяти) пользоваться несколько другим способом вычисления транзитивного замыкания за время \( \Theta(n^3) \). Заменим в алгоритме Флойда–Уоршолла арифметические операции \( \min \) и \( + \) на логические операции \( \lor \) и \( \land \). Другими словами, положим \( t_{ij}^{(k)} \) равным 1, если в графе \( G \) существует путь из \( i \) в \( j \) с промежуточными вершинами из множества \( \{1, 2, \ldots, k\} \), и равным 0, если такого пути нет. Ребро \( (i, j) \) принадлежит транзитивному замыканию \( G^* \) тогда и только тогда, когда \( t_{ij}^{(n)} = 1 \). По аналогии с формулой (26.5) напишем соотношения для \( t_{ij}^{(k)} \):

\[
t_{ij}^{(0)} = \begin{cases}
0 & \text{если } i \neq j \text{ и } (i, j) \notin E, \\
1 & \text{если } i = j \text{ или } (i, j) \in E,
\end{cases}
\]
и (при \( k \geq 1 \))
\[
t_{ij}^{(k)} = t_{ij}^{(k-1)} \lor (t_{ik}^{(k-1)} \land t_{kj}^{(k-1)}).
\] (26.8)

Основанный на этом соотношении алгоритм последовательно вычисляет матрицы \( T^{(k)} = (t_{ij}^{(k)}) \) для \( k = 1, 2, \ldots, n \):

{\sc Transitive-Closure}$(G)$\\
\verb|1 |$n \leftarrow |V[G]|$\\
\verb|2 |for $i\leftarrow 1$ to $n$\\
\verb|3 |do for $j\leftarrow 1$ to $n$\\
\verb|4 |do if $i=j$ or $(i,j)\in E[G]$\\
\verb|5 |then $t^{(0)}_{ij}\leftarrow 1$\\
\verb|6 |else $t^{(0)}_{ij}\leftarrow 0$\\
\verb|7 |for $k\leftarrow 1$ to $n$\\
\verb|8 |do for $i\leftarrow 1$ to $n$\\
\verb|9 |do for $j\leftarrow 1$ to $n$\\
\verb|10 |do $t^{(k)}_{ij}\leftarrow t^{(k-1)}_{ij}\vee(t^{(k-1)}_{ik}\wedge t^{(k-1)}_{kj})$\\
\verb|11 |return $T^{(n)}$

На рис. 26.5 приведён пример графа и матриц \( T^{(k)} \), вычисленных процедурой **Transitive-Closure**.

Время работы процедуры **Transitive-Closure** составляет \( \Theta(n^3) \), как и у алгоритма Флойда–Уоршолла. Однако на многих