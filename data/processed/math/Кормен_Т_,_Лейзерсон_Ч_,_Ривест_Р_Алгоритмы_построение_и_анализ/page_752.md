---
source_image: page_752.png
page_number: 752
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.05
tokens: 11729
characters: 2454
timestamp: 2025-12-24T06:55:54.486314
finish_reason: stop
---

**Проверка чисел на простоту**

важная разница. Процедура PSEUDOPRIME давала неправильный ответ для некоторой (пусть небольшой) доли всех чисел — такие числа можно назвать "плохими" с точки зрения этой процедуры. Для теста Миллера — Рабина плохих чисел нет: для любого числа тест даёт правильный ответ с большой вероятностью. Плохим может быть лишь случайный выбор пробных свидетелей, и вероятность этого события мала.

Как мы сейчас докажем, для любого составного числа \( n \) не менее половины всех возможных значений \( a \) позволит установить, что \( n \) составное — так что вероятность однократного неудачного выбора свидетеля не превышает \( 1/2 \), а при \( s \)-кратном повторении падает до \( 2^{-s} \).

**Теорема 33.38**
Пусть \( n \) — нечётное составное число. Тогда среди элементов \( \mathbb{Z}_n^+ \) не менее \( (n-1)/2 \) являются свидетелями того, что \( n \) составное, то есть

\[
|\{a \in \mathbb{Z}_n^+ : \text{WITNESS}(a, n) = \text{TRUE}\}| \geq (n-1)/2.
\]

**Доказательство**
Пусть фиксировано начётное составное число \( n \). Будем называть элементы \( a \in \mathbb{Z}_n^+ \), для которых \( \text{WITNESS}(a, n) = \text{FALSE} \), плохими. Мы хотим показать, что число плохих элементов не превосходит \( (n-1)/2 \).

Заметим, что все негодные элементы лежат в \( \mathbb{Z}_n^* \). В самом деле, для плохого \( a \) выполнено равенство \( a^{n-1} \equiv 1 \pmod{n} \), и потому \( a^{n-1} \) и само \( a \) взаимно просты с \( n \).

Теперь мы покажем, что все плохие элементы содержатся в некоторой собственной подгруппе \( B \) группы \( \mathbb{Z}_n^* \). По следствию 33.16 число элементов в \( B \) не больше половины общего числа элементов в \( \mathbb{Z}_n^* \), откуда и следует доказываемое утверждение. Остаётся найти собственную подгруппу \( B \), содержащую все плохие элементы.

**Случай 1:** Существует \( x \in \mathbb{Z}_n^* \), для которого

\[
x^{n-1} \not\equiv 1 \pmod{n}.
\] (33.43)

Тогда положим \( B \) равным \( \{b \in \mathbb{Z}_n^* : b^{n-1} \equiv 1 \pmod{n}\} \). Множество \( B \) замкнуто относительно операции \( \cdot_n \), поэтому по теореме 33.14 оно является подгруппой группы \( \mathbb{Z}_n^* \). Очевидно, все плохие элементы лежат в \( B \) и по предположению группа \( B \) является собственной подгруппой — так что в этом случае всё доказано.

**Случай 2:** Для всякого \( x \in \mathbb{Z}_n^* \)

\[
x^{n-1} \equiv 1 \pmod{n}
\] (33.44)

( \( n \) является числом Кармайкла ).