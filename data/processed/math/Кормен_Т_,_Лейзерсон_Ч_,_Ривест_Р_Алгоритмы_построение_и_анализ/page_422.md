---
source_image: page_422.png
page_number: 422
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.53
tokens: 11247
characters: 1272
timestamp: 2025-12-24T06:40:03.989928
finish_reason: stop
---

Операции, предусмотренные для сливаемых куч

преобразований вершина w остаётся потомком вершины x.

Инвариант цикла while (строки 6–12) таков: "d = degree[x]; осталось добавить дерево с корнем в x к множеству, представленному массивом A". Если при этом A[d] = NIL, то мы выполняем эту операцию (добавление) в строке 13. Если же A[d] ≠ NIL, то мы имеем два дерева степени d с корнями в x и y = A[d], и в строках 8–10 соединяем их в одно дерево с корнем в x (одновременно очищая ячейку A[d] и сохраняя инвариант).

Различные стадии этого процесса показаны на рис. 21.3.
После этого остаётся преобразовать массив A в корневой список: в строке 14 мы создаём пустой список, а в цикле в строках 15–19 добавляем в него по очереди все вершины, имеющиеся в массиве A. Результат показан на рис. 21.3м.

На этом процесс уплотнения заканчивается, и управление возвращается в процедуру F1B-HEAP-EXTRACT-MIN, которая уменьшает n[H] на 1 и возвращает указатель на изъятую вершину z (строки 11–12).

Заметим, что если перед выполнением операции F1B-HEAP-EXTRACT-MIN все деревья в H были неупорядоченными биномиальными деревьями, то и после выполнения операции H будет состоять из неупорядоченных биномиальных деревьев. В самом деле, соединение двух неупорядоченных биномиальных деревьев с