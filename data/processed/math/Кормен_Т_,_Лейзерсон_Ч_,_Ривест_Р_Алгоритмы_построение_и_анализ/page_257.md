---
source_image: page_257.png
page_number: 257
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 72.68
tokens: 11702
characters: 2428
timestamp: 2025-12-24T06:32:33.279528
finish_reason: stop
---

Задачи к главе 13

тривать случай равенства отдельно. Оцените асимптотику времени добавления \( n \) равных ключей в пустое дерево при использовании трёх различных подходов:
б Храним в вершине \( x \) флаг \( b[x] \), и выбираем левого или правого ребёнка в зависимости от значения \( b[x] \). При этом флаг меняется при каждом посещении вершины, так что направления чередуются.
в Храним элементы с равными ключами в одной вершине (с помощью списка) и добавляем элемент с уже встречавшимся ключом в этот список.
г Направление движения выбираем случайно. (Каково будет время в худшем случае? Что вы можете сказать о математическом ожидании?)

13-2 Цифровые деревья
Рассмотрим две строки \( a = a_0a_1...a_p \) и \( b = b_0b_1...b_q \), составленные из символов некоторого (упорядоченного) алфавита. Говорят, что строка \( a \) лексикографически меньше строки \( b \) (\( a \) is lexicographically less than \( b \)), если выполняется одно из двух условий:
1. Существует число \( j \) из \( 0..min(p, q) \), при котором \( a_i = b_i \) для всех \( i = 0, 1, ..., j - 1 \) и \( a_j < b_j \).
2. \( p < q \) и \( a_i = b_i \) для всех \( i = 0, 1, ..., p \).

Например, \( 10100 < 10110 \) согласно правилу 1 (при \( j = 3 \)), а \( 10100 < 101000 \) согласно правилу 2. Такой порядок применяется в словарях.

Строение цифрового дерева (radix tree) видно из примера на рис. 13.6, где показано дерево, хранящее битовые строки 1011, 10, 011, 100 и 0. При поиске строки \( a = a_0a_1...a_p \) мы на \( i \)-м шаге идём налево при \( a_i = 0 \) и направо при \( a_i = 1 \). Пусть элементами множества \( S \) являются попарно различные битовые строки суммарной длины \( n \). Покажите, как с помощью цифрового дерева отсортировать \( S \) в лексикографическом порядке за \( \Theta(n) \) действий. (Например, для множества рис. 13.6 результатом сортировки будет последовательность 0, 011, 10, 100, 1011.)

13-3 Средняя глубина вершины в случайном двоичном дереве
В этой задаче мы докажем, что математическое ожидание средней глубины вершины в случайном двоичном дереве с \( n \) вершинами есть \( O(\lg n) \). Хотя этот результат слабее, чем результат теоремы 13.6, доказательство устанавливает интересные аналогии между двоичными деревьями поиска и процедурой RANDOMIZED-QUICKSORT из раздела 8.3.
Рассмотрим (ср. главу 5, упр. 5.5-6) сумму глубин \( d(x, T) \) всех вершин \( x \) дерева \( T \), которую мы будем обозначать \( P(T) \).