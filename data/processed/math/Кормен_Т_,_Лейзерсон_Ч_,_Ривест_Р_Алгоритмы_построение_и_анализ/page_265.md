---
source_image: page_265.png
page_number: 265
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 46.87
tokens: 11429
characters: 1836
timestamp: 2025-12-24T06:32:30.190948
finish_reason: stop
---

Рисунок 14.2 Операции вращения на двоичном дереве поиска. Операция Right-Rotate преобразует левое дерево в правое, меняя несколько указателей. Правое дерево можно перевести в левое обратной операцией Left-Rotate. Вершины x и y могут находиться в любом месте дерева. Буквы α, β и γ обозначают поддеревья. В обоих деревьях выполнено одно и то же свойство упорядоченности: ключи из α предшествуют key[x], который предшествует ключам из β, которые предшествуют key[y], который предшествует ключам из γ.

14.2 Вращения

Операции Tree-Insert и Tree-Delete выполняются на красно-чёрном дереве за время O(lg n), но они изменяют дерево, и результат может не обладать RB-свойствами, описанными в разделе 14.1. Чтобы восстановить эти свойства, надо перекрасить некоторые вершины и изменить структуру дерева.

Мы будем менять структуру с помощью вращений (rotations). Вращение представляет собой локальную операцию (меняется несколько указателей) и сохраняет свойство упорядоченности. На рисунке 14.2 показаны два взаимно обратных вращения: левое и правое. Левое вращение возможно в любой вершине x, правый ребёнок которой (назовём его y) не является листом (NIL). После вращения y оказывается корнем поддерева, x — левым ребёнком y, а бывший левый ребёнок y — правым ребёнком x.

В процедуре Left-Rotate предполагается, что right[x] ≠ NIL.

LEFT-ROTATE(T, x)
1   y ← right[x]        ▷ Находим y.
2   right[x] ← left[y]  ▷ Левое поддерево y становится правым поддеревом x.
3   if left[y] ≠ NIL
4     then p[left[y]] ← x
5     p[y] ← p[x]        ▷ Делаем родителя x родителем y.
6     if p[x] = NIL
7       then root[T] ← y
8       else if x = left[p[x]]
9         then left[p[x]] ← y
10        else right[p[x]] ← y
11     left[y] ← x        ▷ Делаем x левым ребёнком y.
12     p[x] ← y

На рисунке 14.3 показано действие процедуры Left-Rotate. Про-