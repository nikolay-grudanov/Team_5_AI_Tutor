---
source_image: page_565.png
page_number: 565
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.83
tokens: 11631
characters: 2352
timestamp: 2025-12-24T06:47:13.695591
finish_reason: stop
---

Покажем, что для одно и то же ребро может быть критическим не более \( O(V) \) раз. Поскольку все рёбра всех остаточных сетей соответствуют рёбрам графа (возможно, в обратном направлении), их число не превосходит \( 2E \), так что общее число шагов действительно есть \( O(EV) \).

Итак, посмотрим, сколько раз за время работы алгоритма Эдмондса–Карпа ребро \((u, v)\) может быть критическим. Если ребро было критическим, оно исчезает, и может появиться вновь лишь после того, как поток из \(u\) в \(v\) уменьшится. Это может произойти только если ребро \((v, u)\) войдёт в дополняющий путь. Таким образом, возникает последовательность ситуаций:
\[
(u, v) \text{ входит в дополняющий путь (и критическое в нём);}
\]
\[
(v, u) \text{ входит в дополняющий путь (не обязательно критическое);}
\]
\[
(u, v) \text{ входит в дополняющий путь (и критическое в нём);}
\]
\[
(v, u) \text{ входит в дополняющий путь (не обязательно критическое);}
\]
и так далее. Покажем, что число таких ситуаций есть \( O(V) \). Для этого проследим, как меняются расстояния от истока до вершин \(u\) и \(v\) в остаточных сетях. Как мы знаем (лемма 27.8), эти две величины могут только возрастать. При этом то одна, то другая вырывается вперёд на 1 (поскольку они соседствуют в кратчайшем пути, лемма 25.1). Заметим, что при переходе от первой ситуации ко второй расстояние от истока до \(u\) увеличится по крайней мере на 2 (оно было меньше расстояния до \(v\), а стало больше). При переходе от второй строки к третьей расстояние от истока до \(v\) увеличится по крайней мере на 2 и так далее.

Заметим, что расстояния ограничены сверху значением \(V\) (кратчайший путь не проходит дважды через одну вершину), так что общее число таких чередований есть \(O(V)\), как мы и обещали.

Подсчитаем теперь общее время работы алгоритма Эдмондса–Карпа. Каждая итерация требует времени \(O(E)\), их будет \(O(VE)\), поэтому всего будет \(O(VE^2)\).

В разделе 27.4 мы расскажем о другом подходе к поиску максимального потока, который позволяет сделать это за \(O(V^2E)\). Его усовершенствование позволяет ещё уменьшить время работы, получив оценку \(O(V^3)\) (раздел 27.5).

Упражнения

27.2-1
Найдите поток через разрез \(\{s, v_2, v_4\}, \{v_1, v_3, t\}\) на рис. 27.1 b). Чему равна пропускная способность этого разреза?

27.2-2
Проследите за выполнением алгоритма Эдмондса–Карпа для