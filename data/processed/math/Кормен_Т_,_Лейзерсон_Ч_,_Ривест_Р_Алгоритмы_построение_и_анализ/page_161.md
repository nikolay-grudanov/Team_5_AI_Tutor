---
source_image: page_161.png
page_number: 161
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 73.44
tokens: 11715
characters: 2617
timestamp: 2025-12-24T06:27:59.830884
finish_reason: stop
---

при \( n \geq 2 \). Оценка (8.5) доказана.

[Следующий простой вывод оценки для среднего времени работы вероятностного алгоритма быстрой сортировки (для несколько другого варианта алгоритма) предложил Л.А. Левин.

(1) Будем представлять себе сортировку так: есть \( N \) камней разного веса и чашечные весы для их сравнения. Мы берём случайный камень и делим всю кучу на три части: легче его, тяжелее его и он сам, после чего (рекурсивный вызов) сортируем первую и вторую части.

(2) Как выбрать случайный камень? Можно считать, что сначала всем камням случайно присваиваются различные ранги (будем считать их числами от 1 до \( N \)), и в качестве границы берётся камень минимального ранга (из подлежащих сортировке в данный момент). (Можно проверить, что это равносильно независимым выборам камней на каждом шаге: на первом шаге каждый из камней может быть выбран с равной вероятностью, после такого выбора в каждой из групп все камни также равновероятны и т.д.)

(3) Таким образом, каждый камень характеризуется двумя числами от 1 до \( N \) — порядковым номером (в порядке возрастания весов) и рангом. Соответствие между номерами и рангами определяет число операций в процессе сортировки.

(4) Для каждого двух номеров \( i, j \) из \( \{1, \ldots, N\} \) через \( p(i, j) \) обозначим вероятность того, что камни с этими номерами будут сравниваться друг с другом. Например, \( p(i, i+1) = 1 \), поскольку соседние по весу камни должны быть сравнены обязательно (сравнения с другими камнями их не различают).

(5) Заметим, что \( p(i, i+2) = 2/3 \). В самом деле, сравнения не произойдёт в том и только том случае, когда из трёх камней с номерами \( i, i+1 \) и \( i+2 \) камень \( i+1 \) имеет наименьший ранг. Аналогично, \( p(i, i+k) = 2/(k+1) \) (камни с номерами \( i \) и \( i+k \) сравниваются, если среди \( k+1 \) камней \( i, i+1, \ldots, i+k \) один из двух крайних имеет наименьший ранг).

(6) Математическое ожидание числа сравнений можно разбить в сумму \( \sum m(i, j) \) ожиданий числа сравнений между камнями с номерами \( i \) и \( j \). Но поскольку два данных камня сравниваются не более одного раза, \( m(i, j) = p(i, j) \). Таким образом, получаем точное выражение для математического ожидания числа сравнений:

\[
\sum_{1 \leq i < j \leq n} \frac{2}{j - i + 1}.
\]

(7) Группируя в этой сумме равные члены и вспоминая, что \( 1 + 1/2 + 1/3 + \ldots + 1/k = O(\lg k) \), получаем оценку \( O(N \lg N) \) для математического ожидания времени работы быстрой сортировки.

Анализ облегчается тем, что алгоритм разбиения (на три части) более симметричен. Реализация такого способа разбиения также