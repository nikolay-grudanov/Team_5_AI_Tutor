---
source_image: page_767.png
page_number: 767
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 49.11
tokens: 11554
characters: 2120
timestamp: 2025-12-24T06:56:21.203599
finish_reason: stop
---

Простейший алгоритм — не лучший (далее мы расскажем об алгоритме, работающем за время \( O(n + m) \)). Неэффективность простейшего алгоритма связана с тем, что информация о тексте \( T \), получаемая при проверке данного сдвига \( s \), никак не используется при проверке последующих сдвигов. Между тем такая информация может очень помочь. Пусть, например, \( P = aaab \) и мы выяснили, что сдвиг \( s = 0 \) допустим. Тогда сдвиги 1, 2 и 3 заведомо недопустимы, поскольку \( T[4] = b \). Далее мы обсудим различные способы реализации этой идеи.

Упражнения

34.1-1
Какие сравнения символов делает простейший алгоритм при \( P = 0001 \) и \( T = 000010001010001 \)?

34.1-2
Покажите, что в худшем случае простейший алгоритм найдёт первое вхождение подстроки за время \( \Theta((n - m + 1)(m - 1)) \).

34.1-3
Пусть все символы в образце \( P \) различны. Как усовершенствовать алгоритм Naive-String-Matcher, чтобы он работал за время \( O(n) \), где \( n \) — длина текста?

34.1-4
Пусть алфавит содержит \( d \) символов, и пусть образец и текст — случайные строки длины \( m \) и \( n \) соответственно. Покажите, что математическое ожидание числа сравнений символов, производимых простейшим алгоритмом при выполнении строки \( t \), есть
\[
(n - m + 1) \frac{1 - d^{-m}}{1 - d^{-1}} \leq 2(n - m + 1)
\]
(сравнение строк прекращается, как только найдены нesовпадающие символы или когда просмотрен весь образец). Таким образом, для случайных строк простейший алгоритм вполне эффективен.

34-1.5 Пусть в образце (но не в тексте!) может встречаться, наряду с символами из алфавита \( \Sigma \), символ \( \Diamond \), называемый символом пропуска (дир character), который соответствует произвольной подстроке (в том числе пустой). Например, образец \( ab\Diamond ba\Diamond c \) входит в текст \( cabccbacbacab \) и как
\[
c \underbrace{ab}_{ab} \underbrace{cc}_{\Diamond} \underbrace{ba}_{ba} \underbrace{cba}_{\Diamond} \underbrace{c}_{c} \underbrace{ab}_{ab},
\]
и как
\[
c \underbrace{ab}_{ab} \underbrace{ccbac}_{\Diamond} \underbrace{ba}_{ba} \underbrace{cba}_{\Diamond} \underbrace{c}_{c} \underbrace{ab}_{ab}.
\]