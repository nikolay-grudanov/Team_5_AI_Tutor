---
source_image: page_428.png
page_number: 428
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 67.94
tokens: 11622
characters: 2293
timestamp: 2025-12-24T06:40:41.972543
finish_reason: stop
---

Упражнения

21.3-1 Каким образом может появиться помеченная вершина в корневом списке?

21.3-2 Докажите оценку \( O(1) \) для учётной стоимости операции FIB-HEAP-DECREASE-KEY, используя метод группировки (раздел 18.1).

21.4 Оценка максимальной степени

Для получения обещанных оценок \( O(\lg n) \) для учётной стоимости операций FIB-HEAP-EXTRACT-MIN и FIB-HEAP-DELETE осталось показать, что максимальная степень \( D(n) \), которую может иметь какая-либо вершина в фибоначчиевой куче с \( n \) вершинами, не превосходит \( O(\lg n) \).

Как показывает упражнение 21.2-3, если все деревья в фибоначчиевой куче являются неупорядоченными биномиальными деревьями, то \( D(n) = \lfloor \lg n \rfloor \). Но операции вырезания, которые происходят во время исполнения процедуры FIB-HEAP-DECREASE-KEY, приводят к тому, что деревья в фибоначчиевой куче более не являются биномиальными. Мы покажем, что тем не менее при выполнении опи- санных операций остаётся в силе оценка \( D(n) = O(\lg_2 n) \). Точнее, мы установим, что \( D(n) \leq \lfloor \log_\varphi n \rfloor \), где \( \varphi = (1 + \sqrt{5})/2 \).

Для каждой вершины фибоначчиевой кучи через \( \mathrm{size}(x) \) обозначим число вершин в поддереве с корнем \( x \), считая саму вершину \( x \). (Вершина \( x \) не обязана быть корневой вершиной кучи.) Мы покажем, что величина \( \mathrm{size}(x) \) экспоненциально зависит от \( \mathrm{degree}[x] \). (Напомним, что поле \( \mathrm{degree}[x] \) поддерживается равным степени вершины \( x \).)

Лемма 21.1. Пусть \( x \) — произвольная вершина фибоначчиевой кучи, и пусть \( \mathrm{degree}[x] = k \). Тогда степени к детей вершины \( x \) не меньше \( 0, 0, 1, 2, 3, \ldots, k - 2 \), если их расположить в надлежащем порядке.

Доказательство. Для вершин, не входящих в корневой список, определим "модифицированную степень", которая на единицу больше реальной степени для помеченных (и совпадает с ней для не-помеченных). Смысл этого такой: поскольку при удалении ребёнка у вершины делается пометка, то её модифицированная степень не меняется, а добавление детей возможно только для вершин в корневом списке. Таким образом, модифицированная степень есть степень на момент (последнего) выбытия вершины из корневого списка.

Поскольку модифицированная степень отличается от реальной