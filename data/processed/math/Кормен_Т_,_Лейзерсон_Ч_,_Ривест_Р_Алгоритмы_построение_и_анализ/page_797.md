---
source_image: page_797.png
page_number: 797
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 77.09
tokens: 11930
characters: 2953
timestamp: 2025-12-24T06:58:10.830494
finish_reason: stop
---

35.2 Векторное произведение помогает определить, в какую сторону мы поворачиваем в точке \( p_1 \), идя по ломаной \( p_0p_1p_2 \). Для этого надо выяснить, в какой стороне находится вектор \( \overrightarrow{p_0p_2} \) от вектора \( \overrightarrow{p_0p_1} \).
(а) Если против часовой стрелки, то мы поворачиваем налево. (б) Если по часовой стрелке, то — направо.

находится против часовой стрелки от \( \overrightarrow{p_0p_1} \), и в точке \( p_0 \) мы поворачиваем налево. Если векторное произведение положительно, мы поворачиваем направо. Наконец, если оно равно нулю, то мы либо идём прямо, либо поворачиваем кругом (точки \( p_0, p_1 \) и \( p_2 \) принадлежат одной прямой).

Пересекаются ли отрезки?
Определять, пересекаются ли отрезки, мы будем в два этапа. Начальный тест (quick rejection) состоит в следующем: если ограничивающие прямоугольники отрезков не имеют общих точек, то и сами отрезки не пересекаются. При этом ограничивающим прямоугольником (bounding box) геометрической фигуры мы будем называть наименьший из прямоугольников со сторонами, параллельными осям координат, которые содержат данную фигуру.
Для отрезка \( \overline{p_1p_2} \) таковым будет прямоугольник \( (\hat{p}_1, \hat{p}_2) \) с левым нижним углом \( \hat{p}_1 = (\hat{x}_1, \hat{y}_1) \) и правым верхним углом \( \hat{p}_2 = (\hat{x}_2, \hat{y}_2) \), где \( \hat{x}_1 = \min(x_1, x_2) \), \( \hat{y}_1 = \min(y_1, y_2) \), \( \hat{x}_2 = \max(x_1, x_2) \), \( \hat{y}_2 = \max(y_1, y_2) \). Условие пересечения двух прямоугольников, заданных левыми нижними и правыми верхними углами, таково: \( (\hat{p}_1, \hat{p}_2) \) и \( (\hat{p}_3, \hat{p}_4) \) имеют общие точки тогда и только тогда, когда

\[
(\hat{x}_2 \geq \hat{x}_3) \land (\hat{x}_4 \geq \hat{x}_1) \land (\hat{y}_2 \geq \hat{y}_3) \land (\hat{y}_4 \geq \hat{y}_1)
\]

(первые два условия соответствуют пересечению x-проекций, вторые — y-проекциям).
Если на первом этапе не удается установить, что отрезки не пересекаются, мы переходим ко второму этапу и проверяем, пересекается ли каждый из данных отрезков с прямой, содержащей другой отрезок. Отрезок пересекает прямую (straddles a line), если его концы лежат по разные стороны от неё или если один из концов лежит на прямой. Можно проверить, что два отрезка пересекаются тогда и только тогда, когда пересекаются ограничивающие их прямоугольники (начальный тест) и, кроме того, каждый из отрезков пересекается с прямой, содержащей другой отрезок.
Последнее условие проверяется с помощью векторных произведений. Точки \( p_3 \) и \( p_4 \) лежат по разные стороны от прямой \( p_1p_2 \), если векторы \( \overrightarrow{p_1p_3} \) и \( \overrightarrow{p_1p_4} \) имеют различную ориентацию относительно вектора \( \overrightarrow{p_1p_2} \) (см. рис.35.3 (a), (b)), то есть если знаки векторных произведений \( (p_3 - p_1) \times (p_2 - p_1) \) и \( (p_4 - p_1) \times (p_2 - p_1) \) различны. Если одно из этих векторных произведений равно нулю,