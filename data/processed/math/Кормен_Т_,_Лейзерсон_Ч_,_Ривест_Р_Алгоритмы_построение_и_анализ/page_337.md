---
source_image: page_337.png
page_number: 337
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.76
tokens: 11637
characters: 2291
timestamp: 2025-12-24T06:36:16.506121
finish_reason: stop
---

Рисунок 17.6 Доказательство леммы 17.2. Здесь b и c — наиболее удалённые от корня листья-братья, а x и y — листья с наименьшими частотами. Обмен x и b превращает дерево T в T', а обмен y и c превращает T' в T''. При каждой из перестановок стоимость дерева не возрастает.

ному коду, и покажем, что его можно модифицировать, не нарушая оптимальности, так, чтобы вышеуказанное условие выполнялось.

В самом деле, рассмотрим пару соседних (имеющих общего родителя) листьев в дереве T, находящуюся на максимальном расстоянии от корня. (Такие существуют: в оптимальном дереве все внутренние вершины имеют степень 2, и потому лист наибольшей глубины имеет брата.) Символы, стоящие в этих листьях (назовём их b и c) — не обязательно x и y, но заведомо имеют не меньше частоты (поскольку x и y были двумя наиболее редкими символами). Не ограничивая общности, можно считать, что f[x] ≤ f[b] и f[y] ≤ f[c]. Теперь поменяем местами в дереве T символы b и x (полученное дерево назовём T'), а затем символы c и y (полученное дерево назовём T''). После таких обменов x и y (см. пример на рис. 17.6) станут братьями, находящимися на максимальной глубине. Осталось убедиться, что при обменах стоимость дерева не возрастает и, следовательно, дерево T'' также является оптимальным. Другими словами, мы должны проверить, что B(T) ≥ B(T') ≥ B(T''), где B — функция стоимости. В самом деле, стоимость определяется как сумма по всем листьям произведений частоты на глубину (17.3). При переходе от T к T' в этой сумме меняются только два слагаемых: f[b]d_T(b) + f[x]d_T(x) заменяется на f[b]d_{T'}(b) + f[x]d_{T'}(x), т. е. на f[b]d_T(x) + f[x]d_T(b). Таким образом,

\[
B(T) - B(T') = f[b]d_T(b) + f[x]d_T(x) - f[b]d_T(x) - f[x]d_T(b) =
= (f[b] - f[x])(d_T(b) - d_T(x)) \geq 0.
\]

Обе скобки неотрицательны: вспомним, что f[x] ≤ f[b] и что d_T(b) ≥ d_T(x), так как лист b был одним из наиболее удалённых от корня. Аналогичным образом B(T') ≥ B(T''), так что B(T) ≥ B(T''), и поэтому T'' также оптимально (а все наши неравенства являются равенствами). Лемма доказана.

Доказанная лемма показывает, что построение оптимального дерева всегда можно начать со слияния двух символов с наименьшей частотой. Следующее наблюдение оправдывает название "жадный" для такого алгоритма. Назовём стоимостью слияния сумму частот