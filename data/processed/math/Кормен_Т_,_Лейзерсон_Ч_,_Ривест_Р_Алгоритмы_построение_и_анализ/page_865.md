---
source_image: page_865.png
page_number: 865
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.99
tokens: 11774
characters: 2582
timestamp: 2025-12-24T07:00:58.570702
finish_reason: stop
---

Рисунок 37.2 Работа алгоритма APPROX-MST-Tour. (a) Исходные точки лежат в вершинах целочисленной решётки. (Например, вершина f на 1 правее и на 2 выше вершины h.) Стоимость ребра определяется как (евклидово) расстояние между точками. (b) Минимальное покрывающее дерево T, построенное алгоритмом MST-Prim. Вершина a является его корнем. (Алфавитный порядок названий вершин соответствует порядку их добавления в ходе работы алгоритма MST-Prim.) (c) Обход дерева T начинается с его корня a. Отмечая вершины на пути туда и обратно, мы получим последовательность a, b, c, b, h, b, a, d, e, f, e, g, e, d, a. Алгоритм обхода дерева в порядке "вершина-потомки" пропускает вершины на обратном пути, и остаётся a, b, c, h, d, e, f, g. (d) Соответствующий цикл H является результатом работы алгоритма APPROX-MST-TOUR. Его стоимость примерно равна 19,074. (e) Оптимальный цикл стоимости \( \approx 14,715 \).

37.2.1 Задача коммивояжёра (с неравенством треугольника)

Мы можем воспользоваться алгоритмом MST-Prim отыскания минимального покрывающего дерева из раздела 24.2, переделав его в цикл. Если выполнено неравенство треугольника, то этот цикл не более чем вдвое длиннее оптимального.

APPROX-TSP-TOUR

1 считаем произвольную вершину \( r \in V[G] \) "корнем"
2 построим минимальное покрывающее дерево T для графа G (с корнем в r) с помощью алгоритма MST-Prim(G, c, r)
3 пусть L — перечень вершин этого дерева в порядке обхода "вершина-потомки"
4 return гамильтонов цикл, обходящий вершины в порядке L

Обход вершин дерева описан в разделе 13.1: рекурсивный алгоритм обхода поддерева с корнем в v посещает вершину v, а затем обходит поддеревья, корнями которых являются дети вершины v.

На рисунке 37.2 показана работа алгоритма. Для данной системы точек на плоскости (a) строится минимальное остовное дерево T; вершина a — его корень (b). Определяемый им порядок обхода вершин (c) даёт гамильтонов цикл (d), который является результатом работы алгоритма APPROX-MST-Tour. Он примерно на 23% длиннее оптимального цикла (e).

Время работы алгоритма APPROX-MST-Tour равно \( \Theta(E) = \Theta(V^2) \) поскольку алгоритм MST-Prim применяется к полному графу. (См. упражнение 24.2-2.) Осталось проверить, что найденный цикл не более чем вдвое длиннее оптимального. (При этом мы используем неравенство треугольника.)

Теорема 37.2

Алгоритм APPROX-MST-Tour решает задачу о коммивояжёре с ошибкой не более чем в 2 раза, если выполнено неравенство треугольника.

Доказательство. Пусть \( H^* \) — гамильтонов цикл наименьшей стоимости. Нам надо доказать, что \( c(H) \leq 2c(H^*) \) для цикла H,