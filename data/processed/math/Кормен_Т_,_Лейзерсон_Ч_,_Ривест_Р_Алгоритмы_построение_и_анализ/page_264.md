---
source_image: page_264.png
page_number: 264
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.99
tokens: 11481
characters: 1823
timestamp: 2025-12-24T06:32:33.236427
finish_reason: stop
---

всех вершин на пути от корня к листу, не считая корень, составляют чёрные вершины. Следовательно, чёрная высота дерева не меньше \( h/2 \). Тогда
\[
n \geq 2^{h/2} - 1.
\]
Перенося 1 налево и перейдя к логарифмам, получаем \( \lg(n + 1) \geq h/2 \), или \( h \leq 2 \lg(n + 1) \). Лемма доказана.

Тем самым для красно-чёрных деревьев операции SEARCH, MINIMUM, MAXIMUM, SUCCESSOR и PREDECESSOR выполняются за время \( O(\lg n) \), так как время их выполнения есть \( O(h) \) для дерева высоты \( h \), а красно-чёрное дерево с \( n \) вершинами имеет высоту \( O(\lg n) \).

Сложнее обстоит дело с процедурами TREE-INSERT и TREE-DELETE из главы 13: проблема в том, что они могут испортить структуру красно-чёрного дерева, нарушив RB-свойства. Поэтому эти процедуры придётся модифицировать. Мы увидим в разделах 14.3 и 14.4, как можно реализовать добавление и удаление элементов за время \( O(\lg n) \) с сохранением RB-свойств.

Упражнения

14.1-1 Нарисуйте полное двоичное дерево поиска высоты 3 с ключами \( \{1, 2, \ldots, 15\} \). Добавьте NIL-листья и покрасьте вершины тремя способами так, чтобы получившиеся красно-чёрные деревья имели чёрную высоту 2, 3 и 4.

14.1-2 Предположим, что корень красно-чёрного дерева красный. Если мы покрасим его в чёрный цвет, останется ли дерево красно-чёрным?

14.1-3 Покажите, что самый длинный путь вниз от вершины \( x \) к листу не более чем вдвое длиннее самого короткого такого пути.

14.1-4 Какое наибольшее и наименьшее количество внутренних вершин может быть в красно-чёрном дереве чёрной высоты \( k \)?

14.1-5 Опишите красно-чёрное дерево, содержащее \( n \) ключей, с наибольшим возможным отношением числа красных внутренних вершин к числу чёрных внутренних вершин. Чему равно это отношение? Для какого дерева это отношение будет наименьшим, и чему равно это отношение?