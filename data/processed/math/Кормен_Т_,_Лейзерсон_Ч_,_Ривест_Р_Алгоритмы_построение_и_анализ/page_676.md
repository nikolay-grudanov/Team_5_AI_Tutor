---
source_image: page_676.png
page_number: 676
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.41
tokens: 11714
characters: 2241
timestamp: 2025-12-24T06:52:26.104336
finish_reason: stop
---

1. Каждая из матриц \( A \) и \( B \) разбивается на 4 блока, как в (31.9).
2. Строится 14 матриц \( A_1, B_1, A_2, B_2, \ldots, A_7, B_7 \). размера \( (n/2 \times n/2) \) (для чего нужно \( \Theta(n^2) \) операций сложения/вычитания чисел)
3. Рекурсивно вычисляются 7 произведений матриц меньшего размера \( P_i = A_i B_i \) (\( i = 1, \ldots, 7 \)).
4. Вычисляются части \( r, s, t, u \) искомой матрицы \( C \). Они являются линейными комбинациями матриц \( P_i \) с коэффициентами из множества \( \{-1, 0, 1\} \), и вычисление их требует \( \Theta(n^2) \) операций сложения/вычитания чисел.

Время работы этого алгоритма, очевидно, удовлетворяет соотношению (31.15). Изложим теперь опущенные детали.
Какие же матрицы меньшего размера нужно перемножать?
Готовые формулы для \( P_1 - P_7 \) проверить легко, труднее понять, как до них можно догадаться. Вот один из возможных путей.
Будем искать произведения \( P_i \) среди выражений вида

\[
P_i = A_i B_i \\
= (\alpha_{i1} a + \alpha_{i2} b + \alpha_{i3} c + \alpha_{i4} d) \cdot (\beta_{i1} e + \beta_{i2} f + \beta_{i3} g + \beta_{i4} h),
\]

где коэффициенты \( \alpha_{ij}, \beta_{ij} \) принимают значения \( -1, 0, 1 \). Конечно, можно искать формулы для \( P_i \) и в более общем виде, но оказывается, что этого уже достаточно.

Обратите внимание, что после раскрытия скобок куски матрицы \( A \) будут стоять слева в попарных произведениях, а куски матрицы \( B \) — справа. Это важно, поскольку умножение матриц не коммутативно.

Для удобства мы будем изображать линейную комбинацию попарных произведений кусков матриц при помощи \( (4 \times 4) \)-матрицы, элементами которой служат соответствующие коэффициенты линейной комбинации. Например, равенство (31.10) запишется в виде

\[
r = ae + bf \\
= (a \quad b \quad c \quad d) \begin{pmatrix}
+1 & 0 & 0 & 0 \\
0 & +1 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0
\end{pmatrix}
\begin{pmatrix}
e \\ f \\ g \\ h
\end{pmatrix} \\
= \begin{pmatrix}
a & b & c & d
\end{pmatrix}
\begin{pmatrix}
e & f & g & h \\
+ & . & . & . \\
. & + & . & . \\
. & . & . & .
\end{pmatrix}.
\]

Для краткости мы заменяем \( +1 \) на \( + \), \( 0 \) на \( \cdot \) и \( -1 \) на \( - \) и опускаем имена столбцов и строк. В этих терминах три остальные