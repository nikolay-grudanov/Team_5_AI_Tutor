---
source_image: page_256.png
page_number: 256
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 68.08
tokens: 11622
characters: 2125
timestamp: 2025-12-24T06:32:26.623949
finish_reason: stop
---

Взяв теперь \( t = 2(\beta + 1)H_n \), где \( H_n = 1 + 1/2 + \ldots + 1/n \) (а \( \beta \approx 4,32 \) — корень уравнения \( (\ln \beta - 1)\beta = 2 \)) и применив лемму 13.5, мы заключаем, что

\[
\mathbb{P}\{d(k_j, T) \geq 2(\beta + 1)H_n\} \leq 2\mathbb{P}\{|S| \geq (\beta + 1)H_n\} \leq 2/n^2.
\]

Всего вершин в дереве не более \( n \), поэтому вероятность того, что какая-то вершина будет иметь глубину \( 2(\beta + 1)H_n \) или больше, не более чем в \( n \) раз превосходит такую же вероятность для одной вершины, и потому не превосходит \( 2/n \). Итак, с вероятностью по меньшей мере \( 1 - 2/n \) высота случайного дерева не превосходит \( 2(\beta + 1)H_n \), и в любом случае она не больше \( n \). Таким образом, математическое ожидание не превосходит \( (2(\beta + 1)H_n)(1 - 2/n) + n(2/n) = O(\lg n) \).

Упражнения

13.4-1 Приведите пример дерева поиска, в котором средняя (по всем вершинам) глубина вершины есть \( \Theta(\lg n) \), но высота дерева есть \( \omega(\lg n) \). Насколько велика может быть высота дерева, если средняя глубина вершины есть \( \Theta(\lg n) \)?

13.4-2 Покажите, что при нашем понимании случайного двоичного дерева поиска не все упорядоченные деревья с данными \( n \) ключами равновероятны. (Указание: Рассмотрите случай \( n = 3 \).)

13.4-3* Для данной константы \( r \geq 1 \) укажите константу \( t \), для которой вероятность события "высота случайного двоичного дерева поиска не меньше \( tH_n \)" меньше \( 1/n^r \).

13.4-4* Рассмотрим алгоритм RANDOMIZED-QUICKSORT, применённый к последовательности из \( n \) чисел. Докажите, что для любой константы \( k > 0 \) существует такая константа \( c \), что с вероятностью не менее \( 1 - c/n^k \) алгоритм завершает работу за время \( cn \lg n \).

Задачи

13-1 Двоичные деревья поиска и равные ключи
Равные ключи — источник проблем при работе с деревьями поиска.
а Какова асимптотика времени работы процедуры TREE-INSERT при добавлении \( n \) одинаковых ключей в изначально пустое дерево? Причина тут в том, что при выборе в строках 5–7 и 11–13 мы в случае равенства всегда двигаемся направо по дереву. Будем рассма-