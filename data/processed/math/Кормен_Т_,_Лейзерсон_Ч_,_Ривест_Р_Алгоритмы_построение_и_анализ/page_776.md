---
source_image: page_776.png
page_number: 776
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.76
tokens: 11582
characters: 2051
timestamp: 2025-12-24T06:56:46.308011
finish_reason: stop
---

Рис. 34.7
Подпись:
К доказательству леммы 34.2: если \( r = \sigma(xa) \), то \( r \leq \sigma(x) + 1 \).

Рис. 34.8
Подпись:
К доказательству леммы 34.3. Из рисунка видно, что \( r = \sigma(P_q a) \), где \( q = \sigma(x) \) и \( r = \sigma(xa) \).

1 n \gets length[T]
2 q \gets 0
3 for i \gets 1 to n
4    do q \gets \delta(q, T[i])
5    if q=m
6        then s \gets i-m
7        print 'Образец входит со сдвигом 's

Поскольку эта программа обрабатывает каждый символ из текста \( T \) по разу, время её работы есть \( O(n) \). Однако следует учесть и время, требуемое для вычисления функции перехода \( \delta \).
Мы этим вскоре займёмся, но сначала докажем, что процедура FINITE-AUTOMATON-MATCHER правильно находит все вхождения подстроки \( T \).

Как отмечалось выше, нам достаточно показать, что для всех \( i \) выполнено соотношение (34.4), то есть что после прочтения символа \( T[i] \) автомат оказывается в состоянии \( \sigma(T_i) \). Это вытекает из следующих двух лемм.

Лемма 34.2 (неравенство для суффикс-функции)
Для любых строки \( x \) и символа \( a \) имеем \( \sigma(xa) \leq \sigma(x) + 1 \).
Доказательство.
Если \( \sigma(xa) > \sigma(x) + 1 \), то отбросим последний символ \( a \) от наибольшего суффикса \( xa \), являющегося префиксом \( P \), и получим суффикс строки \( x \), имеющий длину больше \( \sigma(x) \) и являющийся префиксом \( P \) — противоречие (см. рис. 34.7).

Лемма 34.3 (Рекуррентная формула для суффикс-функции)
Пусть \( q = \sigma(x) \), где \( x \) — строка. Тогда для любого символа \( a \) имеем \( \sigma(xa) = \sigma(P_q a) \).
Доказательство.
Лемма 34.2 гласит, что \( \sigma(xa) \leq q + 1 \). Поэтому значение \( \sigma(xa) \) не изменится, если оставить от строки \( xa \) последние \( q + 1 \) символов, то есть заменить его на строку \( P_q a \) (напомним, что последние \( q \) символов строки \( x \) образуют слово \( P_q \), так как \( \sigma(x) = q \) (рис. 34.8).

Из леммы 34.3 немедленно вытекает
Теорема 34.4
Пусть \( \varphi \) — функция конечного состояния автомата для поиска