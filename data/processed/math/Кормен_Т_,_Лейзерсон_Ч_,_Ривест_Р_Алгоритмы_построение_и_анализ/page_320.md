---
source_image: page_320.png
page_number: 320
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 74.03
tokens: 11755
characters: 2418
timestamp: 2025-12-24T06:35:41.823515
finish_reason: stop
---

Оптимальная триангуляция многоугольника

бить для решения задачи о триангуляции. Надо только в его заголовке заменить \( p \) на \( v \) и строку 9 заменить на такую:

\[
9 \quad \text{do } q \leftarrow m[i, k] + m[k + 1, j] + w(\Delta v_{i-1} v_k v_j)
\]

В результате работы алгоритма \( m[1, n] \) станет равным весу оптимальной триангуляции.

Строение оптимальной триангуляции

Докажем последнее утверждение. Пусть \( T \) — оптимальная триангуляция \((n + 1)\)-угольника \( P = \langle v_0, v_1, \ldots, v_n \rangle \). Ребро \( v_0 v_n \) входит в один из треугольников триангуляции. Пусть это треугольник \( \triangle v_0 v_k v_n \), где \( 1 \leq k \leq n - 1 \). Тогда вес триангуляции \( T \) равен весу \( \triangle v_0 v_k v_n \) плюс сумма весов триангуляций многоугольников \( \langle v_0, v_1, \ldots, v_k \rangle \) и \( \langle v_k, v_{k+1}, \ldots, v_n \rangle \). Следовательно, триангуляции указанных многоугольников обязаны быть оптимальными, и если оптимальные стоимости для таких многоугольников (при разных \( k \)) уже вычислены, то остаётся выбрать оптимальное значение \( k \).

Рекуррентная формула

Другими словами, имеет место следующая рекуррентная формула. Пусть \( m[i, j] \) — вес оптимальной триангуляции многоугольника \( \langle v_{i-1}, v_i, \ldots, v_j \rangle \), где \( 1 \leq i < j \leq n \). Вес оптимальной триангуляции всего многоугольника равен \( m[1, n] \). Будем считать, что "двугольники" \( \langle v_{i-1}, v_i \rangle \) имеют вес 0. Тогда \( m[i, i] = 0 \) для \( i = 1, 2, \ldots, n \). Если \( j - i \geq 1 \), то у многоугольника \( \langle v_{i-1}, v_i, \ldots, v_j \rangle \) имеется не менее трёх вершин, и нам необходимо найти минимум (по всем \( k \) из промежутка \( i \leq k \leq j - 1 \)) такой суммы: вес \( \triangle v_{i-1} v_k v_j \), плюс вес оптимальной триангуляции \( \langle v_{i-1}, v_i, \ldots, v_k \rangle \), плюс вес оптимальной триангуляции \( \langle v_k, v_{k+1}, \ldots, v_j \rangle \). Поэтому

\[
m[i, j] = \begin{cases}
0 & \text{при } i = j, \\
\min_{i \leq k < j} \{ m[i, k] + m[k + 1, j] + w(\Delta v_{i-1} v_k v_j) \} & \text{при } i < j.
\end{cases}
\]

Единственное отличие этой формулы от формулы (16.2) — более общий вид весовой функции. Стало быть, алгоритм Matrix-Chain-Order с указанными выше изменениями вычисляет вес оптимальной триангуляции; время работы \( \Theta(n^3) \), объём используемой памяти \( \Theta(n^2) \).