---
source_image: page_240.png
page_number: 240
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 86.39
tokens: 11762
characters: 2411
timestamp: 2025-12-24T06:31:56.846054
finish_reason: stop
---

от предыдущих. Пусть \( M \) — максимальная длина цепочек после добавления \( n \) ключей. Ваша задача — доказать, что математическое ожидание \( M \) есть \( O(\lg n / \lg \lg n) \).
а. Фиксируем некоторое хеш-значение. Пусть \( Q_k \) — вероятность того, ему соответствует \( k \) различных ключей. Покажите, что
\[
Q_k = C_n^k \left( \frac{1}{n} \right)^k \left( 1 - \frac{1}{n} \right)^{n-k}.
\]
б. Пусть \( P_k \) — вероятность того, что максимальная длина цепочки равна \( k \). Покажите, что \( P_k \leq n Q_k \).
в. Выведите из формулы Стирлинга (2.11), что \( Q_k < e^k / k!^k \).
г. Покажите, что существует такая константа \( c > 1 \), что \( Q_k < 1/n^3 \) при \( k \geq c \lg n / \lg \lg n \). Заключите отсюда, что \( P_k < 1/n^2 \) при таких \( k \).
д. Покажите, что математическое ожидание величины \( M \) не превосходит
\[
P \left\{ M > \frac{c \lg n}{\lg \lg n} \right\} \cdot n + P \left\{ M \leq \frac{c \lg n}{\lg \lg n} \right\} \cdot \frac{c \lg n}{\lg \lg n},
\]
и выведите отсюда, что это математическое ожидание есть \( O(\lg n / \lg \lg n) \).

12-4 Пример квадратичной последовательности проб
Пусть нам надо поместить запись с ключом \( k \) в хеш-таблицу, ячейки которой пронумерованы числами \( 0, 1, \ldots, m-1 \). У нас есть хеш-функция \( h \), отображающая множество ключей в множество \( \{0, 1, \ldots, m-1\} \). Будем действовать так:
1. Находим \( i \leftarrow h(k) \) и полагаем \( j \leftarrow 0 \).
2. Проверяем позицию номер \( i \). Если она свободна, заносим туда запись и на этом останавливаемся.
3. Полагаем \( j \leftarrow (j+1) \mod m \) и \( i \leftarrow (i+j) \mod m \) и возвращаемся к шагу 2.
а. Покажите, что описанный алгоритм — частный случай "квадратичного метода" для подходящих значений \( c_1 \) и \( c_2 \).
Предположим, что \( m \) является степенью двойки.
б. Покажите, что в худшем случае будет просмотрена вся таблица.

12-5 \( k \)-универсальное хеширование
Пусть \( \mathcal{H} \) — семейство хеш-функций, отображающих множество возможных ключей \( U \) в \( \{0, 1, \ldots, m-1\} \). Будем говорить, что \( \mathcal{H} \) является \( k \)-универсальным, если для любой последовательности \( k \) различных ключей \( \langle x_1, \ldots, x_k \rangle \) случайная величина \( \langle h(x_1), \ldots, h(x_k) \rangle \) (где \( h \) — случайный элемент \( \mathcal{H} \)) принимает все \( m^k \) своих возможных значений с равными вероятностями.