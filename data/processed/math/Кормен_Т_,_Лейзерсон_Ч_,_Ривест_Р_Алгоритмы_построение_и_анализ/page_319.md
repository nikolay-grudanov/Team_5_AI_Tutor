---
source_image: page_319.png
page_number: 319
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 72.87
tokens: 11796
characters: 2708
timestamp: 2025-12-24T06:35:36.296796
finish_reason: stop
---

Триангуляции и расстановки скобок

Существует удивительная связь между триангуляциями многоугольника и расстановками скобок (скажем, в произведении последовательности матриц). Проще всего объяснить эту связь с помощью деревьев.

Полной расстановке скобок соответствует так называемое дерево разбора (parse tree) выражения. На рис. 16.5а изображено дерево разбора для

\[
((A_1(A_2A_3))(A_4(A_5A_6))).
\]

В его листьях стоят матрицы-сомножители, а в вершинах — их произведения: в каждой вершине стоит произведение двух выражений, стоящих в её детях.

Триангуляцию выпуклого многоугольника \( \langle v_0, v_1, \ldots, v_{n-1} \rangle \) также можно изобразить в виде дерева. Листьями его будут стороны многоугольника (кроме \( \overline{v_0v_{n-1}} \)). Остальные вершины — это диагонали триангуляции плюс сторона \( \overline{v_0v_{n-1}} \); эту последнюю объявим корнем.

Построение дерева (на примере триангуляции рис. 16.5а) показано на рис. 16.5б. Для начала мы смотрим, в какой треугольник попал корень \( \overline{v_0v_{n-1}} \). В нашем случае это \( \triangle v_0v_3v_6 \). Детьми корня будем считать две другие стороны этого треугольника. Триангуляция состоит из этого треугольника и двух триангуляций оставшихся частей (\( \langle v_0, v_1, v_2, v_3 \rangle \) и \( \langle v_3, v_4, v_5, v_6 \rangle \), рис. 16.5б), причём диагонали, являющиеся детьми корня, являются сторонами этих многоугольников (\( \overline{v_0v_3} \) и \( \overline{v_3v_6} \) на рис. 16.5б). Повторим для каждой из них ту же конструкцию: рассмотрим треугольник триангуляции нового многоугольника, содержащий выделенную сторону, две другие стороны этого треугольника объявим её детьми и т.д. В конце концов мы придём к бинарному дереву с \( n - 1 \) листом. Действуя в обратном порядке, можно по бинарному дереву построить триангуляцию. Построенное соответствие между триангуляциями и бинарными деревьями является взаимно однозначным.

Вспоминая, что полные расстановки скобок в произведении \( n \) сомножителей находятся во взаимно однозначном соответствии с бинарными деревьями с \( n \) листьями, получаем взаимно однозначное соответствие между полными расстановками скобок в произведении \( n \) матриц и триангуляциями \((n + 1)\)-угольника. При этом матрица \( A_i \) в произведении \( A_1A_2 \ldots A_n \) соответствует стороне \( \overline{v_{i-1}v_i} \), а диагональ \( \overline{v_{i-1}v_j} \) (\( 1 \leq i < j \leq n \)) соответствует произведению \( A_{i..j} \).

Это соответствие можно понять и без деревьев. Напишем на всех сторонах триангулированного многоугольника, кроме одной, по сомножителю. Далее поступаем так: если в треугольнике две стороны уже помечены, то на третьей мы пишем их произведение. На