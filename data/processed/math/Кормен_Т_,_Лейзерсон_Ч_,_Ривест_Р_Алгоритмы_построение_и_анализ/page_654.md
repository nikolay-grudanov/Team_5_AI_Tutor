---
source_image: page_654.png
page_number: 654
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.31
tokens: 11528
characters: 2318
timestamp: 2025-12-24T06:51:12.717166
finish_reason: stop
---

3. К удалению назначаются помеченные объекты, у которых следующий объект не помечен: объект i удаляется, если он помечен, а next[i] не помечен (никаким другим процессором).

Описанные действия выполняются за время O(1) и не используют одновременный доступ к памяти.

Очевидно, что требование 1 выполнено (каждый процессор выбирает не более одного элемента). Требование 2 также выполнено, так как объекты i и next[i] не могут быть выбраны одновременно — если next[i] выбран, то он должен быть помечен — а тогда объект i не выбирается.

30.4.3 Анализ

Поскольку шаг рекурсии занимает время O(1), необходимо оценить лишь количество шагов, после которого список станет пустым. Пусть на этапе 1 описанного процесса какой-то процессор выбрал объект i. Какова вероятность того, что объект i попадёт в число удаляемых? Для этого нужно, чтобы на этапе 2 он был помечен (вероятность 1/2) и чтобы чтобы объект next[i] не был помечен (это независимое событие, имеющее вероятность не меньше 1/2 — лишь один процессор может пометить next[i], и с вероятностью 1/2 он бездействует). Таким образом, вероятность удаления объекта i нее меньше 1/4.

Таким образом, ситуацию можно описать так. Имеется n/lg n групп по lg n элементов в каждой (для простоты мы будем считать, что элементы делятся на группы без остатка). На каждом шаге число элементов в группе может уменьшится на 1 или остаться прежним, при этом вероятность уменьшения не менее 1/4. Уменьшения в разных группах на одном шаге могут не быть независимыми, но уменьшения на разных шагах в одной группе независимы.

Нам надо доказать, что математическое ожидание времени полного исчезновения всех групп есть O(lg n). Анализа для одной группы тут недостаточно, поскольку даже один долго работающий процессор уже увеличивает общее время работы.

Мы покажем, что с вероятностью не менее 1 – 1/n список станет пустым через время c lg n для некоторой константы с. Полное доказательство оценки Θ(lg n) для математического ожидания времени работы оставляется читателю (упр. 30.4-4 и 30.4-5).

Поскольку нас интересует верхняя оценка времени, когда список станет пустым, будем считать, что вероятность уменьшения данной группы на каждом шаге в точности равна 1/4 (хотя на самом деле она может быть больше); формальное обоснование законности такого допущения даётся в упр. 6.4-8 и 6.4-9.