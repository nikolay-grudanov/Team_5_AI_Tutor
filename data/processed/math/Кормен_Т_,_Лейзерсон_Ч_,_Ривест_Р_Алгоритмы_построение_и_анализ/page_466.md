---
source_image: page_466.png
page_number: 466
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.55
tokens: 11637
characters: 2468
timestamp: 2025-12-24T06:42:26.232550
finish_reason: stop
---

Рисунок 23.3 23.4 Исполнение алгоритма DFS для ориентированного графа. После просмотра каждое ребро становится либо серым (если оно включается в дерево поиска) или пунктирным (обратные рёбра помечены буквой B (back), перекрёстные — буквой C (cross), прямые — буквой F (forward)). У каждой вершины показаны времена начала и конца обработки.

7 $color[u]\leftarrow$ чёрный //вершина обработана, делаем её черной
8 $f[u]\leftarrow time\leftarrow time+1$

На рис. 23.4 показана работа процедуры DFS на графе рис. 23.2.
В строках 1-3 все вершины красятся в белый цвет; в поле \( \pi \) помещается nil. В строке 4 устанавливается начальное (нулевое) время. В строках 5-7 вызывается процедура DFS-Visit для всех вершин (которые остались белыми к моменту вызова — предыдущие вызовы процедуры могли сделать их чёрными). Эти вершины становятся корнями деревьев поиска в глубину.
В момент вызова DFS-Visit(u) вершина u — белая. В строке 1 она становится серой. В строке 2 время её обнаружения заносится в \( d[u] \) (до этого счётчик времени увеличивается на 1). В строках 3-7 просматриваются смежные с u вершины; процедура DFS-Visit вызывается для тех из них, которые оказываются белыми к моменту вызова. После просмотра всех смежных с u вершин мы делаем вершину u чёрной и записываем в \( f[u] \) время этого события.
Подсчитаем общее число операций при выполнении процедуры DFS. Циклы в строках 1-3 и 5-7 требуют \( \Theta(V) \) времени (помимо вызовов DFS-Visit). Процедура DFS-Visit вызывается ровно один раз для каждой вершины (ей передаётся белая вершина, и она сразу же делает её серой). Во время выполнения DFS-Visit(v) цикл в строках 3-6 выполняется \( |Adj[v]| \) раз. Поскольку

\[
\sum_{v \in V} |Adj[v]| = \Theta(E),
\]

время выполнения строк 3-6 процедуры DFS-Visit составляет \( \Theta(E) \). В сумме получается время \( \Theta(V + E) \).
Свойства поиска в глубину.
Прежде всего отметим, что подграф предшествования (составленный из деревьев поиска в глубину) в точности соответствует структуре рекурсивных вызовов процедуры DFS-Visit. Именно, \( u = \pi[v] \) тогда и только тогда, когда произошёл вызов DFS-Visit(v) во время просмотра списка смежных с u вершин.
Другое важное свойство состоит в том, что времена обнаружения и окончания обработки образуют правильную скобочную структуру (parenthesis structure). Обозначая обнаружение вершины u открывающийся скобкой с меткой u, а окончание её обработки — закрывающейся с той же меткой, то перечень событий будет