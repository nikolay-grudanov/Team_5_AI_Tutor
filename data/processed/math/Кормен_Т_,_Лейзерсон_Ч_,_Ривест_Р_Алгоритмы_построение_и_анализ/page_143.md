---
source_image: page_143.png
page_number: 143
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.33
tokens: 11390
characters: 1740
timestamp: 2025-12-24T06:26:55.985168
finish_reason: stop
---

7.4 Алгоритм сортировки с помощью кучи

Алгоритм сортировки с помощью кучи состоит из двух частей. Сначала вызывается процедура Build-Heap, после выполнения которой массив является кучей. Идея второй части проста: максимальный элемент массива теперь находится в корне дерева (A[1]). Его следует поменять с A[n], уменьшить размер кучи на 1 и восстановить основное свойство в корневой вершине (поскольку поддеревья с корнями Left(1) и Right(1) не утратили основного свойства кучи, это можно сделать с помощью процедуры Heapify). После этого в корне будет находиться максимальный из оставшихся элементов. Так делается до тех пор, пока в куче не останется всего один элемент.

Heapsort(A)
1 Build-Heap(A)
2 for i ← length[A] downto 2
3 do поменять A[1] ↔ A[i]
4 heap-size[A] ← heap-size[A] − 1
5 Heapify(A, 1)

Работа второй части алгоритма показана на рис. 7.4. Изображены состояния кучи перед каждым выполнением цикла for (строка 2).

Время работы процедуры Heapsort составляет O(n lg n). Действительно, первая часть (построение кучи) требует времени O(n), а каждое из n − 1 выполнений цикла for занимает время O(lg n).

Упражнения

7.4-1 Покажите, следуя образцу рис. 7.4, как работает процедура Heapsort для массива \( A = \langle 5, 13, 2, 25, 7, 17, 20, 8, 4 \rangle \).

7.4-2 Пусть исходный массив A уже отсортирован в порядке возрастания. Каково будет время сортировки с помощью кучи? А если массив был отсортирован в порядке убывания?

7.4-3 Докажите, что время работы процедуры Heapsort составляет \( \Omega(n \lg n) \).

7.5 Очереди с приоритетами

На практике алгоритм сортировки с помощью кучи не является самым быстрым — как правило, быстрая сортировка ( гл. 8 ) работает быстрее. Однако сама куча как структура данных часто ока-