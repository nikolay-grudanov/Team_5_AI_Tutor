---
source_image: page_542.png
page_number: 542
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 70.55
tokens: 11815
characters: 2409
timestamp: 2025-12-24T06:46:20.003958
finish_reason: stop
---

Алгоритм Флойда-Уоршалла

кончающихся в k. (Почему не было такого множителя в алгоритме Флойда-Уоршалла с неотрицательными весами и в алгоритме вычисления транзитивного замыкания? Дело в том, что в обоих случаях \( a^* = \bar{1} \) и поэтому этот "множитель" можно было опустить.)

Начальные значения для рекуррентного соотношения (26.12) таковы:

\[
l_{ij}^{(0)} = \begin{cases}
\lambda(i, j) & \text{если } i \neq j, \\
\bar{1} \oplus \lambda(i, j) & \text{если } i = j.
\end{cases}
\]

В самом деле, путь из одного ребра имеет метку, равную метке этого ребра, а пустой путь имеет метку \( \bar{1} \) в соответствии с нашим соглашением; этот путь надо учесть при \( i = j \).

Мы приходим к алгоритму, использующему метод динамического программирования для последовательного отыскания величин \( l_{ij}^{(k)} \) при \( k = 0, 1, 2 \ldots, n \); его ответом является матрица \( L^{(n)} = (l_{ij}^{(n)}) \) (соответствующая "суммированию" по всем путям без ограничений на промежуточные вершины).

{\sc Compute-Summaries}$(\lambda,V)$\\
\verb|1 |$n\leftarrow|V|$\|
\verb|2 |for $i\leftarrow1$ to $n$|\\
\verb|3 |do for $j\leftarrow1$ to $n$|\\
\verb|4 |do if $i=j$|\\
\verb|5 |then $1^{((0))}_{ij}\leftarrow\bar{1}\oplus\lambda(i,j)$|\\
\verb|6 |else $1^{((0))}_{ij}\leftarrow\lambda(i,j)$|\\
\verb|7 |for $k\leftarrow1$ to $n$|\\
\verb|8 |do for $i\leftarrow1$ to $n$|\\
\verb|9 |do for $j\leftarrow1$ to $n$|\\
\verb|10 |do $1^{((k))}_{ij}=1^{((k-1))}_{ij}\oplus(1^{((k-1))}_{ik})$|\\
odot(1^{((k-1))}_{kk})^{\ast}\odot 1^{((k-1))}_{kj})$\\
\verb|11 |return $L^{((n))}$|

Время работы данного алгоритма зависит от времени выполнения операций \( \circ, \oplus \) и \( * \). Обозначив время выполнения операций через \( T_{\circ}, T_{\oplus}, T_{*} \), общее время работы алгоритма Compute-Summaries можно записать как \( \Theta(n^3)(T_{\circ} + T_{\oplus} + T_{*}) \), что преобразуется в \( \Theta(n^3) \), если время выполнения любой из трёх операций составляет \( O(1) \).

Упражнения

26.4-1 Проверьте, что \( S_1 = (\mathbb{R} \geq 0 \cup \{\infty\}, \min, +, \infty, 0) \) и \( S_3 = (\{0, 1\}, \vee, \wedge, 0, 1) \) являются замкнутыми полукольцами.

26.4-2 Проверьте, что \( S_2 = (\mathbb{R} \cup \{-\infty, +\infty\}, \min, +, +\infty, 0) \) является закнутым полукольцом. Чему равно значение \( a + (-\infty) \) для \( a \in \mathbb{R} \)? Что можно сказать о значении \( (-\infty) + (+\infty) \)?