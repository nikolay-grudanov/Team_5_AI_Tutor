---
source_image: page_784.png
page_number: 784
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.13
tokens: 11728
characters: 2248
timestamp: 2025-12-24T06:57:15.234612
finish_reason: stop
---

• Перед каждым исполнением тела цикла (строки 6–12) выполнено равенство

\[
q = \begin{cases}
\sigma(T_{i-1}), & \text{если } \sigma(T_{i-1}) < m; \\
\pi[m], & \text{если } \sigma(T_{i-1}) = m.
\end{cases}
\]

(здесь \( \sigma(T_j) \) — длина наибольшего префикса \( P \), являющегося суффиксом \( T_j \)).

Заметим, что при \( i = 1 \) второе утверждение верно. Покажем теперь, что при каждом \( i \) из второго утверждения следует первое. В самом деле, пусть при некотором \( i \) второе утверждение верно. Лемма 34.5 показывает, что в строках 6–7 перебираются в убывающем порядке элементы множества \( S = \{ k < m : P_k \sqsupseteq P_q \} \), причем перебор обрывается либо при нахождении наибольшего \( k \in S \), для которого \( P[k+1] = T[i] \), либо при \( k = 0 \) и \( P[1] \neq T[i] \). В первом случае по выходе из цикла в строках 6–7 \( q \) равняется наибольшему \( k \), для которого \( P_k \sqsupseteq T_{i-1} \) и \( P_{k+1} \sqsupseteq T_i \); ясно, что \( k + 1 = \sigma(T_i) \), и после исполнения строки 9 значение \( k + 1 \) присваивается переменной \( q \). Во втором случае по выходе из цикла в строках 6–7 имеем, очевидно, \( \sigma(T_i) = 0 \) и \( q = 0 \); в обоих случаях второе утверждение выполнено. Наконец, если второе утверждение верно для некоторого \( i < n \), то, очевидно, первое утверждение верно для \( i + 1 \). Это завершает индукцию и доказательство.

Упражнения

34.4-1
Найдите префикс-функцию для строки ababbabbabababababbabb.

34.4-2
Укажите верхнюю оценку на размер множества \( \pi^*[q] \) (как функцию от \( q \)) и покажите, что ваша оценка неулучшаема.

34.4-3
Как можно найти все вхождения образца \( P \) в текст \( T \), зная префикс-функцию строки \( PT \) (конкатенация \( P \) и \( T \))?

34.4-4
Покажите, что в алгоритме КМР-Матчер можно в строке 7 (но не в строке 12) заменить \( \pi \) на \( \pi' \), где функция \( \pi' \) определена так:

\[
\pi'[q] = \begin{cases}
0, & \text{если } \pi[q] = 0; \\
\pi'[\pi[q]], & \text{если } \pi[q] \neq 0 \text{ и } P[\pi[q] + 1] = P[q + 1]; \\
\pi[q], & \text{если } \pi[q] \neq 0 \text{ и } P[\pi[q] + 1] \neq P[q + 1].
\end{cases}
\]

Почему можно сказать, что такая модификация алгоритма КМР-Матчер является его усовершенствованием?

34.4-5