---
source_image: page_155.png
page_number: 155
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.13
tokens: 11604
characters: 2543
timestamp: 2025-12-24T06:27:36.342098
finish_reason: stop
---

Вероятностные алгоритмы быстрой сортировки

сировано не хуже, чем \( \alpha : 1 - \alpha \), примерно равна \( 1 - 2\alpha \). При каком значении \( \alpha \) вероятность этого события равна \( 1/2 \)?

8.3 Вероятностные алгоритмы быстрой сортировки

Ранее мы предположили, что все перестановки входных значений равновероятны. Если это так, а размер массива достаточно велик, быстрая сортировка — один из наиболее эффективных алгоритмов. На практике, однако, это предположение (равной вероятности всех перестановок на входе) не всегда оправдано (см. упр. 8.2-3). В этом разделе мы введём понятие вероятностного алгоритма и рассмотрим два вероятностных алгоритма быстрой сортировки, которые позволяют отказаться от предположения о равной вероятности всех перестановок.

Идея состоит в привнесении случайности, обеспечивающем нужное распределение. Например, перед началом сортировки можно случайно переставить элементы, после чего уже все перестановки станут равновероятными (это можно сделать за время \( O(n) \) — см. упр. 8.3-4). Такая модификация не увеличивает существенно время работы, но теперь математическое ожидание времени работы не зависит от порядка элементов во входном массиве (они всё равно случайно переставляются).

Алгоритм называется вероятностным (randomized), если он использует генератор случайных чисел (random-number generator). Мы будем считать, что генератор случайных чисел RANDOM работает так: RANDOM\((a, b)\) возвращает с равной вероятностью любое целое число в интервале от \(a\) до \(b\). Например, RANDOM\((0, 1)\) возвращает 0 или 1 с вероятностью \(1/2\). При этом разные вызовы процедуры независимы в смысле теории вероятностей. Можно считать, что мы каждый раз бросаем кость с \((b - a + 1)\) гранями и сообщаем номер выпавшей грани. (На практике обычно используют генератор псевдослучайных чисел (pseudorandom-number generator) — детерминированный алгоритм, который выдаёт числа, "похожие" на случайные.)

Для такого вероятностного варианта алгоритма варианта быстрой сортировки нет "неудобных входов": упражнение 13.4-4 показывает, что перестановок, при которых время работы велико, совсем мало — поэтому вероятность того, что алгоритм будет работать долго (для любого конкретного входа) невелика.

Аналогичный подход применим и в других ситуациях, когда в ходе выполнения алгоритма мы должны выбрать один из многих вариантов его продолжения, причём мы не знаем, какие из них хорошие, а какие плохие, но знаем, что хороших вариантов достаточно много. Нужно только, чтобы плохие выборы не разрушали достиг-