---
source_image: page_183.png
page_number: 183
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.08
tokens: 11560
characters: 2174
timestamp: 2025-12-24T06:28:59.090001
finish_reason: stop
---

RANDOMIZED-SELECT \((A, p, r, i)\)

1 if \(p = r\)
2 then return \(A[p]\)
3 \(q \leftarrow\) RANDOMIZED-PARTITION\((A, p, r)\)
4 \(k \leftarrow q - p + 1\)
5 if \(i \leq k\)
6 then return RANDOMIZED-SELECT\((A, p, q, i)\)
7 else return RANDOMIZED-SELECT\((A, q + 1, r, i - k)\)

После исполнения процедуры RANDOMIZED-PARTITION в строке 3 массив \(A[p..r]\) состоит из двух непустых частей \(A[p..q]\) и \(A[q+1..r]\), причём всякий элемент \(A[p..q]\) меньше всякого элемента \(A[q+1..r]\). В строке 4 вычисляется количество элементов в массиве \(A[p..q]\). Дальнейшее зависит от того, в каком из этих двух массивов лежит \(i\)-й по величине элемент массива \(A[p..r]\). Если \(i \leq k\), то нужный нам элемент лежит в левой части (массиве \(A[p..q]\)), откуда и извлекается в результате (рекурсивного) вызова RANDOMIZED-SELECT в строке 6. Если же \(i > k\), то все \(k\) элементов левой части (\(A[p..q]\)) заведомо меньше искомого, который можно найти как \((i - k)\)-й по счёту элемент массива \(A[q+1..r]\) (строка 7).

Время работы алгоритма RANDOMIZED-SELECT (с учётом времени работы процедуры RANDOMIZED-PARTITION) в худшем случае есть \(\Theta(n^2)\), даже если мы ищем всего лишь минимум: в самом деле, при особом невезении может оказаться, что мы все время разбиваем массив возле наибольшего оставшегося элемента. Однако случайный выбор гарантирует, что для любого входа среднее время работы алгоритма будет невелико.

Докажем это. Рассмотрим для каждой из возможных перестановок \(n\) элементов математическое ожидание времени работы алгоритма (среднее по всем случайным выборам). Пусть \(T(n)\) — максимальное из этих ожиданий. Как мы отмечали в разделе 8.4, после вызова RANDOMIZED-PARTITION левая часть разбиения содержит 1 элемент с вероятностью \(2/n\), и содержит \(i > 1\) элементов с вероятностью \(1/n\) для любого \(i\) от 2 до \(n-1\). Можно считать, что \(T(n)\) монотонно возрастает с ростом \(n\) (если это не так, заменим \(T(n)\) на \(T'(n) = \max_{1 \leq i \leq n} T(i)\) и повторим все рассуждения для \(T'\)). Заметим, что худшим случаем будет тот, когда \(i\)-й по счёту элемент попадает в большую из двух половин, на которые разбивается мас-