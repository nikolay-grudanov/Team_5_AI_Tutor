---
source_image: page_366.png
page_number: 366
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 90.48
tokens: 11749
characters: 2724
timestamp: 2025-12-24T06:38:13.384448
finish_reason: stop
---

Динамические таблицы

вления записей в таблицу постоянного размера.

Дела пойдут лучше, если мы разрешим коэффициенту заполнения опускаться ниже 1/2 [ведя гистерезис в наш алгоритм, как сказали бы физики]. Именно, мы по-прежнему удваиваем размер таблицы при попытке добавить запись к заполненной таблице, а вот сокращение таблицы вдвое мы предпринимаем только тогда, когда коэффициент заполнения падает ниже 1/4. Таким образом, коэффициент заполнения всегда будет больше или равен 1/4. Другими словами, мы считаем 50% оптимальным коэффициентом заполнения таблицы, и возвращаемся к такой ситуации, как только коэффициент заполнения отклонится от оптимального в два раза (в любую сторону).

Мы не будем выписывать псевдокод для алгоритма Table-Delete — он аналогичен коду для Table-Insert. Отметим только, что при удалении из таблицы последней записи разумно полностью освобождать память, занимаемую ячейками таблицы. Ниже мы будем считать, что в алгоритме Table-Delete это предусмотрено, иными словами, что size[T] = 0, как только num[T] = 0.

Для оценки стоимости последовательности из n операций Table-Insert и Table-Delete, примененных к пустой таблице, мы воспользуемся методом потенциалов. Потенциальная функция будет равна нулю, когда коэффициент заполнения оптимален (равен 1/2) — так будет сразу после сокращения или расширения. Потенциал возрастает по мере того, как коэффициент заполнения приближается к 1 или 1/4. Напомним, что коэффициент заполнения \( \alpha(T) \) равен \( num[T]/size[T] \), если \( size[T] \neq 0 \), и равен 1, если \( size[T] \) (и тем самым \( num[T] \)) равно нулю. Нашим требованиям удовлетворяет такая потенциальная функция:

\[
\Phi(T) = \begin{cases}
2 \cdot num[T] - size[T], & \text{если } \alpha[T] \leq 1/2, \\
size[T]/2 - num[T], & \text{если } \alpha[T] \geq 1/2.
\end{cases}
\]

Заметим, что \( \Phi(T) = 0 \) при \( \alpha(T) = 1/2 \) (по любой из двух формул), что потенциал пустой таблицы равен нулю и что потенциал всегда неотрицателен. Если коэффициент заполнения равен 1 или 1/4, то \( \Phi[T] = num[T] \), так что накопленного потенциала достаточно для оплаты расширения или сокращения таблицы. На рис. 18.4 изображено, как меняется потенциал в процессе выполнения последовательности операций Table-Insert и Table-Delete.

Найдем учётные стоимости операций при таком потенциале \( \Phi \). Если операция Table-Insert или Table-Delete не сопровождается расширением или сокращением таблицы, то изменение потенциала не превосходит 2 (\( size \) не меняется, \( num \) меняется на 1), так что учётная стоимость не превосходит 3. В случае расширения или сжатия таблицы учётная стоимость оказывается равной 1, так как изменения в потенциале компенсируют затраты на копирование.