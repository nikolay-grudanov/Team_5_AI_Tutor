---
source_image: page_531.png
page_number: 531
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 68.94
tokens: 11929
characters: 2795
timestamp: 2025-12-24T06:45:43.694933
finish_reason: stop
---

**Глава 26 Кратчайшие пути для всех пар вершин**

Алгоритм Флойда-Уоршолла содержит три вложенных цикла (строки 3–6); время его работы есть \( \Theta(n^3) \). Константа, скрытая в \( \Theta \)-обозначении, невелика, поскольку алгоритм прост и не использует сложных структур данных, так что он применим для достаточно больших графов.

Построение кратчайших путей
Помимо весов кратчайших путей, нас интересуют и сами пути. Один из способов их построения таков: вычисливы вычислении матрицу \( D \) их весов, можно затем построить по ней матрицу предшествования \( \Pi \) за время \( O(n^3) \) времени (упр. 26.1-5). Затем при помощи функции Print-All-Pairs-Shortest-Path можно напечатать кратчайший путь для любой пары вершин.

Другой способ состоит в том, чтобы вычислять матрицу предшествования параллельно с исполнением алгоритма Флойда–Уоршолла. При этом мы вычисляем последовательность матриц \( \Pi^{(0)}, \Pi^{(1)}, \ldots, \Pi^{(n)} \), где \( \Pi = \Pi^{(n)} \), а \( \pi_{ij}^{(k)} \) определяется как вершина, предшествующая вершине \( j \) на кратчайшем пути из вершины \( i \) в вершину \( j \) с промежуточными вершинами из множества \( \{1, 2, \ldots, k\} \).

Напишем рекурентную формулу для \( \pi_{ij}^{(k)} \). Если \( k = 0 \), то промежуточных вершин нет, поэтому

\[
\pi_{ij}^{(0)} = \begin{cases}
\text{NIL} & \text{если } i = j \text{ или } w_{ij} = \infty, \\
i & \text{если } i \neq j \text{ и } w_{ij} < \infty.
\end{cases}
\]

Пусть теперь \( k \geq 1 \). Если кратчайший пути из \( i \) в \( j \) проходит через вершину \( k \), то предпоследней его вершиной будет та же самая вершина, которая будет предпоследней на кратчайшем пути из \( k \) в \( j \) с промежуточными вершинами из множества \( \{1, 2, \ldots, k-1\} \). Если же путь не проходит через \( k \), то он совпадает с кратчайшим путем из \( i \) в \( j \) с промежуточными вершинами из множества \( \{1, 2, \ldots, k-1\} \). Таким образом,

\[
\pi_{ij}^{(k)} = \begin{cases}
\pi_{ij}^{(k-1)} & \text{если } d_{ij}^{(k-1)} \leq d_{ik}^{(k-1)} + d_{kj}^{(k-1)}, \\
\pi_{kj}^{(k-1)} & \text{если } d_{ij}^{(k-1)} > d_{ik}^{(k-1)} + d_{kj}^{(k-1)}.
\end{cases}
\]

Вычисления по этим формулам легко добавить к алгоритму Флойда–Уоршолла (упр. 26.2-3). На рис. 26.4 показана последовательность матриц \( \Pi^{(k)} \), получающаяся в процессе вычислений. В том же упражнении предлагается доказать, что подграф предшествования \( G_{\pi,i} \) является деревом кратчайших путей из вершины \( i \). Другой способ построения кратчайших путей указан в упр. 26.2-6.

Транзитивное замыкание ориентированного графа
Задача о транзитивном замыкании состоит в следующем. Дан ориентированный граф \( G = (V, E) \) с вершинами \( 1, 2, \ldots, n \). Требуется определить для любой пары его вершин \( i, j \in V \), существует