---
source_image: page_710.png
page_number: 710
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 52.26
tokens: 11636
characters: 2384
timestamp: 2025-12-24T06:53:45.006937
finish_reason: stop
---

Рисунок 31.4  32.3 Преобразование бабочки. Слева поступают два входных значения, \( \omega_n^k \) умножается на \( y_k^{[1]} \), справа выдаются значения суммы и разности. Рисунок можно рассматривать как схему, составленную из элементов сложения, вычитания и умножения.

Рисунок 31.5  32.4 Дерево входных векторов для рекурсивных вызовов процедуры RECURSIVE-FFT. Исходным является вызов при \( n = 8 \).

Затем мы используем те же идеи для быстрой параллельной реализации.

Итеративная реализация быстрого преобразования Фурье

Прежде всего заметим, что в цикле for в строках 10–13 процедуры RECURSIVE-FFT дважды вычисляется значение \( \omega_n^k y_k^{[1]} \). Введя временную переменную \( t \), можно запомнить значение этого общего подвыражения (common subexpression — терминология, используемая разработчиками компиляторов), чтобы не вычислять его вторично:

for $k \leftarrow 0$ to $n/2-1$
\quad do $t \leftarrow \omega y_{k^{[1]}}$
\qquad $y_k \leftarrow y_{k^{[0]}} + t$
\qquad $y_{k+(n/2)} \leftarrow y_{k^{[0]}} - t$
\qquad $\omega \leftarrow \omega \omega_n$

Выполняемые в этом цикле действия показаны на рис. 32.3; их называют преобразованием бабочки (butterfly operation).

Сейчас мы покажем, как построить итеративный (а не рекурсивный) вариант быстрого преобразования Фурье. На рисунке 32.4 показаны входные векторы в дереве рекурсивных вызовов процедуры RECURSIVE-FFT, начиная с ее вызова для \( n = 8 \).

Указаны входные векторы для рекурсивных вызовов процедуры RECURSIVE-FFT; каждый такой вызов порождает два новых (для векторов половинной длины). На рисунке левый потомок соответствует первому из них, а правый — второму.

Эти рекурсивные вызовы можно заменить вычислением снизу вверх. Расположим элементы исходного вектора а в том порядке, в котором они появляются в листьях дерева (нижняя строка). Затем возьмём пары элементов, вычислим для них дискретное преобразование Фурье, используя преобразование бабочки. Получится содержимое второй снизу строки рисунка. (Элементы исходного вектора больше не нужны, так что можно записать результаты преобразований на их место.) Теперь из каждой двух пар мы собираем четвёрку, дважды выполнив преобразование бабочки, получается \( n/4 \) четвёрок. Далее из четвёрок собираются восьмёрки и т.д.; на последнем шаге из двух векторов длины \( n/2 \), являющихся преобразованиями Фурье чётной и нечётной части вектора а, из-