---
source_image: page_312.png
page_number: 312
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 64.75
tokens: 11686
characters: 2575
timestamp: 2025-12-24T06:35:02.741288
finish_reason: stop
---

**Recursive-Matrix-Chain?**

16.2-3 Нарисуйте дерево рекурсии для алгоритма Merge-Sort (сортировка слиянием) из раздела 1.3.1, применённого к массиву из 16 элементов. Почему здесь нет смысла запоминать ответы к уже решённым подзадачам?

**16.3 Наибольшая общая подпоследовательность**

Подпоследовательность получается из данной последовательности, если удалить некоторые её элементы (сама последовательность также считается своей подпоследовательностью). Формально: последовательность \( Z = \langle z_1, z_2, \ldots, z_k \rangle \) называется подпоследовательностью (subsequence) последовательности \( X = \langle x_1, x_2, \ldots, x_n \rangle \), если существует строго возрастающая последовательность индексов \( \langle i_1, i_2, \ldots, i_k \rangle \), для которой \( z_j = x_{i_j} \) при всех \( j = 1, 2, \ldots, k \).
Например, \( Z = \langle B, C, D, B \rangle \) является подпоследовательностью последовательности \( X = \langle A, B, C, B, D, A, B \rangle \); соответствующая последовательность индексов есть \( \langle 2, 3, 5, 7 \rangle \). (Отметим, что говоря о последовательностях, мы — в отличие от курсов математического анализа — имеем в виду конечные последовательности.)

Будем говорить, что последовательность \( Z \) является общей подпоследовательностью (common subsequence) последовательностей \( X \) и \( Y \), если \( Z \) является подпоследовательностью как \( X \), так и \( Y \).
Пример: \( X = \langle A, B, C, B, D, A, B \rangle,\ Y = \langle B, D, C, A, B, A \rangle,\ Z = \langle B, C, A \rangle \). Последовательность \( Z \) в этом примере — не самая длинная из общих подпоследовательностей \( X \) и \( Y \) (последовательность \( \langle B, C, B, A \rangle \) длиннее). Последовательность \( \langle B, C, B, A \rangle \) будет наибольшей общей подпоследовательностью для \( X \) и \( Y \), поскольку общих подпоследовательностей длины 5 у них нет. Наибольших общих подпоследовательностей может быть несколько. Например, \( \langle B, D, A, B \rangle \) — другая наибольшая общая подпоследовательность \( X \) и \( Y \).

Задача о наибольшей общей подпоследовательности (сокращенно НОП; по-английски LCS = longest-common-subsequence) состоит в том, чтобы найти общую подпоследовательность наибольшей длины для двух данных последовательностей \( X \) и \( Y \). В этом разделе мы покажем, как решить эту задачу с помощью динамического программирования.

**Строение наибольшей общей подпоследовательности**

Если решать задачу о НОП "в лоб", перебирая все подпоследовательности последовательности \( X \) и проверяя для каждой из них, не