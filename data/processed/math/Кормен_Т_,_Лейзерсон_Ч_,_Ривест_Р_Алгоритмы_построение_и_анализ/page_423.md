---
source_image: page_423.png
page_number: 423
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 68.66
tokens: 11595
characters: 2302
timestamp: 2025-12-24T06:40:27.399791
finish_reason: stop
---

одинаковыми степенями корня (процедура FIB-HEAP-LINK) даёт (неупорядоченное) биномиальное дерево (степень его корня на единицу больше).

Нам осталось показать, что учётная стоимость изъятия минимальной вершины из n-элементной фибоначчиевой кучи есть O(D(n)). Посмотрим, какие операции нам пришлось выполнить. Прежде всего нужно O(D(n)) действий, чтобы поместить всех потомков удаляемой вершины z в корневой список. Начальный и конечный этапы работы процедуры CONSOLIDATE (строки 1–2 и 15–19) также требует времени O(D(n)). Остаётся учесть вклад цикла for, расположенного в строках 3–13. Это число оценивается сверху как O(D(n)) (размер массива A) плюс константа, умноженная на число обращений к процедуре FIB-HEAP-LINK. Но при каждом таком обращении два дерева сливаются, что приводит в итоге к уменьшению длины корневого списка на 1 и к уменьшению потенциала по крайней мере на 1 (число отмеченных вершин может уменьшиться, но не увеличиться). Так что умножив потенциал на подходящую константу, мы можем считать, что учётная стоимость операции удаления есть O(D(n)).

Другими словами, операции связывания деревьев одинаковой степени (которых может быть много, если корневой список длинный) оплачиваются как раз за счёт уменьшения длины корневого списка!

Упражнения

21.2-1 Нарисуйте фибоначчиеву кучу, которая получится в результате изъятия минимальной вершины (с помощью процедуры FIB-HEAP-EXTRACT-MIN) из кучи рис. 21.3м.

21.2-2 Докажите, что лемма 20.1 остаётся верной для неупорядоченных биномиальных деревьев, если свойство 4 заменить на свойство 4': корень неупорядоченного биномиального дерева U_k имеет степень k, которая является максимальной степенью вершины в дереве; дети корня являются вершинами деревьев U_0, U_1, ..., U_{k-1} (в некотором порядке).

21.2-3 Покажите, что если выполняются лишь операции, описанные в разделе 21.2, то в куче с n вершинами все вершины имеют степень не больше \( \lfloor \lg n \rfloor \).

21.2-4 Профессор придумал новую структуру данных, основанную на фибоначчиевых кучах: операции выполняются как описано в разделе 21.2, но только после добавления вершины и соединения двух куч сразу же производится уплотнение корневого списка. Каково время выполнения различных операций над такими кучами в худшем случае? Будет ли такая структура данных чем-то новым?