---
source_image: page_165.png
page_number: 165
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 53.27
tokens: 11442
characters: 1807
timestamp: 2025-12-24T06:27:49.897997
finish_reason: stop
---

в. Измените процедуру Quicksort' так, чтобы объём стека не превышал \( \Theta(\lg n) \) (сохраняя оценку \( \Theta(n \lg n) \) для среднего времени работы).

8-5 Разбиение с помощью медианы трёх элементов

Работу процедуры Randomized-Quicksort можно ускорить, выбирая граничный элемент для разбиения более тщательно. Один из распространённых подходов — это метод медианы трёх (median-of-3 method): в качестве граничного элемента используется средний из трёх случайно выбранных элементов массива. Мы будем предполагать, что все элементы входного массива \( A[1..n] \) различны и \( n \geq 3 \). Через \( A'[1..n] \) будем обозначать отсортированный массив (который мы и хотим получить). Пусть \( p_i = P\{x = A'[i]\} \), где \( x \) — граничный элемент, выбранный описанным выше способом.

а. Выразите вероятность \( p_i \) (для \( i = 2, 3, \ldots, n - 1 \)) через \( i \) и \( n \) (заметьте, что \( p_1 = p_n = 0 \)).

б. Насколько вероятность выбрать средний элемент (\( A'[\lfloor (n + 1)/2 \rfloor] \)) больше, чем при обычном случайном выборе? К чему стремится отношение этих вероятностей при \( n \to \infty \)?

в. Будем называть разбиение с граничным элементом \( x \) "хорошим", если \( x = A'[i] \), где \( n/3 \leq i \leq 2n/3 \). Насколько вероятность "хорошего" разбиения больше, чем при обычном случайном выборе? (Указание: при вычислениях оцените сумму интегралом.)

г. Докажите, что использование метода медианы трёх сохраняет оценку \( \Omega(n \lg n) \) для времени работы быстрой сортировки (и влияет лишь на константу перед \( n \lg n \)).

Замечания

Алгоритм быстрой сортировки принадлежит Хоару [98]. В статье Седжвика [174] обсуждаются детали реализации быстрой сортировки и их влияние на время работы. Вероятностные алгоритмы для разных задач рассматриваются в статье Рабина [165].