---
source_image: page_584.png
page_number: 584
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 57.71
tokens: 11654
characters: 2477
timestamp: 2025-12-24T06:48:08.774237
finish_reason: stop
---

(строки 3-4) он устанавливает указатели current[u] в начало списка соседей каждой вершины и (считаем, что для всех вершин и списки соседей N[u] уже созданы.)

Работа цикла (строки 6–11, см. также рис. 27.11) происходит так: мы просматриваем все элементы списка L, начиная с начала (строка 5). Всякий раз мы разряжаем текущую вершину и (строка 8). Если при этом высота вершины и увеличилась (что определяется сравнением с сохранённым в строке 7 прежним значением), то мы перемещаем её в начало списка (строка 10). После этого мы переходим к следующему элементу списка L. Заметим, что если мы переместили и в начало списка, то очередным будет элемент, следующий за и в её новой позиции.

Докажем, что алгоритм Lift-To-Front находит максимальный поток. Для этого убедимся, что его можно рассматривать как реализацию общей схемы проталкивания предпотока. Сначала заметим, что программа применяет подъёмы и проталкивания только там, где они возможны (согласно лемме 29.29). Осталось доказать, что после завершения алгоритма никакие подъёмы или проталкивания невозможны. останавливаются, возможных подъёмов и проталкиваний нет.

Когда мы в последний раз в программе просмотрели список L, мы разрядили каждую вершину и, не подняв её. Как мы вскоре увидим (лемма 27.30), список L во время выполнения программы остаётся корректно упорядоченным, то есть конец любого допустимого ребра идёт после его начала. Поэтому процедура Discharge(u), проталкивая поток по допустимым рёбрам, создаёт избыток в вершинах, идущих в списке после и, и не трогает вершины, предшествующие и, в которых избыток остаётся равным нулю. Таким образом, по завершении работы избыток в каждой вершине равен нулю (и ни проталкивание, ни подъём невозможны).

Лемма 27.30

При исполнении алгоритма Lift-To-Front список L остаётся корректно упорядоченным относительно (текущего) графа допустимых рёбер G_{f,h} = (V, E_{f,h}) после любого числа итераций цикла в строках 6–11.

Доказательство

Перед первым выполнением цикла допустимых рёбер нет, так как высота истока h[s] равна |V| \geq 2 (множество V содержит по крайней мере исток s и сток t), а высота остальных вершин равна 0 (и единичного перепада высот быть не может).

Докажем, что свойство топологической упорядоченности сохраняется после каждого выполнения тела цикла. Сеть допустимых рёбер меняют только подъёмы и проталкивания. По лемме 27.27, проталкивания не создают допустимых рёбер. После подъёма произвольной вершины и все рёбра, входящие в эту вершину