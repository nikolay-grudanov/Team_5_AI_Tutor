---
source_image: page_505.png
page_number: 505
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.51
tokens: 11793
characters: 2805
timestamp: 2025-12-24T06:44:24.313446
finish_reason: stop
---

При релаксации ребра \((u, v)\) значение \(d[v]\) становится равным

\[
d'[v] = \min(d[v], d[u] + w(u, v))
\]

Мы знаем, что \(d[v]\) есть вес некоторого пути, который ведёт из \(s\) в \(v\), оставаясь до последнего шага в \(S\). Второй член \(d[u] + w(u, v)\) есть вес некоторого пути, который ведёт из \(s\) в \(u\) (оставаясь до последнего шага в \(S\)), а затем идёт по ребру \((u, v)\). Таким образом существует путь из \(s\) в \(v\), который до последнего шага остаётся в \(S'\) и имеет вес \(d'[v]\). Покажем, что любой путь \(p\) из \(s\) в \(v\), который до последнего шага остаётся в \(S'\), имеет вес не меньше \(d'[v]\). В самом деле, если \(x \in S'\) — его предпоследняя вершина, то либо \(x \in S\), и тогда вес пути \(p\) не меньше \(d[v]\) по индуктивному предположению (a), либо \(x = u\), и тогда вес пути \(p\) не меньше \(d[u] + w(u, v)\).

Мы доказали, что условия (a) и (b) остаются верными после любого числа итераций. Значит, они верны и после выхода из цикла; в этот момент \(S = V\) и потому \(d[u] = \delta(s, u)\) для любой вершины \(v \in V\).

Из доказанной теоремы и леммы 25.9 немедленно вытекает

Следствие 25.11
Пусть \(G = (V, E)\) — взвешенный ориентированный граф с неотрицательной весовой функцией \(w\) и исходной вершиной \(s\). Тогда после применения алгоритма Дейкстры к этому графу подграф предшественников \(G_{\pi}\) будет деревом кратчайших путей с корнем в \(s\).

Время работы алгоритма Дейкстры
Сначала предположим, что очередь с приоритетами \(Q = V \setminus S\) реализована как массив. При этом стоимость операции Extract-Min есть \(O(V)\); поскольку алгоритм делает \(V\) таких операций, суммарная стоимость всех удалений из очереди есть \(O(V^2)\). Что же до стоимости остальных операций, то каждая вершина \(v \in V\) добавляется к множеству \(S\) только один раз, и каждое ребро из \(Adj[v]\) обрабатывается тоже один раз. Общее количество элементов во всех списках смежных вершин есть \(|E|\); стоимость каждой релаксации есть \(O(1)\). Поэтому стоимость прочих операций есть \(O(E)\), а общая стоимость алгоритма есть \(O(V^2 + E)\).

Если граф является разреженным, имеет смысл реализовать очередь с помощью (двоичной) кучи (раздел 7.5). Получаемый алгоритм называют иногда модифицированным алгоритмом Дейкстры (modified Dijkstra algorithm). Стоимость операции Extract-Min при такой реализации очереди есть \(O(\lg V)\), а стоимость построения кучи (строка 3) есть \(O(V)\). Присваивание \(d[v] \leftarrow d[u] + w(u, v)\) при релаксации ребра реализуется с помощью вызова процедуры Decrease-Key\((Q, v, d[u] + w(u, v))\), имеющего стоимость \(O(\lg V)\) (см. упражнение 7.5-4). Количество таких вызовов не превосходит \(|E|\), так что общая стоимость модифицированного алгоритма Дейкстры есть \(O((V + E) \lg V)\) (если все вершины достижимы из