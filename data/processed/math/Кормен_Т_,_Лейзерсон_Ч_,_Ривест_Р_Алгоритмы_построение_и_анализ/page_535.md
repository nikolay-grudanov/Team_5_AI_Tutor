---
source_image: page_535.png
page_number: 535
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.81
tokens: 11778
characters: 2579
timestamp: 2025-12-24T06:45:48.979387
finish_reason: stop
---

является также кратчайшим путём с точки зрения \( \hat{w} \) и наоборот.

2. Все новые веса \( \hat{w}(u, v) \) неотрицательны.

Как мы увидим, новая весовая функция \( \hat{w} \) с такими свойствами может быть построена за время \( O(VE) \).

Кратчайшие пути сохраняются

Следующая лемма указывает простой общий способ изменить весовую функцию, не меняя кратчайших путей. В её формулировке длины кратчайших путей с весовыми функциями \( w \) и \( \hat{w} \) обозначаются через \( \delta \) и \( \hat{\delta} \) соответственно.

Лемма 26.1 (Изменение весов не меняет кратчайших путей)
Пусть \( G = (V, E) \) — взвешенный ориентированный граф с весовой функцией \( w : E \to \mathbb{R} \). Пусть \( h : V \to \mathbb{R} \) — произвольная функция с вещественными значениями, определённая на вершинах графа. Рассмотрим новую весовую функцию

\[
\hat{w}(u, v) = w(u, v) + h(u) - h(v).
\]

Тогда (a) произвольный путь \( p = \langle v_0, v_1, \ldots, v_k \rangle \) является кратчайшим относительно \( w \) тогда и только тогда, когда он будет кратчайшим относительно \( \hat{w} \); (b) граф \( G \) содержит цикл с отрицательным \( w \)-весом тогда и только тогда, когда он содержит цикл с отрицательным \( \hat{w} \)-весом.

Доказательство. Оба утверждения леммы следуют из равенства

\[
\hat{w}(p) = w(p) + h(v_0) - h(v_k).
\]

В самом деле, из него следует, что для путей с фиксированными началом и концом разница между старым и новым весом постоянна (тем самым один и тот же путь будет кратчайшим). Кроме того, видно, что для циклов суммарный вес в старом и новом смысле одинаков, так как разница \( h(v_0) - h(v_k) \) обращается в 0.

Равенство (26.10) проверить легко. Для каждого ребра пути имеем

\[
\hat{w}(v_i, v_{i+1}) = w(v_i, v_{i+1}) + h(v_i) - h(v_{i+1}).
\]

Если мы теперь сложим эти равенства для всех рёбер, то промежуточные члены сократятся, и получится равенство (26.10).

Как получить неотрицательные веса?

Теперь надо подобрать функцию \( h \) так, что бы изменённые веса \( \hat{w}(u, v) \) были неотрицательны. Это можно сделать следующим образом. По данному ориентированному взвешенному графу \( G = (V, E) \) с весовой функцией \( w \) построим новый граф \( G' = (V', E') \) с одной дополнительной вершиной \( s \) (другими словами, \( V' = V \cup \{s\} \)), из которой идут рёбра нулевого веса во все вершины графа \( V \) (\( E' = E \cup \{(s, v) : v \in V\} \) и \( w(s, v) = 0 \) для всех \( v \in V \)). Заметим, что вершина \( s \) может быть лишь начальной вершиной в пути (входящих в \( s \) рёбер нет). Очевидно, что новый граф \( G' \) содержит