---
source_image: page_509.png
page_number: 509
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 70.54
tokens: 11802
characters: 2560
timestamp: 2025-12-24T06:44:39.681792
finish_reason: stop
---

ревом кратчайших путей с вершиной s (лемма 25.9). Коль скоро \( d[v] = \delta(s, v) \) для всех \( v \in V \), из леммы 25.3 следует, что для всякого ребра \((u, v)\) выполнено неравенство \( d[v] \leq d[u] + w(u, v) \). Значит, ни одно из условий в строке 6 алгоритма выполнено не будет, и алгоритм возвратит значение TRUE.

Пусть теперь в графе есть цикл отрицательного веса \( \langle v_0, v_1, \ldots, v_k = v_0 \rangle \), достижимый из исходной вершины; нам надо показать, что алгоритм возвратит значение FALSE. В самом деле, если \( d[v_i] \leq d[v_{i-1}] + w(v_{i-1}, v_i) \) для всех \( i = 1, 2, \ldots, k \), то, складывая эти \( k \) неравенств и сокращая \( \sum d[v_i] \) в обеих частях, получим \( 0 \leq \sum_{i=1}^k w(v_{i-1}, v_i) \), что противоречит выбору цикла. Значит, для некоторого \( i \) имеем \( d[v_i] > d[v_{i-1}] + w(v_{i-1}, v_i) \), и алгоритм возвращает значение FALSE.

Упражнения

25.3-1 Примените алгоритм Беллмана-Форда к ориентированному графу рис. 25.7, выбрав \( y \) в качестве исходной вершины. Рёбра обрабатывайте в лексикографическом порядке; изобразите этапы выполнения алгоритма как на рис. 25.7. Замените вес ребра \((y, v)\) на 4 и проделайте то же самое, выбрав исходной вершиной \( z \).

25.3-2 Докажите следствие 25.13.

25-3.3 Пусть во взвешенном ориентированном графе нет циклов отрицательного веса. Определим число \( m \) следующим образом: для каждой пары вершин \( u, v \in V \), для которой существует путь из \( u \) в \( v \), найдем минимальное количество ребер в путях минимального веса, идущих из \( u \) в \( v \); затем возьмем максимум этих чисел по всем таким парам — это и есть \( m \). Покажите, что в алгоритме Беллмана-Форда достаточно выполнять цикл в строках 2–4 \( m \) раз.

25.3-4 Модифицируйте алгоритм Беллмана-Форда таким образом, чтобы и для вершин \( v \), у которых \( \delta(s, v) = -\infty \) (как мы помним, такое бывает тогда и только тогда, когда существует путь из \( s \) в \( v \), задевающий цикл отрицательного веса), после исполнения алгоритма было установлено правильное значение \( d[v] = \delta(s, v) = -\infty \).

25.3-5 Пусть \( G = (V, E) \) — взвешенный ориентированный граф. Разработайте алгоритм, работающий за время \( O(VE) \) и находящий для каждой вершины \( v \in V \) значение \( \delta^*(v) = \min_{u \in V} \{ \delta(u, v) \} \). (В графе могут быть рёбра с отрицательным весом.)

25-3.6 Пусть взвешенный ориентированный граф \( G = (V, E) \) имеет цикл отрицательного веса. Разработайте алгоритм, печатающий вершины такого цикла (хотя бы одного).