---
source_image: page_514.png
page_number: 514
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 65.32
tokens: 11752
characters: 2516
timestamp: 2025-12-24T06:44:47.098722
finish_reason: stop
---

Рисунок 25.9 Граф ограничений, соответствующий системе (25.4). В каждой вершине \( v_i \) написано число \( \delta(v_0, v_i) \). Вектор \( x = (-5, -3, 0, -1, -4) \) является одним из решений системы (25.4).

Системы ограничений на разности возникают во многих приложениях. Например, \( x_i \) могут быть сроками начала различных работ при строительстве дома. Если \( x_1 \) — срок начала рытья котлована под фундамент, а \( x_2 \) — срок начала заливки фундамента, и если рытье котлована занимает 3 дня, то \( x_1 - x_2 \leq -3 \).

Графы ограничений

Если система ограничений на разности представлена в виде \( Ax \leq b \), где \( A \) — \( m \times n \)-матрица, удобно рассмотреть ориентированный граф, для которого \( A \) будет матрицей инцидентности (см. упражнение 23.1-7). Точнее говоря, мы сделаем не совсем это, а свяжем с системой взвешенный ориентированный граф \( G = (V, E) \), в котором \( V = \{v_0, v_1, \ldots, v_n\} \) (по одной вершине на каждое неизвестное плюс вершина \( v_0 \)), а каждому неравенству \( x_j - x_i \leq b_k \) соответствует ребро \( (v_i, v_j) \) с весом \( b_k \) (несколько неравенств с одинаковой левой частью можно заменить одним, взяв минимум их правых частей). Кроме того, в графе имеются \( n \) ребер \( (v_0, v_1), (v_0, v_2), \ldots, (v_0, v_n) \) (каждое — веса 0). На рис. 25.9 изображен граф, соответствующий системе (25.4).

Следующая теорема показывает, что решения систем разностных ограничений можно находить с помощью алгоритмов поиска кратчайших путей.

Теорема 25.17
Пусть \( G = (V, E) \) — граф, соответствующий системе разностных ограничений с \( n \) неизвестными. Если он не содержит циклов отрицательного веса, то вектор
\[
x = (\delta(v_0, v_1), \delta(v_0, v_2), \ldots, \delta(v_0, v_n))
\]
является решением системы. Если \( G \) содержит цикл отрицательного веса, то система разностных ограничений несовместна.

Доказательство
Если цикла отрицательного веса нет, то все \( \delta(v_0, v_j) \) являются (конечными) числами и лемма 25.3 гарантирует, что числа \( x_i \) удовлетворяют всем неравенствам.
Если цикл отрицательного веса есть, то он не содержит вершины \( v_0 \), поскольку ни одно ребро в эту вершину не входит, так что все ребра цикла соответствуют каким-то неравенствам системы. Складывая неравенства, соответствующие ребрам цикла, получим (поскольку левые части неравенств цикла сокращаются) неравенство вида \( 0 \leq b \), где \( b < 0 \) — вес цикла. Следовательно, система несовместна.

Решение систем ограничений на разности