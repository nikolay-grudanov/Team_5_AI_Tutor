---
source_image: page_465.png
page_number: 465
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 56.99
tokens: 11508
characters: 1965
timestamp: 2025-12-24T06:42:17.440200
finish_reason: stop
---

Подграф предшествования представляет собой лес поиска в глубину (depth-first forest), состоящий из деревьев поиска в глубину (deep-first trees).

Алгоритм поиска в глубину также использует цвета вершин. Каждая из вершин вначале белая. Будучи обнаруженной (discovered), она становится серой; она станет чёрной, когда будет полностью обработана, то есть когда список смежных с ней вершин будет просмотрен. Каждая вершина попадает ровно в одно дерево поиска в глубину, так что эти деревья не пересекаются.

Помимо этого, поиск в глубину ставит на вершинах метки времени (timestamps). Каждая вершина имеет две метки: в \( d[v] \) записано, когда эта вершина была обнаружена (и сделана серой), а в \( f[v] \) — когда была закончена обработка списка смежных с \( v \) вершин (и \( v \) стала чёрной).

Эти метки времени используются во многих алгоритмах на графах и полезны для анализа свойств поиска в глубину.

В приводимой далее процедуре DFS (Depth-First Search — поиск в глубину) метки времени \( d[v] \) и \( f[v] \) являются целыми числами от 1 до \( 2|V| \); для любой вершины \( u \) выполнено неравенство

\[
d[u] < f[u]
\]

Вершина \( u \) будет белой до момента \( d[u] \), серой между \( d[u] \) и \( f[u] \) и чёрной после \( f[u] \).

Исходный граф может быть ориентированным или неориентированным. Переменная \( time \) — глобальная переменная текущего времени, используемого для пометок.

DFS$(G)$

1 for (для) всех вершин $u\in V[G]$
2 \hspace{1cm} do $color[u]\leftarrow$ белый
3 \hspace{2cm} $\pi[u]\leftarrow NIL$
4 $time\leftarrow 0$
5 for (для) всех вершин $u\in V[G]$
6 \hspace{1cm} do if $color[u]=$ белый
7 \hspace{2cm} then DFS-Visit$(u)$

DFS-Visit(u)
1 $color[u]\leftarrow$ белый // вершина $u$ была белой
2 $d[u]\leftarrow time\leftarrow time+1$
3 \textsc{for} (для) всех $v\in Adj[u]$ // обработать ребро $(u,v)$
4 \hspace{1cm} \textsc{do if} $color[v]=$ белый
5 \hspace{2cm} \textsc{then} $\pi[v]\leftarrow u$
6 \hspace{3cm} DFS-Visit$(v)$