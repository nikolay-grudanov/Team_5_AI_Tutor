---
source_image: page_582.png
page_number: 582
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.31
tokens: 11681
characters: 2420
timestamp: 2025-12-24T06:48:10.291585
finish_reason: stop
---

27.10 Разрядка вершины. Требуется 15 повторений цикла while в процедуре DISCHARGE, чтобы протолкнуть весь избыток из вершины y. Показаны только соседи вершины y и рёбра, соединяющие их с y. Внутри каждой вершины указан избыток в ней перед соответствующей итерацией; слева указана высота вершины. Справа показан список N[y]; выделен сосед current[y]. (a) Изначально избыток в y равен 19 и current[y] = s. Из y не выходят допустимые рёбра, поэтому первые три итерации сдвигают указатель current[y]. На четвертом шаге мы дошли до конца списка. Поднимаем вершину y и переходим к началу списка. (b) Высота вершины y стала равной 1. Рёбра (y, s) и (y, x) — недопустимые (шаги 5-6), а ребро (y, z) — допустимое, и мы проталкиваем 8 единиц в z (шаг 7; заметим, что указатель current[y] мы при этом не сдвинули). (c) Проталкивание на шаге 7 оказалось насыщающим, и на шаге 8 ребро (y, z) становится недопустимым. На шаге 9 мы дошли до конца списка (current[y] = NIL), поднимаем y, переходим к началу. (d) Ребро (y, s) недопустимо (шаг 10), но ребро (y, x) допустимо — по нему мы проталкиваем 5 единиц. (e) Больше допустимых рёбер нет (шаги 12-13), поэтому ещё раз поднимаем y и возвращаемся к началу списка (шаг 14). (f) Проталкиваем 6 единиц в s (шаг 15). (g) Избытка в вершине y больше нет, и процедура завершает работу. Заметим, что в этом примере в начале и в конце работы процедуры DISCHARGE указатель current[y] установлен на начало списка, но в общем случае это не так.

2. Если мы не дошли до конца списка и ребро (u, v) — допустимое (проверка в строке 6), то проталкиваем поток из u в v (строка 7).

3. Если мы не дошли до конца списка, но ребро (u, v) — недопустимое, то сдвигаем указатель current[u] на одну позицию в списке (строка 8).

Заметим, что при вызове процедуры DISCHARGE указатель current[u] находится в позиции, "унаследованной" от предыдущего вызова. Последним действием этой процедуры может быть лишь проталкивание: процедура останавливается, если избыток e[u] обращается в нуль, но ни подъём вершины, ни сдвиг указателя не меняют эту величину.

Надо проверить, что процедура DISCHARGE выполняет подъём и проталкивание тогда, когда это действительно можно сделать по нашим правилам.

Лемма 27.29

При вызове операции PUSH(u, v) в процедуре DISCHARGE (строка 7) по ребру (u, v) возможно проталкивание. При вызове операции LIFT(u) в процедуре DISCHARGE (строка 4) возможен подъём вершины u.

Доказательство