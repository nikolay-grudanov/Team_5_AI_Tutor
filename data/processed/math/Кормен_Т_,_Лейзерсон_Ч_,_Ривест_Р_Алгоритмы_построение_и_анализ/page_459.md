---
source_image: page_459.png
page_number: 459
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.92
tokens: 11329
characters: 1511
timestamp: 2025-12-24T06:41:40.173315
finish_reason: stop
---

Глава 23 Алгоритмы на графах

неравенство выполнено. Если же $u$ недостижима из $s$, то $\delta(s,u)=\infty$ и неравенство тривиально.

% конец доказательства

% далее текст переписан, и даже формулировки лемм изменены
% (с сохранением из общего числа для последующей нумерации
% - невозможно было оставлять такое длинное и запутанное
% рассуждение по такому простому поводу...

Лемма 23.2

Если $\delta(s,s,v)>0$, то существует вершина $u$, до которой расстояние на единицу меньше ($\delta(s,v)=\delta(s,u)+1$) и для которой $v$ является смежной вершиной.

Доказательство. Рассмотрим кратчайший путь из $s$ в $v$. Он будет иметь длину $\delta(s,v)$. Возьмём вершину $u$, лежащую на этом пути непосредственно перед $v$. Нам надо убедиться, что до неё расстояние на единицу меньше. В самом деле, у нас есть ведущий в неё путь длины $\delta(s,v)-1$ (отбросим последнее ребро), а более короткого пути быть не может по предыдущей лемме.

% конец доказательства

В условиях леммы для нахождения кратчайшего пути из $s$ в $v$ достаточно найти кратчайший путь из $s$ в $u$ и добавить к нему ребро $(u,v)$.

\medskip

Теперь мы можем доказать, что поиск в ширину правильно вычисляет длины кратчайших путей.

Работа процедуры \textsc{BFS} делится на начальный этап (строки 1--8) и повторения цикла в строках 9--18. Нас будет интересовать состояние переменных после нескольких таких повторений.

Лемма 23.3

Для всякого целого неотрицательного $k$ существует момент после нескольких повторений тела цикла (строки 10--18),