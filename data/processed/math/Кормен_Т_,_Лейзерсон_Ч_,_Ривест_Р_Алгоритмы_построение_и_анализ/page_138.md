---
source_image: page_138.png
page_number: 138
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.73
tokens: 11439
characters: 1822
timestamp: 2025-12-24T06:26:39.144744
finish_reason: stop
---

Глава 7 Сортировка с помощью кучи

сортировки и моделирования очереди с приоритетами. Перечислим основные операции над кучей:

• Процедура HEAPIFY позволяет поддерживать основное свойство (7.1). Время работы составляет \( O(\lg n) \).
• Процедура BUILD-HEAP строит кучу из исходного (неотсортированного) массива. Время работы \( O(n) \).
• Процедура HEAPSORT сортирует массив, не используя дополнительной памяти. Время работы \( O(n \lg n) \).
• Процедуры EXTRACT-MAX (взятие наибольшего) и INSERT (дополнение элемента) используются при моделировании очереди с приоритетами на базе кучи. Время работы обеих процедур составляет \( O(\lg n) \).

Упражнения

7.1-1 Пусть куча имеет высоту \( h \). Сколько элементов может в ней быть? (Укажите максимальное и минимальное значения.)

7.1-2 Докажите, что куча из \( n \) элементов имеет высоту \( \lfloor \lg n \rfloor \).

7.1-3 Докажите, что при выполнении основного свойства кучи корневая вершина любого поддерева является наибольшей в этом поддереве.

7.1-4 Где может находиться наименьший элемент кучи, если все её элементы различны?

7.1-5 Пусть массив отсортирован в обратном порядке (первый элемент — наибольший). Является ли такой массив кучей?

7.1-6 Является ли кучей массив \( \langle 23, 17, 14, 6, 13, 10, 1, 5, 7, 12 \rangle \)?

7.2 Сохранение основного свойства кучи

Процедура HEAPIFY — важное средство работы с кучей. Её параметрами являются массив \( A \) и индекс \( i \). Предполагается, что поддеревья с корнями LEFT\((i)\) и RIGHT\((i)\) уже обладают основным свойством. Процедура переставляет элементы поддерева с вершиной \( i \), после чего оно обладает основным свойством. Идея проста: если это свойство не выполнено для вершины \( i \), то её следует поменять с большим из её детей и т. д., пока элемент \( A[i] \) не "подгрузится" до нужного места.