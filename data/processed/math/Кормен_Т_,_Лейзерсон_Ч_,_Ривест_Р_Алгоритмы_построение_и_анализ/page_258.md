---
source_image: page_258.png
page_number: 258
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 49.27
tokens: 11419
characters: 1596
timestamp: 2025-12-24T06:32:17.342337
finish_reason: stop
---

а Средняя глубина вершины в дереве \( T \) есть

\[
\frac{1}{n} \sum_{x \in T} d(x, T) = \frac{1}{n} P(T).
\]

Таким образом, надо показать, что математическое ожидание \( P(T) \) есть \( O(n \lg n) \).

б Обозначим через \( T_L \) и \( T_R \) левое и правое поддеревья дерева \( T \). Убедитесь, что если \( T \) содержит \( n \) вершин, то

\[
P(T) = P(T_L) + P(T_R) + n - 1.
\]

в Обозначим через \( P(n) \) математическое ожидание внутренней суммы длин для случайного двоичного дерева поиска с \( n \) вершинами. Покажите, что

\[
P(n) = \frac{1}{n} \sum_{i=0}^{n-1} (P(i) + P(n-i-1) + n-1).
\]

г Покажите, что

\[
P(n) = \frac{2}{n} \sum_{k=1}^{n-1} P(k) + \Theta(n).
\]

д Вспоминая рассуждение из раздела 8.4.2 (оценка математического ожидания времени быстрой сортировки), покажите, что \( P(n) = O(n \lg n) \).

В каждом рекурсивном вызове быстрой сортировки мы случайным образом выбираем граничный элемент. Подобно этому, каждая вершина дерева поиска является границей между левым и правым своим поддеревом.

е Опишите реализацию алгоритма быстрой сортировки, при котором в процессе сортировки элементов \( k_1, \ldots, k_n \) выполняются в точности те же сравнения, что и при добавлении их в (изначально пустое) дерево. (Порядок сравнений может быть другим.)

13-4 Количество разных двоичных деревьев

Обозначим через \( b_n \) количество различных двоичных деревьев с \( n \) вершинами. В этой задаче требуется вывести формулу для \( b_n \) и оценить скорость роста числа \( b_n \).

а Покажите, что \( b_0 = 1 \) и что

\[
b_n = \sum_{k=0}^{n-1} b_k b_{n-1-k}
\]

при \( n \geq 1 \).