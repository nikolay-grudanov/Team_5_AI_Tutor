---
source_image: page_450.png
page_number: 450
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.32
tokens: 11464
characters: 1849
timestamp: 2025-12-24T06:41:31.360577
finish_reason: stop
---

2 ancestor[Find-Set(u)] \gets u
3 for (для) каждого $v$, являющегося ребёнком $u$
4 do LCA(v)
5 Union(u,v)
6 ancestor[Find-Set(u)] \gets u
7 покрасить u в чёрный цвет
8 for (для) каждой вершины v такой, что $(u,v)\in P$
9 do if вершина v чёрная
10 then print (''Наименьший общий предок '' $u$ '' и '' $v$
'' есть '' ancestor[Find-Set(v)]

(а) Покажите, что строка 10 исполняется в точности один раз для каждой пары $(u, v) \in P$.

(б) Покажите, что в результате вызова LCA($root[T]$) каждый из последующих вызовов LCA($u$) происходит в тот момент, когда количество непересекающихся множеств равно глубине вершины $u$ в дереве $T$.

(в) Покажите, что в результате вызова LCA([T]) будут напечатаны наименьшие общие предки для всех пар $(u, v) \in P$.

(г) Оцените время работы алгоритма LCA в предположении, что система непересекающихся множеств реализована с помощью леса с объединением по рангам и сжатием путей.

Замечания

Многие важные результаты о системах непересекающихся множеств в той или иной мере принадлежат Тарьяну. В частности, именно он установил оценку $O(m\alpha(m, n))$ [186, 188]. Более слабая оценка $O(m \lg^* n)$ была ранее получена Хопкрофтом и Ульманом [4, 103]. В работе [190] Тарьян и ван Леувен обсуждают различные варианты сжатия путей, в том числе алгоритмы, работающие "за один проход" (иногда они работают быстрее "двухпроходных"). Габов и Тарьян [76] показали, что в некоторых приложениях операции с непересекающимися множествами можно выполнить за время $O(m)$.

В работе [187] Тарьян показал, что при некоторых дополнительных условиях стоимость операций с непересекающимися множествами не может быть ниже, чем $O(m\alpha(m, n))$, какую реализацию мы бы ни избрали. Фредман и Сакс [74] показали, что, кроме того, в худшем случае эти операции требуют обращения к $\Omega(m\alpha(m, n))$ словам длиною в $\lg n$ битов.