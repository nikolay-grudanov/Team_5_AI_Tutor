---
source_image: page_313.png
page_number: 313
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 82.93
tokens: 11940
characters: 2893
timestamp: 2025-12-24T06:35:24.996433
finish_reason: stop
---

Наибольшая общая подпоследовательность

будет ли она подпоследовательностью последовательности \( Y \), то алгоритм будет работать экспоненциальное время, поскольку последовательность длины \( m \) имеет \( 2^m \) подпоследовательностей (столько же, сколько подмножеств у множества \( \{1, 2, \ldots, m\} \)).

Однако задача о НОП обладает свойством оптимальности для подзадач, как показывает теорема 16.1 (см. ниже). Подходящее множество подзадач — множество пар префиксов двух данных последовательностей. Пусть \( X = \langle x_1, x_2, \ldots, x_m \rangle \) — некоторая последовательность. Её префикс (prefix) длины \( i \) — это последовательность \( X_i = \langle x_1, x_2, \ldots, x_i \rangle \) (при \( i \) от 0 до \( m \)). Например, если \( X = \langle A, B, C, B, D, A, B \rangle \), то \( X_4 = \langle A, B, C, B \rangle \), а \( X_0 \) — пустая последовательность.

Теорема 16.1 (о строении НОП). Пусть \( Z = \langle z_1, z_2, \ldots, z_k \rangle \) — одна из наибольших общих подпоследовательностей для \( X = \langle x_1, x_2, \ldots, x_m \rangle \) и \( Y = \langle y_1, y_2, \ldots, y_n \rangle \). Тогда:
1. если \( x_m = y_n \), то \( z_k = x_m = y_n \) и \( Z_{k-1} \) является НОП для \( X_{m-1} \) и \( Y_{n-1} \);
2. если \( x_m \neq y_n \) и \( z_k \neq x_m \), то \( Z \) является НОП для \( X_{m-1} \) и \( Y \);
3. если \( x_m \neq y_n \) и \( z_k \neq y_n \), то \( Z \) является НОП для \( X_m \) и \( Y_{n-1} \).

Доказательство. (1) Если \( z_k \neq x_m \), то мы можем дописать \( x_m = y_n \) в конец последовательности \( Z \) и получить общую подпоследовательность длины \( k + 1 \), что противоречит условию. Стало быть, \( z_k = x_m = y_n \). Если у последовательностей \( X_{m-1} \) и \( Y_{n-1} \) есть более длинная (чем \( Z_{k-1} \)) общая подпоследовательность, то мы можем дописать к ней \( x_m = y_n \) и получить общую подпоследовательность для \( X \) и \( Y \), более длинную, чем \( Z \) — противоречие.
(2) Коль скоро \( z_k \neq x_m \), последовательность \( Z \) является общей подпоследовательностью для \( X_{m-1} \) и \( Y \). Так как \( Z \) — НОП для \( X \) и \( Y \), то она тем более является НОП для \( X_{m-1} \) и \( Y \).
(3) Аналогично (2).

Мы видим, что НОП двух последовательностей содержит в себе наибольшую общую подпоследовательность их префиксов. Стало быть, задача о НОП обладает свойством оптимальности для подзадач. Сейчас мы убедимся, что перекрытие подзадач также имеет место.

Рекуррентная формула

Теорема 16.1 показывает, что нахождение НОП последовательностей \( X = \langle x_1, x_2, \ldots, x_m \rangle \) и \( Y = \langle y_1, y_2, \ldots, y_n \rangle \) сводится к решению либо одной, либо двух подзадач. Если \( x_m = y_n \), то достаточно найти НОП последовательностей \( X_{m-1} \) и \( Y_{n-1} \) и дописать к ней в конце \( x_m = y_n \). Если же \( x_m \neq y_n \), то надо решить две подзадачи: найти