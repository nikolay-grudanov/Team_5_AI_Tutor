---
source_image: page_757.png
page_number: 757
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.13
tokens: 11761
characters: 2785
timestamp: 2025-12-24T06:56:00.122318
finish_reason: stop
---

Рисунок 33.7 33.7 \( \rho \)-эвристика Полларда. (а) Последовательность \( x_{i+1} = (x_i^2 - 1) \bmod 1387 \) с начальным элементом \( x_1 = 2 \). (Разложение: \( 1387 = 19 \cdot 73 \).) Жирные стрелки соответствуют шагам цикла, выполняемым до нахождения делителя 19. (После этого выполнение процедуры прекращается — но на рисунке показан весь \( \rho \)-цикл.) Серым цветом показаны последовательные значения переменной \( y \). Делитель 19 обнаруживается при сравнении \( y = 63 \) с \( x_7 = 177 \): \( (63 - 177, 1387) = 19 \). (б) Та же самая последовательность по модулю 19. По этому модулю упомянутые выше числа \( x_7 = 177 \) и \( y = 63 \) сравнимы. (с) Та же последовательность по модулю 73

\( gcd(y - x_i, n) \) отлично от 1 и от \( n \) (проверка выполняется в строке 9).

Эти действия на первый взгляд выглядят странно, но по крайней мере легко видеть, что процедура Pollard-Rho никогда не выдаёт неправильных ответов: уже если она чего напечатала, значит, это нетривиальный делитель \( n \). Вопрос только в том, напечатает ли она хоть что-то. Сейчас мы приведём некоторые неформальные аргументы в пользу того, что если число \( n \) имеет нетривиальный делитель \( s \), то есть шансы найти его после \( \sqrt{s} \) проходов. (Напомним, что у составного числа \( n \) есть делитель, не превосходящий \( \sqrt{n} \), так что ожидаемое число итераций можно оценить как \( \sqrt[4]{n} \).

Вот обещанные неформальные аргументы. Для начала заметим, что последовательность (33.49), начиная с какого-то места, становится периодической. (В самом деле, возможностей конечное число, так что должно встретиться повторение, а дальше уже всё пойдёт по циклу, так как следующий член последовательности зависит только от предыдущего.)

Поэтому последовательности можно изобразить в виде окружности с хвостиком (рис. 33.7): окружность соответствует периодической части последовательности, а хвостик — допериодической. (Эта картинка напоминает греческую букву \( \rho \), поэтому метод и называется \( \rho \)-эвристикой.)

Что можно сказать о длине периода для случайно выбранного \( x_1 \)? Некоторая (пусть и безосновательная) оценка может быть получена так. Представим себе, что каждое \( x_i \) выбирается случайно и не зависит от предыдущих; сколько шагов пройдёт до первого повторения? (Конечно, предположение о случайности \( x_i \) абсурдно — каждый элемент есть функция предыдущего — но преобразование \( x \mapsto x^2 - 1 \) достаточно сложно, и с большой натяжкой его можно уподобить случайному перемешиванию.)

Итак, сколько шагов пройдёт до первого повторения? Эту задачу мы уже рассматривали под названием парадокса с днями рождения (раздел 6.6.1), где отмечали, что среднее количество членов последовательности до первого повтора имеет порядок \( \Theta(\sqrt{n}) \).