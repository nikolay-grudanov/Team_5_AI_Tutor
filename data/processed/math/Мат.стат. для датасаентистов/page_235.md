---
source_image: page_235.png
page_number: 235
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 62.00
tokens: 11867
characters: 2118
timestamp: 2025-12-24T06:16:34.233044
finish_reason: stop
---

далее фрагмент кода создает признак, который представляет кредитоспособность заемщика:

borrow_df <- model.matrix(~ -1 + dti + revol_bal + revol_util + open_acc +
    delinq_2yrs_zero + pub_rec_zero, data=loan_data)
borrow_knn <- knn(borrow_df, test=borrow_df, cl=loan_data[, 'outcome'],
    prob=TRUE, k=10)
prob <- attr(borrow_knn, "prob")
borrow_feature <- ifelse(borrow_knn=='default', prob, 1-prob)
summary(borrow_feature)
    Min.  1st Qu.   Median   Mean 3rd Qu.   Max.
0.0000  0.4000  0.5000  0.5012  0.6000  1.0000

Результатом является признак, который предсказывает правдоподобие ситуации, что заемщик не вернет ссуду, опираясь на его кредитную историю.

Ключевые идеи для K ближайших соседей

• Метод K ближайших соседей (KNN) классифицирует запись путем ее отнесения к классу, которому принадлежат схожие записи.
• Сходство (расстояние) определяется евклидовым расстоянием или другими подобными метрическими показателями.
• Число ближайших соседей, с которыми сравнивается запись, K, определяется тем, насколько хорошую результативность алгоритм показывает на тренировочных данных с использованием разных значений K.
• Как правило, предикторные переменные стандартизуются, в результате чего переменные с большой шкалой не доминируют над метрическим показателем расстояния.
• В предсказательном моделировании KNN часто используется на первом этапе, и предсказанное значение добавляется в данные в качестве предиктора для моделирования на втором (не KNN) этапе.

Древовидные модели

Древовидные модели, так называемые классификационные и регрессионные деревья (classification and regression trees, CART)3, деревья решений, или просто деревья — это эффективный и популярный метод классификации (и регрессии), первоначально разработанный в 1984 г. Лео Брейманом и др. Древовидные модели и их более мощные потомки случайные леса и бустинг (см. разд. "Бэггинг и случайный лес" и "Бустинг" далее в этой главе) формируют основание для наиболее широко используемых моделей.

3 Термин CART является зарегистрированной торговой маркой Salford Systems, которая связана с их конкретной реализацией древовидных моделей.