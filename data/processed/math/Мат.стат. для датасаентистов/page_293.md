---
source_image: page_293.png
page_number: 293
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.77
tokens: 11913
characters: 2174
timestamp: 2025-12-24T06:19:12.655777
finish_reason: stop
---

Проблемы кластеризации смешанных данных

Методы K средних и РСА лучше всего подходят для непрерывных переменных. Для меньших наборов данных лучше использовать иерархическую кластеризацию с расстоянием Говера. В принципе нет причин отказываться от применения K средних к двоичным или категориальным данным. Вы обычно будете использовать представление в виде "кодирования с одним активным состоянием" (см. разд. "Кодировщик с одним активным состоянием" главы 6) для конвертирования категориальных данных в числовые значения. На практике, однако, использование методов K средних и РСА с двоичными данными может быть сопряжено с трудностями.

Если используются стандартные z-оценки, то двоичные переменные будут доминировать над определением кластеров. Это вызвано тем, что переменные в формате 0/1 принимают всего два значения, и K средних могут получить малую внутрикластерную сумму квадратов за счет отнесения всех записей с 0 или 1 к единственному кластеру. Например, применим kmeans к данным о невозвратных ссудах, включив факторные переменные home и pub_rec_zero:

df <- model.matrix(~ -1 + dti + payment_inc_ratio + home + pub_rec_zero,
    data=defaults)
df0 <- scale(df)
km0 <- kmeans(df0, centers=4, nstart=10)
centers0 <-scale(km0$centers, center=FALSE,
    scale=1/attr(df0, 'scaled:scale'))
scale(centers0, center=-attr(df0, 'scaled:center'), scale=F)

dti payment_inc_ratio homeMORTGAGE homeOWN homeRENT pub_rec_zero
1 17.02   9.10   0.00   0   1.00   1.00
2 17.47   8.43   1.00   0   0.00   1.00
3 17.23   9.28   0.00   1   0.00   0.92
4 16.50   8.09   0.52   0   0.48   0.00

Верхние четыре кластера являются по существу эрзацами для разных уровней факторных переменных. Для того чтобы предотвратить такое поведение, вы можете прошкалировать двоичные переменные и получить дисперсию меньше, чем у других переменных. Как вариант, если речь идет об очень крупных наборах данных, вы можете применить кластеризацию к разным подмножествам данных, принимающим конкретные категориальные значения. Например, вы можете применить кластеризацию отдельно к тем ссудам, которые были выданы физическим лицам, выплачивающим ипотеку, владеющим домом напрямую или его арендующим.