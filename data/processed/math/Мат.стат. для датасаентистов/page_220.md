---
source_image: page_220.png
page_number: 220
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 59.93
tokens: 11956
characters: 2472
timestamp: 2025-12-24T06:15:52.259895
finish_reason: stop
---

Понижающий отбор

Если данных достаточно, как в случае с данными о ссудах, одно из решений состоит в понижающем отборе преобладающего класса, в результате чего моделируемые данные становятся более сбалансированными между нулями и единицами. Основная идея понижающего отбора состоит в том, что данные для доминирующего класса имеют много избыточных записей. Работа с меньшим, более сбалансированным набором данных приводит к преимуществам в результативности модели и упрощает подготовку данных, а также обследование и апробирование экспериментальных моделей.

Какое количество данных будет достаточным? Это зависит от приложения, но в целом, наличие десятков тысяч записей для менее доминирующего класса будет достаточным. Чем легче различимы единицы и нули, тем меньше необходимо данных.

Данные о ссудах, проанализированные в разд. "Логистическая регрессия" ранее в этой главе были основаны на сбалансированном тренировочном наборе: половина ссуд была погашена, а другая половина не возвращена. Предсказанные значения были схожими: половина вероятностей была меньше 0,5, а половина — больше 0,5. В полном наборе данных всего лишь порядка 5% ссуд были невозвратными:

mean(loan_all_data$outcome == 'default')
[1] 0.05024048

Что происходит, если использовать полный набор данных для тренировки модели?

full_model <- glm(outcome ~ payment_inc_ratio + purpose_ +
    home_ + emp_len_ + dti + revol_bal + revol_util,
    data=train_set, family='binomial')
pred <- predict(full_model)
mean(pred > 0)
[1] 0.00386009

Только 0,39% ссуд были предсказаны, что они будут невозвратными, или менее 1/12 ожидаемого числа. Погашенные ссуды подавляют количеством невозвращенные ссуды, потому что модель натренирована с использованием всех данных одинаково. Если подумать об этом на интуитивном уровне, то присутствие такого количества ссуд, не относящихся к невозвратным, в сопряжении с неизбежной вариабельностью в предикторных данных означает, что даже для невозвратной ссуды модель скорее всего найдет несколько не относящихся к невозвратным ссуд, с которыми они будут схожи случайным образом. Когда же использовалась сбалансированная выборка, примерно 50% ссуд были предсказаны как невозвратные.

Повышающий отбор и повышающая/понижающая перевесовка

Одним из критических замечаний по поводу метода понижающего отбора записей является то, что он отбрасывает данные и не использует всю имеющуюся под рукой информацию. Если вы имеете относительно небольшой набор данных, и более ред-