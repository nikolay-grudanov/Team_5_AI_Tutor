---
source_image: page_247.png
page_number: 247
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.05
tokens: 11836
characters: 1969
timestamp: 2025-12-24T06:17:05.460132
finish_reason: stop
---

ранее бэггинг (см. разд. "Бэггинг и случайный лес" ранее в этой главе) и бутстранированный отбор переменных в каждой точке разбиения:
1. Взять из записей бутстраповскую подвыборку (с возвратом).
2. Для первого разбиения отобрать в произвольном порядке \( p < P \) переменных без возврата.
3. Для каждой из отобранных переменных \( X_{j(1)}, X_{j(2)}, ..., X_{j(p)} \) применить алгоритм разбиения:
   • для каждого значения \( s_{j(k)} \) из \( X \):
     □ разбить записи в сегменте \( A \) с \( X_{j(k)} < s_{j(k)} \) на один сегмент и оставшиеся записи, где \( X_{j(k)} \geq s_{j(k)} \), на другой сегмент;
     □ измерить однородность классов внутри каждого подсегмента \( A \);
   • выбрать значение \( s_{j(k)} \), которое порождает максимальную внутрисегментную однородность класса.
4. Выбрать переменную \( X_{j(k)} \) и значение в точке разбиения \( s_{j(k)} \), которое порождает максимальную внутрисегментную однородность класса.
5. Перейти к следующему разбиению и повторить предыдущие шаги, начиная с шага 2.
6. Продолжить дополнительные разбиения, следуя той же процедуре, пока дерево не будет выращено.
7. Вернуться к шагу 1, взять еще одну бутстраповскую подвыборку и начать процесс заново.

Сколько переменных отбирать на каждом шаге? Эмпирическое правило говорит о выборе \( \sqrt{P} \), где \( P \) — это число предикторных переменных. Программный пакет randomForest реализует случайный лес в R. Приведенный далее фрагмент применяет этот пакет к данным о ссудах (см. разд. "К ближайших соседей" ранее в этой главе относительно описания данных).

> library(randomForest)
> rf <- randomForest(outcome ~ borrower_score + payment_inc_ratio,
    data=loan3000)
Call:

randomForest(formula = outcome ~ borrower_score + payment_inc_ratio,
    data = loan3000)
    Type of random forest: classification
    Number of trees: 500
No. of variables tried at each split: 1

    OOB estimate of error rate: 38.53%
Confusion matrix:
    paid off default class.error