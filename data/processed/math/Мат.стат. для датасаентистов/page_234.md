---
source_image: page_234.png
page_number: 234
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 73.91
tokens: 12016
characters: 2923
timestamp: 2025-12-24T06:16:46.002237
finish_reason: stop
---

Метод KNN как конструктор признаков

Метод KNN получил свою популярность из-за его простоты и интуитивно понятной природы. С точки зрения результативности, KNN как таковой обычно не конкурентоспособен по сравнению с более изощренными приемами классификации. При подгонке моделей в практических условиях, однако, KNN может использоваться для добавления "локального знания" в многоэтапном процессе с другими приемами классификации.

1. KNN выполняется на данных, и для каждой записи формируется результат классификации (либо квазивероятность класса).
2. Этот результат добавляется в качестве нового признака к записи, и затем на данных выполняется еще один метод классификации. Исходные предикторные переменные таким образом используются дважды.

Поначалу можно засомневаться, не вызывает ли этот процесс проблему, связанную с мультиколлинеарностью ввиду того, что некоторые предикторы используются им дважды (см. разд. "Мультиколлинеарность" главы 4). Это не является проблемой, поскольку информация, включаемая в модель второго этапа, очень локальна, получена только из нескольких соседних записей и является поэтому не избыточной информацией, а дополнительной.

Такое поэтапное применение KNN можно представить как форму ансамблевого обучения, в котором многочисленные предсказывающие методы моделирования используются в сочетании друг с другом. Его также можно рассматривать как форму конструирования признаков, где цель состоит в том, чтобы получить признаки (предикторные переменные), которые имеют предсказательную силу. Нередко это сопряжено с некоторым ручным анализом данных; KNN предоставляет вполне автоматический способ достижения этого.

Например, рассмотрим данные о жилом фонде округа Кинг. При установлении продажной цены на дом агент по продаже недвижимости будет основывать цену на схожих домах, которые были недавно проданы, так называемых "продажах-аналогах". В сущности, агенты по продаже недвижимости выполняют ручную версию KNN: глядя на продажные цены схожих домов, они могут оценить, за что дом будет продан. Мы можем создать новый признак для статистической модели, которая будет имитировать профессионала в области торговли недвижимостью путем применения KNN к недавним продажам. Предсказываемое значение является продажной ценой, и существующие предикторные переменные могут включать местоположение, общую площадь в кв. футах, тип строения, размер земельного участка и количество спален и ванных комнат. Новая предикторная переменная (признак), которую мы добавляем посредством KNN, — это предиктор KNN для каждой записи (аналогичной продажам-аналогам у агентов по продаже недвижимости). Поскольку предсказываемое значение является числовым, вместо мажоритарного голосования используется среднее K ближайших соседей (так называемая KNN-регрессия).

Аналогичным образом, для данных о ссудах мы можем создать признаки, которые представляют разные стороны процесса выдачи ссуд. Например, приведенный