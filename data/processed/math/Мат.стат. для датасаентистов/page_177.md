---
source_image: page_177.png
page_number: 177
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 61.13
tokens: 11956
characters: 2445
timestamp: 2025-12-24T06:13:41.696173
finish_reason: stop
---

Гетероскедастичность, ненормальность и коррелированные ошибки

В статистике значительное внимание уделяется распределению остатков. Оказывается, что обычные наименьшие квадраты (см. разд. "Наименьшие квадраты" ранее в этой главе) являются несмещенными и в некоторых случаях единственными "оптимальными" критериями оценки на основе широкого спектра допущений о характере распределения. Это означает, что в большинстве задач аналитикам данных не приходится слишком беспокоиться о характере распределения остатков.

Распределение остатков релевантно главным образом для подтверждения достоверности формального статистического вывода (проверки гипотез и p-значения), который имеет минимальное значение для аналитиков данных, озабоченных главным образом предсказательной точностью. Для того чтобы формальный вывод был полноценным, принимается допущение, что остатки нормально распределены, имеют такую же дисперсию и независимы. Одной из областей, где это может представлять интерес для аналитиков науки о данных, является стандартное вычисление доверительных интервалов для предсказанных значений, которые основаны на допущениях о характере остатков (см. разд. "Доверительные и предсказательные интервалы" ранее в этой главе).

Гетероскедастичность — это отсутствие постоянной остаточной дисперсии по всему диапазону предсказанных значений. Другими словами, для некоторых частей диапазона ошибки больше, чем для других. Программный пакет ggplot2 располагает несколькими удобными инструментами для анализа остатков.

Следующий ниже фрагмент кода выводит график с абсолютными остатками против предсказанных значений для регрессии lm_98105, подогнанной в разд. "Выбросы" ранее в этой главе.

df <- data.frame(
  resid = residuals(lm_98105),
  pred = predict(lm_98105))
ggplot(df, aes(pred, abs(resid))) +
  geom_point() +
  geom_smooth()

На рис. 4.7 представлен результирующий график. При помощи geom_smooth очень легко наложить сглаженную из абсолютных остатков кривую. Данная функция вызывает метод loess для создания визуальной сглаженной кривой для оценки связи между переменными на осях x и y в диаграмме рассеяния (см. врезку "Сглаживатели для диаграмм рассеяния" далее в этой главе).

Совершенно очевидно, что дисперсия остатков имеет тенденцию увеличиваться для домов с более высокой стоимостью, но является также большой для домов с более низкой стоимостью. Данный график говорит о том, что регрессия lm_98105 имеет гетероскедастичные ошибки.