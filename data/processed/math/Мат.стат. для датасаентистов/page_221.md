---
source_image: page_221.png
page_number: 221
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.35
tokens: 11978
characters: 2571
timestamp: 2025-12-24T06:16:01.867698
finish_reason: stop
---

кий класс содержит несколько сотен или несколько тысяч записей, тогда понижающий отбор доминирующего класса имеет риск выбросить полезную информацию. В этом случае вместо понижающего отбора доминирующего случая следует выполнить повышающий отбор более редкого класса путем выемки дополнительных строк с возвратом (бутстрапирование).

Вы можете добиться аналогичного эффекта путем взвешивания данных. Многие алгоритмы классификации принимают весовой аргумент, который позволит вам выполнить повышающую/понижающую перевесовку данных. Например, применить весовой вектор к данным о ссудах при помощи аргумента weight к glm:

wt <- ifelse(loan_all_data$outcome=='default',
    1/mean(loan_all_data$outcome == 'default'), 1)
full_model <- glm(outcome ~ payment_inc_ratio + purpose_ +
    home_ + emp_len_+ dti + revol_bal + revol_util,
    data=loan_all_data, weight=wt, family='binomial')
pred <- predict(full_model)
mean(pred > 0)
[1] 0.4344177

Веса для невозвратных ссуд установлены в \(1/p\), где \(p\) — это вероятность невозврата. Ссуды, не относящиеся к невозвратным, имеют вес 1. Суммы весов для невозвратных ссуд и ссуд, не относящихся к невозвратным, примерно эквивалентны. Среднее предсказанных значений теперь составляет 43% вместо 0,39%.

Отметим, что перевесовка обеспечивает альтернативу как для повышающего отбора более редкого класса, так и для понижающего отбора доминирующего класса.

Адаптация функции потерь
Многие алгоритмы классификации и регрессии оптимизируют определенный критерий, или функцию потерь. Например, логистическая регрессия пытается минимизировать погрешность. В специализированной литературе некоторые разработчики предлагают модифицировать функцию потерь, чтобы предотвратить проблемы, вызываемые редким классом. На практике это сделать трудно: алгоритмы классификации могут быть многослойными, и их трудно модифицировать. Перевесовка является простым способом внесения изменений в функцию потерь, обесценивая ошибки для записей с низкими весами в пользу записей с более высокими весами.

Генерация данных
Генерация данных — это вариант повышающего отбора записей посредством бутстрапирования (см. разд. "Понижающий отбор" ранее в этой главе) с перебором существующих записей для создания новых записей. Лежащая в основе этой идеи логика состоит в том, что поскольку мы наблюдаем только предельный набор случаев, алгоритм не имеет богатого набора информации для создания "правил" классификации. Путем создания новых записей, которые аналогичны, но не идентичны существующим записям, алгоритм имеет возможность научиться более робастному