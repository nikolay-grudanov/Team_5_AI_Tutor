---
source_image: page_273.png
page_number: 273
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 67.39
tokens: 11974
characters: 2383
timestamp: 2025-12-24T06:18:39.502000
finish_reason: stop
---

Алгоритм начинается с определенного пользователем количества \( K \) и первоначального набора центров кластеров, затем многократно выполняет следующие шаги:

1. Отнести каждую запись к центру ближайшего кластера согласно измеренному квадратическому расстоянию.
2. Пересчитать центры кластеров по-новому на основе отнесения записей к кластерам.

Алгоритм сходится, когда отнесение записей к кластерам не изменяется.

Для первой итерации вам нужно указать исходный набор центров кластеров. Обычно это делается путем отнесения в произвольном порядке каждой записи к одному из \( K \) кластеров, а затем отыскания средних этих кластеров.

Поскольку этот алгоритм не гарантирует нахождение лучшего решения, рекомендуется выполнять алгоритм несколько раз с использованием разных случайных выборок для инициализации алгоритма. Когда используется больше одного набора итераций, результат \( K \) средних задается итерацией, которая имеет самую низкую внутрикластерную сумму квадратов.

Параметр nstart для функции R kmeans позволяет определять число случайных запусков для попыток. Например, приведенный далее фрагмент кода выполняет алгоритм \( K \) средних, чтобы найти 5 кластеров с использованием 10 разных начальных центров кластеров:

```r
syms <- c('AAPL', 'MSFT', 'CSCO', 'INTC', 'CVX', 'XOM', 'SLB', 'COP',
          'JPM', 'WFC', 'USB', 'AXP', 'WMT', 'TGT', 'HD', 'COST')
df <- sp500_px[row.names(sp500_px) >= '2011-01-01', syms]
km <- kmeans(df, centers=5, nstart=10)
```

Функция автоматически возвращает лучшее решение из 10 разных начальных точек. Вы можете использовать параметр iter.max для определения максимального числа итераций, которое дается алгоритму для каждого случайного запуска.

Интерпретация кластеров

Важная часть кластерного анализа может быть сопряжена с интерпретацией кластеров. Двумя самыми важными элементами данных на выходе из kmeans являются размеры кластеров и центры кластеров. Например, в предыдущем подразделе размеры результирующих кластеров задаются такой командой R:

```r
km$size
[1] 186 106 285 288 266
```

Размеры кластеров относительно сбалансированы. Несбалансированные кластеры могут быть вызваны дальними выбросами либо группами записей, которые сильно отличаются от остальной части данных — обе причины могут нуждаться в дальнейшем изучении.

Вы можете построить график центров кластеров при помощи функции gather в сочетании с ggplot: