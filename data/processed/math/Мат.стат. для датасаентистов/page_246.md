---
source_image: page_246.png
page_number: 246
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 89.59
tokens: 12193
characters: 2795
timestamp: 2025-12-24T06:17:32.034227
finish_reason: stop
---

Бэггинг

Бэггинг (bagging, как сокр. от bootstrap aggregating (в русском языке — бутстрап-агрегирование или агрегация бутстраповских выборок)) был представлен Лео Брейманом в 1994 г. Предположим, мы имеем отклик \( Y \) и \( P \) предикторных переменных \( \mathbf{X} = X_1, X_2, ..., X_p \) с \( n \) записями.

Бэггинг похож на базовый алгоритм для ансамблей за одним исключением — вместо подгонки различных моделей к одинаковым данным, каждая новая модель подгоняется к повторно отобранной бутстраповской выборке. Ниже данный алгоритм представлен более формально:

1. Инициализировать \( M \), число моделей для подгонки, и \( n \), число записей, из которых делается выборка (\( n < N \)). Установить итерацию в \( m = 1 \).
2. Взять повторную бутстраповскую выборку (т. е. с возвратом) из \( n \) записей из тренировочных данных, чтобы сформировать подвыборку \( Y_m \) и \( \mathbf{X}_m \) (пакет).
3. Натренировать модель, используя \( Y_m \) и \( \mathbf{X}_m \), чтобы создать набор правил решения \( \hat{f}_m(\mathbf{X}) \).
4. Прирастить счетчик моделей \( m = m + 1 \). Если \( m \leq M \), перейти к шагу 1.

В случае, где \( f_m \) предсказывает вероятность \( Y = 1 \), оценка на основе бэггинга (bagged estimate — пакетная оценка) задается следующей формулой:

\[
\hat{f} = \frac{1}{M} \left( \hat{f}_1(\mathbf{X}) + \hat{f}_2(\mathbf{X}) + ... + \hat{f}_M(\mathbf{X}) \right).
\]

Случайный лес

Случайный лес основывается на применении бэггинга к деревьям решений с одним важным расширением: в дополнение к отбору записей алгоритм также отбирает переменные. В традиционных деревьях решений, для того чтобы определить, как создать подсегмент сегмента \( A \), алгоритм делает выбор переменной и точки разбиения путем минимизации критерия, в частности, коэффициента разнородности Джини (см. разд. "Измерение однородности или разнородности" ранее в этой главе). При использовании случайных лесов на каждом этапе алгоритма выбор переменной ограничен случайным подмножеством переменных. По сравнению с базовым древовидным алгоритмом (см. разд. "Алгоритм рекурсивного сегментирования" ранее в этой главе), алгоритм случайного леса добавляет еще два шага: обсуждавшийся

4 Термин bagging — это своего рода технический каламбур, который, с одной стороны, является аббревиатурой для бутстрап-агрегирования и, с другой, означает упаковывание в пакеты, поскольку, в сущности, характер работы алгоритма бэггинга в этом и состоит — он отбирает бутстраповские пакеты данных и затем их агрегирует. — Прим. пер.
5 Термин "случайный лес" является товарным знаком Лео Бреймана и Адель Катлер с лицензией, выданной Salford Systems. Стандартное наименование нетоварного знака отсутствует, и термин "случайный лес" является таким же синонимом алгоритма, как и "Клинекс" для косметических салфеток.