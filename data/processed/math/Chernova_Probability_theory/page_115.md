---
source_image: page_115.png
page_number: 115
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.48
tokens: 12280
characters: 2437
timestamp: 2025-12-24T07:37:34.786852
finish_reason: stop
---

§1. Цепи Маркова

равна вероятности перейти за шаг хоть куда-нибудь, т. е. единице:

\[
P = \|p_{i,j}\|, \quad p_{i,j} \geqslant 0, \quad \sum_j p_{i,j} = \sum_j \mathbf{P}(1 = j \mid 0 = i) = 1.
\]

Обозначим через \( p_{i,j}^{(n)} \) вероятность за \( n \) шагов перейти из состояния \( i \) в \( j \):

\[
p_{i,j}^{(n)} = \mathbf{P}(n = i \mid 0 = j) = \mathbf{P}(n+m = i \mid m = j), \qquad P^{(n)} = \|p_{i,j}^{(n)}\|.
\]

Вычислим эту вероятность. Выйдя из состояния \( i \), попасть в \( j \) за \( n \) шагов можно, если за \( (n-1) \) шаг попасть в любое состояние \( k \), и уже из него за один шаг попасть в \( j \):

\[
p_{i,j}^{(n)} = \sum_k \mathbf{P}(n-1 = k \mid 0 = i) \cdot \mathbf{P}(n = j \mid n-1 = k) = \sum_k p_{i,k}^{(n-1)} p_{k,j}.
\]

Мы показали, что \((i, j)\)-й элемент матрицы \(P^{(n)}\) получается умножением строки матрицы \(P^{(n-1)}\) на столбец матрицы \(P\). Поэтому \(P^{(n)} = P^{(n-1)} \cdot P = = P^{(n-2)} \cdot P^2 = \ldots = P^n\). Итак, матрица вероятностей перехода за \( n \) шагов есть \( n \)-я степень матрицы вероятностей перехода за один шаг.

Чтобы найти безусловные вероятности цепи Маркова находиться после \( n \) шагов в состояниях \( j \in \mathbb{Z} \) (распределение величины \( n \)), воспользуемся формулой полной вероятности:

\[
\mathbf{P}(n = j) = \sum_i \mathbf{P}(0 = i) \cdot \mathbf{P}(n = j \mid 0 = i) = \sum_i p_i p_{i,j}^{(n)}. \tag{27}
\]

Пример 87. Лягушка прыгает по точкам 1, 2, 3. В каждой точке она может задержаться на единицу времени с вероятностью \( \frac{1}{2} \), либо куда-то перепрыгнуть. Из точек 1 и 3 она обязательно прыгает в точку 2, из точки 2 она может перепрыгнуть в любую из соседних с равными вероятностями.

Запишем матрицу \( P \) вероятностей перехода этой однородной ЦМ и найдём матрицу вероятностей перехода за два шага:

\[
P = \begin{pmatrix} p_{1,1} & p_{1,2} & p_{1,3} \\ p_{2,1} & p_{2,2} & p_{2,3} \\ p_{3,1} & p_{3,2} & p_{3,3} \end{pmatrix} = \begin{pmatrix} 1/2 & 1/2 & 0 \\ 1/4 & 1/2 & 1/4 \\ 0 & 1/2 & 1/2 \end{pmatrix}, \quad P^{(2)} = P^2 = \begin{pmatrix} 3/8 & 1/2 & 1/8 \\ 1/4 & 1/2 & 1/4 \\ 1/8 & 1/2 & 3/8 \end{pmatrix}.
\]

Можно вычислить вероятности перехода за 3, 4 и более шагов. Возникает естественный вопрос: пусть лягушка прыгает уже очень давно. Каковы шансы в произвольный момент времени обнаружить её в точке 1? В точке 2?

![Блуждание лягушки](https://i.imgur.com/3Q5z5QG.png)

Рис. 21. Блуждание лягушки