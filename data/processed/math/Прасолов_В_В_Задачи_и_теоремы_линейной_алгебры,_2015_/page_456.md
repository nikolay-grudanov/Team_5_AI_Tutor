---
source_image: page_456.png
page_number: 456
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.04
tokens: 6677
characters: 2405
timestamp: 2025-12-24T08:20:04.139178
finish_reason: stop
---

Чтобы доказать, что инвариант Арфа не зависит от выбора симплектического базиса, нужно доказать, что формы \( q_0 \) и \( q_1 \) не эквивалентны, т. е. не получаются друг из друга заменой базиса. Для этого достаточно заметить, что форма \( q_0 \) принимает значение 1 ровно один раз, а форма \( q_1 \) — три раза.

Рассмотрим теперь произвольную невырожденную квадратичную форму \( q \). Выберем симплектический базис \( e_1, \ldots, f_n \). Пусть \( \varphi_i \) — ограничение формы \( q \) на подпространство, натянутое на векторы \( e_i \) и \( f_i \). Тогда \( q = \varphi_1 \oplus \ldots \oplus \varphi_n \). Каждая форма \( \varphi_i \) эквивалентна \( q_0 \) или \( q_1 \).

**Лемма 1.** *Квадратичные формы \( \psi_0 = q_0 \oplus q_0 \) и \( \psi_1 = q_1 \oplus q_1 \) эквивалентны.*

**Доказательство.** Пусть \( e_1, f_1, e_2, f_2 \) — симплектический базис, для которого \( \psi_0(e_i) = \psi_0(f_i) = 0 \) и \( \psi_1(e_i) = \psi_1(f_i) = 1 \). Рассмотрим базис \( e'_1 = e_1 + e_2, f'_1 = e_1 + f_2, e'_2 = e_1 + f_1 + e_2 + f_2, f'_2 = e_1 + f_1 + f_2 \). Легко проверить, что этот базис симплектический. Проверим, что \( \psi_1(e'_i) = \psi_1(f'_i) = 0 \), т. е. \( \psi_1(e'_i) = \psi_0(e_i) \) и \( \psi_1(f'_i) = \psi_0(f_i) \). Действительно,

\[
\begin{align*}
\psi_1(e_1 + e_2) &= \psi_1(e_1) + \psi_1(e_2) + B(e_1, e_2) = 1 + 1 + 0 = 0, \\
\psi_1(e_1 + f_2) &= \psi_1(e_1) + \psi_1(f_2) + B(e_1, f_2) = 1 + 1 + 0 = 0, \\
\psi_1(e_1 + f_1 + e_2 + f_2) &= \psi_1(e_1 + e_2) + \psi_1(f_1 + f_2) + B(e_1 + e_2, f_1 + f_2) = 0 + 0 + 0 = 0, \\
\psi_1(e_1 + f_1 + f_2) &= \psi_1(e_1 + f_2) + \psi_1(f_1) + B(e_1 + f_2, f_1) = 0 + 1 + 1 = 0.
\end{align*}
\]

Введём следующее обозначение:

\[
\underbrace{q \oplus \ldots \oplus q}_{n \text{ раз}} = nq.
\]

Из леммы 1 следует, что форма \( q \) эквивалентна либо форме \( nq_0 \), либо форме \( (n-1)q_0 \oplus q_1 \). В координатах эти формы записываются так: \( x_1 y_1 + \ldots + x_n y_n \) и \( x_1 y_1 + \ldots + x_n y_n + x_n^2 + y_n^2 \). Ясно также, что \( c(nq_0) = 0 \) и \( c((n-1)q_0 \oplus q_1) = 1 \).

Чтобы доказать, что инвариант Арфа не зависит от выбора симплектического базиса, нужно доказать, что формы \( nq_0 \) и \( (n-1)q_0 \oplus q_1 \) не эквивалентны.

**Лемма 2.** *Значение 1 форма \( nq_0 \) принимает ровно \( 2^{2n-1} - 2^{n-1} \) раз, а форма \( (n-1)q_0 \oplus q_1 \) — ровно \( 2^{2n-1} + 2^{n-1} \) раз.*