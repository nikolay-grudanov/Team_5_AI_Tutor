---
source_image: page_206.png
page_number: 206
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.19
tokens: 6386
characters: 2173
timestamp: 2025-12-24T07:46:09.177086
finish_reason: stop
---

Этого соотношения еще недостаточно, чтобы найти \( B_n \) для всех значений \( n \). Надо еще узнать, как выражаются \( C_{n+1} \) и \( D_{n+1} \) через \( B_n, C_n \) и \( D_n \).

Предположим, что среди \( 2n + 2 \) рыцарей за столом оказалась ровно одна пара врагов-соседей (\( n > 1 \)). Мы знаем, что это может произойти в \( C_{n+1} \) случаях. Во избежание ссоры попросим их удалиться из-за стола. Тогда останется \( 2n \) рыцарей, причем возможно одно из двух: либо среди оставшихся нет врагов-соседей, либо есть ровно одна пара таких врагов — до ухода покинувших зал они сидели по обе стороны от них, и теперь оказались рядом.

В первом случае можно посадить пару ушедших между любыми двумя рыцарями, т. е. \( 2n \) способами, а так как их еще можно поменять местами, то получится \( 4n \) способов. Комбинируя их со всеми способами посадки \( n \) пар рыцарей, при которых нет соседей-врагов, получаем \( 4nB_n \) способов.

Во втором случае ушедших можно посадить только рядом обратно, разделив появившуюся пару врагов — иначе появится вторая пара враждующих соседей или исчезнут обе. Но так как \( 2n \) рыцарей можно посадить \( C_n \) способами так, чтобы была только одна пара враждующих соседей, то мы получаем \( 2C_n \) вариантов (возвратившихся рыцарей можно поменять местами).

Наконец, номер ушедшей и вернувшейся пары рыцарей мог быть любым от 1 до \( n + 1 \). Отсюда вытекает, что рекуррентное соотношение для \( C_{n+1} \) имеет вид

\[
C_{n+1} = 4n(n + 1)B_n + 2(n + 1)C_n.
\]

Наконец, разберем случай, когда среди \( 2n + 2 \) рыцарей было две пары врагов-соседей. Номера этих пар можно выбрать \( C_{n+1}^2 = \frac{n(n + 1)}{2} \) способами. Заменим каждую пару одним новым рыцарем, причем будем считать новых двух рыцарей врагами. Тогда за столом будут сидеть \( 2n \) рыцарей, причем среди них либо не будет ни одной пары врагов-соседей (если новые рыцари не сидят рядом), либо только одна такая пара.

Первый вариант может быть в \( B_n \) случаях. Вернуться к исходной компании мы можем 4 способами благодаря возможности изменить порядок рыцарей в каждой паре. Поэтому первый вариант приводит к \( 4C_{n+1}^2 B_n = 2n(n + 1)B_n \) способам.