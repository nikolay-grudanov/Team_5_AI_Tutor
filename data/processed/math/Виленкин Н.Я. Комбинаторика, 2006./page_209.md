---
source_image: page_209.png
page_number: 209
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.41
tokens: 6557
characters: 2600
timestamp: 2025-12-24T07:46:22.630661
finish_reason: stop
---

Обозначим через \( F(m, n) \) число способов рассадки, при которых рядом сидят ровно \( m \) пар врагов. Мы выведем сейчас рекуррентную формулу, выражающую \( F(m, n + 1) \) через \( F(k, n),\ k = m - 1,\ m,\ m + 1,\ m + 2 \).

Будем считать, что сначала за столом сидели \( n \) пар рыцарей, причем \( n \geq 2 \), а потом пришла \((n + 1)\)-я пара и села за стол. Подсчитаем, во скольких случаях за столом окажутся \( m \) пар соседей-врагов. Это может произойти четырьмя способами.

а) За столом была \( m - 1 \) пара врагов, сидевших рядом. Это могло случиться \( F(m - 1, n) \) способами. Чтобы за столом оказалось \( m \) пар враждующих соседей, новая пара должна сесть рядом, не разбив ни одну из уже существовавших пар соседей-врагов. Но между \( 2n \) рыцарями есть \( 2n \) промежутков, а садиться нельзя в \( m - 1 \) промежутков. Остается \( 2n - m + 1 \) промежутков, куда могут рядом сесть вновь пришедшие рыцари. Так как при этом пришедшие рыцари могут еще меняться местами, то всего получаем \( 2(2n - m + 1)F(m - 1, n) \) способов.

б) За столом уже было \( m \) пар рядом сидящих врагов. В этом случае вновь пришедшие могут выбрать одно из двух: либо сесть врозь, не разделив при этом ни одну пару соседей-врагов, либо сесть рядом между двумя враждующими соседями. Легко подсчитать, что первое можно проделать \( (2n - m)(2n - m - 1) \) способами, а второе \( 2m \) способами. Так как \( n \) пар рыцарей могут сесть \( F(m, n) \) способами так, чтобы рядом оказались \( m \) пар врагов, то всего получаем \( \left[ (2n - m)^2 - 2n + 3m \right] F(m, n) \) способов.

в) Далее, рассмотрим случай, когда среди \( 2n \) рыцарей рядом сидела \( m + 1 \) пара врагов (это может случиться \( F(m + 1, n) \) способами). В этом случае один из вновь пришедших должен сесть между одной из пар врагов-соседей, а второй должен сесть так, чтобы не разбить ни одну такую пару. Первое можно сделать \( m + 1 \), а второе \( 2n - m - 1 \) способами. Всего получаем \( 2(m + 1)(2n - m - 1) \) возможностей (множитель 2 появился потому, что любой из двух вновь пришедших может сесть между врагами). Поэтому рассматриваемый случай дает всего \( 2(m + 1)(2n - m - 1)F(m + 1, n) \) возможностей.

г) Наконец, предположим, что было \( m + 2 \) пар соседей-врагов. Это могло случиться \( F(m + 2, n) \) способами. Чтобы оказалось только \( m \) пар соседей-врагов, каждый из вновь пришедших рыцарей должен разбить одну пару враждующих соседей. Первый рыцарь может сесть \( m + 2 \) способами, после чего второму остается лишь \( m + 1 \) место. Всего получаем \( (m + 1)(m + 2)F(m + 2, n) \) возможностей.