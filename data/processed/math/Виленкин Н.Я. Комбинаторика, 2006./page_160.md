---
source_image: page_160.png
page_number: 160
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.08
tokens: 6473
characters: 2082
timestamp: 2025-12-24T07:45:06.304982
finish_reason: stop
---

\( P_8 = 8! \). Тот же результат получаем и для остальных 7 запрещенных пар.

Теперь рассмотрим перестановки, запрещенные по крайней мере дважды, т. е. содержащие две запрещенные пары. Возможны два случая — две запрещенные пары либо не имеют общих элементов, либо имеют один общий элемент.

В первом случае объединим вместе элементы каждой пары. У нас останется всего 7 переставляемых элементов (2 пары и 5 элементов, не попавших ни в одну из этих пар). Число таких перестановок равно \( P_7 = 7! \). Во втором случае три элемента, входящие в две запрещенные пары, должны идти подряд. Например, если в перестановку входят пары (3; 4) и (4; 5), то в ней подряд идут элементы 3, 4, 5. Объединим эти три элемента вместе. Тогда перестановкам подлежат снова 7 элементов — 1 блок из трех элементов и 6 элементов, не вошедших в блок. Число таких перестановок опять равно \( P_7 = 7! \).

Совершенно так же доказывается, что какие бы \( k \) запрещенных пар мы ни взяли, число перестановок, содержащих все эти \( k \) пар, равно \( P_{9-k} = (9 - k)! \). Но \( k \) пар из 8 можно выбрать \( C_8^k \) способами. По формуле включений и исключений получаем, что количество перестановок, не содержащих ни одной запрещенной пары, равно

\[
P_9 - C_8^1 P_8 + C_8^2 P_7 - C_8^3 P_6 + C_8^4 P_5 - C_8^5 P_4 + C_8^6 P_3 - C_8^7 P_2 + C_8^8 P_1 =
= 8! \left( 9 - \frac{8}{1!} + \frac{7}{2!} - \frac{6}{3!} + \frac{5}{4!} - \frac{4}{5!} + \frac{3}{6!} - \frac{2}{7!} + \frac{1}{8!} \right) = 148\ 329.
\]

Аналогично доказывается, что количество перестановок из чисел 1, 2, ..., \( n \), не содержащих ни одной из пар (1; 2), (2; 3), ..., (\( n-1 \); \( n \)), выражается формулой

\[
E_n = P_n - C_{n-1}^1 P_{n-1} + C_{n-1}^2 P_{n-2} - C_{n-1}^3 P_{n-3} + ... + (-1)^{n-1} C_{n-1}^{n-1} P_1 =
= (n-1)! \left[ n - \frac{n-1}{1!} + \frac{n-2}{2!} - \frac{n-3}{3!} + ... + \frac{(-1)^{n-1}}{(n-1)!} \right].
\] (17)

Выразим полученный ответ через субфакториалы. Для этого разобьем каждое слагаемое в правой части на два:

\[
\frac{(-1)^k(n-k)}{k!} = \frac{(-1)^k n}{k!} + \frac{(-1)^{k-1}}{(k-1)!}.
\]