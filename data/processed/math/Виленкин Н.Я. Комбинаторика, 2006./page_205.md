---
source_image: page_205.png
page_number: 205
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.75
tokens: 6401
characters: 2297
timestamp: 2025-12-24T07:46:09.335454
finish_reason: stop
---

Выведем формулу, выражающую \( B_{n+1} \) через \( B_n, C_n \) и \( D_n \) при \( n > 1 \). Пусть \( n + 1 \) пара рыцарей сидит так, что никакие два врага не сидят рядом. Мы будем считать, что все враждующие пары рыцарей занумерованы. Попросим встать из-за стола пару рыцарей с номером \( n + 1 \). Тогда появятся 2 новые пары соседей (те, которых ушедшие рыцари разделяли), поэтому возможны три случая: среди оставшихся за столом не появилось ни одной пары соседей-врагов; появилась одна такая пара; появились две такие пары.

Выясним теперь, сколькими способами можно снова посадить ушедших рыцарей за стол, так, чтобы после этого не было ни одной пары соседей-врагов.

Проще всего посадить их, если за столом рядом сидят две пары врагов. В этом случае один из вновь пришедших садится между рыцарями первой пары, а другой — между рыцарями второй пары. Это можно сделать двумя способами. Но так как число способов рассадки \( 2n \) рыцарей, при которых две пары соседей оказались врагами, равно \( D_n \), то всего получилось \( 2D_n \) способов.

Пусть теперь рядом сидит только одна пара врагов. Один из вернувшихся должен сесть между ними. Тогда за столом окажутся \( 2n + 1 \) рыцарей, между которыми есть \( 2n + 1 \) мест, но два места (рядом с только что севшим гостем) запретны для второго рыцаря, и ему остается \( 2n - 1 \) мест. Так как первым может войти любой из двух вышедших рыцарей, то получается \( 2(2n - 1) \) способов рассадки. Но число случаев, когда \( 2n \) рыцарей сели так, чтобы ровно одна пара врагов оказалась соседями, равно \( C_n \). Поэтому мы получаем \( 2(2n - 1)C_n \) способов посадить гостей требуемым образом.

Наконец, пусть никакие два врага не сидят рядом. В этом случае первый рыцарь садится между любыми двумя гостями — это он может сделать \( 2n \) способами. После этого для его врага останется \( 2n - 1 \) мест — он может занять любое место, кроме двух мест, соседних с только что севшим рыцарем. Таким образом, если \( 2n \) рыцарей уже сидели нужным образом, то вернувшихся гостей можно посадить \( 2n(2n - 1) \) способами. Всего же в этом случае получается \( 2n(2n - 1)B_n \) способов.

Тремя разобранными случаями исчерпываются все возможности. Поэтому имеет место рекуррентное соотношение

\[
B_{n+1} = 2n(2n - 1)B_n + 2(2n - 1)C_n + 2D_n.
\]