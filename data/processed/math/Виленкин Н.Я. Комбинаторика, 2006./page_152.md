---
source_image: page_152.png
page_number: 152
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.92
tokens: 6513
characters: 2246
timestamp: 2025-12-24T07:44:57.521068
finish_reason: stop
---

для первого элемента, и получится, что все элементы должны сместиться. Так как число этих элементов равно \( n - 1 \), то во второй части \( D_{n-1} \) перестановок. Поэтому тогда вся группа состоит из \( D_{n-2} + D_{n-1} \) перестановок. Так как все множество смещающих перестановок состоит из \( n - 1 \) группы, то в него входит \( (n - 1)(D_{n-2} + D_{n-1}) \) перестановок. Тем самым доказано равенство (8).

Из формулы (8) вытекает, что

\[
D_n - nD_{n-1} = - [D_{n-1} - (n - 1)D_{n-2}].
\]

Поэтому при изменении \( n \) выражение \( D_n - nD_{n-1} \) только меняет знак. Применяя это соотношение несколько раз, получаем, что

\[
D_n - nD_{n-1} = (-1)^{n-2}(D_2 - 2D_1).
\]
Но \( D_2 = 1 \), а \( D_1 = 0 \), и поэтому

\[
D_n = nD_{n-1} + (-1)^n.
\] (9)

Эта формула напоминает соотношение \( n! = n(n - 1)! \) для факториалов. Выпишем значения первых 12 субфакториалов:

\[
\begin{array}{cccc}
D_1 = 0, & D_4 = 9, & D_7 = 1854, & D_{10} = 1\ 334\ 961, \\
D_2 = 1, & D_5 = 44, & D_8 = 14\ 833, & D_{11} = 14\ 684\ 570, \\
D_3 = 2, & D_6 = 265, & D_9 = 133\ 496, & D_{12} = 176\ 214\ 841.
\end{array}
\]

**72. Запретные зоны и ладейные числа**

Теперь мы несколько обобщим рассмотренную задачу и разберем обширный круг задач о так называемых «запретных зонах».

Мы знаем, что каждую перестановку \( n \) чисел \( 1, 2, ..., n \) можно изобразить, поставив \( n \) ладей на квадратную доску с \( n \) горизонталями и \( n \) вертикалями — если перестановка имеет вид \( (a_1, ..., a_n) \), то ладьи занимают пересечения \( k \)-х вертикалей с \( a_k \)-ми горизонталями. При этом ни одна ладья не бьет другую, так как ни номера горизонталей, ни номера вертикалей в парах \( (1; a_1), ..., (n; a_n) \) не повторяются.

В задаче о паспортах берутся не все перестановки, а лишь такие, при которых ни одно число не стоит на своем месте. В этом случае ни одна ладья не может занять поля с номерами \( (1; 1), ..., (n; n) \), а это как раз поля на диагонали. Иными словами, в этой задаче требуется найти число расстановок ладей, при которых ни одна ладья не попадает на диагональ.

Разумеется, вместо диагонали можно выбрать любое другое множество запретных полей, а число ладей может быть любым. Мы приходим, таким образом, к следующей задаче.