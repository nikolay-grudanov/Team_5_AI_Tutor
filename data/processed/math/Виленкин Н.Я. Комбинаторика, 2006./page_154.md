---
source_image: page_154.png
page_number: 154
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.32
tokens: 6378
characters: 2024
timestamp: 2025-12-24T07:44:57.247647
finish_reason: stop
---

полях, чтобы они не били друг друга. Это можно сделать \( t_k' \) способами. Затем занятые \( k \) горизонталей и \( k \) вертикалей следует вычеркнуть и на оставшуюся \((m - k) \times (n - k)\)-доску поставить остальные \( r - k \) ладьи, не обращая внимания на цвет полей, а следя лишь за тем, чтобы они не били друг друга. Это можно сделать \( C_{m-k}^{r-k} A_{n-k}^{r-k} \) способами. По правилу произведения получаем \( C_{m-k}^{r-k} A_{n-k}^{r-k} t_k' \) требуемых расстановок ладей.

Теперь мы уже можем вывести основную формулу всей теории запретных зон, связывающую ладейные числа для черной и белой досок. Для этого воспользуемся формулой включений и исключений. Занумеруем все черные поля на доске \( m \times n \) и обозначим через \( \langle a \rangle \) свойство «занято \( a \)-е черное поле». Тогда \( N(a_1 a_2 ... a_k) \) — число расстановок, при которых заняты черные поля с номерами \( a_1, a_2, ..., a_k \). Все слагаемые вида \( N(a_1 a_2 ... a_k) \) в формуле включений и исключений имеют знак \( (-1)^k \). Если сложить все эти слагаемые при заданном значении \( k \), то получаются все расстановки, в которых занято не менее \( k \) черных полей. А число таких расстановок, как мы знаем, равно \( C_{m-k}^{r-k} A_{n-k}^{r-k} t_k' \). Замечательно, что мы нашли это число, не зная отдельных слагаемых — ведь для некоторых выборов черных полей может и не существовать искомых расстановок.

А теперь, применяя формулу включений и исключений, получаем ладейные числа для белопольной доски \( t_r \) в виде

\[
t_r = C_m^r A_n^r t_0' - C_{m-1}^{r-1} A_{n-1}^{r-1} t_1' + \\
+ ... + (-1)^k C_{m-k}^{r-k} A_{n-k}^{r-k} t_k' + ... + (-1)^r C_{m-r}^0 A_{n-r}^0 t_r'.
\] (10)

Применяя знак суммы, эту формулу можно записать в виде

\[
t_r = \sum_{k=0}^r (-1)^k C_{m-k}^{r-k} A_{n-k}^{r-k} t_k'.
\]

Точно так же доказывается, что число расстановок \( r \) ладей, из которых \( p \) стоят на черных, а остальные — на белых полях, равно

\[
\sum_{k=0}^{r-p} (-1)^k C_{p+k}^k C_{m-p-k}^{r-p-k} t_{p+k}'.
\] (11)