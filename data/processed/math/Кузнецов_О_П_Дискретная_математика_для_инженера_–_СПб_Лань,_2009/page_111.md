---
source_image: page_111.png
page_number: 111
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.20
tokens: 5268
characters: 1894
timestamp: 2025-12-24T07:19:47.983799
finish_reason: stop
---

всеми инцидентными ему ребрами. Получим ациклический граф с \( n - 1 \) вершиной. Выберем в нем какой-либо сток и присвоим ему номер \( n - 1 \). Будем повторять процедуру удаления стоков и инцидентных им ребер до тех пор, пока не пронумеруем все вершины. Поскольку всякий раз удаляемые ребра будут удовлетворять условию топологической сортировки, получим топологическую сортировку исходного орграфа.

Пример 4.11. На рис. 4.16 приведен пример топологической сортировки.

![Два графа с направленными дугами и нумерацией вершин](../images/4.16.png)

Рис. 4.16.

Матрицы орграфов и их связь с путями. Матрицу смежности \( C(G) \) орграфа \( G \) можно использовать для подсчета числа различных путей в \( G \). Сама матрица \( C \) задает ребра \( G \), т. е. пути длины 1. Оказывается, что матрица \( C^l \) (\( l \)-я степень \( C \)) задает число путей длины \( l \).

Теорема 4.6. Элемент \( (i, j) = c_{ij}^{(l)} \) матрицы \( C^l \) орграфа \( G \) равен числу путей длины \( l \) из \( v_i \) в \( v_j \).

Напомним правило умножения квадратных матриц (случай неквадратных матриц нам не понадобится). Если даны две квадратные матрицы \( X \) и \( Y \) одинаковой размерности \( n \), то элемент \( z_{ij} \) матрицы \( Z = XY \) определяется следующей формулой:

\[
z_{ij} = \sum_{k=1}^n x_{ik} y_{ki}.
\]

Доказательство теоремы проведем индукцией по \( l \). Для \( l = 1 \) теорема очевидна (см. сказанное ранее). Пусть для некоторого \( l \) теорема верна, т. е. элемент \( c_{ij}^{(l)} \) матрицы \( C^l \) равен числу путей длины \( l \) из \( v_i \) в \( v_j \). Докажем ее для \( l + 1 \). Любой путь длины \( l + 1 \) из \( v_i \) в \( v_j \) состоит из ребра, ведущего в некоторую вершину \( v_k \), и пути длины \( l \) из \( v_k \) в \( v_j \). Для произвольного \( k \) число путей длины \( l + 1 \) из \( v_i \) в \( v_j \), проходящих на первом шаге через вершину \( v_k \),