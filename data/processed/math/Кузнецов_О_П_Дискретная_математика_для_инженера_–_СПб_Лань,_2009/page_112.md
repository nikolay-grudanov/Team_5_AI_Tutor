---
source_image: page_112.png
page_number: 112
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.50
tokens: 5551
characters: 2441
timestamp: 2025-12-24T07:19:56.562915
finish_reason: stop
---

равно \( c_{ik} c_{kj}^{(l)} \) (если ребра из \( v_i \) в \( v_k \) нет, то \( c_{ik} = 0 \), и \( c_{ik} c_{kj}^{(l)} = 0 \)). Общее число путей длины \( l + 1 \) из \( v_i \) в \( v_j \) получим, если просуммируем эту величину по всем \( k \):

\[
\sum_{k=1}^n c_{ik} c_{kj}^{(l)}.
\]

Эта сумма, как видно из формулы (4.1), равна элементу \((i, j)\) произведения матриц \(C\) и \(C^l\), т. е. элементу \((i, j)\) матрицы \(C^{l+1}\), что и доказывает теорему. □

**Следствие 4.1.** Элемент \((i, j)\) матрицы \(C + C^2 + ... + C^l\) орграфа \(G\) равен числу всех путей длины \(\leq l\) из \(v_i\) в \(v_j\). □

Использование матриц позволяет получить и перечисление конкретных путей. Для этого всем ребрам графа \(G\) присвоим конкретные имена (например, \(e_1, ..., e_m\)) и в матрице \(C\) заменим единицы именами соответствующих ребер, т. е. элемент \(c_{ij} = 1\) заменим именем ребра, которое соединяет вершину \(v_i\) с вершиной \(v_j\). Полученную матрицу обозначим через \(H(G)\). Для того чтобы определить произведение матриц этого вида, введем алгебру на множествах путей.

Путь будем рассматривать как слово (последовательность символов) в алфавите \(\{e_1, ..., e_m\}\). Пусть даны два множества путей \(M_1\) и \(M_2\). Сумма \(M_1\) и \(M_2\) определяется как их обычное теоретико-множественное объединение: \(M_1 \cup M_2\), произведение \(M_1M_2\) — как множество, получающееся приписыванием справа к каждому слову из \(M_1\) всех слов из \(M_2\). Например, если \(M_1 = \{e_2e_4e_2, e_3e_1, e_1\}\), \(M_2 = \{e_3e_1e_4, e_2\}\), то \(M_1M_2 = \{e_2e_4e_2e_3e_1e_4, e_2e_4e_2e_2, e_3e_1e_3e_1e_4, e_3e_1e_2, e_1e_3e_1e_4, e_1e_2\}\). (Такую операцию называют еще конкатенацией.) Пустое множество \(\varnothing\) играет здесь роль нуля: \(M_1\varnothing = \varnothing M_2 = \varnothing\). Поэтому вместо \(\varnothing\) будем, как и в матрице \(C\), писать 0. Очевидно, что эта операция некоммутативна. Она имеет простой графовый смысл: если \(M_1\) — множество всех путей, ведущих из \(v_i\) в \(v_j\), а \(M_2\) — множество всех путей, ведущих из \(v_j\) в \(v_k\), то \(M_1M_2\) — это множество всех путей, ведущих из \(v_i\) в \(v_k\) и проходящих через \(v_j\).

С помощью этих операций определим произведение \(Z = XY\) квадратных матриц \(X\) и \(Y\) одинаковой размерности \(n\), элементами которых являются множества слов (такие матрицы назовем словарными):

\[
z_{ij} = \bigcup_{k=1}^n x_{ik} y_{kij}.
\] (4.2)