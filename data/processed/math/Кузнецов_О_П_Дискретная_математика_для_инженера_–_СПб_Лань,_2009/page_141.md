---
source_image: page_141.png
page_number: 141
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.23
tokens: 5462
characters: 2292
timestamp: 2025-12-24T07:20:28.910501
finish_reason: stop
---

Обозначим через \( T_k \) граф, образованный ребрами и вершинами, помеченными в первых \( k \) циклах. Вершину, помеченную в \( k \)-м цикле, обозначим через \( x_k \). \( T_{k+1} \) получается из \( T_k \) добавлением \( x_{k+1} \) и помеченного ребра, входящего в \( x_{k+1} \) из некоторой вершины \( T_k \). Из этого построения видно, что \( T_k \) связан и при любом \( k \) в каждую вершину \( T_k \) (кроме \( s \)) входит ровно одно ребро. Поэтому \( T_k \) — ориентированное дерево с корнем в \( s \). На рис. 4.29 представлено дерево \( T_5 \) для примера 4.21.

Далее, обозначим через \( d_k(x) \) значение \( d(x) \) после \( k \)-го цикла. Окончательное значение \( d(x) \) обозначим через \( d_z(x) \). Переменная \( y \) алгоритма после \( k \)-го цикла принимает значение \( x_k \). Формула (4.7) для \((k+1)\)-го цикла в этих обозначениях примет следующий вид:

\[
d_{k+1}(x) = \min\{d_k(x),\ d_z(x_k) + l(x_k,\ x)\}.
\] (4.8)

Основное свойство величин \( d(x) \), порождаемых алгоритмом Дейкстры, описывается следующим утверждением.

**Лемма 4.3.** Пусть \( x_i \) — вершина \( T_k \), помеченная в \( i \)-м цикле. Тогда

1) \( d_z(x_{i-1}) \leq d_z(x_i) \) для всех \( i \leq k \);
2) для любой вершины \( x \), непомеченной после \( k \)-го цикла, \( d_z(x_k) \leq d(x) \).

Для вершины \( x_i \)
\[
d_z(x_i) = d_z(x_j) + l(x_j, x_i),
\] (4.9)
где \( j \) — номер цикла, где \( d(x_i) \) менялась последний раз. Если \( j = i - 1 \), то из (4.8) имеем \( d_z(x_i) = d_z(x_{i-1}) + l(x_{i-1}, x_i) \), и первое утверждение выполняется.

Если же \( j < i - 1 \), то \( d_z(x_i) = d_{i-1}(x_i) \) в \((i-1)\)-м цикле не менялась, и величины \( d_{i-1}(x_{i-1}),\ d_{i-1}(x_i) \) рассматривались в этом цикле при выборе новой помеченной вершины. Поскольку была выбрана вершина \( x_{i-1} \), то первое утверждение выполняется и в этом случае.

Аналогично доказывается и второе утверждение. \( \square \)

Докажем теперь корректность алгоритма Дейкстры.

**Теорема 4.24.** Для любого \( k < n \) \( T_k \) является деревом кратчайших путей, т. е. путь в \( T_k \), ведущий из \( s \) в любую его вершину \( x \), является кратчайшим путем из \( s \) в \( x \) в исходном графе \( G \), а \( d_z(x) \) — его длина.

Доказательство проведем индукцией по числу циклов алгоритма.