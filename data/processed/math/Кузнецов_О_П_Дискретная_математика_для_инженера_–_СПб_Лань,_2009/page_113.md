---
source_image: page_113.png
page_number: 113
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.54
tokens: 5519
characters: 2407
timestamp: 2025-12-24T07:19:56.188476
finish_reason: stop
---

В этой формуле роль суммы элементов играет теоретико-множественное объединение, а произведения — определенная выше конкатенация. Степень матрицы \( H \) определяется тогда по индукции формулой \( H^{l+1} = HH^l \).

Теорема 4.7. Элемент \((i, j) = h_{ij}^{(l)}\) матрицы \(H^l\) орграфа \(G\) представляет собой множество всех путей длины \(l\) из \(v_i\) в \(v_j\).

Докажем эту теорему индукцией по \(l\). Доказательство почти дословно совпадает с доказательством предыдущей теоремы. Для \(l = 1\) теорема очевидна, поскольку любой ненулевой элемент \(h_{ij}\) матрицы \(H\) — это ребро (т. е. путь длины 1), ведущее из \(v_i\) в \(v_j\). Пусть для некоторого \(l\) теорема верна, т. е. элемент \(h_{ij}^{(l)}\) матрицы \(H^l\) равен числу путей длины \(l\) из \(v_i\) в \(v_j\). Докажем ее для \(l + 1\). Любой путь длины \(l + 1\) из \(v_i\) в \(v_j\) состоит из ребра, ведущего в некоторую вершину \(v_k\), и пути длины \(l\) из \(v_k\) в \(v_j\). Для произвольного \(k\) множество путей длины \(l + 1\) из \(v_i\) в \(v_j\), проходящих на первом шаге через вершину \(v_k\), равно конкатенации \(h_{ik} h_{kj}^{(l)}\) (если ребра из \(v_i\) в \(v_k\) нет, то \(h_{ik} = 0\), и \(h_{ik} h_{kj}^{(l)} = \varnothing\)). Все множество путей длины \(l + 1\) из \(v_i\) в \(v_j\) получим, если объединим множества \(h_{ik} h_{kj}^{(l)}\) по всем \(k\):

\[
\bigcup_{k=1}^n h_{ik} h_{kj}^{(l)}.
\]

Эта сумма, как видно из формулы (4.2), равна элементу \((i, j)\) произведения матриц \(H\) и \(H^l\), т. е. элементу \((i, j)\) матрицы \(H^{l+1}\), что и доказывает теорему. \(□\)

Следствие 4.2. Элемент \((i, j)\) матрицы \(H + H^2 + ... + H^l\) орграфа \(G\) равен множеству всех путей длины \(\leq l\) из \(v_i\) в \(v_j\).

Матрицей достижимости орграфа \(G\) с \(n\) вершинами будем называть квадратную матрицу \(T(G)\) размерности \(n \times n\), в которой элемент \(r_{ij} = 1\), если \(v_j\) достижима из \(v_i\), и \(r_{ij} = 0\), если \(v_j\) недостижима из \(v_i\). Полагаем, что \(r_{ii} = 1\) для всех \(i\).

Преобразование произвольной матрицы \(A\), заключающееся в замене на 1 всех ненулевых элементов \(A\), обозначим через \(B(A)\).

Теорема 4.8. Для орграфа \(G\) с \(n\) вершинами \(T(G) = B(I + C + C^2 + ... + C^{n-1})\), где \(I\) — единичная матрица.

По теореме 4.1', если \(v_j\) достижима из \(v_i\), то существует простая цепь из \(v_i\) в \(v_j\). Длина этого пути не превосходит