---
source_image: page_361.png
page_number: 361
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.99
tokens: 7422
characters: 1982
timestamp: 2025-12-24T08:55:04.311855
finish_reason: stop
---

Key ASTRONOMY: The real secrets are not the ones I tell.

Enter D for done, or just press Enter to continue breaking:
> d
Copying hacked message to clipboard:
The real secrets are not the ones I tell.

Первый ключ, предложенный программой (ASTROLOGY), не подходит, поэтому пользователь нажимает клавишу <Enter>, позволяя программе выполняться до тех пор, пока не будет найден корректный ключ (ASTRONOMY).

О структуре программы

Исходный код программы vigenereDictionaryHacker.py в основном содержит уже знакомые нам инструкции, поэтому мы не будем рассматривать его построчно. Общий алгоритм таков: функция hackVigenereDictionary() пытается использовать каждое слово из файла словаря в качестве ключа для дешифрования шифротекста, и если результат дешифрования представляет собой осмысленный текст на английском языке (в соответствии с критериями модуля detectEnglish), то она выводит его на экран и предлагает пользователю завершить процесс дешифрования или продолжить его.

Обратите внимание на вызов метода readlines() для файлового объекта, возвращаемого функцией open():

20. words = fo.readlines()

В отличие от метода read(), который возвращает все содержимое файла в виде одной строки, метод readlines() возвращает список, каждый элемент которого является строкой из файла. Поскольку каждая строка словаря содержит по одному слову, переменная words будет содержать список всех английских слов от Aarhus до Zurich.

Остальная часть функции (строки 23–36) аналогична коду, который использовался в программе взлома перестановочного шифра, рассмотренной в главе 12. В цикле for мы перебираем все слова, содержащиеся в списке words, дешифруем шифротекст с использованием очередного слова в качестве ключа, а затем вызываем функцию detectEnglish.isEnglish() для проверки того, что результат представляет собой осмысленный текст на английском языке.

Теперь рассмотрим, как взломать шифр Виженера даже в том случае, когда ключом служит случайный набор букв, а не слово из словаря.