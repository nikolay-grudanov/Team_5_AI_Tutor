---
source_image: page_396.png
page_number: 396
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.45
tokens: 7695
characters: 2379
timestamp: 2025-12-24T08:56:16.381044
finish_reason: stop
---

Мы конструируем полные ключи Виженера, используя переменную indexes, которая на каждой итерации получает значение в виде одного кортежа, созданного с помощью функции itertools.product(). Ключ инициализируется пустой строкой в строке 190, а во вложенном цикле for (строки 191 и 192) программа проходит по целым числам в диапазоне от 0 до значения mostLikelyKeyLength (но не включая его) для каждого кортежа, формируя ключ.

Поскольку значение переменной i изменяется на каждой итерации цикла, значение indexes[i] становится индексом кортежа, который мы выбираем в элементе allFreqScores[i]. Именно поэтому, обращаясь к элементу allFreqScores[i][indexes[i]], мы получаем нужный кортеж. Далее необходимо обратиться к его элементу с индексом 0, чтобы получить букву подключа.

Если для константы SILENT_MODE установлено значение False, то в строке 195 выводится сформированный ключ.

<table>
  <tr>
    <th>194.</th>
    <td>if not SILENT_MODE:</td>
  </tr>
  <tr>
    <th>195.</th>
    <td>print('Attempting with key: %s' % (possibleKey))</td>
  </tr>
</table>

Теперь, когда в нашем распоряжении имеется полный ключ Виженера, мы можем дешифровать шифротекст (строки 197–208) и проверить, получен ли в результате осмысленный текст на английском языке. В случае положительного исхода такой проверки программа выводит дешифрованный текст на экран, чтобы дать пользователю возможность принять окончательное решение.

Вывод дешифрованного текста с сохранением корректного регистра букв

Поскольку переменная decryptedText содержит буквы в верхнем регистре, мы создаем новую строку путем добавления в список origCase букв из строки decryptedText, предварительно преобразуя их в нужный регистр (строки 201–207).

<table>
  <tr>
    <th>197.</th>
    <td>decryptedText = vigenereCipher.decryptMessage(possibleKey, ciphertextUp)</td>
  </tr>
  <tr>
    <th>198.</th>
    <td></td>
  </tr>
  <tr>
    <th>199.</th>
    <td>if detectEnglish.isEnglish(decryptedText):</td>
  </tr>
  <tr>
    <th>200.</th>
    <td># Задаем исходный регистр букв во взломанном шифротексте</td>
  </tr>
  <tr>
    <th>201.</th>
    <td>origCase = []</td>
  </tr>
  <tr>
    <th>202.</th>
    <td>for i in range(len(ciphertext)):</td>
  </tr>
  <tr>
    <th>203.</th>
    <td>if ciphertext[i].isupper():</td>
  </tr>
  <tr>
    <th>204.</th>
    <td>origCase.append(decryptedText[i].upper())</td>
  </tr>
</table>