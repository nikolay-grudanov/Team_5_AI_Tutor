---
source_image: page_424.png
page_number: 424
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.37
tokens: 7435
characters: 1869
timestamp: 2025-12-24T08:56:44.825865
finish_reason: stop
---

ходим по всему списку sieve и добавляем в список primes значения i при условии, что элемент sieve[i] равен True, т.е. i — простое число.

38.    # Формируем список простых чисел
39.    primes = []
40.    for i in range(sieveSize):
41.        if sieve[i] == True:
42.            primes.append(i)

В строке 44 возвращается список простых чисел:

44.    return primes

Функция primeSieve() позволяет находить все простые числа в пределах небольшого диапазона, тогда как функция isPrimeTrialDiv() способна быстро определять, является ли заданное небольшое число простым. Но как быть с большими простыми числами, содержащими сотни цифр?

Даже если передать функции isPrimeTrialDiv() относительно большое целое число, то на его проверку уйдет несколько секунд. В случае простых чисел, содержащих сотни цифр, наподобие тех, с которыми мы будем работать в программе шифрования с открытым ключом в главе 23, функция isPrimeTrialDiv() будет выполняться более триллиона лет.

В следующем разделе вы узнаете о том, как определить, является ли очень большое число простым, используя тест Миллера — Рабина.

Тест Миллера — Рабина для проверки простоты числа

Основное преимущество теста Миллера — Рабина заключается в том, что на обычном компьютере он выполняется всего за несколько секунд. Но несмотря на относительно компактный код Python, математическое обоснование принципов его работы заняло бы слишком много места, поэтому мы не будем приводить его здесь. Тест Миллера — Рабина является вероятностным. Он позволяет находить вероятно простые числа, которые могут оказаться составными. Впрочем, риск ошибиться в данном случае относительно невелик, чего вполне достаточно для целей книги. Чтобы узнать больше о том, как работает этот алгоритм, обратитесь к Википедии (https://ru.wikipedia.org/wiki/Тест_Миллера_-_Рабина).

Тест Миллера — Рабина реализован в функции rabinMiller().