---
source_image: page_256.png
page_number: 256
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.49
tokens: 7443
characters: 1933
timestamp: 2025-12-24T08:52:20.953833
finish_reason: stop
---

Если умножить 66 возможных значений ключа A на 66 возможных значений ключа B, то получим 4356 возможных комбинаций. Если исключить все целые числа, которые не могут быть использованы в качестве ключа A, поскольку они не являются взаимно простыми числами с числом 66, то общее количество возможных комбинаций ключей для аффинного шифра уменьшится до 1320.

Написание функции шифрования

Чтобы зашифровать сообщение с помощью программы affineCipher.py, прежде всего нужны ключ и само сообщение, которые передаются в функцию encryptMessage() в качестве аргументов.

41. def encryptMessage(key, message):
42.     keyA, keyB = getKeyParts(key)
43.     checkKeys(keyA, keyB, 'encrypt')

В строке 42 мы передаем ключ в функцию getKeyParts(), чтобы получить от нее целочисленные значения ключей A и B. Далее мы проверяем, являются ли эти значения допустимыми ключами, передавая их в функцию checkKeys(). Если функция checkKeys() не завершила работу программы, значит, ключи являются допустимыми, и выполняется остальная часть функции encryptMessage() после строки 43.

В строке 44 переменная ciphertext инициализируется пустой строкой. Впоследствии в нее будет записано зашифрованное сообщение. В цикле for, который начинается в строке 45, мы проходим по всем символам сообщения, добавляя их в переменную ciphertext.

44.     ciphertext = ''
45.     for symbol in message:

К моменту, когда цикл завершит свою работу, переменная ciphertext будет содержать всю строку зашифрованного сообщения.

На каждой итерации цикла переменной symbol присваивается очередной символ сообщения. Если этот символ содержится в строке SYMBOLS, которая представляет наш символьный набор, то мы находим индекс символа и присваиваем его переменной symbolIndex в строке 48.

46.         if symbol in SYMBOLS:
47.             # Зашифровать символ
48.             symbolIndex = SYMBOLS.find(symbol)
49.             ciphertext += SYMBOLS[(symbolIndex * keyA + keyB) %