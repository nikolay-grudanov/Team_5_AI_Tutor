---
source_image: page_435.png
page_number: 435
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.06
tokens: 7513
characters: 1803
timestamp: 2025-12-24T08:57:04.887364
finish_reason: stop
---

Спецслужбы могут заменить открытый ключ Эммануила, прикрепленный к письму, своим открытым ключом и переслать сообщение вам. У вас не будет никакой возможности узнать, чей это ключ: Эммануила или спецслужб!

Впоследствии, когда вы будете шифровать свой ответ Эммануилу, вы воспользуетесь открытым ключ спецслужб, а не Эммануила. Спецслужбы смогут перехватить ваше сообщение и расшифровать его, а затем повторно зашифровать, но уже с помощью открытого ключа Эммануила. Аналогичный трюк будет проделан со всеми последующими ответами Эммануила на ваши письма. Суть атаки посредника проиллюстрирована на рис. 23.1.

![Рис. 23.1. Атака посредника](../images/chapter23/figure23_1.png)

Для вас и Эммануила все будет выглядеть так, словно ваше общение осуществляется втайне от других. Однако спецслужбам будет известно содержимое всех ваших сообщений, поскольку и вы, и Эммануил шифруете свои сообщения открытым ключом, сгенерированным спецслужбами! Опять-таки, описанная проблема возникает лишь по той причине, что шифрование с открытым ключом обеспечивает конфиденциальность, но не аутентификацию. Более подробное обсуждение механизмов аутентификации и инфраструктуры открытых ключей выходит за рамки книги. А нам предстоит рассмотреть способы генерации ключей.

Порядок генерирования открытых и закрытых ключей

В криптосистемах с открытым ключом каждый ключ состоит из двух чисел. Открытым ключом служат числа \( n \) и \( e \), закрытым — числа \( n \) и \( d \). Эти числа создаются в три этапа.

1. Создайте два очень больших простых числа: \( p \) и \( q \). Это должны быть два разных случайных числа. Перемножьте их для получения числа \( n \).
2. Создайте случайное число \( e \), взаимно простое с числом \( (p - 1)(q - 1) \).
3. Вычислите модульное обращение числа \( e \)— это будет число \( d \).