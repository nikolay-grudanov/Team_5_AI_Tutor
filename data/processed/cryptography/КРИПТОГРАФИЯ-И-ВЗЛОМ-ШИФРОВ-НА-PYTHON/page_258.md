---
source_image: page_258.png
page_number: 258
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.28
tokens: 7443
characters: 1897
timestamp: 2025-12-24T08:52:21.003843
finish_reason: stop
---

61. for symbol in message:
62.     if symbol in SYMBOLS:
63.         # Дешифровать символ
64.         symbolIndex = SYMBOLS.find(symbol)
65.         plaintext += SYMBOLS[(symbolIndex - keyB) *
66.             modInverseOfKeyA % len(SYMBOLS)]
67.     else:
68.         plaintext += symbol  # присоединить символ без дешифрования
69. return plaintext

В функции encryptMessage() индекс символа умножался на ключ А и к полученному результату прибавлялся ключ В. В строке 65 функции decryptMessage() из индекса символа сначала вычитается ключ В, после чего полученный результат умножается на модульное обращение ключа А. Далее вычисляется остаток от деления полученного числа на размер символьного набора, т.е. len(SYMBOLS).

Так реализуется процесс дешифрования. Теперь рассмотрим, какие изменения необходимо внести в программу affineCipher.py, чтобы она выбирала допустимые ключи для аффинного шифра случайным образом.

Генерирование случайных ключей

Не так-то легко подобрать допустимый ключ для аффинного шифра. Проще вызвать функцию getRandomKey(), которая случайным образом генерирует допустимый ключ. Для этого достаточно изменить строку 10 таким образом, чтобы возвращаемое значение функции getRandomKey() сохранялось в переменной myKey.

10. myKey = getRandomKey()
--опущено--
17. print('Key: %s' % (myKey))

Теперь программа сама выбирает случайный ключ и выводит его на экран в строке 17. Разберемся в том, как работает функция getRandomKey().

В строке 72 начинается цикл, условием которого является значение True. Этот бесконечный цикл будет продолжаться до тех пор, пока не поступит команда выйти из него или пользователь не прервет выполнение программы. Если программа застряла в бесконечном цикле, можно прервать ее выполнение, нажав комбинацию клавиш <Ctrl+C> (<Ctrl+D> в Linux и macOS). В нашем случае функция getRandomKey() выйдет из бесконечного цикла с помощью инструкции return.