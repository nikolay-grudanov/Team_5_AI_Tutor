---
source_image: page_425.png
page_number: 425
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.27
tokens: 7518
characters: 1923
timestamp: 2025-12-24T08:56:50.754743
finish_reason: stop
---

46. def rabinMiller(num):
47.     # Возвращает True, если num — простое число
48.     if num % 2 == 0 or num < 2:
49.         return False  # тест не работает для четных чисел
50.     if num == 3:
51.         return True
52.     s = num - 1
53.     t = 0
54.     while s % 2 == 0:
55.         # Делим s на 2 до тех пор, пока не получим нечетное
56.         # число (используя t для подсчета таких делений)
57.         s = s // 2
58.         t += 1
59.     for trials in range(5):  # пытаемся фальсифицировать проверку
60.                                 простоты числа num 5 раз
61.         a = random.randrange(2, num - 1)
62.         v = pow(a, s, num)
63.         if v != 1:  # тест неприменим, если v равно 1
64.             i = 0
65.             while v != (num - 1):
66.                 if i == t - 1:
67.                     return False
68.                 else:
69.                     i = i + 1
70.                     v = (v ** 2) % num
71.     return True

Не обязательно понимать, как работает этот код. Важно знать лишь одно: если функция rabinMiller() возвращает True, то аргумент num является вероятно простым числом. Если же возвращаемое значение равно False, то число num является составным.

Проверка больших простых чисел

Мы создадим еще одну функцию, isPrime(), которая будет вызывать функцию rabinMiller(). Тест Миллера — Рабина не всегда будет самым эффективным способом проверки простоты числа, поэтому предварительно выполняются несколько быстрых проверок, позволяющих определить, является ли параметр num простым числом. Список всех простых чисел, не превышающих 100, хранится в константе LOW_PRIMES. Он генерируется с помощью функции primeSieve().

72. # Обычно можно быстро определить, что параметр num — составное число,
73. # разделив его на первые несколько десятков простых чисел. Это быстрее,
74. # чем вызывать функцию rabinMiller(), но годится не всегда.
75. LOW_PRIMES = primeSieve(100)