---
source_image: page_252.png
page_number: 252
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.04
tokens: 7481
characters: 1867
timestamp: 2025-12-24T08:52:16.186723
finish_reason: stop
---

оператор mod (%) возвращает остаток, который мы будем использовать в качестве ключа В.

Например, если выбран ключ 2894, а строка SYMBOLS содержит 66 символов, то ключ А будет равен 2894 // 66 = 43, а ключ В — 2894 % 66 = 56.

Чтобы объединить ключи А и В в один ключ, умножьте ключ А на размер символьного набора и прибавьте к полученному произведению ключ В: (43 * 66) + 56. В результате вы получите число 2894, являющееся исходным целочисленным ключом.

Примечание

Имейте в виду, что в соответствии с максимой Шеннона ("Враг знает систему!") мы должны предполагать, что хакерам известно все об алгоритме шифрования, включая набор символов и его размер. Мы считаем, что единственным элементом, неизвестным хакеру, является использованный ключ. Безопасность программы шифрования должна зависеть только от секретности ключа, а не от секретности символьного набора или исходного кода программы.

Кортежи

Строка 27 выглядит так, будто возвращает список значений, только вместо квадратных скобок использованы круглые. Так обозначаются значения типа кортеж (tuple).

27. return (keyA, keyB)

Кортеж аналогичен списку в том смысле, что хранит другие значения, к которым можно получить доступ через индекс или срез. Разница лишь в том, что содержимое кортежа не может быть изменено. Метод append() для кортежей не поддерживается.

Поскольку в программе affineCipher.py нет необходимости изменять значение, возвращаемое функцией getKeyParts(), в данном случае уместнее использовать кортеж, а не список.

Выявление слабых ключей

Аффинное шифрование подразумевает умножение индекса символа в наборе SYMBOLS на ключ А и прибавление ключа В. Но если ключ А равен 1, то шифр оказывается очень слабым, поскольку в результате умножения индекса на 1 мы получаем тот же индекс. Точно так же, если ключ В равен нулю, шифр оказывается слабым, ведь добавление нуля к индексу не изме-