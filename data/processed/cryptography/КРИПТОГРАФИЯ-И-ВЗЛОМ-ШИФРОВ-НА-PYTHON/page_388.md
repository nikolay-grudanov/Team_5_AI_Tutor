---
source_image: page_388.png
page_number: 388
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.13
tokens: 7532
characters: 2160
timestamp: 2025-12-24T08:55:53.320060
finish_reason: stop
---

Теперь, когда мы научились извлекать буквы, зашифрованные одним и тем же подключом, мы сможем использовать функцию getNthSubkeysLetters() для того, чтобы попытаться дешифровать сообщение с помощью ключей наиболее вероятной длины.

Попытки дешифрования с помощью ключей вероятной длины

Вспомните о том, что функция kasiskiExamination() возвращает не гарантированно верную длину ключа Виженера, а список, включающий несколько возможных вариантов, отсортированных в порядке убывания их вероятности. Если длина ключа была определена неверно, программа попытается использовать ключ другой длины. Эту работу выполняет функция attemptHackWithKeyLength(), которая получает шифротекст и предполагаемую длину ключа. В случае успеха функция возвращает строку взломанного сообщения, а в случае неудачи — значение None.

Процедура взлома применяется к буквам, преобразованным в верхний регистр, но мы хотим, чтобы любая дешифрованная строка возвращалась с соблюдением исходного регистра, а для этого нужно сохранить строку в ее первоначальном виде. Чтобы обеспечить это, мы сохраняем строку шифротекста, буквы которой преобразованы в верхний регистр, в переменной ciphertextUp (строка 157).

155. def attemptHackWithKeyLength(ciphertext, mostLikelyKeyLength):
156.     # Определяем наиболее вероятные буквы для каждого подключа
157.     ciphertextUp = ciphertext.upper()

Исходя из предположения, что значение mostLikelyKeyLength представляет собой корректную длину ключа, программа взлома вызывает функцию getNthSubkeysLetters() для каждого подключа, а затем применяет метод грубой силы, выполняя полный перебор всех 26 возможных букв для нахождения той из них, которая приводит к получению дешифрованного текста с частотностью, наиболее близко соответствующей частотности букв в типичных английских текстах.

Сначала в строке 160 создается пустой список allFreqScores, в котором будут храниться оценки частотного соответствия, возвращаемые функцией freqAnalysis.englishFreqMatchScore().

160.    allFreqScores = []
161.    for nth in range(1, mostLikelyKeyLength + 1):
162.        nthLetters = getNthSubkeysLetters(nth, mostLikelyKeyLength,
163.            ciphertextUp)