---
source_image: page_470.png
page_number: 470
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.85
tokens: 7502
characters: 2049
timestamp: 2025-12-24T08:58:11.226353
finish_reason: stop
---

Чтение открытого и закрытого ключей из соответствующих файлов

Функция readKeyFile() считывает числовые значения ключей из файлов, создаваемых программой makePublicPrivateKeys.py (см. главу 23). Имя файла задается параметром keyFilename. Файл должен находиться в той же папке, что и программа publicKeyCipher.py.

В строках 97–99 функция открывает файл, загружает его содержимое в строковом виде в переменную content, после чего закрывает файл.

94. def readKeyFile(keyFilename):
95.     # Считывает из указанного файла открытый или
96.     # закрытый ключ в виде кортежа (n,e) или (n,d)
97.     fo = open(keyFilename)
98.     content = fo.read()
99.     fo.close()
100.    keySize, n, EorD = content.split(',')
101.    return (int(keySize), int(n), int(EorD))

В файле ключа хранится размер ключа в байтах, число n, а также число e либо d, в зависимости от типа ключа (открытый или закрытый). Как было показано в предыдущей главе, эти значения записываются в строковом виде и разделяются запятыми, что позволяет извлечь их с помощью строкового метода split(), задав запятую в качестве разделителя. Возвращаемый методом split() список содержит три элемента, которые помещаются в переменные keySize, n и EorD с помощью инструкции группового присваивания (строка 100).

Вспомните, что переменная content представляет собой строку, поэтому возвращаемые методом split() элементы списка также будут строками. Чтобы преобразовать их в числа, мы применяем к ним функцию int(). В результате функция readKeyFile() возвращает три целых числа: int(keySize), int(n) и int(EorD).

Запись зашифрованного сообщения в файл

Функция encryptAndWriteToFile() вызывает функцию encryptMessage() для шифрования строки с помощью прочитанного ключа и создает файл, содержащий зашифрованное содержимое.

104. def encryptAndWriteToFile(messageFilename, keyFilename, message,
    blockSize=None):
105.     # Считывает ключ из файла, шифрует сообщение и сохраняет его
106.     # в выходном файле, возвращая зашифрованную строку
107.     keySize, n, e = readKeyFile(keyFilename)