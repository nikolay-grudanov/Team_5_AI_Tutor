---
source_image: page_452.png
page_number: 452
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.00
tokens: 7660
characters: 1901
timestamp: 2025-12-24T08:57:42.331441
finish_reason: stop
---

Пусть, например, Алиса пытается расшифровать целочисленный блок 43 924 807 641 574 602 969 334 176 505 118 775 186. Компоненты n ее открытого и закрытого ключей совпадают, а компонента d закрытого ключа равна 72 424 475 949 690 145 396 970 707 764 378 340 583. Для дешифрования необходимо выполнить следующую операцию.

>>> pow(43924807641574602969334176505118775186,
      72424475949690145396970707764378340583,
      116284564958604315258674918142848831759)
957285919

Преобразовав целочисленный блок 957285919 в строку, мы получим 'Howdy', т.е. исходное сообщение. Сейчас вы узнаете, как преобразовать целочисленный блок в строку.

Преобразование блока в строку

Чтобы дешифровать блок в исходный целочисленный блок, прежде всего необходимо преобразовать его в небольшие целые числа, каждое из которых соответствует исходному символу. Процесс начинается с последнего символа, добавленного в блок. Для вычисления чисел, соответствующих отдельным символам, используется деление с округлением вниз и деление с остатком.

Вспомните, что в предыдущем примере целочисленное значение блока для строки 'Howdy' было равно 957285919. Исходное сообщение содержит пять символов, а значит, индекс последнего символа в сообщении равен 4. Размер символьного набора сообщения равен 66. Чтобы определить индекс последнего символа строки сообщения в символьном наборе, мы делим число 957 285 919 на \(66^4\) с округлением вниз, получая 50. Для округления вниз можно использовать оператор целочисленного деления (//). В символьном наборе элементом с индексом 50 (SYMBOLS[50]) будет символ 'y', который действительно является последним символом в строке 'Howdy'.

В интерактивной оболочке эти вычисления можно выполнить с помощью следующих инструкций.

>>> blockInteger = 957285919
>>> SYMBOLS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890 !?.'
>>> blockInteger // (66 ** 4)
50
>>> SYMBOLS[50]
'y'