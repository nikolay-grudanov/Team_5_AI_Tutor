---
source_image: page_389.png
page_number: 389
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.77
tokens: 7510
characters: 2077
timestamp: 2025-12-24T08:55:53.777785
finish_reason: stop
---

Переменная nth в цикле for, который начинается в строке 161, поочередно принимает значения от 1 до mostLikelyKeyLength. Вспомните, что диапазон, возвращаемый функцией range(), не включает верхнюю границу, задаваемую вторым аргументом. В связи с этим мы увеличиваем верхнюю границу диапазона на 1, чтобы охватить значение mostLikelyKeyLength.

Буквы n-го подключа возвращаются функцией getNthSubkeysLetters() в строке 162.

Далее необходимо дешифровать буквы n-го подключа, используя все 26 возможных подключей, чтобы увидеть, какой из них приводит к частотности букв, близкой к частотности в типичных английских текстах. Список оценок частотного соответствия будет храниться в переменной freqScores, которая инициализируется пустым списком в строке 168. В цикле for, который начинается в строке 169, программа проходит по всем 26 буквам строки LETTERS.

168. freqScores = []
169. for possibleKey in LETTERS:
170.     decryptedText = vigenereCipher.decryptMessage(possibleKey, nthLetters)

Значение possibleKey используется для дешифрования шифротекста путем вызова функции vigenereCipher.decryptMessage() в строке 170. Подключ, содержащийся в переменной possibleKey, является однобуквенным, тогда как строка nthLetters формируется только из тех букв шифротекста, которые могут быть зашифрованы данным подключом, если программа правильно определила длину ключа.

Далее дешифрованный текст передается функции freqAnalysis.englishFreqMatchScore(), чтобы проверить, насколько близко частотность букв в строке decryptedText соответствует частотности букв в типичных английских текстах. Вспомните из главы 19, что данная функция возвращает целое число в интервале от 0 до 12, причем чем больше это значение, тем ближе соответствие.

В строке 171 полученная оценка частотного соответствия и подключ, использованный для дешифрования, заносятся в переменную keyAndFreqMatchTuple. В строке 172 этот кортеж добавляется в конец списка freqScores.

171. keyAndFreqMatchTuple = (possibleKey,
    freqAnalysis.englishFreqMatchScore(decryptedText))
172. freqScores.append(keyAndFreqMatchTuple)