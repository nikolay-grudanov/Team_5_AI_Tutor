---
source_image: page_078.png
page_number: 78
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.20
tokens: 7528
characters: 1779
timestamp: 2025-12-24T08:32:55.193560
finish_reason: stop
---

Джон зашифровал хеш сообщения своим закрытым ключом. Этот зашифрованный хеш служит подписью. Когда Лиза расшифрует подпись В открытым ключом С Джона, она должна получить хеш, совпадающий с хешем сообщения А в письме.

Лиза расшифровывает подпись В с помощью открытого ключа С из своей таблицы открытых ключей и получает в результате большое число. Если число совпадает с хешем сообщения А, это доказывает, что для подписи сообщения использовался закрытый ключ Джона. Чтобы получить хеш, Лиза берет текст сообщения А из письма в точности как написано и хеширует его так же, как это сделал Джон, когда создавал подпись. Этот хеш затем сравнивается с расшифрованной подписью. Если хеш сообщения и дешифрованная подпись совпадают, значит, подпись действительна.

Обратите внимание, что подобный способ проверки возможен, только если Джон и Лиза используют одну и ту же схему создания цифровых подписей. Она должна быть согласована заранее, но чаще используется стандартная процедура. В Биткоин все точно знают, какую схему создания цифровых подписей использовать.

Теперь Лиза может быть уверена, что никто не пытается ее одурачить. Она обновляет электронную таблицу, добавляя перевод Джону, как показано на рис. 2.21.

<table>
  <tr>
    <th>От кого</th>
    <th>Кому</th>
    <th>Количество СТ</th>
  </tr>
  <tr>
    <td>...</td>
    <td>...</td>
    <td>...</td>
  </tr>
  <tr>
    <td>Компания</td>
    <td>Джон</td>
    <td>100</td>
  </tr>
  <tr>
    <td>Джон</td>
    <td>Кафе</td>
    <td>10</td>
  </tr>
</table>

Новая запись! Джон подписал просьбу о переводе, и Лиза убедилась в достоверности подписи. Она проверила баланс Джона и добавила запись о переводе в электронную таблицу

Рис. 2.21. После проверки подписи сообщения Лиза добавляет запись о переводе жетонов Джону