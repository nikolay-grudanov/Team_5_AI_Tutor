---
source_image: page_324.png
page_number: 324
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.10
tokens: 7369
characters: 1230
timestamp: 2025-12-24T08:39:12.275389
finish_reason: stop
---

Обратите внимание, что запросы к DNS, изображенные на рис. 8.30, не возвращают номера портов. Два других метода поиска начальных соседей обычно включают их, но сервер DNS может возвращать только IP-адреса. Предполагается, что узлы с этими IP-адресами прослушивают порт, используемый в Bitcoin Core по умолчанию, а именно 8333.

Рукопожатие

Допустим, что Селма решила подключиться к узлу Ци с адресом 1.234.63.203:4567 и к узлу Рашида с адресом 47.196.31.246:8333. Селма настраивает TCP-соединение с каждым из этих двух узлов и посылает им начальное сообщение. Давайте посмотрим, как протекает общение с узлом Ци (рис. 8.31).

![Схема рукопожатия между узлами Селма, Рашид и Ци](https://i.imgur.com/3Q5z5QG.png)

Рис. 8.31. Селма обменивается с Ци сообщениями version

Этот обмен, называемый рукопожатием, начинает Селма. Она отправляет сообщение version узлу Ци. Рукопожатие используется, чтобы согласовать версию протокола и сообщить друг другу, какую высоту блоков они имеют. Сообщение version содержит много сведений, не показанных на рис. 8.31, из которых наиболее важными являются:

★ Версия протокола — версия сетевого протокола, или «языка», который используют узлы для общения друг с другом. Селма и Ци будут использовать