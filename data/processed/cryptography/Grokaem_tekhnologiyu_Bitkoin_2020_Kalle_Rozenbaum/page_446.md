---
source_image: page_446.png
page_number: 446
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.21
tokens: 7559
characters: 1852
timestamp: 2025-12-24T08:42:54.791007
finish_reason: stop
---

Использование отдельных битов в номере версии блока — BIP9

Разработчики Биткоин накопили богатый опыт в ходе предыдущих софт-форков. Им предстояло решить несколько проблем:

★ в каждый период времени развертываться могло только один софт-форк;
★ номера версий блоков нельзя повторно использовать для других целей.

Самая досадная проблема — невозможность одновременного развертывания нескольких софт-форков. Это связано с тем, что предыдущие механизмы развертывания, такие как описанный в BIP34, проверяли условие: больше или равен номер версии определенному числу, например 2.

Предположим, требуется развернуть оба предложения — BIP34 и BIP66 — одновременно. Для развертывания BIP34 будет использоваться версия блока 2, а для развертывания BIP66 — версия 3. Мы не сможем избирательно сигнализировать о поддержке только BIP66. Присваивая блоку номер версии 3, мы также сообщим о поддержке BIP34, потому что номер версии 3 больше или равен 2.

Разработчики выдвинули предложение по улучшению Биткоин BIP9, в котором описали процесс одновременного развертывания нескольких софт-форков.

Этот процесс тоже использует номер версии блока, но по-другому. Разработчики решили изменить способ интерпретации байтов в номере версии. Версии блоков, в которых старшие 3 бита имеют значение 001, обрабатываются особым образом.

Во-первых, все такие версии блоков больше 4, потому что наименьший номер версии с тремя старшими битами 001 равен 20000000, что намного больше, чем 00000004. Поэтому блоки с поддержкой BIP9 всегда будут поддерживать уже развернутые BIP34, 66 и 65. Отлично.

29 битов, расположенных правее крайних левых битов 001, можно использовать для одновременной сигнализации о поддержке до 29 софт-форков. Каждый из этих 29 битов в номере версии можно использовать для независимого развертывания одного или группы изменений (рис. 11.21). Если бит