---
source_image: page_185.png
page_number: 185
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.45
tokens: 7373
characters: 1370
timestamp: 2025-12-24T08:35:37.734970
finish_reason: stop
---

ЗАЧЕМ ПРОВЕРЯТЬ?
Кафе никак не вовлечено в эту транзакцию, так зачем им понадобилось бы проверять ее? В кафе хотят знать, насколько добросовестно Лиза относится к своей работе. Кафе заинтересовано в том, чтобы своевременно узнать, что происходит что-то подозрительное.

Новое программное обеспечение

Предположим, что в кафе только что обновили свое программное обеспечение и теперь хотят вновь проверить эту транзакцию. Посмотрим, как выполнится эта проверка.

Новое программное обеспечение обнаружит сценарий открытого ключа и по следующему шаблону определит, что эта транзакция описывает платеж вида p2sh:

OP_HASH160
20 байт хеша
OP_EQUAL

Если сценарий открытого ключа в точности соответствует этому шаблону — шаблону p2sh, — программное обеспечение будет обрабатывать программу иначе. Сначала будут выполнены те же семь шагов, что и в старом программном обеспечении, показанные на рис. 5.23, но программа сохранит стек после шага 2. Назовем его сохраненным стеком. Если первые семь шагов дадут в результате признак OK, стек заменяется сохраненным стеком, и верхний элемент — сценарий погашения redeemScript — удаляется из стека (рис. 5.24).

![Стек замещается сохраненным стеком, и сценарий погашения redeemScript удаляется из стека](https://i.imgur.com/5.24.png)

Рис. 5.24. Стек замещается сохраненным стеком, и сценарий погашения redeemScript удаляется из стека