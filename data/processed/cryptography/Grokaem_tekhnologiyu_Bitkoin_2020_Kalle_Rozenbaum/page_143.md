---
source_image: page_143.png
page_number: 143
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.46
tokens: 7294
characters: 1121
timestamp: 2025-12-24T08:34:29.033741
finish_reason: stop
---

Предположим, что в кафе решили предотвратить возможность вычисления главного xprv по известному главному xpriv и закрытому ключу в счете онлайн-продаж. Для этого они могут сгенерировать xprv для счета онлайн-продаж, используя функцию создания защищенных xprv, как показано на рис. 4.22.

Так обозначается защищенный ключ с индексом 1

Теперь вычислить m будет невозможно

Хеширование с закрытым ключом вместо открытого

Счет для онлайн-продаж

Рис. 4.22. Создание защищенного дочернего xprv для счета онлайн-продаж. На вход хеш-функции вместо открытого ключа подается родительский закрытый ключ

Апостроф в пути m/1' — это не опечатка: так обозначаются защищенные ключи. Разница между защищенным и незащищенным ключами состоит в том, что при создании защищенного ключа вместо открытого ключа хешируется закрытый ключ. В этом случае злоумышленник не сможет проделать трюк с вычитанием, потому что хеш получен из родительского закрытого ключа. Мэллори не сможет вычислить левую половину хеша для вычитания из дочернего закрытого ключа, потому что не имеет родительского закрытого ключа. Результат можно видеть на рис. 4.23.