---
source_image: page_410.png
page_number: 410
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.23
tokens: 7462
characters: 1607
timestamp: 2025-12-24T08:41:45.820665
finish_reason: stop
---

★ расходуемый сценарий (spent script) — сценарий свидетеля или сценарий p2wpkh, соответствующий расходуемому выходу;
★ расходуемая сумма (spent amount) — сумма в BTC расходуемого выхода.

Основная часть транзакции хешируется только один раз для создания промежуточного хеша. Это резко уменьшает количество операций хеширования. Если количество входов удвоится, количество операций хеширования тоже удвоится. То есть время работы алгоритма находится в линейной зависимости от количества входов, а не в квадратичной. Время проверки транзакции с 1024 входами, изображенной на рис. 10.7, сокращается с 262 144 мс до 512 мс.

Подпись удостоверяет сумму

Почему в проверку включена расходуемая сумма? Старый алгоритм хеширования подписи не игнорировал ее. Это не имеет никакого отношения к увеличению эффективности хеширования, но устраняет еще одну проблему, с которой сталкиваются автономные и некоторые легкие кошельки.

АППАРАТНЫЕ КОШЕЛЬКИ
Appаратный кошелек — это электронное устройство, предназначенное для защиты закрытых ключей. Неподписанные транзакции посылаются в устройство для подписи. Обычно, чтобы поставить подпись, такое устройство требует ввести пин-код.

Автономный кошелек, например аппаратный кошелек, не может знать, какая сумма расходуется. Если автономный кошелек используется для подписания транзакции, он не сможет показать пользователю сумму комиссии за транзакцию, потому что не видит расходуемую сумму (рис. 10.27). У него нет доступа к блокчейну.

Это верно как для обычных, так и для segwit-транзакций. Но в случае с segwit-транзакциями, когда подписи удостоверяют суммы расходуемых