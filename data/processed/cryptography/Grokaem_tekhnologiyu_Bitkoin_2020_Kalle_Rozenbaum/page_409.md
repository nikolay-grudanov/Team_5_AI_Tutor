---
source_image: page_409.png
page_number: 409
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 21.86
tokens: 7301
characters: 1125
timestamp: 2025-12-24T08:41:36.355379
finish_reason: stop
---

Если удвоить количество операций хеширования и удвоить объем данных, необходимых для обработки каждого хеша, общее время, затрачиваемое на хеширование, фактически увеличивается в четыре раза.

Решение заключается в создании подписей по шагам. Предположим, вы решили подписать все четыре входа транзакции, как показано на рис. 10.26.

ЭТО УПРОЩЕННОЕ ОПИСАНИЕ АЛГОРИТМА

В действительности создаются три разных промежуточных хеша: один для всех выходов, один для всех порядковых номеров и один для всех выходных точек. Однако суть остается прежней. Подробности ищите в BIP143.

Рис. 10.26. Хеширование выполняется в два этапа. Для каждого входа повторно используется промежуточный хеш

Сначала создается промежуточный хеш всей транзакции. Если транзакция содержит не segwit-входы, соответствующие сценарии подписей очищаются перед хешированием. Промежуточный хеш удостоверяет все входы и выходы этой транзакции. Затем для каждого входа промежуточный хеш прибавляется к данным, соответствующим этому входу:

★ расходуемая выходная точка (spent outpoint) — идентификатор транзакции и индекс выхода, который расходует данный вход;