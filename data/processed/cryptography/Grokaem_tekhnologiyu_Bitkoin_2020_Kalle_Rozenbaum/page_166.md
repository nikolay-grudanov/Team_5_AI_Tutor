---
source_image: page_166.png
page_number: 166
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.03
tokens: 7415
characters: 1482
timestamp: 2025-12-24T08:35:01.611413
finish_reason: stop
---

в электронную таблицу, Лиза проверяет присутствие в множестве UTXO выходов, которые тратит транзакция. Если их там нет, значит, Джон пытается потратить деньги, которые никогда не существовали в электронной таблице или уже потрачены (обычно это называется попыткой двойного расходования).

![Используя свое множество UTXO, Лиза убеждается, что Джон не попытался дважды потратить одни и те же деньги](https://i.imgur.com/3Q5z5QG.png)

Рис. 5.6. Используя свое множество UTXO, Лиза убеждается, что Джон не попытался дважды потратить одни и те же деньги

Лиза использует свое множество UTXO для проверки каждого входа в транзакции Джона, выполнив поиск идентификаторов транзакций и индексов выходов. Если все расходуемые выходы присутствуют в множестве UTXO, значит, эта транзакция не является попыткой двойного расходования или расходования несуществующих средств. В данном случае Лиза обнаружит оба выхода в своем множестве UTXO и затем перейдет к проверке подписей в обоих входах транзакции Джона.

Она извлекает PKH выхода из первого входа и сравнивает с хешем открытого ключа, указанного в этом же входе (рис. 5.7). Затем проверяет подпись во входе, используя открытый ключ, подпись и транзакцию, а затем тем же способом проверяет подпись второго входа. Обе проверки завершаются успехом.

ДВОЙНОЕ РАСХОДОВАНИЕ
Под двойным расходованием понимается попытка дважды потратить один и тот же выход. Лиза может предотвратить двойное расходование, выполнив проверку в своем множестве UTXO.