---
source_image: page_128.png
page_number: 128
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.90
tokens: 7450
characters: 1622
timestamp: 2025-12-24T08:34:10.359500
finish_reason: stop
---

Расширенный закрытый ключ (extended private key, xprv) состоит из двух компонентов: закрытого ключа и цепного кода (chain code, см. рис. 4.10).

![Рис. 4.10. xprv состоит из закрытого ключа и цепного кода](https://i.imgur.com/3Q5z5QG.png)

Новый закрытый ключ ничем не отличается от закрытого ключа старого типа, сгенерированного непосредственно генератором случайных чисел. Его также можно использовать для создания открытого ключа и адреса. Обычно адреса создаются только для листьев, но их можно создавать также для промежуточных ключей. Другой компонент xprv — цепной код. Цепной код — это крайние правые 256 бит 512-битного хеша, что объясняет вид значка на рисунке. Чуть ниже я покажу, как создается этот хеш. Целью цепного кода является обеспечение энтропии при создании дочернего xprv. Главный xprv не отличается от других xprv, но мы дали ему особое название (главный), потому что он является прародителем всех ключей в дереве, но создается иным способом.

Начальное случайное число создается на первом шаге точно так же, как создавались закрытые ключи в главе 2. В этом примере генерируется 128 бит случайных данных, но точно так же можно сгенерировать 256 бит, в зависимости от желаемого уровня безопасности, однако для большинства пользователей вполне достаточно 128 бит. Далее вы увидите, как выбор размера начального числа влияет на процесс резервного копирования; более длинное начальное число дольше записывать на листе бумаги во время резервного копирования. Мы вернемся к этой теме в разделе «Назад к резервному копированию».

Описание шагов 2 и 3 заслуживает отдельных подразделов, которые следуют ниже.