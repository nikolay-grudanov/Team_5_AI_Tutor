---
source_image: page_141.png
page_number: 141
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 40.52
tokens: 7559
characters: 1937
timestamp: 2025-12-24T08:34:40.855911
finish_reason: stop
---

В создании закрытого ключа используется обычное сложение: чтобы получить дочерний закрытый ключ, нужно 256-битное число сложить с родительским закрытым ключом. Но чтобы длина результата не превысила 256 бит, используется сложение по модулю 2256.

Сложение, используемое в создании дочернего открытого ключа, отличается от привычного для большинства людей (включая меня). Но давайте пока просто примем на веру, что это сложение работает. Мы подробно рассмотрим его в разделе «Математика открытого ключа».

Создание защищенных закрытых ключей

ВНИМАНИЕ
Это очень сложный раздел. Если у вас возникли трудности с пониманием того, как создаются xprv и xpub, советую пропустить этот раздел и перейти к «Математике открытого ключа». Сведения в этом разделе не нужны для понимания остальной части этой книги.

В этом разделе мы поговорим о том, как предотвратить возможные проблемы безопасности, связанные с обычной процедурой создания xprv.

Запуск онлайн-продаж в кафе начал приносить прибыль. Люди как сумасшедшие стали заказывать булочки! С созданием новых открытых ключей для заказов счет онлайн-продаж растет. Xpub для счета онлайн-продаж хранится на веб-сервере, а xprv присутствует только в кошельке кафе (и в mnemonicическом предложении, запертом в сейфе).

Предположим, что каким-то образом Мэллори смогла украсть закрытый ключ m/1/1, на котором хранится всего 10 СТ. Такая кража может показаться безобидной, потому что на этом закрытом ключе так мало денег. Но на самом деле ситуация намного хуже. Если Мэллори удастся также заполучить xpub для счета онлайн-продаж, который хранится на веб-сервере, она сможет вычислить xprv для счета онлайн-продаж, как показано на рис. 4.21.

Помните, как функция создания xprv использовала обычное сложение для вычисления дочернего закрытого ключа из родительского?

m/1 + левая половина хеша с индексом 1 = m/1/1

Это уравнение можно переписать так:

m/1/1 — левая половина хеша с индексом 1 = m/1