---
source_image: page_142.png
page_number: 142
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.67
tokens: 7428
characters: 1461
timestamp: 2025-12-24T08:34:30.999159
finish_reason: stop
---

Рис. 4.21. Мэллори похитила закрытый ключ m/1/1 из кошелька кафе и родительский хриb с веб-сервера. Теперь она может украсть все деньги, имеющиеся на счете онлайн-продаж

У Мэллори есть все, что нужно, чтобы вычислить левую половину хеша для любого дочернего индекса M/1, который ей понравится, но она не знает, какой индекс имеет украденный ею закрытый ключ, поэтому начинает тестирование с индекса 0:

m/1/1 — левая половина хеша с индексом 0 = закрытый ключ

Она вычисляет открытый ключ для этого закрытого ключа и замечает, что он отличается от M/1, значит, 0 — ошибочный индекс. Затем она пробует индекс 1:

m/1/1 — левая половина хеша с индексом 1 = другой закрытый ключ

Мэллори вычисляет другой закрытый ключ из открытого ключа M/1 и на этот раз попадает точно в яблочко! Она получила закрытый ключ m/1 счета для онлайн-продаж. Оба ключа, xprv и хриb, используют один и тот же цепной код, поэтому удалось вычислить xprv для m/1. Теперь она может вычислить все дерево закрытых ключей для счета онлайн-продаж и украсть все деньги. Это очень плохо.

А теперь представьте, что может случиться, если Мэллори завладеет главным хриb. Она сможет тем же способом, имея главный хриb и m/1/1, вычислить главный xprv и воссоздать все закрытые ключи для всех счетов во всем кошельке. Можно ли как-то предотвратить такой катастрофический сценарий? Да, если использовать еще одну функцию создания ключей! Эта новая функция называется функцией создания защищенных xprv.