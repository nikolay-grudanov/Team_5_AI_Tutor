---
source_image: page_164.png
page_number: 164
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.19
tokens: 7345
characters: 1420
timestamp: 2025-12-24T08:34:58.237048
finish_reason: stop
---

Рис. 5.5. Кошелек Джона подписывает транзакцию. Каждый вход получает отдельную подпись. Во входных данных также должен присутствовать открытый ключ, чтобы любой мог проверить подпись

Каждая подпись подтверждает всю транзакцию, то есть алгоритм создания подписи будет хешировать всю транзакцию, кроме самих подписей. Если что-то изменится в содержимом транзакции, любая подпись для этой транзакции станет недействительной.

Для упрощения проверки подписывается чистая версия транзакции, то есть версия без подписей во входах. Нельзя добавить подпись во вход 0, а затем во вход 1. Проверка будет затруднена, если проверяющий не знает порядок, в каком добавлялись подписи. Когда все подписи создаются на основе чистой транзакции и только потом добавляются в нее, порядок создания подписей не имеет значения.

После создания подписей кошелек добавляет их в транзакцию. Но пока остается неясным еще один аспект: как кто-то, проверяющий транзакцию, например кафе, узнает открытый ключ для проверки подписи? Проверяющий в кафе может видеть только хеш РКН в выходе и подпись во входе. Он не может получить открытый ключ для РКН, потому что, как вы наверняка помните, криптографические хеши являются однонаправленными функциями. Кошелек Джона должен явно добавить соответствующий открытый ключ во вход. Подпись во входе 0, которая тратит деньги из РКН₁, должна проверяться с помощью открытого ключа, из которого был сгенерирован