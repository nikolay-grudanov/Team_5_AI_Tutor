---
source_image: page_386.png
page_number: 386
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.73
tokens: 7370
characters: 1409
timestamp: 2025-12-24T08:40:56.074663
finish_reason: stop
---

386 Глава 10. Segwit

![Три способа изменить форму транзакции](https://i.imgur.com/3Q5z5QG.png)

Рис. 10.4. Три способа изменить форму транзакции

Второй способ основан на использовании криптографических приемов. Я не буду вдаваться в подробности, но, независимо от формата контейнера, подпись можно изменить несколькими способами так, что она не утратит свою действительность. Пока известен только один такой трюк, но нельзя исключать, что есть и другие.

Последний способ заключается в изменении самого сценария. Сделать это можно по-разному. Один из вариантов показан на рис. 10.4: сначала на вершину стека помещается копия верхнего элемента (OP_DUP), а затем она удаляется (OP_DROP); по сути, это изменение ничего не делает, и сам сценарий будет работать нормально.

Второй и третий способы изменения формы транзакции несколько ограничены правилами пересылки, согласно которым узлы требуют, чтобы подписи соответствовали определенным правилам и сценарии подписи не содержали операторов, кроме тех, что помещают данные на стек. В противном случае узел не передаст такую транзакцию дальше. Но ничто не мешает майнеру попытаться включить такую транзакцию в блок. Правила пересылки усложняют распространение измененных транзакций, но не предотвращают возможности их включения в блоки.

Неэффективная проверка подписи

В процессе подписания транзакции алгоритм подписи определенным образом хеширует транзакцию.