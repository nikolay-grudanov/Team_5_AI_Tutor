---
source_image: page_229.png
page_number: 229
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.20
tokens: 7692
characters: 2007
timestamp: 2025-12-24T08:36:52.604443
finish_reason: stop
---

Частичное дерево Меркла включает:

★ число, определяющее общее количество транзакций в блоке;
★ список флагов;
★ список хешей.

Как отмечено в следующей таблице, на каждом шаге с текущим хешем выполняются две операции.

1. Флаг добавляется в список. Значок × означает, что далее в этой ветви дерева нет ничего интересного; значок √ означает, что эта ветвь содержит транзакцию, представляющую интерес.

2. Если установлен флаг × или хеш является идентификатором транзакции, представляющей интерес, этот хеш добавляется в список хешей.

<table>
  <tr>
    <th>Шаг</th>
    <th>Соответствует идентификатору транзакции, представляющей интерес?</th>
    <th>Список флагов</th>
    <th>Установлен флаг × или хеш является идентификатором транзакции, представляющей интерес?</th>
    <th>Список хешей</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Да</td>
    <td>√</td>
    <td>Нет</td>
    <td>—</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Да</td>
    <td>√√</td>
    <td>Нет</td>
    <td>—</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Нет</td>
    <td>√√×</td>
    <td>Да</td>
    <td>3</td>
  </tr>
  <tr>
    <td>4</td>
    <td>Да</td>
    <td>√√×√</td>
    <td>Да</td>
    <td>3 4</td>
  </tr>
  <tr>
    <td>5</td>
    <td>Нет</td>
    <td>√√×√×</td>
    <td>Да</td>
    <td>3 4 5</td>
  </tr>
</table>

Такой порядок шагов называется обходом дерева в глубину, то есть сначала выполняется движение вниз по дереву настолько, насколько возможно, а затем производится переход к следующей ветви. Но для нас нет смысла выполнять полный обход ветвей, в которых нет транзакций, представляющих интерес. Эти ветви отмечены в списке флагов как ×. Выполняя обход, полный узел останавливается, достигнув флага ×, потому что нет необходимости отправлять ненужные данные в кошелек, отсюда и термин «частичное дерево Меркла».

Создав частичное дерево Меркла, полный узел отправит его и заголовок блока в кошелек, а также фактическую транзакцию Tx₂. Заголовок блока с частичным деревом Меркла часто называют доказательством Меркла.