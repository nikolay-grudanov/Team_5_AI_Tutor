---
source_image: page_408.png
page_number: 408
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 21.29
tokens: 7285
characters: 1128
timestamp: 2025-12-24T08:41:33.031084
finish_reason: stop
---

программы. Затем верхний элемент на стеке, сценарий свидетеля, сверяется с программой свидетеля в выходе (рис. 10.25).

![Проверка поля witness из платежа p2wsh](https://i.imgur.com/3Q5z5QG.png)

Рис. 10.25. Проверка поля witness из платежа p2wsh

Перед выполнением с тремя элементами на стеке сценарий свидетеля хешируется и сравнивается с программой свидетеля в расходуемом выходе. Этот процесс напоминает процесс проверки платежа p2sh.

Майнеры и полные узлы, проверяющие блоки, обрабатывают все segwit-транзакции одинаково, поэтому включение этой транзакции в блок ничем не отличается от включения транзакции p2wpkh.

Новый метод хеширования подписей

Одна из проблем, которую решает segwit, — неэффективное хеширование подписей. Как объясняется в разделе «Неэффективная проверка подписи», если количество входов удваивается, время, необходимое для проверки транзакции, увеличивается примерно в четыре раза. Это объясняется тем, что:

★ удваивается количество проверяемых подписей;
★ удваивается размер транзакции.

BIP143
Это решение описывается в BIP143, «Transaction Signature Verification for Version 0 Witness Program».