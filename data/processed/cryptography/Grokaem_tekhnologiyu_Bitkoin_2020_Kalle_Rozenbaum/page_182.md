---
source_image: page_182.png
page_number: 182
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.22
tokens: 7500
characters: 1912
timestamp: 2025-12-24T08:35:40.654164
finish_reason: stop
---

на рис. 5.19, в выход транзакции пожертвования. Это влечет за собой несколько проблем:

★ Кошелек сотрудника может выполнять только платежи p2pkh. Его нужно модифицировать, чтобы он мог обрабатывать выходы с несколькими подписями и включать пользовательский интерфейс, чтобы сделать этот вид платежей понятным для пользователей.

★ Обычно отправителю не обязательно знать, как защищены деньги получателя. Ему все равно, какого вида платеж он выполняет — с несколькими подписями, p2pkh или какой-то другой. Он просто хочет перевести средства.

★ Часто за обработку транзакции взимается комиссия (подробнее об этом рассказывается в главе 7). Сумма комиссии обычно зависит от размера транзакции в байтах. Большой сценарий открытого ключа увеличивает сумму комиссии, которую должен заплатить отправитель. Это несправедливо, потому что такую необычную и дорогостоящую функцию хотел использовать получатель. Получатель, а не отправитель, должен платить за эту роскошь.

Вы можете исправить эту несправедливость, немного изменив порядок работы программы. Некоторые разработчики из числа сотрудников придумали нечто, получившее название платеж на хеш сценария (pay-to-script-hash, p2sh).

Платеж на хеш сценария

Мы уже знаем, как платеж вида p2pkh скрывает открытый ключ от отправителя за счет передачи ему хеша открытого ключа для оплаты вместо самого открытого ключа.

Разновидность p2sh развивает эту идею еще дальше — она скрывает программу. Вместо большого и сложного сценария открытого ключа получатель передает отправителю только хеш этого сценария. Затем отправитель осуществляет платеж на этот хеш и оставляет за получателем возможность представить сценарий позже, когда получатель захочет потратить деньги.

Снова предположим, что Фаиза, Элен и Джон решили собрать деньги на благотворительность и хотят защитить их множественной подписью (рис. 5.22).

BIP16
Этот вид платежа был предложен в 2012 году в BIP16.