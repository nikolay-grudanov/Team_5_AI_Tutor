---
source_image: page_131.png
page_number: 131
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.33
tokens: 7461
characters: 1660
timestamp: 2025-12-24T08:34:18.353431
finish_reason: stop
---

1. Желаемый индекс добавляется в конец родительского открытого ключа.

2. Открытый ключ с индексом подаются на вход HMAC-SHA512. Родительский цепной код выступает в роли источника энтропии для хеш-функции. Для простоты можно считать, что все три элемента данных хешируются вместе.

3. 512-битный хеш разбивается пополам:

• левые 256 бит складываются обычным образом (по модулю \(2^{256}\)) с родительским закрытым ключом, и сумма становится дочерним закрытым ключом;
• правые 256 бит становятся дочерним цепным кодом.

4. Дочерний закрытый ключ и цепной код вместе образуют дочерний xprv.

Этот процесс используется для создания всех дочерних и внучатых xprv, пока не будут получены все ключи, которые Рита хотела бы хранить в своем кошельке.

Вы можете спросить, зачем нужна эта операция сложения — почему бы просто не использовать оставшиеся 256 бит в качестве дочернего закрытого ключа? 512-битный хеш рассчитывается на основе открытого ключа с цепным кодом, которые вместе называются расширенным открытым ключом (extended public key, xpub), и индекса. Далее вы увидите, как использовать xpub в слабо защищенных окружениях, таких как веб-серверы, для создания соответствующего дерева открытых ключей. Сложение родительского закрытого ключа с левыми 256 битами необходимо, чтобы никто не смог сгенерировать дочерние закрытые ключи по имеющемуся xpub.

На чем мы остановились?

Давайте вспомним, почему мы здесь оказались: чтобы создать приложение кошелька, которое облегчит жизнь конечным пользователям (рис. 4.13).

Основные задачи кошелька:
★ управление закрытыми ключами;
★ создание новых адресов;
★ отправка реквизитов платежа от получателя плательщику;