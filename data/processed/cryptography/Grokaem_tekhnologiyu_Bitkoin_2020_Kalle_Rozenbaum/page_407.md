---
source_image: page_407.png
page_number: 407
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 24.34
tokens: 7329
characters: 1173
timestamp: 2025-12-24T08:41:35.913149
finish_reason: stop
---

Обратите внимание, что в сценарии подписи ничего нет. Когда мы использовали платежи p2sh в разделе «Платеж на хеш сценария» главы 5, сценарий подписи получился по-настоящему большим, потому что включал две подписи и сценарий погашения, который, в свою очередь, включал три открытых ключа. С внедрением решения segwit все данные теперь содержатся в свидетеле.

Проверка входа p2wsh

Чтобы проверить эту транзакцию, полный узел должен определить тип расходуемого выхода (рис. 10.24). Он просматривает выход, находит шаблон <байт версии> <от 2 до 40 байт данных> и приходит к выводу, что это segwit-выход. Следующее, что нужно проверить, — значение байта версии.

Байт версии содержит 00. Версия 00 segwit-выхода может иметь программу свидетеля длиной 20 или 32 байта. Первая, как мы узнали в предыдущих разделах, выполняет платеж p2wpkh. В этом примере программа свидетеля имеет длину 32 байта, то есть это выход p2wsh.

![Подготовка к проверке входа p2wsh](https://i.imgur.com/3Q5z5QG.png)

Рис. 10.24. Подготовка к проверке входа p2wsh

Когда расходуется выход p2wsh, применяются особые правила. Сначала элементы данных из поля witness расходующего входа помещаются на стек