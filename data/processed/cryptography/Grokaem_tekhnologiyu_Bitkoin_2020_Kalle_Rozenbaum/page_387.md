---
source_image: page_387.png
page_number: 387
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.72
tokens: 7390
characters: 1519
timestamp: 2025-12-24T08:40:56.509948
finish_reason: stop
---

Как говорилось в разделе «Подписывание транзакции» в главе 5, перед подписанием удаляются все сценарии подписи. Но если сделать только это, все подписи в транзакции будут использовать один и тот же хеш. Если транзакция использует два разных выхода и переводит средства на один и тот же адрес, подпись из одного входа можно будет повторно использовать во втором. Этой особенностью может воспользоваться злоумышленник.

Чтобы избежать этой проблемы, Биткоин заставляет каждую подпись удостоверять немного отличающуюся версию транзакции, которая получается копированием сценария открытого ключа из расходуемого выхода в сценарий подписи подписываемого входа.

ПОЧЕМУ БЫ НЕ ИСПОЛЬЗОВАТЬ ФИКТИВНЫЙ БАЙТ?

Копирование сценария открытого ключа в сценарий подписи выглядит слишком сложно. Проще добавить в сценарий подписи один фиктивный байт, чтобы исключить возможность повторного использования подписи. В действительностии никто не знает, почему для этого используется именно сценарий открытого ключа.

Давайте рассмотрим поближе происходящее. Предположим, вы хотите подписать транзакцию с двумя входами. Первый подписан, как показано на рис. 10.5.

Перед подписанием вставляется сценарий открытого ключа из расходуемого выхода

Подписывается этот вход
Остальные сценарии подписи остаются пустыми

Рис. 10.5. Подписание первого входа. Сценарий открытого ключа копируется в сценарий подписи

Сценарии подписей во всех входах пустые, но вы копируете сценарий открытого ключа расходуемого выхода в сценарий подписи расходующего