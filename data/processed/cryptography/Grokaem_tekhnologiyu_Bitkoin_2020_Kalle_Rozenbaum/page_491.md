---
source_image: page_491.png
page_number: 491
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 18.61
tokens: 7632
characters: 2154
timestamp: 2025-12-24T08:43:59.445862
finish_reason: stop
---

10.3. С удвоением числа входов время проверки старых транзакций увеличивается в четыре раза. Это объясняется следующими причинами:

• требуется проверить в два раза больше подписей;

• на проверку каждой подписи требуется в два раза больше времени из-за удвоения размеров транзакции.

10.4. Чтобы убедиться, что транзакция включена в блок, легкий кошелек должен рассчитать идентификатор транзакции, а для этого кошельку нужны подписи, потому что они включаются в идентификатор.

10.5. Новое поведение OP_NOP5 в случае успеха должно точно соответствовать старому поведению OP_NOP5. То есть в случае успеха оно не должно влиять на стек.

10.6. Segwit-адресами являются a (p2wpkh) и c (p2wsh). d — это адрес p2sh, он может содержать в сценарии погашения вложенный платеж p2wpkh или p2wsh, но мы не можем утверждать этого. Единственное, что можно сказать наверняка, — это адрес p2sh, а не segwit-адрес.

10.7. Версия свидетеля используется для облегчения будущих обновлений. Здесь действует простое правило: неизвестные версии свидетелей принимаются. При развертывании новой версии свидетеля старые узлы будут принимать любой платеж, который расходит выход с этой новой версией свидетеля. Это позволяет избежать расщепления блокчейна на новые и старые узлы.

10.8. Все данные, имеющиеся в сценарии подписи, помещаются на стек. В данном случае в сценарии подписи таких элементов нет, поэтому он ничего не делает. Затем на стек будет помещен байт 00, а затем с805...c8a8. Программа на языке Script завершится, и узел проверит верхний элемент в стеке. Он не равен нулю, а значит, транзакция будет признана действительной.

10.9. Новый узел заметит, что выход соответствует шаблону segwit. Он также заметит, что версия свидетеля — 00, а программа свидетеля имеет длину 20 байт. То есть это выход p2wpkh. Чтобы потратить такой выход, сценарий подписи должен быть пустым, а свидетель должен содержать подпись и открытый ключ, соответствующий программе свидетеля РКН_y. Шаблон p2wpkh заполняется с использованием подписи и открытого ключа из поля свидетеля и РКН из сценария открытого ключа (программа свидетеля). Заполненный шаблон затем обрабатывается как обычно.