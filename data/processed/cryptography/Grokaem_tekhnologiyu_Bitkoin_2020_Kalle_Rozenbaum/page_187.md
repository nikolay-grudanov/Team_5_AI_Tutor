---
source_image: page_187.png
page_number: 187
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 43.17
tokens: 7592
characters: 1827
timestamp: 2025-12-24T08:35:53.376467
finish_reason: stop
---

02b0c907f0876485798fc1a8e15e9ddabae0858b49236ab3b1330f2cbadf854ee8
3
OP_CHECKMULTISIG

Теперь они хотят, чтобы люди проводили платежи на хеш SHA256+RIPEMD160 этого сценария:

04e214163b3b927c3d2058171dd66ff6780f8708

Как Фаизе, Элен и Джону все организовать? Что они должны напечатать на листовках, чтобы коллеги могли перевести благотворительные взносы на хеш сценария? Давайте рассмотрим несколько доступных вариантов:

★ Напечатать хеш сценария как есть и сообщить коллегам, что это хеш сценария погашения. В этом случае велик риск допустить опечатку, так же как в случае с платежами на обычные РКН, которые обсуждались в главе 3.

★ Вычислить хеш base58check сценария, как в главе 3, и получить адрес вида 1SpXyW...RMmEMZ. Этот адрес можно напечатать на листовках, раздать коллегам и сообщить, что они должны выполнить платеж типа p2sh вместо обычного p2pkh.

В обоих случаях, если благотворитель ошибочно выполнит платеж типа p2pkh, используя напечатанный хеш или адрес, никто не сможет потратить деньги, потому что этому ложному РКН не соответствует ни один закрытый ключ.

Эти два варианта не выглядят ни безопасными, ни практичными. Поэтому познакомимся с новым форматом адресов для p2sh, адресом p2sh (рис. 5.26). Этот формат похож на обычные адреса p2pkh. Он использует схему кодирования base58check, как и обычные адреса.

Эта процедура почти в точности повторяет процедуру создания адресов p2pkh. Единственное отличие в номере версии — 05 вместо 00. В результате получается адрес, начинающийся с 3 вместо 1.

Из-за этого изменения и особенности работы алгоритма base58, связанной с использованием целочисленного деления на 58, последний остаток всегда будет равен 2. Если вам интересно, на рис. 5.27 подробно показано, как кодируется хеш сценария погашения Фаизы, Элен и Джона с номером версии и контрольной суммой.