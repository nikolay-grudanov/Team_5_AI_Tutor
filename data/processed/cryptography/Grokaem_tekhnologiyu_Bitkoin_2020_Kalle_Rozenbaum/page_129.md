---
source_image: page_129.png
page_number: 129
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.72
tokens: 7364
characters: 1332
timestamp: 2025-12-24T08:34:03.560161
finish_reason: stop
---

Создание главного расширенного закрытого ключа

Давайте посмотрим, как создается главный xprv (рис. 4.11).

![Схема создания главного xprv](https://i.imgur.com/3Q5z5QG.png)

Рис. 4.11. Создание главного xprv Риты. Начальное случайное число хешируется с использованием алгоритма HMAC-SHA512. Получившийся 512-битный хеш разбивается на левые 256 бит, которые превращаются в главный закрытый ключ, и правые 256 бит, которые превращаются в цепной код

Чтобы создать главный закрытый ключ, начальное число хешируется с использованием алгоритма HMAC-SHA512 (HMAC — сокращенно Hash Based Message Authentication Code, хеш-код аутентификации сообщений), которое генерирует 512-битный хеш. HMAC-SHA512 — это специальная криптографическая хеш-функция, которая помимо входного числа принимает дополнительный ключ. С точки зрения пользователя алгоритм HMAC-SHA512 можно считать обычной криптографической хеш-функцией, но с несколькими входами. Значение хеш-функции делится на левые и правые 256 бит. Левые 256 бит становятся главным закрытым ключом, который является самым обычным закрытым ключом; он называется главным, потому что все остальные закрытые ключи получаются из этого единственного закрытого ключа (и цепного кода). Правые 256 бит становятся цепным кодом, который используется на следующем шаге для получения потомков главного xprv.