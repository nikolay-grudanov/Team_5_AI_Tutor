---
source_image: page_440.png
page_number: 440
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.42
tokens: 7503
characters: 1730
timestamp: 2025-12-24T08:42:32.602090
finish_reason: stop
---

Если ваша транзакция попадет как к новому, так и к старому майнеру, она, скорее всего, будет помещена в обе ветви блокчейна. А это для вас нежелательно. Ваша транзакция была повторена в ветви Bitcoin New (рис. 11.14).

Защита от повторения

Для защиты пользователей от повторения транзакций во время расщепления блокчейна из-за хард-форка можно изменить формат транзакций в новой цепочке так, чтобы транзакция была действительно только в одной ветви.

Когда происходило отделение криптовалюты Bitcoin Cash в отдельную цепочку, разработчики позаботились о том, чтобы старые транзакции считались недействительными на новых узлах, а новые транзакции — недействительными на старых (рис. 11.15).

![С защитой от повторения транзакция считается действительно только в одной из ветвей](https://i.imgur.com/3Q5z5QG.png)

Рис. 11.15. С защитой от повторения транзакция считается действительно только в одной из ветвей

Для этого в подписях транзакций в новой ветви должен использоваться новый SIGHASH-тип — FORKID. Этот тип не делает ничего, но из-за него транзакция будет считаться недействительной в старой и действительноной в новой цепочке. Если транзакция не использует тип FORKID, она будет считаться действительноной в старой и недействительной в новой цепочке.

Конечно, использование нового SIGHASH-типа для подписей — не единственный способ защититься от повторения. Тот же эффект могут дать любые изменения, делающие транзакции действительноными только в одной цепочке. Например, можно потребовать, чтобы новые транзакции вычитали 1 из идентификатора входной транзакции. Предположим, что UTXO содержит идентификатор транзакции, выход которой вы хотите потратить:

6bde18fff1a6d465de1e88b3e84edfe8db7daa1b1f7b8443965f389d8decac08