---
source_image: page_365.png
page_number: 365
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.59
tokens: 7583
characters: 2009
timestamp: 2025-12-24T08:40:28.215261
finish_reason: stop
---

а значит, Фатима не получит S. Без S она не сможет потратить выход контрактной транзакции Джона. Единственный возможный исход: Джон вынужден будет подождать 48 часов, пока закончится относительная временная блокировка, после чего сможет вернуть свои деньги.

★ Джон не потратил контрактную транзакцию Фатимы в течение 24 часов. Фатима может вернуть свои монеты, а Джону придется подождать еще 24 часа, после чего он тоже сможет вернуть свои монеты.

★ Джон потратил контрактную транзакцию Фатимы сразу после того, как прошло 24 часа, но до того, как Фатима успела забрать свои монеты. К счастью, выход контрактной транзакции Джона имеет 48-часовой период блокировки, против 24 часов в выходе контрактной транзакции Фатимы, поэтому Джон не сможет вернуть свои монеты, пока не пройдут еще 24 часа. В течение этого времени Фатима может потребовать свои 2 BTC из выхода контрактной транзакции Джона, используя S и свою подпись.

★ Фатима попадает под автобус сразу после отправки своей контрактной транзакции. Это плохо. Джон сможет забрать свои NMC из выхода контрактной транзакции Фатимы, а затем подождать 48 часов и вернуть свои BTC. Фатима оказывается в проигрыше.

В последнем случае можно утверждать, что обмен оказался неатомарным. В конце концов, обмен как таковой не состоялся — Джон забрал себе все монеты. Впрочем, это уже в большей степени философский вопрос. Но мы можем считать обмены атомарными при условии, что Фатима способна активно действовать. Однако это условие не предъявляется Джону. Все дело в том, кто создает секретное число S.

Сохранение данных в блокчейне Биткоин

Уже в первые дни существования Биткоин стало ясно, что люди не прочь сохранять в блокчейне вместе с транзакциями некоторые данные, не имеющие никакого отношения к самой системе Биткоин. Например, взгляните на листинг 9.1, который является посвящением криптографу Лену Сассаману (Sassaman), автором которого предположительно является Дэн Камински (Dan Kaminsky). (Сообщение приводится в три столбца для экономии места.)