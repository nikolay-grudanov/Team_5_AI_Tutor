---
source_image: page_223.png
page_number: 223
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 40.18
tokens: 7957
characters: 2909
timestamp: 2025-12-24T09:16:29.429663
finish_reason: stop
---

RSA – это прежде всего арифметический трюк. В основе ее работы лежит математический объект, называемый перестановкой с потайным входом (trapdoor permutation), — функция, которая преобразует число x в число y в том же диапазоне, так что вычислить y по x легко, зная открытый ключ, но вычислить x по y практически невозможно, если не знать закрытого ключа — потайного входа. (Можете считать, что x — открытый текст, а y — шифртекст.)

Кроме шифрования, RSA используется для создания цифровых подписей, когда только владелец закрытого ключа может подписать сообщение, а наличие открытого ключа позволяет любому желающему проверить достоверность подписи.

В этой главе я объясню, как работает перестановка с потайным входом в RSA, разберу, как безопасность RSA связана с задачей факторизации (см. главу 9), и расскажу, почему одной лишь перестановки с потайным входом недостаточно для построения безопасных шифрования и цифровой подписи. Я также рассмотрю способы реализации RSA и продемонстрирую атаки на нее.

Начнем с математических понятий, лежащих в основе RSA.

Математические основания RSA

Алгоритм RSA видит сообщение как большое число, а само шифрование заключается, по существу, в умножении больших чисел. Поэтому, чтобы понять, как работает система RSA, нужно знать, какого рода большими числами она манипулирует и как устроено умножение этих чисел.

RSA видит зашифровываемый открытый текст как положительное целое число от 1 до n − 1, где n — большое число, называемое модулем. При перемножении таких чисел получается третье число, удовлетворяющее тем же условиям. Мы говорим, что эти числа образуют группу, обозначаемую \( \mathbb{Z}_n^* \) и называемую мультипликативной группой целых чисел по модулю n. (Математическое определение группы см. в разделе «Что такое группа?» главы 9.)

Например, рассмотрим группу \( \mathbb{Z}_4^* \) целых чисел по модулю 4. Напомним, что группа должна содержать единичный элемент (т. е. 1) и что у каждого элемента группы должен быть обратный — число y, такое что \( x \times y = 1 \). Как найти множество, образующее \( \mathbb{Z}_4^* \)? Исходя из наших определений, мы знаем, что 0 не принадлежит группе \( \mathbb{Z}_4^* \), потому что умножение любого числа на 0 не может дать 1, так что у 0 не было бы обратного элемента. С другой стороны, число 1 принадлежит \( \mathbb{Z}_4^* \), поскольку \( 1 \times 1 = 1 \), так что 1 обратна самой себе. Однако число 2 этой группе не принадлежит, т. к. невозможно получить 1, умножая любой элемент \( \mathbb{Z}_4^* \) на 2 (причина в том, что 2 и 4 — не взаимно простые числа, поскольку у них есть общий множитель 2). Число 3 принадлежит группе элементов \( \mathbb{Z}_4^* \), потому что оно обратно самому себе. Таким образом, элемент \( \mathbb{Z}_4^* = \{1, 3\} \).

Теперь рассмотрим \( \mathbb{Z}_5^* \), мультипликативную группу целых чисел по модулю 5. Из каких чисел она состоит? Число 5 простое, и все числа