---
source_image: page_178.png
page_number: 178
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.77
tokens: 7705
characters: 2185
timestamp: 2025-12-24T09:14:56.650777
finish_reason: stop
---

вания. Хеш-таблицы — это структуры данных, применяемые в языках программирования для эффективного хранения элементов. До появления SipHash хеш-таблицы полагались на некриптографические хеш-функции с ключом, для которых было легко найти коллизии, а значит, эксплуатировать удаленную систему, замедлив доступ к хеш-таблице и тем самым реализовав DoS-атаку. Мы установили, что использование PRF решило бы эту проблему, и начали проектировать псевдослучайную функцию SipHash, подходящую для хеш-таблиц. Поскольку хеш-таблицы обрабатывают в основном короткие данные, SipHash оптимизирована для коротких сообщений. Однако SipHash можно использовать не только для хеш-таблиц, это полноценная PRF и MAC, достоинства которой в полной мере раскрываются в ситуациях, когда входные данные преимущественно короткие.

Как работает SipHash

В SipHash применяется трюк, благодаря которому она оказывается более безопасной, чем простые функции губки: вместо того чтобы применять к блокам XOR только один раз перед перестановкой, SipHash применяет XOR до и после перестановки, как показано на рис. 7.5. 128-битовый ключ SipHash рассматривается как два 64-битовых слова, \( K_1 \) и \( K_2 \), которые с помощью XOR объединяются в 256-битовое фиксированное начальное состояние, рассматриваемое как четыре 64-битовых слова. Затем ключи отбрасываются, и вычисление SipHash сводится к итеративному выполнению базовой функции SipRound с последующим применением XOR к блокам сообщения с целью модификации четырехсловного внутреннего состояния. Наконец, SipHash возвращает 64-битовый жетон, объединяя четыре слова состояния с помощью XOR.

![Обработка 15-байтового сообщения в алгоритме SipHash-2-4](https://i.imgur.com/3Q5z5QG.png)

Рис. 7.5. Обработка 15-байтового сообщения в алгоритме SipHash-2-4 (блок \( M_1 \) длиной 8 байт и блок \( M_2 \) длиной 7 байт плюс 1 байт дополнения)

Функция SipRound сочетает операции XOR со сложениями и циклическими сдвигами слова, чтобы добиться безопасности. Она преобразует состояние — четыре 64-битовых слова (\( a, b, c, d \)), — выполняя следующие операции в порядке сверху вниз. Операции в левом и правом столбцах независимы, поэтому могут выполняться параллельно.