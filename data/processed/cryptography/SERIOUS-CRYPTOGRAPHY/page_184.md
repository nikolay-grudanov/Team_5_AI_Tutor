---
source_image: page_184.png
page_number: 184
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.00
tokens: 7614
characters: 1669
timestamp: 2025-12-24T09:15:11.759652
finish_reason: stop
---

рах, порождающих как шифртекст, так и аутентификационный жетон. Затем мы рассмотрим четыре важных шифра с аутентификацией: три построения на основе блочных шифров с упором на популярный шифр AES в режиме счетчика с аутентификацией Галуа (AES-GCM) и один шифр, в котором используется только алгоритм перестановки.

Шифрование с аутентификацией с использованием МАС

Как показано на рис. 8.1, МАС и шифры можно сочетать одним из трех способов: шифрование-и-МАС, МАС-затем-шифрование и шифрование-затем-МАС.

![Комбинации шифра и МАС](https://i.imgur.com/3Q5z5QG.png)

Рис. 8.1. Комбинации шифра и МАС

Эти три комбинации различаются порядком применения шифрования и генерирования аутентификационного жетона. Но выбор конкретного алгоритма МАС или шифра не играет роли, при условии что каждый безопасен и ключи МАС и шифра различны.

По рис. 8.1 видно, что в схеме шифрование-и-МАС открытый текст зашифровывается и аутентификационный жетон генерируется по открытому тексту, так что обе операции (шифрование и аутентификация) не зависят друг от друга и могут вычисляться параллельно. В схеме МАС-затем-шифрование сначала генерируется жетон по открытому тексту, а затем открытый текст и МАС зашифровываются совместно. Наоборот, в схеме шифрование-затем-МАС сначала зашифровывается открытый текст, а затем по шифртексту генерируется жетон.

Потребление ресурсов во всех трех подходах приблизительно одинаково. Поговорим о том, какой из них наиболее безопасен.

Шифрование-и-МАС

В схеме шифрование-и-МАС шифртекст и МАС-жетон вычисляются по отдельности. Зная открытый текст (P), отправитель вычисляет шифртекст C = E(K_1, P), где E – алгоритм шифрования, а C – результирующий