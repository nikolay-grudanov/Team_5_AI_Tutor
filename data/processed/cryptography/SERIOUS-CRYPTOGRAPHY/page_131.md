---
source_image: page_131.png
page_number: 131
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.14
tokens: 7593
characters: 1493
timestamp: 2025-12-24T09:13:33.764604
finish_reason: stop
---

от 1 до 31 (для 32-битовых слов). Например, <<< 8 сдвигает биты слова на восемь позиций влево, как показано в следующих примерах:

\[
0x01234567 <<< 8 = 0x23456701;
0x01234567 <<< 16 = 0x45670123;
0x01234567 <<< 22 = 0x59c048d1.
\]

**Преобразование 512-битового состояния в Salsa20**

Базовая перестановка в Salsa20 преобразует 512-битовое внутреннее состояние, рассматриваемое как массив 32-битовых слов 4×4. На рис. 5.11 показано начальное состояние, состоящее из восьми слов ключа (256 бит), двух слов одноразового числа (64 бита), двух слов счетчика (64 бита) и четырех фиксированных слов (128 бит), одинаковых для любого акта шифрования и дешифрирования и для всех блоков.

Для преобразования начального 512-битового состояния Salsa20 сначала применяет преобразование QR ко всем четырем столбцам независимо (так называемый столбцовый раунд), а затем ко всем четырем строкам независимо (строковый раунд), как показано на рис. 5.12. Последовательность, состоящая из столбцового и строкового раундов, называется двойным раундом. Salsa20 выполняет 10 двойных раундов, т. е. всего 20 раундов, что объясняет появление числа 20 в названии Salsa20.

![Инициализация состояния Salsa20](https://i.imgur.com/1234567.png)
Рис. 5.11. Инициализация состояния Salsa20

![Столбцы и строки, преобразуемые функцией quarterround (QR)](https://i.imgur.com/8901234.png)
Рис. 5.12. Столбцы и строки, преобразуемые функцией quarterround (QR)

В столбцовом раунде четыре столбца преобразуются следующим образом: