---
source_image: page_145.png
page_number: 145
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.43
tokens: 7907
characters: 2570
timestamp: 2025-12-24T09:14:07.438208
finish_reason: stop
---

Для сравнения: в случае поиска прообраза N сообщений дают только N потенциальных прообразов, тогда как те же N сообщений дают приблизительно \(N^2\) потенциальных коллизий. Поэтому мы говорим, что шансов найти решение квадратично больше. А сложность поиска, в свою очередь, оказывается квадратично меньше: чтобы найти коллизию, количество сообщений должно быть равно квадратному корню из \(2^n\), т. е. \(2^{n/2}\).

Наивная атака на основе парадокса дней рождения

Вот простейший способ провести атаку на основе парадокса дней рождения для нахождения коллизий.

1. Вычислить \(2^{n/2}\) хешей \(2^{n/2}\) произвольно выбранных сообщений и сохранить все пары (сообщение, хеш) в списке.
2. Отсортировать список по хеш-значению, так чтобы одинаковые хеш-значения оказались рядом.
3. Поискать в отсортированном списке два соседних элемента с одинаковым хеш-значением.

К сожалению, этот метод требует очень много памяти (для хранения \(2^{n/2}\) пар сообщение–хеш), а сортировка такого большого списка замедляет поиск, поскольку требует в среднем \(n2^n\) операций даже при использовании алгоритма быстрой сортировки.

Поиск коллизий с низким потреблением памяти: ро-метод

Ро-метод — это алгоритм нахождения коллизий, который, в отличие от наивной атаки на основе парадокса дней рождения, требует небольшого объема памяти. Он работает следующим образом.

1. Для данной функции хеширования, порождающей n-битовые хеш-значения, выбрать случайным образом хеш-значение (\(H_1\)) и положить \(H_1 = H'_1\).
2. Вычислить \(H_2 = \text{Hash}(H_1)\) и \(H'_2 = \text{Hash}(\text{Hash}(H'_1))\); т. е. в первом случае мы применяем хеш-функцию один раз, а во втором дважды.
3. Повторяя этот процесс, вычислять \(H_{i+1} = \text{Hash}(H_i)\), \(H'_{i+1} = \text{Hash}(\text{Hash}(H'_i))\), пока не найдется такое i, что \(H_{i+1} = H'_{i+1}\).

Рисунок 6.3 помогает наглядно представить эту атаку. Стрелка, ведущая, например, из \(H_1\) в \(H_2\), означает, что \(H_2 = \text{Hash}(H_1)\). Заметим, что последовательность \(H_i\) рано или поздно зациклывается, напоминая по форме греческую букву ро (ρ). Цикл начинается в \(H_5\) и характеризуется коллизией \(\text{Hash}(H_4) = \text{Hash}(H_{10}) = H_5\). Ключевое наблюдение состоит в том, что для нахождения коллизии достаточно просто найти такой цикл. Описанный алгоритм позволяет противнику обнаружить цикл и, следовательно, найти коллизию.

Передовые методы поиска коллизий сначала находят начало цикла, а затем коллизию, не требуя хранить многочисленные значения в памяти и сортировать длинный список. Ро-метод для достижения