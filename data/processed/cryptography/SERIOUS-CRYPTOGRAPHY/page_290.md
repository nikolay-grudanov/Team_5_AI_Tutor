---
source_image: page_290.png
page_number: 290
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.63
tokens: 7797
characters: 2465
timestamp: 2025-12-24T09:18:33.009296
finish_reason: stop
---

Я разберу три из них: защиту от понижения версии, квитирование с одним периодом кругового обращения и возобновление сеанса.

Защита от понижения версии

В TLS 1.3 защита от понижения версии предназначена для противостояния атакам, при которых противник вынуждает клиента и сервер использовать более слабую версию TLS, чем 1.3. Чтобы организовать такую атаку, противник перехватывает и модифицирует сообщение ClientHello, сообщая серверу, что клиент не поддерживает TLS 1.3. Теперь противник может эксплуатировать уязвимости в прежних версиях TLS.

Пытаясь защититься от атак с понижением версии, сервер TLS 1.3 использует три типа паттернов в 32-байтовом случайном значении, отправляемом в сообщении ServerHello, чтобы идентифицировать тип запрошенного соединения. Паттерн должен соответствовать запросу клиентом конкретного типа TLS-соединения. Получив неверный паттерн, клиент понимает, что что-то пошло не так.

А именно если клиент запрашивает соединение с версией TLS 1.2, то первые восемь из 32 байт равны 44 4F 57 4E 47 52 44 01, а если он запрашивает соединение с версией TLS 1.1, то они равны 44 4F 57 4E 47 52 44 00. Если же клиент запрашивает соединение с версией TLS 1.3, то эти восемь байт должны быть случайными. Например, если клиент отправил сообщение ClientHello с запросом TLS 1.3, но противник модифицировал его, запросив TLS 1.1, то, получив в ответ сообщение ServerHello, клиент увидит неправильный паттерн и будет знать, что сообщение ClientHello было модифицировано. (Противник не может по своему усмотрению модифицировать случайное 32-байтовое значение, выбранное сервером, потому что оно криптографически подписано.)

Квитирование с одним периодом кругового обращения

В типичной процедуре квитирования TLS 1.2 клиент отправляет какие-то данные серверу, ждет ответа, затем отправляет еще данные, снова ждет ответа и только потом начинает отправлять зашифрованные сообщения. Задержка составляет два периода кругового обращения (round-trip time – RTT). Что же касается TLS 1.3, то период кругового обращения только один, как показано на рис. 13.1. Сэкономить удастся сотни миллисекунд. На первый взгляд, мало, но если вспомнить, что серверы популярных служб обрабатывают тысячи соединений в секунду, то набегает вполне прилично.

Возобновление сеанса

TLS 1.3 работает быстрее, чем 1.2, но его можно сделать еще быстрее (на несколько сотен миллисекунд), полностью исключив периоды кругового обращения, предшествующие зашифрованной части сеан-