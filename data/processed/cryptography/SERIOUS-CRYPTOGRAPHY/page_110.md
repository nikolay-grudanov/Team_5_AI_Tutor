---
source_image: page_110.png
page_number: 110
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 40.05
tokens: 7803
characters: 2395
timestamp: 2025-12-24T09:13:07.613451
finish_reason: stop
---

проектировать безопасные потоковые шифры, и доверяем им защищать такие вещи, как подключения по Bluetooth, мобильную связь в системах 4G, TLS-соединения и многое другое.

В этой главе мы сначала опишем, как работают потоковые шифры, и обсудим два основных класса таких шифров: с хранимым состоянием и на основе счетчика. Затем мы изучим аппаратные и программные потоковые шифры и рассмотрим некоторые небезопасные шифры (например, A5/1 в стандарте мобильной связи GSM и RC4 в TLS) и некоторые современные безопасные шифры (например, Grain-128a для применения в оборудовании и Salsa20 для применения в программах).

Как работают потоковые шифры

Потоковые шифры ближе к детерминированным генераторам случайных битов (DRBG), чем к полноценным генераторам псевдослучайных чисел (PRNG), потому что, как и DRBG, они детерминированы. Детерминированность потоковых шифров позволяет осуществлять дешифрирование путем повторного генерирования тех же случайных битов, которые использовались при шифровании. PRNG позволил бы зашифровать сообщение, но не позволил бы дешифрировать его — это безопасно, но и бесполезно.

От DRBG потоковые шифры отличаются тем, что DRBG принимает одно входное значение, тогда как потоковые шифры — два: ключ и одноразовое число (nonce). Ключ должен быть секретным и обычно состоит из 128 или 256 бит. Одноразовое число может быть несекретным, но должно быть уникально для каждого ключа, обычно его длина варьируется от 64 до 128 бит.

Потоковые шифры порождают псевдослучайный поток битов, называемый ключевым потоком, или гаммой. Гамма объединяется с открытым текстом операцией XOR для шифрования, а затем та же самая гамма применяется к шифртексту для дешифрирования. На рис. 5.1 показана базовая операция шифрования в потоковом шифре, где SC — алгоритм шифра, KS — гамма, P — открытый текст, C — шифртекст.

![Рис. 5.1. Потоковый шифр производит шифрование, принимая ключ K и открытое одноразовое число N](https://i.imgur.com/3Q5z5QG.png)

Потоковый шифр вычисляет \( KS = SC(K, N) \), зашифровывает открытый текст операцией \( C = P \oplus KS \) и дешифрирует шифртекст операцией \( P = C \oplus KS \). Функции шифрования и дешифрирования одинаковы, потому что делают одно и то же: вычисляют XOR битов и гаммы. Именно поэтому в некоторых криптографических библиотеках имеется единственная функция ensgurt, которая применяется как для шифрования, так и для дешифрирования.