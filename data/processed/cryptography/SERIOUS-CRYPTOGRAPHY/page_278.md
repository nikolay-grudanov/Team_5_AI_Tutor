---
source_image: page_278.png
page_number: 278
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.59
tokens: 7829
characters: 2513
timestamp: 2025-12-24T09:18:07.196838
finish_reason: stop
---

с другим коэффициентом \( b \). Это означает, что ECDH можно взломать, как описано в следующем сценарии, называемом атакой с неправильной кривой.

Предположим, что Алиса и Боб выполняют протокол ECDH и согласовали кривую и базовую точку \( G \). Боб отправляет свой открытый ключ \( d_B G \) Алисе. Алиса, вместо того чтобы отправить открытый ключ \( d_A G \) в соответствии с ранее согласованной кривой, отправляет точку на другой кривой, случайно или намеренно. К несчастью, эта кривая слабая, что позволяет Алисе выбрать точку \( P \), для которой решить задачу ECDLP легко. Она выбирает точку низкого порядка, для которой существует сравнительно небольшое \( k \) такое, что \( kP = O \).

Теперь Боб, думая, что располагает настоящим открытым ключом, вычисляет то, что, по его мнению, является разделяемым секретом \( d_B P \), хеширует его и использует получившийся ключ, чтобы зашифровать данные, отправляемые Алисе. Проблема в том, что когда Боб вычисляет \( d_B P \), он, ничего не подозревая, использует более слабую кривую. А в результате, поскольку \( P \) выбрана из малой подгруппы гораздо большей группы точек, \( d_B P \) также будет принадлежать этой малой подгруппе, что позволит противнику, знающему порядок \( P \), эффективно определить разделяемый секрет \( d_B P \).

Предотвратить это можно, проверив, что точки \( P \) и \( Q \) принадлежат правильной кривой, для чего нужно убедиться, что их координаты удовлетворяют ее уравнению. В этом случае мы будем работать только с точками на безопасной кривой и сорвем атаку.

Эта атака с неправильной кривой была найдена в 2015 году для некоторых реализаций протокола TLS, в которых протокол ECDH использовался для выработки сеансовых ключей. (Детали см. в работе Jager, Schwenk, and Somorovsky «Practical Invalid Curve Attacks on TLS-ECDH».)

Для дополнительного чтения

Эллиптическая криптография — увлекательная и сложная тема, требующая привлечения серьезной математики. Я не стал обсуждать такие важные понятия, как порядок точки, кофактор кривой, проективные координаты, точки кручения и методы решения задачи ECDLP. Читатели с математическим складом ума могут найти информацию по этим и другим вопросам в книге Cohen and Frey «Handbook of Elliptic and Hyperelliptic Curve Cryptography» (Chapman and Hall/CRC, 2005). Обзор Bos, Halderman, Heninger, Moore, Naehrig, and Wustrow «Elliptic Curve Cryptography in Practice» 2013 года также содержит хорошее введение с иллюстрациями и практическими примерами (https://eprint.iacr.org/2013/734/).