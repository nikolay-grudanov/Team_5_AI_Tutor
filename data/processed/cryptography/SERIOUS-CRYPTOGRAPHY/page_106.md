---
source_image: page_106.png
page_number: 106
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.52
tokens: 7733
characters: 1904
timestamp: 2025-12-24T09:12:55.864407
finish_reason: stop
---

довательность шифрование–дешифрирование–шифрование применяется вместо тройного шифрования, чтобы системы могли при необходимости эмулировать DES, пользуясь новым интерфейсом 3DES.

![Конструирование блочного шифра 3DES](../images/4.11.png)

Рис. 4.11. Конструирование блочного шифра 3DES

Для чего нужно использовать тройной DES, а не просто два раза DES, т. е. E(K_2, E(K_1, P))? Как выясняется, из-за атаки MitM двойной DES небезопаснее простого. На рис. 4.12 показана атака MitM в действии.

![Атака «встреча посередине»](../images/4.12.png)

Рис. 4.12. Атака «встреча посередине»

Для вскрытия двойного DES атака «встреча посередине» применяется следующим образом:

1. Пусть даны P и C = E(K_2, E(K_1, P)) с двумя неизвестными 56-битовыми ключами K_1 и K_2. (DES принимает 56-битовые ключи, поэтому двойной DES принимает 112 бит ключей.) Построим таблицу ключ-значение, содержащую 2^{56} элементов вида E(K_1, P), где E – функция шифрования DES, а K_1 – хранимое значение.
2. Для всех 2^{56} возможных значений K_2 вычислим D(K_2, C) и проверим, является ли результат одним из индексов таблицы (среднее значение, представленное вопросительным знаком на рис. 4.12).
3. Если среднее значение является индексом таблицы, то мы находим соответствующее ему значение K_1 из таблицы и проверяем, что найденная пара ключей (K_1, K_2) правильная, на других парах P и C. Достаточно зашифровать P ключами K_1 и K_2 и убедиться, что полученный шифртекст совпадает с C.

Этот метод восстанавливает K_1 и K_2 путем выполнения 2^{57}, а не 2^{112} операций: на шаге 1 шифруется 2^{56} блоков, а затем на шаге 2 дешифрируется не более 2^{56} блоков, так что всего получается 2^{56} + 2^{56} = 2^{57} операций. Кроме того, нужно будет хранить 2^{56} элементов по 15 байт каждый, т. е. примерно 1 экзабайт. Это много, но существует трюк, позволяющий провести эту атаку, потребляя пренебрежимо мало памяти (см. главу 6).