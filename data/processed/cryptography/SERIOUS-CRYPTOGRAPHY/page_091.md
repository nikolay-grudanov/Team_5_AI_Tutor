---
source_image: page_091.png
page_number: 91
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.93
tokens: 7488
characters: 1442
timestamp: 2025-12-24T09:12:23.303702
finish_reason: stop
---

На рис. 4.4 показаны все четыре строительных блока, составляющих один раунд AES (заметьте, что все раунды, кроме последнего, являются последовательностями операций SubBytes, ShiftRows, MixColumns и AddRoundKey).

• AddRoundKey. Применяет XOR к ключу раунда и внутреннему состоянию.
• SubBytes. Заменяет каждый байт \((s_0, s_1, ..., s_{15})\) другим байтом согласно S-блоку. В этом пример S-блок представляет собой таблицу перекодировки из 256 элементов.
• ShiftRows. Циклически сдвигает \(i\)-ю строку на \(i\) позиций, где \(i\) изменяется от 0 до 3 (см. рис. 4.5).
• MixColumns. Применяет одно и то же линейное преобразование к каждому из четырех столбцов состояния (т. е. к каждой группе ячеек, окрашенных одним и тем же оттенком серого в левой части рис. 4.5).

Напомним, что в акрониме SPN буква \(S\) означает «подстановка», а буква \(P\) — «перестановка». Здесь подстановочным слоем является SubBytes, а перестановочным — комбинация ShiftRows и MixColumns.

Функция KeyExpansion, показанная на рис. 4.4, — реализация алгоритма развертки ключа в AES. В результате развертки из одного 16-байтового ключа создается 11 ключей раундов \((K_0, K_1, ..., K_{10})\) длиной 16 байт каждый, для чего используется тот же S-блок, что в SubBytes, и комбинация операций XOR. Важное свойство KeyExpansion заключается в том, что если известен любой ключ раунда \(K_i\), то противник может определить ключи всех остальных раундов и главный ключ \(K\).