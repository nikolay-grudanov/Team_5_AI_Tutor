---
source_image: page_061.png
page_number: 61
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.19
tokens: 7746
characters: 2509
timestamp: 2025-12-24T09:11:34.034263
finish_reason: stop
---

**Аппаратный PRNG: RDRAND в микропроцессорах Intel**

Пока что мы обсуждали только программные PRNG, а теперь рассмотрим аппаратный. Цифровой генератор случайных чисел Intel представляет собой аппаратный PRNG, впервые включенный в микроархитектуру Intel Ivy Bridge в 2012 году. Он основан на рекомендациях NIST SP 800-90 и использует шифр Advanced Encryption Standard (AES) в режиме CTR_DRBG. Доступ к PRNG от Intel осуществляется с помощью ассемблерной команды RDRAND, которая предлагает независимый от операционной системы интерфейс, принципиально более быстрый, чем программные PRNG.

Если программные PRNG пытаются получить энтропию из непредсказуемых источников, то у RDRAND имеется единственный источник энтропии, который поставляет поток данных, состоящий из нулей и единиц. В электронике этот источник называется двойной дифференциальной защелкой с обратной связью; по существу, это небольшая схема, которая переключается между двумя состояниями (0 или 1) в зависимости от флуктуаций теплового шума с частотой 800 МГц. Такой источник обычно достаточно надежен.

Команда RDRAND принимает в качестве аргумента 16-, 32- или 64-разрядный регистр и записывает в него случайное значение. Она устанавливает флаг переноса в 1, если в указанный регистр действительно помещено случайное значение, и 0 в противном случае, поэтому если вы пишете ассемблерный код напрямую, то необходимо проверять флаг CF. Отметим, что внутренние функции современных компиляторов С не проверяют флаг CF, а возвращают его значение.

**Примечание** В инфраструктуре Intel PRNG, помимо RDRAND, имеется еще ассемблерная команда RDSEED, которая возвращает случайные биты непосредственно от источника энтропии, после некоторой криптографической обработки. Она предназначена для поставки начальных значений другим PRNG.

Intel PRNG документирован не полностью, но основан на известных стандартах и был подвергнут аудиту со стороны авторитетной компании Cryptography Research (см. ее отчет «Analysis of Intel’s Ivy Bridge Digital Random Number Generator»). Тем не менее существуют сомнения в его безопасности, особенно после разоблачений криптографических закладок Сноуденом. Действительно, PRNG — идеальная мишень для подрывных действий. Если вас это беспокоит, но вы все-таки хотите использовать команды RDRAND или RDSEED, то просто добавьте к ним другие источники энтропии. Это предотвратит эффективную эксплуатацию гипотетической закладки в оборудовании Intel или связанном с ними микрокоде во всех сценариях, кроме самых продвинутых.