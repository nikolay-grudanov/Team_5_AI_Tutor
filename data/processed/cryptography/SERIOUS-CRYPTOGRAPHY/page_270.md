---
source_image: page_270.png
page_number: 270
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.37
tokens: 7885
characters: 2350
timestamp: 2025-12-24T09:17:52.871454
finish_reason: stop
---

Как и для хеш-функций — предмета обсуждения в главе 6, — коллизия имеет место, когда два разных входа дают одинаковый выход. Поэтому для решения ECDLP мы должны найти точки, для которых справедливо равенство:

\[
c_1 P + d_1 Q = c_2 P + d_2 Q.
\]

Чтобы найти такие точки, подставим \( kP \) вместо \( Q \) и получим:

\[
c_1 P + d_1 kP = (c_1 + d_1 k)P = c_2 P + d2kP = (c_2 + d_2 k)P.
\]

Это означает, что \( (c_1 + d_1 k) \) равно \( (c_2 + d_2 k) \) по модулю, равному количеству точек на кривой, которое не является секретом.

Отсюда

\[
\begin{align*}
d_2 k - d_1 k &= c_1 - c_2; \\
k(d_1 - d_2) &= c_1 - c_2; \\
k &= (c_1 - c_2)/(d_1 - d_2).
\end{align*}
\]

И мы нашли \( k \), решив тем самым ECDLP.

Разумеется, это только общая картина — детали сложнее и интереснее. На практике эллиптические кривые строятся над полем по модулю длиной как минимум 256 бит, что делает атаки на эллиптическую криптографию с помощью попытки найти коллизию практически неосуществимыми, потому что для этого понадобилось бы порядка \( 2^{128} \) операций (в главе 6 мы определили стоимость нахождения коллизии в множестве 256-битовых чисел).

Протокол совместной выработки ключа Диффи–Хеллмана над эллиптическими кривыми

Напомним (см. главу 11), что в классическом протоколе Диффи–Хеллмана (DH) две стороны вырабатывают совместный секрет, обмениваясь несекретными значениями. Зная некоторое фиксированное число \( g \), Алиса выбирает случайное секретное число \( a \), вычисляет \( A = g^a \), отправляет А Бобу, а Боб выбирает случайное секретное число \( b \) и отправляет \( B = g^b \) Алисе. Затем каждая сторона объединяет свой секретный ключ с открытым ключом другой стороны, в результате чего получается одно и то же значение \( A^b = B^a = g^{ab} \).

Вариант DH на эллиптической кривой совпадает с классическим DH с точностью до обозначений. В случае ECC Алиса, зная некоторую фиксированную точку \( G \), выбирает случайное секретное число \( d_A \), вычисляет \( P_A = d_A G \) (произведение точки \( G \) на \( d_A \)) и отправляет \( P_A \) Бобу. Боб выбирает случайное секретное число \( d_B \), вычисляет \( P_B = d_B G \) и отправляет результат Алисе. Затем обе стороны вычисляют общий секрет \( d_A P_B = d_B P_A = d_A d_B G \). Этот метод называется протоколом Диффи–Хеллмана на эллиптических кривых (elliptic curve Diffie–Hellman – ECDH).