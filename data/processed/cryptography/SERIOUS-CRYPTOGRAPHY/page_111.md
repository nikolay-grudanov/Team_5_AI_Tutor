---
source_image: page_111.png
page_number: 111
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.19
tokens: 7709
characters: 2096
timestamp: 2025-12-24T09:13:04.578067
finish_reason: stop
---

Потоковый шифр позволяет зашифровать одно сообщение ключом \( K_1 \) и одноразовым числом \( N_1 \), а затем другое сообщение — ключом \( K_1 \) и одноразовым числом \( N_2 \), отличным от \( N_1 \), или ключом \( K_2 \), отличным от \( K_1 \), и одноразовым числом \( N_1 \). Однако никогда не следует повторно шифровать комбинацией \( K_1 \) и \( N_1 \), потому что в этом случае дважды использовалась бы одна и та же гамма \( KS \). Тогда мы получили бы в свое распоряжение первый шифртекст \( C_1 = P_1 \oplus KS \) и второй шифртекст \( C_2 = P_2 \oplus KS \), и если \( P_1 \) известен, то можно было бы определить \( P_2 = C_1 \oplus C_2 \oplus P_1 \).

**Примечание** Название «nonce» — это сокращение от «number used only once» (число, используемое только один раз). В контексте потоковых шифров его иногда называют IV, от «initial value» (начальное значение).

**Потоковые шифры с хранимым состоянием и на основе счетчика**

На верхнем уровне есть два типа потоковых шифров: с хранимым состоянием и на основе счетчика. *Шифры с хранимым состоянием* имеют секретное внутреннее состояние, которое изменяется по мере генерирования гаммы. Состояние шифра инициализируется на основе ключа и одноразового числа, после чего вызывается функция обновления, которая изменяет состояние и порождает один или несколько битов гаммы, как показано на рис. 5.2. Например, знаменитый шифр RC4 является шифром с хранимым состоянием.

![Схема потокового шифра с хранимым состоянием](https://i.imgur.com/3Q5z5QG.png)

Рис. 5.2. Потоковый шифр с хранимым состоянием

**Потоковые шифры на основе счетчика** порождают порции гаммы из ключа, одноразового числа и значения счетчика, как показано на рис. 5.3. В отличие от шифров с хранимым состоянием, например Salsa20, в процессе генерирования гаммы никакое секретное состояние не запоминается.

Эти два подхода определяют верхнеуровневую архитектуру потокового шифра, не зависящую от способа работы базового алгоритма. По внутреннему устройству потоковые шифры также можно отнести к двум категориям в зависимости от целевой платформы: аппаратные и программные.