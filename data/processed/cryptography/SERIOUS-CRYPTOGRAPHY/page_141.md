---
source_image: page_141.png
page_number: 141
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.41
tokens: 7899
characters: 2411
timestamp: 2025-12-24T09:14:01.969634
finish_reason: stop
---

Рассмотрим самое распространенное применение хеш-функции: цифровые подписи, или просто подписи. При использовании цифровых подписей приложение обрабатывает хеш подписываемого сообщения, а не само сообщение, как показано на рис. 6.2. Хеш выступает в роли идентификатора сообщения. Если изменить всего один бит сообщения, то его хеш станет совершенно другим. Поэтому хеш-функция служит гарантией того, что сообщение не было модифицировано. Подписание хеша сообщения столь же безопасно, как подписание самого сообщения, а подписать короткий хеш, скажем состоящий из 256 бит, гораздо быстрее, чем полное сообщение, которое может быть очень длинным. На самом деле большинство алгоритмов цифровой подписи могут работать только с короткими входными данными типа хеш-значений.

![Схема цифровой подписи с хеш-функцией](https://i.imgur.com/3Q5z5QG.png)

Рис. 6.2. Хеш-функция в схеме цифровой подписи. Хеш играет роль заместителя сообщения

И снова непредсказуемость

Криптографическая стойкость хеш-функций проистекает из непредсказуемости их выхода. Взять 256-битовые шестнадцатеричные значения, показанные ниже, — эти хеши вычислены с помощью описанной в стандарте NIST функции хеширования SHA-256, которой на вход подавались буквы a, b и c. Как видим, хотя значения a, b и c в кодировке ASCII отличаются только одним или двумя битами (a имеет код 01100001, b — 01100010, c — 01100011), их хеш-значения совершенно различны.

SHA-256("a") = ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb
SHA-256("b") = 3e23e8160039594a33894f6564e1b1348bbd7a0088d42c4acb73eeaed59c009d
SHA-256("c") = 2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6

Зная только эти три хеша, невозможно предсказать результат применения SHA-256 к d или любому из его битов. Почему? Потому что хеш-значения безопасной хеш-функции непредсказуемы. Безопасная хеш-функция должна выглядеть как черный ящик, возвращающий случайную строку всякий раз, как получает какие-то данные.

Общее теоретическое определение безопасной хеш-функции говорит, что она ведет себя как истинно случайная функция (иногда называемая случайным оракулом). Точнее, случайная хеш-функция не должна обладать никаким свойством или закономерностью, которым не обладала бы случайная функция. Это определение полезно теоретикам, но на практике нам нужны более специфические понятия, а именно стойкость к восстановлению прообраза и стойкость к коллизиям.