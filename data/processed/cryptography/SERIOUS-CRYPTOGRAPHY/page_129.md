---
source_image: page_129.png
page_number: 129
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 43.33
tokens: 7936
characters: 2790
timestamp: 2025-12-24T09:13:45.032346
finish_reason: stop
---

бы мы не знали о том, как эксплуатировать эту смещённость для компрометации реальных приложений. В TLS дефекты RC4 не подвергались публичной эксплуатации до 2011 года, но предполагается, что АНБ использовало его недостатки для компрометации соединений, установленных с применением RC4, задолго до того.

Выяснилось, что смещён не только второй байт гаммы RC4, но и все первые 256 байт. Как обнаружилось в 2011 году, вероятность того, что один из этих байтов нулевой, равна \( \frac{1}{256} + c/256^2 \), где константа \( c \) принимает значение от 0.24 до 1.34. Это верно не только для нуля, но и для других значений байтов. Удивительно, что RC4 терпит неудачу там, где успешны даже криптографически нестойкие PRNG, — в порождении равномерно распределенных псевдослучайных байтов (когда вероятность появления каждого из 256 байт равна 1/256).

Чтобы эксплуатировать основанную на дефектном RC4 реализацию TLS, достаточно даже самой слабой модели атаки: по существу, мы набираем шифртексты и ищем сам открытый текст, а не ключ. Но есть и подводный камень: нужно много шифртекстов, зашифровывающих один и тот же открытый текст с разными секретными ключами. Такую модель атаки иногда называют широковещательной, потому что она сродни широковещательной передаче одного и того же сообщения нескольким получателям.

Например, предположим, что мы хотим дешифрировать байт открытого текста \( P_1 \), имея много байтов, полученных перехватом различных шифртекстов для одного и того же сообщения. Первые четыре байта шифртекста будут тогда выглядеть следующим образом:

\[
C_1^2 = P_1 \oplus KS_1^2; \\
C_1^3 = P_1 \oplus KS_1^3; \\
C_1^4 = P_1 \oplus KS_1^4.
\]

Из-за смещённости RC4 байты гаммы \( KS_1^i \) с большей вероятностью равны нулю, чем любому другому значению. Поэтому байты \( C_1^i \) с большей вероятностью равны \( P_1 \), чем какому-то другому значению. Чтобы определить \( P_1 \), зная байты \( C_1^i \), мы должны просто подсчитать, сколько раз встречается каждое значение байта, и вернуть в качестве \( P_1 \) самое частое. Но поскольку статистическое смещение очень мало, для ма-ло-мальски достоверных выводов необходимы миллионы значений.

Атаку можно обобщить с целью восстановления более одного байта открытого текста и эксплуатировать не только одно смещённое значение (в данном случае нуль). Просто алгоритм становится чуть более сложным. Но провести такую атаку практически затруднительно, т. е. требуется набрать много шифртекстов, соответствующих одному открытому тексту, зашифрованному разными ключами. Например, эта атака не может вскрыть все защищенные TLS соединения, в которых используется RC4, потому что нужно как-то убедить сервер отправить один и тот же открытый текст, зашифрованный разными ключами, многим разным получателям или много раз одному получателю.