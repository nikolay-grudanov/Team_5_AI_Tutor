---
source_image: page_154.png
page_number: 154
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.16
tokens: 7823
characters: 2217
timestamp: 2025-12-24T09:14:22.242822
finish_reason: stop
---

Операция <<< 1 в листинге 6.6 — единственное различие между функциями SHA-1 и SHA-0.
Наконец, функция f() (см. листинг 6.7) в SHA1-blockcipher() выполняет последовательность простых поразрядных логических операций (булевых функций), зависящую от номера раунда.

Листинг 6.7. Функция f() в SHA-1

f(i, b, c, d) {
    if i < 20 then return ((b & c) ⊕ (~b & d))
    if i < 40 then return (b ⊕ c ⊕ d)
    if i < 60 then return ((b & c) ⊕ (b & d) ⊕ (c & d))
    if i < 80 then return (b ⊕ c ⊕ d)
}

Вторая и четвертая булевые функции в листинге 6.7 — просто XOR трех входных слов, это линейная операция. Напротив, первая и третья функции включают нелинейный оператор & (логическое И), чтобы защититься от дифференциального криптоанализа, который, как вы помните, эксплуатирует предсказуемое распространение различий в битах. Без оператора & (иными словами, если бы f() всегда вычисляла, к примеру, b ⊕ c ⊕ d) SHA-1 было бы легко взломать, проследив закономерности во внутреннем состоянии.

Атаки на SHA-1

Хотя функция SHA-1 безопаснее, чем SHA-0, она все равно небезопасна, поэтому браузер Chrome отмечает сайты, использующие SHA-1 при установлении HTTPS-соединения как небезопасные. Хотя 160-битовый хеш должен обеспечивать 80-битовую стойкость к коллизиям, в 2005 году в SHA-1 были обнаружены слабости, и, по некоторым оценкам, для нахождения коллизии должно хватить приблизительно \(2^{65}\) вычислений (если бы алгоритм не содержал дефектов, то это число равнялось бы \(2^{80}\)). Реальная коллизия в SHA-1 была найдена лишь спустя 12 лет, когда после нескольких лет криптоанализа Марк Стивенс и другие исследователи представили два PDF-документа с одинаковым хеш-значением (см. https://shattered.io/).

Вывод: использовать SHA-1 не следует. Как уже было отмечено, браузеры помечают функцию SHA-1 как небезопасную, и NIST ее больше не рекомендует. Используйте вместо нее функции хеширования семейства SHA-2, BLAKE2 или SHA-3.

SHA-2

Алгоритм SHA-2, пришедший на смену SHA-1, был спроектирован АНБ и стандартизован NIST. SHA-2 — это семейство из четырех функций хеширования: SHA-224, SHA-256, SHA-384 и SHA-512, из которых основными являются SHA-256 и SHA-512. Трехзначное число обозначает длину хеш-значения в битах.