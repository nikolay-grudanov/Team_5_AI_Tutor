---
source_image: page_097.png
page_number: 97
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.37
tokens: 7679
characters: 2044
timestamp: 2025-12-24T09:12:34.671606
finish_reason: stop
---

Резюмируя, можно сказать, что при реализации и развертывании криптосистем есть миллион вещей, о которых нужно побеспокоиться, но безопасность AES не из их числа. Самая серьезная опасность, грозящая блочным шифрам, — не их базовые алгоритмы, а режимы работы. Если выбран неправильный режим работы или правильный режим неправильно используется, то даже такой стойкий шифр, как AES, вас не спасет.

Режимы работы

В главе 1 я объяснял, как схемы шифрования сочетают перестановку с режимом работы, чтобы можно было обрабатывать сообщения любой длины. В этом разделе я рассмотрю основные режимы работы блочных шифров, их свойства (функциональные и безопасности) и когда следует (или не следует) использовать каждый. Начну с самого простого режима: электронной кодовой книги.

Режим электронной кодовой книги (ECB)

Простейший режим работы блочного шифра — это режим электронной кодовой книги (electronic codebook — ECB)¹, его и режимом-то работы назвать трудно. ECB принимает блоки открытого текста \( P_1, P_2, \ldots, P_N \) и обрабатывает их независимо, вычисляя \( C_1 = E(K, P_1), C_2 = E(K, P_2) \) и т. д., как показано на рис. 4.6. Это простая, но и небезопасная операция. Повторяю: режим ECB небезопасен, использовать его не следует!

![Режим ECB](../images/chapter4/fig4.6.png)

Рис. 4.6. Режим ECB

Марш Рэй, криптограф из Microsoft, писал: «Все знают, что режим ECB никуда не годится, потому что мы можем видеть пингвина». Он имел в виду знаменитую иллюстрацию небезопасности ECB, в которой используется изображение символа Linux, пингвина Такса, показанное на рис. 4.7. Слева приведено оригинальное изображение Такса, а справа оно же, зашифрованное AES в режиме ECB (впрочем, базовый шифр не имеет значения). В зашифрованном изображении легко угадывается силуэт пингвина, поскольку все блоки исходного изображения одного оттенка серого после шифрования тоже имеют один оттенок; иными словами, шифрование в режиме ECB дает то же изображение, только в других цветах.

¹ В ГОСТ 28147–89 он называется режимом простой замены. – Прим. перев.