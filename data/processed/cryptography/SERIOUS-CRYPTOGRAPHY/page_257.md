---
source_image: page_257.png
page_number: 257
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.85
tokens: 7795
characters: 2108
timestamp: 2025-12-24T09:17:29.559919
finish_reason: stop
---

ми ключами друг друга, равными g в степени, равной закрытому ключу. Каждая сторона выбирает случайный показатель степени, после чего Алиса вычисляет A и отправляет Бобу, а Боб вычисляет B и отправляет Алисе. Получив эфемерный открытый ключ Боба B, Алиса объединяет его со своим долговременным закрытым ключом x, своим эфемерным закрытым ключом a и долговременным открытым ключом Боба Y, вычисляя выражение \((B \times Y^B)^{a+xA}\), как показано на рис. 11.6. Преобразование этого выражения дает

\[
(B \times Y^B)^{a+xA} = (g^b \times (g^y)^B)^{a+xA} = (g^{b+yB})^{a+xA} = g^{(b+yB)(a+xA)}.
\]

![Протокол MQV](https://i.imgur.com/3Q5z5QG.png)

Рис. 11.6. Протокол MQV

На рис. 11.6 x и y — долговременные закрытые ключи Алисы и Боба. Тем временем Боб вычисляет выражение \((A \times X^A)^{b+yB}\), и легко проверить, что оно равно выражению, вычисленному Алисой:

\[
(A \times X^A)^{b+yB} = (g^a \times (g^x)^A)^{b+yB} = (g^{a+xA})^{b+yB} = g^{(a+xA)(b+yB)} = g^{(b+yB)(a+xA)}.
\]

Как видим, Алиса и Боб получают одинаковое значение, \(g^{(b+yB)(a+xA)}\), т. е. разделяют общий секрет.

В отличие от DH с аутентификацией, протокол MQV невозможно взломать из-за простой утечки эфемерных секретов. Знание a или b не позволит противнику добыть окончательный разделяемый секрет, потому что для его вычисления нужно знать долговременные закрытые ключи.

Что произойдет при самой сильной модели атаки, со вскрытием, когда скомпрометирован долговременный ключ? Если Ева скомпрометирует долговременный закрытый ключ Алисы, x, то ранее выработанные разделяемые секреты останутся в безопасности, потому что в их вычислении участвовали также эфемерные закрытые ключи Алисы.

Однако MQV не дает совершенной секретности прошлого из-за следующей атаки. Предположим, что Ева перехватила сообщение Алисы A и заменила его своим сообщением \(A = g^a\) с некоторым a, выбранным Евой. Тем временем Боб отправляет B Алисе (и Ева запоминает значение B) и вычисляет разделяемый ключ. Если впоследствии Ева скомпрометирует долговременный закрытый ключ Алисы x, то сможет определить, какой ключ вычислил Боб в этом сеансе. Это на-