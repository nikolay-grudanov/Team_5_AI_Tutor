---
source_image: page_286.png
page_number: 286
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.52
tokens: 7725
characters: 2525
timestamp: 2025-12-24T09:18:23.523748
finish_reason: stop
---

Одноразовые числа

В отличие от многих других протоколов, например Encapsulating Security Payload (ESP), являющегося частью IPsec, в записях TLS нет одноразового числа, необходимого шифру с аутентификацией.

Одноразовые числа, применяемые для шифрования и дешифрирования записей TLS, выводятся из 64-битовых порядковых номеров, которые локально хранятся каждой стороной и увеличиваются на единицу для каждой новой записи. Клиент, зашифровывающий данные, выводит одноразовое число, выполняя XOR между порядковым номером и значением client_write_iv, которое само выводится из разделяемого секрета. Сервер поступает аналогично, но использует другое значение, server_write_iv.

Например, если передается три записи TLS, то для первой записи одноразовое число будет равно 0, для второй 1, а для третьей 2; при получении этих трех записей также будут использованы одноразовые числа 0, 1, 2, именно в таком порядке. Повторное применение одинаковых порядковых номеров для шифрования передаваемых и дешифрирования принимаемых данных не является слабостью протокола, потому что они объединяются операцией XOR с разными константами (client_write_iv и server_write_iv) и потому что в каждом направлении применяются разные секретные ключи.

Дополнение нулями

Записи TLS 1.3 поддерживают интересное свойство, которое называется дополнением нулями и уменьшает риск атак посредством анализа трафика. Анализ трафика — это метод, с помощью которого противник извлекает полезную информацию из трафика, ориентируясь на хронометраж, объем переданных данных и т. д. Например, поскольку шифртекст обычно мало отличается по размеру от открытого текста, даже при использовании стойкого шифрования противник может определить приблизительный размер сообщения, просто глядя на длину соответствующего ему шифртекста.

Дополнение нулями означает добавление нулей к открытому тексту, чтобы увеличить размер шифртекста и тем самым заставить наблюдателя думать, что зашифрованное сообщение длиннее, чем на самом деле.

Протокол подтверждения связи

Подтверждение связи, или квитирование, — это основной протокол согласования в TLS; в процессе его выполнения клиент и сервер вырабатывают общие секретные ключи для инициирования безопасной связи. Во время квитирования клиент и сервер играют разные роли. Клиент предлагает какие-то конфигурации (версию TLS и набор шифров в порядке предпочтения), а сервер выбирает, какую конфигурацию он будет использовать. Сервер стремится уважать пожелания клиента, но не обязан это делать. Чтобы обеспечить интероперабель-