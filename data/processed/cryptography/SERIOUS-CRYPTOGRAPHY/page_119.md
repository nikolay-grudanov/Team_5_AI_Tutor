---
source_image: page_119.png
page_number: 119
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.50
tokens: 7842
characters: 2433
timestamp: 2025-12-24T09:13:22.513934
finish_reason: stop
---

Из этих примеров следует вынести простой урок — пластырем пу-левые раны не залечишь. Латание непригодного алгоритма путем добавления чуть более стойкого уровня не сделает систему безопасной. Нужно устранить корень проблемы.

Нелинейные FSR

Нелинейные FSR (NFSR) похожи на LFSR, но функция обратной связи в них нелинейна. То есть в дополнение к поразрядным операциям XOR она может включать поразрядные AND и OR — свойство, у которого есть как плюсы, так и минусы.

Достоинства нелинейных функций обратной связи в том, что благодаря им NFSR оказываются криптографически более стойкими, чем LFSR, потому что выходные биты зависят от секретного начального состояния сложным образом и описываются уравнениями экспоненциального размера. В линейной функции связи прости и содержат не более n членов (\( N_1, N_2, ..., N_n \), где \( N_i \) — биты состояния). Но, например, 4-битовый NFSR с секретным начальным состоянием (\( N_1, N_2, N_3, N_4 \)) и функцией обратной связи (\( N + N_2 + N_1N_2 + N_3N_4 \)) порождает первый выходной бит, равный

\[
N_1 + N_2 + N_1N_2 + N_3N_4.
\]

На второй итерации бит \( N_1 \) заменяется этим новым значением. Выражение второго выходного бита в терминах начального состояния имеет вид:

\[
(N_1N_2 + N_3N_4 + N_1 + N_2) + N_1 + (N_1N_2 + N_3N_4 + N_1 + N_2)N_1 + N_2N_3 \\
= N_1N_3N_4 + N_1N_2 + N_2N_3 + N_3N_4 + N_1 + N_2.
\]

Алгебраическая степень этого уравнения (максимальное число сомножителей в произведении, в данном случае в члене \( N_1N_3N_4 \)) равна 3, тогда как степень функции обратной связи равна всего 2, а членов в уравнении шесть, а не четыре. Многократное применение нелинейной функции очень быстро порождает нерешаемые уравнения, поскольку размер выхода возрастает экспоненциально. Нам в процессе работы NFSR вычислять эти уравнения не нужно, но противнику придется решить их, если он хочет взломать систему.

Недостаток NFSR — отсутствие эффективного способа определить период регистра или хотя бы узнать, является ли его период максимальным. Для n-битового NFSR потребовалось бы провести примерно \( 2^n \) испытаний, чтобы проверить, максимален ли период. Для больших NFSR длиной 80 и более бит выполнить такое вычисление невозможно.

По счастью, есть способ использовать NFSR, не тревожась по поводу короткого периода: можно объединить LFSR и NFSR, получив в результате гарантированно максимальный период и криптографическую стойкость, — именно так работает шифр Grain-128a.