---
source_image: page_201.png
page_number: 201
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.80
tokens: 8008
characters: 2805
timestamp: 2025-12-24T09:15:49.203545
finish_reason: stop
---

Разумеется, 0 и 1 — лишь два из \(2^{128}\) возможных значений \(H\), и встретиться они могут с вероятностью \(2/2^{128} = 1/2^{127}\). Но есть и другие слабые значения, а именно все значения \(H\), принадлежащие короткому циклу при возведении в степени. Например, значение \(H = 10d04d25f93556e69f58ce2f8d035a4\) принадлежит циклу длины 5, потому что для него \(H^5 = H\) и, значит, \(H^e = H\) для любого \(e\), кратного пяти. Следовательно, в приведенном выше выражении последнего значения GHASH \(X_n\) перестановка блоков \(Cn\) (умножаемого на \(H\)) и \(C_{n-4}\) (умножаемого на \(H^5\)) оставит аутентификационный жетон неизменным, что эквивалентно подделке. Противник может воспользоваться этим свойством для конструирования нового сообщения вместе с правильным жетоном, не зная ключа, — для безопасного шифра с аутентификацией такое должно быть невозможно.

Описанный выше пример основан на цикле длины 5, но есть много циклов большей длины, а значит, много значений \(H\), которые слабее, чем должны быть. Вывод: в том маловероятном случае, когда \(H\) принадлежит короткому циклу, противник может подделать столько жетонов, сколько захочет, но, не зная \(H\) или \(K\), он не сможет определить длину цикла \(H\). Таким образом, хотя эту уязвимость невозможно эксплуатировать, ее все же следует избегать, более тщательно выбирая полином, используемый для сокращения по модулю.

Примечание Дополнительные сведения об этой атаке можно почерпнуть из статьи Markku-Juhani O. Saarinen «Cycling Attacks on GCM, GHASH and Other Polynomial MACs and Hashes», доступной по адресу https://eprint.iacr.org/2011/202/.

AES-GCM и короткие жетоны

На практике AES-GCM обычно возвращает 128-битовые жетоны, но может порождать жетоны любой длины. К сожалению, при использовании коротких жетонов вероятность подделки значительно возрастает.

Если длина жетона равна 128 бит, то противник, пытающийся подделать жетон, добьется успеха с вероятностью \(1/2^{128}\), потому что существует \(2^{128}\) возможных жетонов. (В общем случае для \(n\)-битовых жетонов вероятность успеха должна быть равна \(1/2^n\).) Но при использовании коротких жетонов вероятность успешной подделки гораздо выше, чем \(1/2^n\), из-за слабостей в структуре GCM, обсуждение которых выходит за рамки этой книги. Например, при 32-битовых жетонах противник, знающий аутентификационный жетон некоторого сообщения длиной 2 МБ, сможет добиться успеха с вероятностью \(1/2^{16}\) вместо \(1/2^{32}\).

Вообще, при \(n\)-битовых жетонах вероятность успешной подделки равна не \(1/2^n\), а \(2^m/2^n\), где \(2^m\) — число блоков самого длинного сообщения, для которого противник наблюдал жетон. Например, если используются 48-битовые жетоны и обрабатываются сообщения длиной 4 ГБ (или \(2^{28}\) блоков по 16 байт), то вероятность подделки будет