---
source_image: page_244.png
page_number: 244
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.42
tokens: 7890
characters: 2655
timestamp: 2025-12-24T09:17:08.902821
finish_reason: stop
---

обе стороны выработали общее секретное значение по протоколу DH, этим секретом можно воспользоваться для установления безопасного канала, преобразовав секрет в один или несколько симметричных ключей, с помощью которых шифруется и аутентифицируется последующий обмен данными. Поэтому протокол DH и его варианты называются протоколами совместной выработки ключа.

В первой части этой главы я в общих чертах объясню математические основания протокола Диффи–Хеллмана, включая вычислительные задачи, на которые он опирается. Затем, во второй части, я опишу различные версии протокола Диффи–Хеллмана, применяемые для создания безопасных каналов. Наконец, поскольку схемы DH безопасны только при правильно выбранных параметрах, я завершу главу рассмотрением сценариев, в которых этот протокол может дать сбой.

Примечание В 2015 году Диффи и Хеллман получили престижную премию Тьюринга за изобретение криптографии с открытым ключом и цифровых подписей, но есть и другие, чей вклад следует отметить. В 1974 году, за два года до основополагающей статьи Диффи и Хеллмана, Ральф Меркл впервые предложил идею криптографии с открытым ключом, представив то, что теперь известно под названием «головоломки Меркла». Примерно тогда же исследователи из Управления правительственной связи, британского эквивалента АНБ, также открыли принципы, положенные в основу RSA и протокола выработки ключей Диффи–Хеллмана, хотя этот факт был рассекречен лишь спустя несколько десятилетий.

Функция Диффи–Хеллмана

Чтобы разобраться в протоколах совместной выработки ключей DH, нужно сначала понимать их базовую операцию, функцию Диффи–Хеллмана. Обычно эта функция работает с группами, обозначаемыми \( \mathbb{Z}_p^* \). Напомним (см. главу 9), что эти группы образованы ненулевыми целыми числами по модулю простого числа \( p \). Другой открытый параметр — основание, \( g \). Все арифметические операции выполняются по модулю \( p \).

В функции DH участвуют два закрытых значения, \( a \) и \( b \), случайно выбранных двумя сообщающимися сторонами из группы \( \mathbb{Z}_p^* \). С \( a \) ассоциировано открытое значение \( A = g^a \bmod p \), т. е. \( g \), возведенное в степень \( a \) по модулю \( p \). Это значение отправляется другой стороне в сообщении, доступном для прослушивания. С \( b \) ассоциировано открытое значение \( B = g^b \bmod p \), которое отправляется владельцу \( a \) тоже в виде сообщения, допускающего прослушивание.

Работа DH основана на комбинировании любого открытого значения с другим закрытым значением, при этом результат в обоих случаях одинаков: \( A^b = (g^a)^b = g^{ab} \) и \( B^a = (g^b)^a = g^{ba} = g^{ab} \). Результат, \( g^{ab} \), —