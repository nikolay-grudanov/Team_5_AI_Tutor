---
source_image: page_252.png
page_number: 252
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.92
tokens: 7678
characters: 2062
timestamp: 2025-12-24T09:17:12.650405
finish_reason: stop
---

Протоколы Диффи–Хеллмана

Функция Диффи–Хеллмана — основа большинства современных протоколов выработки открытого ключа. Однако не существует единственного протокола Диффи–Хеллмана, вместо этого есть много способов использования функции DH для выработки общего секрета. В следующих разделах мы рассмотрим три таких протокола. Я буду придерживаться принятого в криптографии соглашения и называть стороны Алисой и Бобом, а противника Евой. Основание группы, фиксированное и заранее известное Алисе и Бобу, я буду обозначать g.

Анонимный протокол Диффи–Хеллмана

Анонимный протокол Диффи–Хеллмана — самый простой из таких протоколов. Он называется анонимным, потому что не требует аутентификации; у участников нет никакого идентификатора, который мог бы быть проверен другой стороной, и ни одна из сторон не хранит долговременного ключа. Алиса не может доказать Бобу, что она Алиса, и наоборот.

В анонимном протоколе Диффи–Хеллмана каждая сторона выбирает случайное значение (Алиса — a, а Боб — b) в качестве своего закрытого ключа и отправляет соответствующий открытый ключ другой стороне. На рис. 11.2 эта процедура показана более подробно.

![Диаграмма анонимного протокола Диффи–Хеллмана](https://i.imgur.com/3Q5z5QG.png)

Рис. 11.2. Анонимный протокол Диффи–Хеллмана

Как видим, Алиса использует свой показатель степени a и основание группы g, чтобы вычислить \( A = g^a \), и отправляет это значение Бобу. Боб получает A и вычисляет \( A^b \), равное \( (g^a)^b \). Теперь у Боба есть значение \( g^{ab} \), и он вычисляет B по своему случайному показателю степени b и значению g. Затем он отправляет B Алисе, а она использует его для вычисления \( g^{ab} \). Теперь у Алисы и Боба есть одно и то же значение \( g^{ab} \), полученное выполнением похожих операций — возведением g и полученного от другой стороны значения в степень, равную своему секретному показателю. Чисто, просто, но безопасно, только когда противник совсем уж ленивый.

Анонимный алгоритм DH можно взломать с помощью атаки с человеком посередине. Противнику нужно лишь перехватить сообще-