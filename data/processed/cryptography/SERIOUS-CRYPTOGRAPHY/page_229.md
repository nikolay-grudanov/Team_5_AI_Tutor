---
source_image: page_229.png
page_number: 229
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.10
tokens: 7638
characters: 1829
timestamp: 2025-12-24T09:16:27.361239
finish_reason: stop
---

n, которую можно преобразовать в целое число, меньшее n. Результатом такого преобразования является число x, которое используется для вычисления функции RSA \( x^e \bmod n \) и получения шифртекста.

![Шифрование симметричного ключа K в режиме RSA-OAEP](../images/ch10_02.png)

Рис. 10.2. Шифрование симметричного ключа K в режиме RSA-OAEP, где H — фиксированный параметр, а R — случайные биты

Чтобы дешифрировать шифртекст y, мы сначала вычисляем \( x = y^d \bmod n \), а затем восстанавливаем значения M и R. Далее вычисляется исходное значение M по формуле \( M \oplus \text{Hash1}(R \oplus \text{Hash2}(M)) \). Наконец, мы проверяем, что M имеет вид \( H||00...00||01||K \), где длина H равна h байт, а после серии байтов 00 находится байт 01.

На практике параметры m и h (длина модуля и длина результата Hash2 соответственно) обычно равны m = 256 байт (для 2048-битового RSA) и h = 32 (при использовании SHA-256 в качестве Hash2). Следовательно, остается \( m - h - 1 = 223 \) байта для M, из которых до \( m - 2h - 2 = 190 \) байт доступны для K (член «-2» — это длина разделятельного байта 01). Хеш-значение Hash1 тогда содержит \( m - h - 1 = 223 \) байта — больше, чем хеш-значение любой из общеупотребительных функций хеширования.

**Примечание** Для построения хеша такой необычной длины в стандартах RSA описывается применение метода функций генерирования масок, который создает хеш-функции, возвращающие хеш-значения произвольной длины, по любой хеш-функции.

Подписание с помощью RSA

Цифровая подпись доказывает, что владелец закрытого ключа действительно подписал некоторое сообщение и что подпись подлинная. Поскольку никто, кроме владельца закрытого ключа, не знает секретного показателя степени d, никто не может вычислить подпись \( y = x^d \bmod n \) для некоторого значения x, но любой желающий может про-