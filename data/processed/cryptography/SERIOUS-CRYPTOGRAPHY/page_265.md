---
source_image: page_265.png
page_number: 265
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 49.33
tokens: 8060
characters: 2796
timestamp: 2025-12-24T09:17:58.036528
finish_reason: stop
---

Примечание На рис. 12.2 рассмотрены точки из множества \( \mathbb{Z}_{191} = \{0, 1, 2, ..., 190\} \), включающего нуль. Этим оно отличается от групп, обозначаемых \( \mathbb{Z}_p^* \) (обратите внимание на верхнюю звездочку), которые мы обсуждали в контексте RSA и протокола Диффи–Хеллмана. Причина этого отличия в том, что здесь мы не только умножаем, но и складываем числа, поэтому хотим, чтобы множество включало единичный элемент относительно сложения (а именно 0, т. к. \( x + 0 = x \) для любого \( x \in \mathbb{Z}_{191} \)). Кроме того, для каждого числа \( x \) имеется обратное относительно сложения, обозначаемое \( -x \) и такое, что \( x + (-x) = 0 \). Например, обратным к 100 в множестве \( \mathbb{Z}_{191} \) является 91, потому что \( 100 + 91 \bmod 191 = 0 \). Такое множество чисел, в котором определены операции сложения и умножения и для каждого элемента \( x \) существует обратный относительно сложения (обозначаемый \( -x \)), а также обратный относительно умножения (обозначаемый \( 1/x \)), называется полем. Если поле содержит конечное число элементов, как \( \mathbb{Z}_{191} \) и вообще все поля, используемые в эллиптической криптографии, то оно называется конечным полем.

Сложение и умножение точек

Мы видели, что координаты \((x, y)\) точек на эллиптической кривой удовлетворяют уравнению \(y^2 = x^3 + ax + b\). В этом разделе мы рассмотрим, как складывать точки на эллиптической кривой по правилу сложения.

Сложение двух точек

Пусть требуется сложить две точки на эллиптической кривой, \(P\) и \(Q\), с целью получить новую точку \(R\), являющуюся их суммой. Проще всего для этого воспользоваться геометрическим правилом: провести прямую, соединяющую \(P\) и \(Q\), и найти на кривой еще одну точку пересечения с этой прямой. Тогда суммой \(P\) и \(Q\) будет точка, симметричная этой точке пересечения относительно оси \(x\). Например, на рис. 12.3 прямая, соединяющая \(P\) и \(Q\), пересекает кривую в точке, расположенной между \(P\) и \(Q\), и точка \(P + Q\) имеет такую же абсциссу, как эта третья точка, но противоположную ординату.

Это геометрическое правило простое, но не дает численных значений координат точки \(R\). Ее координаты \((x_R, y_R)\) вычисляются по координатам \((x_P, y_P)\) точки \(P\) и \((x_Q, y_Q)\) точки \(Q\) по формулам \(x_R = m^2 - x_P - x_Q\), \(y_R = m(x_P - x_R) - y_P\), где \(m = (y_Q - y_P)/(x_Q - x_P)\) — угловой коэффициент прямой, соединяющей \(P\) и \(Q\).

К сожалению, эти формулы и прием с проведением прямой, как на рис. 12.3, работают не всегда. Например, если \(P = Q\), то нельзя провести прямую через две точки (точка-то всего одна), а если \(P = -P\), то эта прямая не пересечет кривую во второй раз, так что нечего будет отражать относительно оси \(x\). Мы рассмотрим эти случаи в следующем разделе.