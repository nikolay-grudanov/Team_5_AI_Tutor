---
source_image: page_108.png
page_number: 108
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.22
tokens: 7871
characters: 2357
timestamp: 2025-12-24T09:13:04.637929
finish_reason: stop
---

1. Выбрать случайный блок \( C_1 \) и изменять его последний байт, пока оракул дополнения не сочтет шифртекст корректным. Обычно в корректном шифртексте \( C_1[15] \oplus X[15] = 01 \), так что, опробовав 128 значений \( C_1[15] \), мы найдем \( X[15] \).
2. Определить значение \( X[14] \), положив \( C_1[15] \) равным \( X[15] \oplus 02 \) и найдя такой байт \( C_1[14] \), который приводит к правильному дополнению. Как только оракул счел шифртекст корректным, мы нашли \( C_1[14] \) такой, что \( C_1[14] \oplus X[14] = 02 \).
3. Повторить шаги 1 и 2 для всех 16 байт.

Для атаки нужно в среднем 128 запросов к оракулу на каждый из 16 байт, т. е. всего 2000 запросов. (Отметим, что во всех запросах следует использовать одно и то же начальное значение.)

**Примечание** На практике реализация атаки на оракул дополнения несколько сложнее, потому что нужно обрабатывать неверные гипотезы на шаге 1. Шифртекст может иметь корректное дополнение не потому, что \( P_2 \) оканчивается одним байтом 01, а потому, что заканчивается двумя байтами 02 или тремя байтами 03. Но с этим легко справиться, проверяя корректность шифртекстов, в которых модифицируется больше байтов.

Для дополнительного чтения

О блочных шифрах можно говорить еще очень много: и о том, как работают алгоритмы, и о том, как их можно атаковать. Например, схема Фейстеля и подстановочно-перестановочные сети — не единственные способы построения блочных шифров. В шифрах IDEA и FOX используется построение Лая-Месси, а в шифре Threefish — сети ARX, включающие комбинации сложения, циклического сдвига и XOR.

Существует также много других режимов, помимо ECB, CBC и CTR. Некоторые из них — чистая теория, их никто не использует, например CFB и OFB, другие предназначены для специализированных приложений, например XTS для настраиваемого шифрования или GCM для шифрования с аутентификацией.

Я обсудил шифр Rijndael, победивший в конкурсе на звание AES, но в нем принимали участие еще 14 алгоритмов: CAST-256, CRYPTON, DEAL, DFC, E2, FROG, HPC, LOKI97, Magenta, MARS, RC6, SAFER+, Serpent и Twofish. Рекомендую поинтересоваться, как они работают, как проектировались, каким атакам подвергались и насколько они быстрые. Стоит также почитать о наработках АНБ (Skipjack и более поздних, SIMON и SPECK), а также о сравнительно недавних «облегченных» шифрах, например KATAN, PRESENT или PRINCE.