---
source_image: page_153.png
page_number: 153
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.66
tokens: 7666
characters: 1602
timestamp: 2025-12-24T09:14:10.552373
finish_reason: stop
---

В листинге 6.4 показана функция сжатия SHA-1, SHA1-compress():

Листинг 6.4. Функция сжатия в SHA-1

SHA1-compress(H, M) {
    (a0, b0, c0, d0, e0) = H // разложение H на пять 32-битовых слов
        // с обратным порядком байтов
    (a, b, c, d, e) = SHA1-blockcipher(a0, b0, c0, d0, e0, M)
    return (a + a0, b + b0, c + c0, d + d0, e + e0)
}

Функция блочного шифра SHA-1, SHA1-blockcipher(), выделенная полужирным шрифтом в листинге 6.5, принимает 512-битовый блок сообщения M в качестве ключа и преобразует пять 32-битовых слов (a, b, c, d, e), 80 раз повторяя в цикле короткую последовательность операций, чтобы заменить слово комбинацией всех пяти слов. Затем она сдвигает другие слова в массиве, как в регистре сдвига.

Листинг 6.5. Блочный шифр в SHA-1

SHA1-blockcipher(a, b, c, d, e, M) {
    W = expand(M)
    for i = 0 to 79 {
        new = (a <<< 5) + f(i, b, c, d) + e + K[i] + W[i]
        (a, b, c, d, e) = (new, a, b >>> 2, c, d)
    }
    return (a, b, c, d, e)
}

Функция expand(), показанная в листинге 6.6, создает массив восьмидесяти 32-битовых слов, W, из блока сообщения длиной 16 слов. Для этого в первые 16 слов W записываются слова M, а в последующие — XOR-комбинации предыдущих слов, циклически сдвинутые на один бит влево.

Листинг 6.6. Функция expand() в SHA-1

expand(M) {
    // 512-битовый блок M рассматривается как массив шестнадцати 32-битовых слов
    W = пустой массив из восьмидесяти 32-битовых слов
    for i = 0 to 79 {
        if i < 16 then W[i] = M[i]
        else
            W[i] = (W[i - 3] ⊕ W[i - 8] ⊕ W[i - 14] ⊕ W[i - 16]) <<< 1
    }
    return W
}