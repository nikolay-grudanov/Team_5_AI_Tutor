---
source_image: page_133.png
page_number: 133
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.72
tokens: 7875
characters: 1962
timestamp: 2025-12-24T09:13:46.382786
finish_reason: stop
---

Выход RC4 выглядит случайным, но в нем присутствует роковое статистическое смещение. По счастью, Salsa20 гораздо безопаснее RC4, и никакого статистического смещения в нем нет.

Дифференциальный криптоанализ

Чтобы продемонстрировать, почему Salsa20 безопаснее RC4, рассмотрим основы дифференциального криптоанализа, который изучает различия между состояниями, а не их фактические значения. Например, два начальных состояния на рис. 5.13 отличаются одним битом счетчика, или словом x8 в массиве состояния Salsa20. Их поразрядное различие показано в массиве ниже:

00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000
00000001 00000000 00000000 00000000
00000000 00000000 00000000 00000000

Различие между двумя состояниями описывается результатом применения к ним операции XOR. Бит 1, выделенный полужирным шрифтом, соответствует различию в одном бите между двумя состояниями. Если применить к обоим состояниям XOR, то различиям будут соответствовать позиции результата, содержащие 1.

Чтобы увидеть, насколько быстро распространяются изменения начального состояния в результате выполнения базового алгоритма Salsa20, посмотрим на различия между состояниями в процессе повторения раундов. После одного раунда различие распространяется на два из трех слов в первом столбце:

80040003 00000000 00000000 00000000
00000000 00000000 00000000 00000000
00000001 00000000 00000000 00000000
00002000 00000000 00000000 00000000

После двух раундов различия распространяются на уже различающиеся строки, т. е. на все, кроме второй. В этот момент различия между состояниями еще относительно разрежены; изменилось не так много битов в слове:

9ed7eb7f 060002c0 18028b0c 57ca83c0
00000000 00000000 00000000 00000000
00000001 0000e000 801c0006 00000000
00002000 00400000 04000008 0060f300

После трех раундов различия становятся более плотными, хотя наличие большого числа нулевых полубайтов указывает, что многие позиции еще не затронуты начальным различием: