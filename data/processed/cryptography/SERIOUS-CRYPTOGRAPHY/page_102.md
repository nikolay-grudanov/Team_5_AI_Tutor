---
source_image: page_102.png
page_number: 102
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.04
tokens: 7741
characters: 2171
timestamp: 2025-12-24T09:12:43.973828
finish_reason: stop
---

• Если осталось два байта, то дополнить сообщение 14 байтами 0e (десятичное 14).
• Если осталось три байта, то дополнить сообщение 13 байтами 0d (десятичное 13).

Если в блоке не хватает одного байта, то он дополняется одним байтом, равным 01. Если длина открытого текста уже кратна 16, то добавляется 16 байт 10 (десятичное 16). Ну, вы поняли идею. Этот прием обобщается на любую длину блока, не большую 255 (для более длинных блоков так не получится, потому что одним байтом нельзя закодировать значение, большее 255).
Дешифрирование дополненного сообщения производится следующим образом.

1. Дешифрировать все блоки, как в режиме CBC.
2. Проверить, удовлетворяют ли последние байты последнего блока правилу дополнения: что блок заканчивается по крайней мере одним байтом 01, или по крайней мере двумя байтами 02, или по крайней мере тремя байтами 03 и т. д. Если правило дополнения не выполнено, например если последние байты равны 01 02 03, то сообщение отвергается. В противном случае дешифратор отбрасывает байты дополнения и возвращает оставшиеся байты открытого текста.

Недостаток дополнения заключается в том, что шифртекст оказывается длиннее по крайней мере на один байт, а в худшем случае — на целый блок.

Заимствование шифртекста

Заимствование шифртекста — еще один способ шифрования сообщения, длина которого не кратна размеру блока. Этот способ сложнее и не так популярен, как дополнение, но предлагает как минимум три преимущества:

• открытый текст может иметь любую длину в битах, а не только в байтах. Например, можно зашифровать сообщение длиной 131 бит;
• длина шифртекста совпадает с длиной открытого текста;
• заимствование шифртекста не уязвимо к атакам на оракул дополнения, которые иногда оказываются успешны против CBC с дополнением (как мы увидим в разделе «Атаки на оракул дополнения» ниже).

В режиме CBC с заимствованием шифртекста последний неполный блок открытого текста дополняется битами из предыдущего блока шифртекста, после чего получившийся блок зашифровывается. Последний неполный блок шифртекста включает начальные биты предыдущего блока шифртекста, т. е. те, которые не были дописаны в конец последнего блока открытого текста.