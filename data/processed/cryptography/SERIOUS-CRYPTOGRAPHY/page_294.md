---
source_image: page_294.png
page_number: 294
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.30
tokens: 7845
characters: 2324
timestamp: 2025-12-24T09:18:39.561328
finish_reason: stop
---

По счастью, подобные катастрофы редко случаются в таких известных приложениях, как Gmail или iCloud, которые хорошо защищены и часто хранят закрытые ключи в отдельном модуле безопасности. Атаки на уязвимости веб-приложений, например с внедрением запросов к базе данных или межсайтового скриптинга, более распространены, поскольку не зависят от безопасности TLS и выполняются по легитимному TLS-соединению. Такие атаки могут скомпрометировать имена и пароли пользователей и т. п.

Скомпрометированный клиент

TLS-безопасность окажется под угрозой и тогда, когда удаленный противник скомпрометировал клиента, например браузер. Добившись в этом успеха, противник сможет захватить сеансовые ключи, читать любые дешифрированные данные и т. д. Он даже сможет установить сертификат фальшивого УЦ в браузер клиента и таким образом заставить браузер безропотно принимать недействительные сертификаты и перехватывать контроль над TLS-соединениями.

Большая разница между скомпрометированным сервером или УЦ и скомпрометированным клиентом заключается в том, что в последнем случае страдает только один, а не все клиенты.

Дефекты реализации

Как и любая криптографическая система, TLS может вести себя неправильно, если в реализации имеются дефекты. Ходячий пример дефектов TLS — атака Heartbleed (см. рис. 13.3), вызывающая переполнение буфера в реализации второстепенной функции TLS — контрольном сигнале (heartbeat) — в пакете OpenSSL. Heartbleed была обнаружена в 2014 году независимо сотрудником Google и компанией Codenomicon. Она затронула миллионы серверов и клиентов TLS.

Как показано на рис. 13.3, клиент сначала отправляет буфер и его длину серверу, чтобы проверить, работает ли сервер. В этом примере в буфере находится строка BANANAS, и клиент явно сообщает, что длина этого слова — семь букв. Сервер читает семибуквенное слово и возвращает его клиенту.

Клиент
Если ты еще там, отправь мне 7-буквенное слово BANANAS
BANANAS

Сервер
Память сервера
CLIENT_WANTS_7_LETTERS:
BANANAS..PRIVATE_KEY=1928
1249128319283812994851123
189123123812312312...

Если ты еще там, отправь мне 200-буквенное слово BANANAS
BANANAS..PRIVATE_KEY = 192812491283192838129

Память сервера
CLIENT_WANTS_200_LETTERS:
BANANAS..PRIVATE_KEY=1928
1249128319283812994851123
189123123812312312...

Рис. 13.3. Ошибка Heartbleed в реализации TLS в OpenSSL