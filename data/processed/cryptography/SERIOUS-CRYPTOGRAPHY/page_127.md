---
source_image: page_127.png
page_number: 127
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 43.04
tokens: 7915
characters: 2683
timestamp: 2025-12-24T09:13:41.372991
finish_reason: stop
---

Выглядит слишком просто, чтобы обеспечить безопасность, и тем не менее криптоаналитикам понадобилось 20 лет, чтобы найти дефекты, допускающие эксплуатацию. До обнаружения этих дефектов мы знали только о слабых местах RC4 в конкретных реализациях, в частности в первом стандарте шифрования Wi-Fi, WEP.

RC4 в WEP

WEP, протокол безопасности Wi-Fi первого поколения, в настоящее время полностью взломан из-за недостатков в конструкции протокола и в RC4.

В реализации WEP алгоритм RC4 применяется для шифрования полезной нагрузки кадров 802.11, дейтаграмм (или пакетов), транспортирующих данные по беспроводной сети. Вся полезная нагрузка доставляется в одном сеансе с применением одного и того же секретного ключа длиной 40 или 104 бита, но имеет предположительно уникальное 3-байтовое одноразовое число, являющееся частью заголовка кадра (той части кадра, в которой хранятся метаданные и которая предшествует самой полезной нагрузке). Видите, в чем проблема?

Проблема в том, что RC4 не поддерживает одноразовых чисел, по крайней мере о них нет ни слова в официальной спецификации, а потоковый шифр нельзя использовать без одноразового числа. Проектировщики WEP обошли это ограничение следующим образом: включили 24-битовое одноразовое число в заголовок беспроводного кадра и дописали его в начало ключа WEP, предполагая использовать как секретный ключ RC4. То есть если одноразовое число занимает байты N[0], N[1], N[2], а ключ WEP — байты K[0], K[1], K[2], K[3], K[4], то сам ключ RC4 будет равен N[0], N[1], N[2], K[0], K[1], K[2], K[3], K[4]. Предполагалось, что 40-битовые секретные ключи должны давать 64-битовые эффективные ключи, а 104-битовые ключи — 128-битовые эффективные ключи. А что на самом деле? Объявленный 128-битовым протокол WEP фактически обеспечивает только 104-битовую безопасность, в лучшем случае.

Но у этого трюка с одноразовыми числами в WEP есть и реальные проблемы.

• 24 бита — слишком мало для одноразовых чисел. Это означает, что если одноразовое число случайно выбирается для каждого нового сообщения, то спустя приблизительно \(2^{24/2} = 2^{12}\) пакетов, или всего несколько мегабайтов трафика, мы встретим два пакета, зашифрованных с одним и тем же одноразовым числом и, стало быть, имеющих одинаковую гамму. Даже если одноразовое число — счетчик, пробегающий значения от 0 до \(2^{24} - 1\), повторение случится после передачи нескольких гигабайтов данных, и тогда повторившееся случайное число позволит противнику дешифрировать пакеты. Но есть и более серьезная проблема.

• Комбинирование одноразового числа с ключом описанным выше способом позволяет определить ключ. Три несекретных байта одноразового числа в WEP открывают возможность найти