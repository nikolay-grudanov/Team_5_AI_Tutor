---
source_image: page_079.png
page_number: 79
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.05
tokens: 7945
characters: 2548
timestamp: 2025-12-24T09:12:18.575819
finish_reason: stop
---

Генерирование асимметричных ключей

Асимметричные ключи обычно длиннее обеспечиваемого ими уровня безопасности. Но главная проблема не в этом. Асимметричные ключи труднее генерировать, потому что недостаточно получить n бит от PRNG и на этом успокоиться. Асимметричный ключ — это не просто последовательность битов, а объект определенного типа, например большое число, обладающее нужными свойствами (в RSA это произведение двух простых чисел). Маловероятно, что случайная битовая строка (а стало быть, случайное число) будет обладать свойствами, необходимыми, чтобы считаться допустимым ключом.

Для генерирования асимметричного ключа псевдослучайные биты нужно подать на вход алгоритма генерирования ключа. По этому начальному значению, длина которого должна быть не меньше требуемого уровня безопасности, алгоритм строит закрытый ключ и соответствующий ему открытый ключ, так чтобы эта пара удовлетворяла всем обязательным критериям. Например, наивный алгоритм генерирования ключей для RSA сгенерировал бы число n = pq, воспользовавшись алгоритмом нахождения двух простых чисел примерно одинаковой длины. Этот алгоритм пробует случайные числа, пока какое-нибудь не окажется простым, поэтому нам понадобится алгоритм для проверки простоты числа.

Чтобы не заниматься самостоятельной реализацией алгоритма генерирования ключей, можно воспользоваться пакетом OpenSSL и сгенерировать, например, 4096-битовый закрытый ключ RSA:

$ openssl genrsa 4096
Generating RSA private key, 4096 bit long modulus
...............................................................
.....................++.........................................
e is 65537 (0x10001)
-----BEGIN RSA PRIVATE KEY-----
MIJKQIBAAKCAgEA3Qgm60jMy61YVstaGawk22A9LyMXhiQUU4N8F5QZXeef2PjqvTtAIA1hzpK2AJsv16INpNkYcTjNmechAJ0xHraft06cp2pZFP85dvknsMfUoe8ubtKXZiYvJwpS0fQQ4tzlDtH45Gj8sMHcwFxTO3HSIx0XV0owfJTLmzZbSE3TDln+JdW8d9Xd5UVB+o9gUCI8tSfn0jF2dhllNiOhlFT4w0Rf+G35USIyUJZtOQ0Dh8M+
--опущено--
z0/dbYtqRkMT8Ubb/0Q1IW0q8e0WnFetzkwPzAIjwZGXT0kWJu3RYj10XbTYDr2cxBRVC/ujoDL603NaqPxkWY5HJVmkyKIE5pC04RFNyaQ8+o4APyobabPMylQq5Vo5N5L2c4mhy1/0H8fvKBRDuvCk2oZinjdoKUo8ZA5D0a4pdvIQfR+b4/4Jjsx4
-----END RSA PRIVATE KEY-----

Обратите внимание, что ключ записывается в определенном формате — данные в кодировке base64, обрамленные маркерами BEGIN RSA PRIVATE KEY и END RSA PRIVATE KEY. Это стандартный формат, поддерживаемый большинством систем, которые затем преобразуют это представление в последовательность байтов. Точки в начале выдачи индицируют ход выполнения, а e is 65537 (0x10001) — параметр, ис-