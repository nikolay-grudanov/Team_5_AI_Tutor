---
source_image: page_232.png
page_number: 232
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.10
tokens: 7825
characters: 2251
timestamp: 2025-12-24T09:16:44.186361
finish_reason: stop
---

4. Положить \( L = 00 \ldots 00 \| 01 \| R \) — последовательность байтов 00, за которой следует байт 01 и \( R \), а байтов 00 столько, чтобы длина \( L \) составляла \( m - h - 1 \) байт (ширина \( m \) модуля в байтах за вычетом длины хеша и единицы).
5. Положить \( L = L \oplus \text{Hash2}(H) \), заменив предыдущее значение \( L \) новым.
6. Преобразовать \( m \)-байтовую строку \( P = L \| H \| \text{ВС} \) в число \( x \), меньшее \( n \). Здесь байт ВС — фиксированное значение, дописанное после \( H \).
7. Для полученного значения \( x \) вычислить функцию RSA \( x^d \bmod n \), она и будет подписью.

Чтобы верифицировать подпись заданного сообщения \( M \), следует вычислить \( \text{Hash1}(M) \) и воспользоваться открытым показателем степени \( e \) для выделения \( L \) и \( H \), а затем \( M' \) из подписи, проверяя на каждом шаге правильность дополнения.

На практике длина случайной строки \( R \) (называемой солью в стандарте RSA-PSS) обычно такая же, как длина хеш-значения. Например, если используется \( n = 2048 \) бит и SHA-256 в качестве функции хеширования, то длина \( L \) равна \( m - h - 1 = 256 - 32 - 1 = 223 \) байта, а длина случайной строки \( R \) обычно равна 32 байта.

Как и OAEP, схема PSS доказуемо безопасна, стандартизована и широко применяется. И так же, как OAEP, она выглядит беспричинно усложненной, из-за чего возможны ошибки реализации и нерасмотренные редкие случаи. Но, в отличие от RSA-шифрования, есть способ избежать этой излишней сложности, применив схему подписания, в которой даже PRNG не нужен, и тем самым уменьшить риск появления небезопасных подписей, вызванный небезопасным PRNG. Читайте дальше.

Подписи на основе полного хеша домена

Полный хеш домена (Full Domain Hash — FDH) — простейшая мыслимая схема цифровой подписи. Для ее реализации мы просто преобразуем байтовую строку \( \text{Hash}(M) \) в число \( x \) и создаем подпись \( y = x^d \bmod n \), как показано на рис. 10.4.

![RSA-подписание сообщения методом полного хеша домена](https://i.imgur.com/3Q5z5QG.png)

Рис. 10.4. RSA-подписание сообщения методом полного хеша домена

Верификация подписи также не вызывает трудностей. Имея подпись — число \( y \), мы вычисляем \( x = y^e \bmod n \) и сравниваем результат