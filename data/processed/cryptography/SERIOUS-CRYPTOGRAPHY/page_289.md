---
source_image: page_289.png
page_number: 289
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 46.59
tokens: 7934
characters: 2582
timestamp: 2025-12-24T09:18:39.507419
finish_reason: stop
---

менее эффективен, чем GCM) и потоковый шифр ChaCha20 в сочетании с имитовставкой Poly1305 (определенной в RFC 7539). Поскольку TLS 1.3 не позволяет задать небезопасную длину ключа, например 64 или 80 бит (то и другое слишком мало), то секретный ключ может иметь длину 128 бит (AES-GCM или AES-CCM) или 256 бит (AES-GCM или ChaCha20-Poly1305).

Функция формирования ключа (KDF) на рис. 13.1 основана на HKDF, построении на основе HMAC (см. главу 7), определенном в RFC 5869; в нем используется хеш-функция SHA-256 или SHA-384.

Варианты выполнения операции Диффи–Хеллмана (на основе протокола квитирования в TLS 1.3) ограничены эллиптической криптографией и мультипликативной группой целых чисел по простому модулю (как в традиционном протоколе Диффи–Хеллмана). Но нельзя использовать любую эллиптическую кривую или группу: поддерживаются только три кривые NIST, а также кривые Curve25519 (обсуждалась в главе 12) и Curve448, определенные в RFC 7748. TLS 1.3 поддерживает еще протокол DH над группой целых чисел, а не над эллиптическими кривыми. Конкретно поддерживается пять групп, определенных в RFC 7919: с модулями длиной 2048, 3072, 4096, 6144 и 8192 бит.

2048-битовая группа, вероятно, является самым слабым звеном TLS 1.3. Считается, что она обеспечивает уровень безопасности меньше 100 бит, тогда как остальные варианты дают по меньшей мере 128-битовую безопасность. Поэтому решение о поддержке 2048-битовой группы можно расценить как не согласованное с остальными проектными решениями TLS 1.3.

Улучшения TLS 1.3 по сравнению с TLS 1.2

Протокол TLS 1.3 очень сильно отличается от своего предшественника. Прежде всего он избавился от слабых алгоритмов типа MD5, SHA-1, RC4 и AES в режиме CBC. Кроме того, если в TLS 1.2 записи часто защищались с помощью комбинации шифра и MAC (например, HMAC-SHA-1) в рамках построения MAC-затем-шифрование, то TLS 1.3 поддерживает только более эффективные и безопасные шифры с аутентификацией. TLS 1.3 также отказался от согласования кодировки точек эллиптической кривой и определяет единственный формат точек для всех кривых.

Одной из главных целей разработки TLS 1.3 было исключение из версии 1.2 функциональности, ослаблявшей протокол, и уменьшение сложности, а значит, и поверхности атаки. Например, из TLS 1.3 исключено факультативное сжатие данных, из-за которого стала возможной атака CRIME на TLS 1.2. В этой атаке использовался тот факт, что длина сжатого сообщения раскрывает информацию о его содержимом.

Однако в TLS 1.3 включены также новые возможности, позволяющие сделать соединение более безопасным или более эффективным.