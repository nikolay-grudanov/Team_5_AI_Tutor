---
source_image: page_135.png
page_number: 135
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.05
tokens: 7659
characters: 1969
timestamp: 2025-12-24T09:13:37.856751
finish_reason: stop
---

известны одноразовое число \( N \) и счетчик \( Ctr \) (см. рис. 5.10), то для обращения вычисления гаммы и получения начального состояния нужен только ключ \( K \). Но, как показано на рис. 5.13, если известна лишь какая-то часть \( K \), то можно частично обратить вычисление до четвертого раунда и наблюдать некоторые биты этого промежуточного состояния — включая смещенный бит! Увидеть смещение можно, только если правильно угадан частичный ключ, поэтому наличие смещения — признак того, что ключ правилен.

![Принцип атаки на Salsa20/8](https://i.imgur.com/3Q5z5QG.png)

Рис. 5.13. Принцип атаки на Salsa20/8

В реальной атаке на Salsa20/8, чтобы определить, верна ли догадка, нужно угадать 220 бит ключа и понадобится \( 2^{31} \) пар блоков гаммы, все с одинаковым конкретным различием в одноразовом числе. Выделив 220 правильных бит, остальные 36 бит можно найти полным перебором. Полный перебор требует \( 2^{36} \) операций — вычисление, мизерное по сравнению с неосуществимыми \( 2^{220} \times 2^{31} = 2^{251} \) попытками, необходимыми для определения 220 бит при выполнении первой части атаки.

Какие возможны проблемы

К сожалению, потоковые шифры подвержены различным проблемам, от хрупкой и небезопасной конструкции до неправильной реализации криптостойких алгоритмов. В следующих разделах я рассмотрю примеры потенциальных проблем из каждой категории.

Повторное использование одноразового числа

Самая распространенная ошибка в потоковых шифрах — чисто любительская: она возникает, когда одноразовое число используется более одного раза с одним и тем же ключом. В этом случае получаются одинаковые гаммы, что позволяет взломать шифр, применив к двум шифртекстам операцию XOR. Тогда гамма взаимно уничтожается, и остается результат XOR двух открытых текстов.

Например, в старых версиях Microsoft Word и Excel использовалось уникальное одноразовое число для каждого документа, но это число не изменялось при модификации документа. В результате откры-