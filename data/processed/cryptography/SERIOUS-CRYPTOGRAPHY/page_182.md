---
source_image: page_182.png
page_number: 182
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.26
tokens: 7800
characters: 2574
timestamp: 2025-12-24T09:15:07.356281
finish_reason: stop
---

ет использовать MAC, основанную на необратимой функции сжатия, а не на перестановке.

Для дополнительного чтения

Достопочтенная HMAC заслуживает больше внимания, чем я могу уделять в этой книге, особенно чтобы осветить ход мыслей, который сначала привел к ее широкому признанию, а затем к отказу в случае комбинации со слабой хеш-функцией. Я рекомендую статью Bellare, Canetti, and Krawczyk «Keying Hash Functions for Message Authentication» 1996 года, в которой впервые описана HMAC и ее близкая родственница NMAC, а также ее продолжение — статью Bellare «New Proofs for NMAC and HMAC: Security Without Collision-Resistance» 2006 года, в которой доказывается, что HMAC не нуждается в хеш-функции, стойкой к коллизиям, а лишь в хеш-функции, для которой функция сжатия псевдослучайная. С другой стороны, в статье Fouque, Leurent, and Nguyen «Full Key-Recovery Attacks on HMAC/NMAC-MD4 and NMAC-MD5» 2007 года показано, как атаковать HMAC и NMAC, основанные на уязвимой хеш-функции типа MD4 или MD5. (Кстати говоря, нельзя сказать, что HMAC-MD5 и HMAC-SHA-1 совсем никуда не годятся, но риск достаточно велик.)

Имитовставки Вегмана–Картера также достойны более пристального внимания как в силу практического интереса, так и благодаря лежащей в их основе теории. Основополагающие работы Вегмана и Картера можно скачать по адресу http://cr.yp.to/bib/entries.html. Из числа более современных проектов упомянем UMAC и VMAC — одни из самых быстрых MAC для длинных сообщений.

В этой главе не обсуждалась MAC Pelican, в которой блочный шифр AES, сокращенный до четырех раундов (вместо 10 в полной версии шифра), используется для аутентификации блоков сообщений с помощью довольно простого построения,писанного по адресу https://eprint.iacr.org/2005/088/. Впрочем, Pelican — скорее, курьез, который на практике применяется редко.

И последнее: если вас интересуют поиск уязвимостей в криптографическом ПО, поищите места, где используется CBC-MAC, или слабости, вызванные обработкой в HMAC ключей произвольного размера — взятие в качестве ключа Hash(K) вместо K, если K слишком длинный, в результате чего K и Hash(K) становятся эквивалентными ключами. Или просто поищите системы, которые не используют MAC, хотя должны бы, — довольно частая ситуация.

В главе 8 мы рассмотрим, как можно объединить MAC с шифрами для защиты подлинности, целостности и конфиденциальности сообщения. Мы также обсудим, как это можно сделать без MAC благодаря шифрам с аутентификацией, которые сочетают функциональность базового шифра с функциональностью MAC, возвращая жетон вместе с каждым шифртекстом.