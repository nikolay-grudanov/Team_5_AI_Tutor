---
source_image: page_134.png
page_number: 134
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 42.43
tokens: 7950
characters: 2346
timestamp: 2025-12-24T09:13:50.122376
finish_reason: stop
---

3ab3c25d 9f40a5c9 10070e30 07bd03c0
db1ee2ce 43ee9401 21a702c3 48fd800c
403c1e72 00034003 4dc843be 700b8857
5625b75b 09c00e00 06000348 23f712d4

После четырех раундов различия кажутся человеку случайными, и статистический анализ тоже показывает, что они почти случайны:

d93bed6d a267bf47 760c2f9f 4a41d54b
0e03d792 7340e010 119e6a00 e90186af
7fa9617e b6aca0d7 4f6e9a4a 564b34fd
98be796d 64908d32 4897f7ca a684a2df

Итак, понадобилось всего четыре раунда, чтобы различие в одном бите распространилось на большую часть 512-битового состояния. В криптографии это называется полной диффузией.

Мы видели, что в раундах Salsa20 различия распространяются быстро. Но мало того, что различия распространяются по всему состоянию, они еще и описываются сложными уравнениями, которые затрудняют предсказания будущих различий из-за своей нелинейности, обусловленной смесью операций XOR, сложения и циклического сдвига. Если бы использовались только операции XOR, то различия также распространялись бы быстро, но процесс оказался бы линейным, а потому небезопасным.

Атака на Salsa20/8

В Salsa20 по умолчанию выполняется 20 раундов, но иногда для ускорения используется всего 12 раундов — эта версия называется Salsa20/12. Хотя в Salsa20/12 на восемь раундов меньше, чем в Salsa20, он все равно криптографически гораздо более стойкий, чем ослабленный вариант Salsa20/8 с восьмью раундами, который используется реже.

Для взлома Salsa20 в идеале понадобилось бы \(2^{256}\) операций, поскольку ключ 256-битовый. Если ключ можно восстановить, выполнив меньше \(2^{256}\) операций, то теоретически шифр можно считать взломанным. Именно так обстоит дело с Salsa20/8.

Атака на Salsa20/8 (опубликованная в 2008 году в статье «New Features of Latin Dances: Analysis of Salsa, ChaCha, and Rumba», соавтором которой я являюсь и которая получила приз за криптоанализ от Дэниеля Дж. Бернштейна) эксплуатирует статистическое смещение в базовом алгоритме Salsa после четырех раундов для нахождения ключа восьмираундового Salsa20. На самом деле эта атака носит в основном теоретический характер: мы оценили ее сложность как \(2^{251}\) вычислений базовой функции — это все равно невозможно, хотя и меньше ожидаемой сложности \(2^{256}\) операций.

В атаке эксплуатируется не только смещение первых четырех раундов Salsa20/8, но и свойство последних четырех раундов: если