---
source_image: page_107.png
page_number: 107
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.30
tokens: 7826
characters: 2328
timestamp: 2025-12-24T09:13:01.650214
finish_reason: stop
---

Как видим, атаку MitM можно применить к 3DES почти так же, как и к двойному DES, только на третьем этапе нужно будет перебрать все \(2^{112}\) комбинаций \(K_2\) и \(K_3\). Поэтому атака заведомо достигнет успеха после \(2^{112}\) операций, а значит, 3DES обеспечивает только 112-битовую безопасность, хотя длина ключа равна 168 бит.

**Атаки на оракул дополнения**

В заключение этой главы рассмотрим одну из самых простых и вместе с тем самых разрушительных атак 2000-х годов: атаку на оракул дополнения. Напомним, что под дополнением понимается включение лишних байтов в последний блок открытого текста. Например, открытый текст, содержащий 111 байт, состоит из шести 16-байтовых блоков, за которыми следует еще 15 байт. Для формирования полного блока нужно добавить байт 01. В случае 110-байтового блока нужно добавить два байта 02 и т. д.

Оракул дополнения — это система, которая ведет себя по-разному в зависимости от того, является ли корректным дополнение в шифртексте, созданном в режиме CBC. Можно рассматривать его как черный ящик или API, возвращающий код успеха или ошибки. Оракул дополнения можно найти в любой службе на удаленном сервере, которая отправляет сообщения об ошибке, получив некорректно сформированный шифртекст. При заданном оракуле дополнения атака на него запоминает, какие входные данные дополнены правильно, а какие нет, и использует эту информацию, чтобы дешифрировать подобраные шифртексты.

Допустим, мы хотим дешифрировать блок \(C_2\) шифртекста. Обозначим \(X\) искомое значение, т. е. \(D(K, C_2)\), и пусть \(P_2\) — блок, полученный после дешифрирования в режиме CBC (см. рис. 4.13). Если выбрать случайный блок \(C_1\) и отправить состоящий из двух блоков шифртекст \(C_1 \| C_2\) оракулу, то дешифрирование окажется успешным, только если \(C_1 \oplus P_2 = X\) заканчивается корректным дополнением — одним байтом 01, двумя байтами 02, тремя байтами 03 и т. д.

![Рис. 4.13. Атака на оракул дополнения восстанавливает X путем выбора C_1 и проверки корректности дополнения](https://i.imgur.com/3Q5z5QG.png)

Основываясь на этом наблюдении, можно с помощью атаки на оракул дополнения дешифрировать блок \(C_2\), зашифрованный в режиме CBC, следующим образом (байты обозначены, как в массиве: \(C_1[0]\) — первый байт \(C_1\), \(C_1[1]\) — второй байт, ..., \(C_1[15]\) — последний байт):