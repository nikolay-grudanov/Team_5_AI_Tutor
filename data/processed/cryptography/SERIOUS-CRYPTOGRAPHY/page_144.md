---
source_image: page_144.png
page_number: 144
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.49
tokens: 7690
characters: 2149
timestamp: 2025-12-24T09:13:57.818415
finish_reason: stop
---

n кроликов, то при n > m по крайней мере в одной клетке окажется более одного кролика.

Примечание Этот принцип можно обобщить и на другие предметы и контейнеры. Например, любая последовательность 27 слов в Конституции США содержит по крайней мере два слова, начинающихся с одной буквы. В мире хеш-функций клетками являются хеш-значения, а кроликами — сообщения. Поскольку мы знаем, что сообщений гораздо больше, чем хеш-значений, коллизии обязательно будут.

Однако, вопреки очевидному, коллизии должно быть так же трудно найти, как исходное сообщение, только тогда хеш-функция будет считаться стойкой к коллизиям. Иными словами, противник не должен иметь возможность найти два разных сообщения с одинаковым хеш-значением.

Понятие стойкости к коллизиям связано с понятием стойкости к восстановлению второго прообраза: если для хеш-функции можно найти вторые прообразы, то можно найти и коллизии, как доказывает псевдокод в листинге 6.3.

Листинг 6.3. Наивный алгоритм поиска коллизий

solve-collision() {
    M = random_message()
    return (M, solve-second-preimage(M))
}

То есть любая стойкая к коллизиям хеш-функция является также стойкой к восстановлению второго прообраза. Если бы это было не так, то мы имели бы алгоритм восстановления второго прообраза, который позволил бы обойти стойкость к коллизиям.

Нахождение коллизий

Найти коллизии можно быстрее, чем прообразы, поскольку для этого требуется порядка \(2^{n/2}\), а не \(2^n\) операций вследствие атаки на основе парадокса дней рождения, идея которой заключается в следующем: если дано N сообщений и столько же хеш-значений, то можно породить \(N \times (N - 1)/2\) потенциальных коллизий, рассматривая каждую пару хеш-значений (их количество имеет порядок \(N^2\)). Эта атака обычно иллюстрируется так называемым парадоксом дней рождений, согласно которому вероятность того, что в группе из 23 человек найдутся двое, родившихся в один день, равна 1/2.

Примечание \(N \times (N - 1)/2\) — это количество пар различных сообщений, которое мы делим на 2, потому что пары \((M_1, M_2)\) и \((M_2, M_1)\) считаются одинаковыми. Иными словами, порядок следования в паре нам безразличен.