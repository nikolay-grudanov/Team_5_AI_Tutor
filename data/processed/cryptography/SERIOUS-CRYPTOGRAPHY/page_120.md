---
source_image: page_120.png
page_number: 120
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.34
tokens: 7774
characters: 2098
timestamp: 2025-12-24T09:13:20.382619
finish_reason: stop
---

Grain-128a

Помните конкурс на звание AES, который мы обсуждали в главе 4 применительно к блочному шифру AES? Потоковый шифр Grain — продукт аналогичного конкурса под названием eSTREAM. Этот конкурс закрылся в 2008 году, и в результате был сформирован короткий список кандидатов на звание рекомендованного потокового шифра: четыре аппаратных и четыре программных. Grain — один из четырех аппаратных шифров, а Grain-128а — его усовершенствованная версия, разработанная теми же авторами. На рис. 5.8 показан механизм работы Grain-128а.

![Механизм работы шифра Grain-128а](https://i.imgur.com/3Q5z5QG.png)

Рис. 5.8. Механизм работы шифра Grain-128а, состоящего из 128-битового NFSR и 128-битового LFSR

Как видно по рис. 5.8, шифр Grain-128а настолько прост, насколько это возможно для потокового шифра; он сочетает 128-битовый LFSR, 128-битовый NFSR и функцию фильтра h. LFSR имеет максимальный период \(2^{128} - 1\), это гарантирует, что период всей системы не меньше \(2^{128} - 1\), и, стало быть, защищает от потенциально коротких циклов в NFSR. В то же время NFSR и нелинейная функция фильтра h обеспечивают криптографическую стойкость.

Grain-128а принимает 128-битовый ключ и 96-битовое одноразовое число. Он копирует 128 бит ключа в 128 бит состояния NFSR, а 96 бит одноразового числа в первые 96 бит состояния LFSR, заполняя следующий 31 бит единицами и добавляя в конце один нуль. На этапе инициализации вся система обновляется 256 раз, и только после этого возвращается первый бит гаммы. Поэтому на этапе инициализации бит, возвращенный функцией h, не выводится в состав гаммы, а поступает в LFSR, гарантируя, что следующее состояние зависит одновременно от ключа и одноразового числа.

Функция обратной связи LFSR в шифре Grain-128а имеет вид

\[
f(L) = L_{32} + L_{47} + L_{58} + L_{90} + L_{121} + L_{128},
\]

где \(L_1, L_2, ..., L_{128}\) — биты LFSR. Эта функция использует только 6 бит из 128-битового LFSR, но этого достаточно для получения примитивного полинома, гарантирующего максимальный период. Благодаря небольшому числу битов уменьшается стоимость аппаратной реализации.