---
source_image: page_198.png
page_number: 198
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.61
tokens: 7739
characters: 2470
timestamp: 2025-12-24T09:15:30.314330
finish_reason: stop
---

![Шифр с аутентификацией на основе перестановки](../images/8.4.png)

Рис. 8.4. Шифр с аутентификацией на основе перестановки

**Примечание** Режим, показанный на рис. 8.4, можно адаптировать для поддержки ассоциированных данных, но этот процесс довольно сложный, поэтому его описание мы опустим.

При проектировании шифров с аутентификацией на основе перестановки необходимо соблюсти некоторые требования, обеспечивающие безопасность. Во-первых, отметим, что с помощью XOR мы объединяем входные значения только с частью состояния: чем больше эта часть, тем сильнее контроль противника над внутренним состоянием в случае успешной атаки, а значит, тем ниже безопасность шифра. В самом деле, безопасность целиком зависит от секретности внутреннего состояния.

Кроме того, блоки нужно надлежащим образом дополнять битами, так чтобы любые два разных сообщения давали разные результаты. Так, если последний блок открытого текста короче полного блока, то его не следует дополнять нулями, в противном случае двухбайтовый блок открытого текста 0000 был бы дополнен до полного блока 0000...0000, как и трехбайтовый блок 0000000. В результате жетоны обоих сообщений совпали бы, хотя их размер разный.

А что, если одноразовое число используется в шифре на основе перестановки несколько раз? Хорошая новость заключается в том, что последствия не так серьезны, как в случае GCM или OCB, — стойкость аутентификационного жетона не будет скомпрометирована. Если одноразовое число повторяется, то противник сможет узнать только, что два зашифрованных сообщения начинаются одинаковым префиксом, а также длину этого префикса. Например, хотя шифрование двух шестиблочных сообщений ABCXYZ и ABCDYZ (здесь каждая буква соответствует блоку) с одним и тем же одноразовым числом может дать два шифртекста JKLTUV и JKLMNO с одинаковыми префиксами, противник не сможет узнать, что последние два блока обоих открытых текстов совпадают (YZ).

Что касается производительности, то у шифров на основе перестановок имеются такие преимущества: один уровень операций, возможность потоковой обработки и использование одного базового алгоритма для шифрования и дешифрирования. Однако они не допускают распараллеливания, как GCM или OCB, потому что следующее обращение к P возможно только после завершения предыдущего.

**Примечание** Если вы испытываете искушение взять свою любимую перестановку и на ее основе создать собственный шифр с аутентификацией, не делайте этого. Скорее всего, вы напортачите в де-