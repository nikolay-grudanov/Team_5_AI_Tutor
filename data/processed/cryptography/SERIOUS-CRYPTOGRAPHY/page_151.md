---
source_image: page_151.png
page_number: 151
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.15
tokens: 7828
characters: 2534
timestamp: 2025-12-24T09:14:15.134061
finish_reason: stop
---

одних нулей) \( H_0 \) применяется операция XOR. Все блоки сообщения одинакового размера, меньшего, чем размер внутреннего состояния.

2. Перестановка \( \mathbf{P} \) преобразует внутреннее состояние в другое значение того же размера.

3. Оно объединяется с блоком \( M_2 \) операцией XOR, после чего снова применяется \( \mathbf{P} \). Это повторяется для блоков \( M_3, M_4 \) и т. д. Процесс называется фазой впитывания.

4. После обработки всех блоков сообщения губка применяет перестановку \( \mathbf{P} \) еще раз и выделяет из состояния блок битов, образующих хеш. (Если нужен более длинный хеш, то нужно применить \( \mathbf{P} \) еще раз и выделить блок.) Это называется фазой выжимания.

Безопасность функции губки зависит от длины ее внутреннего состояния и длины блоков. Если блоки сообщения \( r \)-битовые, а внутреннее состояние \( w \)-битовое, то существует \( c = w - r \) бит внутреннего состояния, которые невозможно модифицировать с помощью блоков сообщения. Значение \( c \) называется емкостью губки, а уровень безопасности, гарантироваемый функцией губки, равен \( c/2 \). Например, чтобы добиться 256-битовой безопасности при 64-битовых блоках сообщения, внутреннее состояние должно иметь длину \( w = 2 \times 256 + 64 = 576 \) бит. Разумеется, уровень безопасности зависит также от длины \( n \) хеш-значения. Поэтому сложность атаки нахождения коллизий равна минимуму из чисел \( 2^{n/2} \) и \( 2^{c/2} \), а сложность атаки восстановления второго прообраза — минимуму из \( 2^n \) и \( 2^{c/2} \).

Чтобы считаться безопасной, перестановка \( \mathbf{P} \) должна вести себя как случайная, т. е. не быть статистически смещенной и не иметь математической структуры, которая позволила бы противнику предсказывать выходы. Как и хеш-функции на основе функций сжатия, функции губки нуждаются в дополнении сообщений, но дополнение в этом случае проще, потому что длину сообщения включать не нужно. За последним битом сообщения просто дописывается бит 1, а затем необходимое количество нулей.

Семейство хеш-функций SHA

Функции хеширования семейства Secure Hash Algorithm (SHA) определены стандартом NIST для применения невоенными федеральными агентствами в США. Он считается международным стандартом, и лишь некоторые страны применяют собственные алгоритмы хеширования (например, SM3 в Китае, Streebog в России и Кируна на Украине) по причинам, связанным с суверенитетом, а не отсутствием доверия к безопасности SHA. Американский стандарт SHA более скрупулезно изучен криптоаналитиками, чем другие стандарты.