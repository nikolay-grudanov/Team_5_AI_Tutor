---
source_image: page_245.png
page_number: 245
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 44.51
tokens: 7947
characters: 2544
timestamp: 2025-12-24T09:17:14.458067
finish_reason: stop
---

разделяемый секрет, он передается функции формирования ключа (key derivation function – KDF), чтобы та сгенерировала один или несколько разделяемых симметричных ключей. KDF — это разновидность хеш-функции, которая возвращает кажущуюся случайной строку, размер которой равен желаемой длине ключа.

Вот, собственно, и все. Как и многие другие научные открытия (всемирное тяготение, теория относительности, квантовые вычисления или RSA), протокол Диффи–Хеллмана задним числом кажется на удивление простым.

Но простота DH может быть обманчива. Прежде всего он работает не с любым простым \( p \) или основанием \( g \). Например, при некоторых значениях \( g \) разделяемый секрет \( g^{ab} \) ограничен небольшим подмножеством возможных значений, тогда как мы ожидаем, что их будет столько же, сколько элементов в группе \( \mathbb{Z}_p^* \). Для обеспечения наивысшей безопасности простое число \( p \) нужно выбирать так, чтобы \( (p - 1)/2 \) тоже было простым. Такое безопасное простое число гарантирует, что у группы не будет небольших подгрупп, что облегчило бы взлом DH. Если \( p \) безопасно, то DH может работать с \( g = 2 \), что немного ускоряет вычисления. Но для генерирования безопасного простого числа \( p \) нужно больше времени, чем для генерирования случайного простого числа.

Например, команда dhparam из пакета OpenSSL генерирует только безопасные параметры DH, но встроенные в алгоритм проверки заметно увеличивают время выполнения, как показано в листинге 11.1.

Листинг 11.1. Измерение времени генерирования параметров 2048-битового протокола Диффи–Хеллмана с помощью пакета OpenSSL

$ time openssl dhparam 2048
Generating DH parameters, 2048 bit long safe prime, generator 2
This is going to take a long time
--опущено--
-----BEGIN DH PARAMETERS-----
MIIBCAKCAQEaSIbyA9e844q7V89rcoEV8vd/l2svwhIIjG9EPwWWr7FkfYhYkU9fRNttmilGCTfxc9EDf+4dzw+AbRBc6o0L9gxUoPn0d1/G/YDYgypLF5M3xeswqeaSD+B7628pWTaCZGKZham7vmiN8azGeaYAucckTkjVWceHVIVXe5fvU74k7+C2wKkiiyMFm8th2zm9W/shiKNV2+SsHtD6r3ZC2/hfu7Xd0I4iT6ise83YicU/cRaDmK6zgBKn3SlCjwL4M3+m1J+Vh0UFz/nWTJ1IWAVC+aoLK8upqRgAp0gHkVqzP/CgwBwXA0E8ncQqroJ0mUSB5eLqfpAvyBWpkrwQwIBAg==
-----END DH PARAMETERS-----
openssl dhparam 2048 154.53s user 0.86s system 99% cpu 2:36.85 total

Как видно, для генерирования параметров понадобилось 154.53 секунды. Для сравнения в листинге 11.2 показано, сколько в той же самой системе ушло времени на генерирование параметров RSA такого же размера (двух простых чисел \( p \) и \( q \), размер каждого из которых равен примерно половине размера \( p \)).