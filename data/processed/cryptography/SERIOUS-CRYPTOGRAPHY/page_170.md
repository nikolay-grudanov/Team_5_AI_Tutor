---
source_image: page_170.png
page_number: 170
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.11
tokens: 7676
characters: 1903
timestamp: 2025-12-24T09:14:39.706674
finish_reason: stop
---

если функция сжатия внутри хеш-функции псевдослучайная. Во всех безопасных протоколах связи — IPSec, SSH и TLS — используется HMAC. (Спецификации HMAC приведены в стандарте NIST FIPS 198-1 и в документе RFC 2104.)

В HMAC для вычисления аутентификационного жетона используется функция хеширования, Hash, показанная на рис. 7.1 и определяемая следующим выражением:

\[
\text{Hash}((K \oplus opad) || \text{Hash}((K \oplus ipad) || M)).
\]

Здесь opad (внешнее дополнение) — строка вида (5c5c5c...5c), длина которой равна длине блока Hash. Ключ K обычно короче одного блока, он дополняется байтами 00 и объединяется с opad операцией XOR. Например, если K — однобайтовая строка 00, то K ⊕ opad = opad (то же самое верно, если K — строка произвольной длины, не превышающей длину блока, состоящая из одних нулей). K ⊕ opad — первый блок, обрабатываемый внешним вызовом Hash, а именно левым вызовом Hash в приведенном выше выражении, или нижним хешированием на рис. 7.1.

ipad (внутреннее дополнение) — строка вида (363636...36), длина которой равна длине блока Hash и которая тоже дополняется байтами 00. Результирующий блок — первый блок, обрабатываемый внутренним вызовом Hash, а именно правым вызовом Hash в выражении выше, или верхним хешированием на рис. 7.1.

![Построение имитовставки на основе функции хеширования](https://i.imgur.com/3Q5z5QG.png)

Рис. 7.1. Построение имитовставки на основе функции хеширования

**Примечание** Метод конверта — более безопасное построение, чем секретный префикс или суффикс. Он описывается выражением Hash(K||M||K), иногда называемым бутербродной имитовставкой, но теоретически менее безопасен, чем HMAC.

Если в роли Hash выступает хеш-функция SHA-256, то такой экземпляр HMAC называется HMAC-SHA-256. Вообще, HMAC-Hash называется экземпляр HMAC с хеш-функцией Hash. Это значит, что если вас попросят использовать HMAC, то следует спросить: «С какой хеш-функцией?»