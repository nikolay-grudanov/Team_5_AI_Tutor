---
source_image: page_190.png
page_number: 190
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.62
tokens: 7824
characters: 2772
timestamp: 2025-12-24T09:15:27.522268
finish_reason: stop
---

ры: одноуровневая и двухуровневая. В двухуровневой структуре (например, в широко распространенном шифре AES-GCM) один алгоритм обрабатывает открытый текст, а затем другой алгоритм обрабатывает результат. Как правило, на первом уровне находится шифрование, а на втором — аутентификация. Но легко понять, что двухуровневая структура усложняет реализацию и ведет к замедлению.

Шифр с аутентификацией допускает потоковую обработку (употребляют также термин онлайновый), если он может обрабатывать сообщение блок за блоком и отбрасывать уже обработанные блоки. С другой стороны, шифры, не допускающие потоковой обработки, должны хранить сообщение целиком, обычно вследствие того, что необходимо два прохода по данным: один от начала до конца, а второй — от конца к началу данных, полученных после первого прохода.

Из-за потенциально высокого потребления памяти некоторые приложения не могут работать с шифрами, не допускающими потоковой обработки. Например, маршрутизатор мог бы получить зашифрованный блок данных, дешифрировать его и вернуть блок открытого текста, перед тем как переходить к дешифрированию следующего блока, хотя получателю дешифрированного сообщения все равно нужно будет проверить аутентификационный жетон, находящийся в конце дешифрированного потока данных.

Функциональные критерии

Функциональные критерии — это свойства шифра или его реализации, не связанные напрямую с безопасностью или производительностью. Например, некоторые шифры с аутентификацией позволяют размещать ассоциированные данные только перед данными, подлежащими шифрованию (потому что их необходимо знать, чтобы приступить к шифрованию). Другие требуют, чтобы ассоциированные данные располагались после шифруемых, или поддерживают размещение ассоциированных данных в любом месте — даже между блоками открытого текста. Последняя возможность считается наилучшей, потому что позволяет пользователям защитить свои данные в любой мыслимой ситуации, но и реализовать ее безопасно труднее всего. Как всегда, чем больше возможностей, тем выше сложность, а вместе с ней и количество потенциальных уязвимостей.

Еще один куст функциональных критериев связан с тем, можно ли использовать один и тот же базовый алгоритм и для шифрования, и для дешифрирования. Например, многие шифры с аутентификацией основаны на блочном шифре AES, в котором для шифрования и дешифрирования блока применяются похожие алгоритмы. В главе 4 мы обсуждали, что блочный шифр в режиме CBC нуждается в обоих алгоритмах, а в режиме CTR — только в алгоритме шифрования. Так и шифры с аутентификацией необязательно нуждаются в обоих алгоритмах. Хотя дополнительные затраты на реализацию двух алгоритмов — шифрования и дешифрирования — обычно несущественны при программной реализации, они часто влияют на стоимость специали-