---
source_image: page_078.png
page_number: 78
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.31
tokens: 7678
characters: 2189
timestamp: 2025-12-24T09:11:59.840922
finish_reason: stop
---

Генерирование ключей

Если вы планируете что-то зашифровать, то нужно будет сгенерировать ключи — временные «сеансовые» (типа тех, что генерируются при посещении HTTPS-сайта) или открытые на длительный срок. Напомним (см. главу 2), что секретные ключи лежат в основе криптографической безопасности и должны генерироваться случайным образом, так чтобы их нельзя было предсказать.

Например, при заходе на HTTPS-сайт ваш браузер получает открытый ключ сайта и с его помощью генерирует симметричный ключ, действующий только на время текущего сеанса, тогда как открытый ключ сайта и ассоциированный с ним закрытый ключ могут действовать на протяжении многих лет. Поэтому было бы лучше, если бы противник не смог узнать закрытый ключ. Но генерирование секретного ключа не всегда сводится к простому получению достаточного числа псевдослучайных битов. Криптографические ключи могут генерироваться одним из трех способов:

• случайно, с помощью генератора псевдослучайных чисел (PRNG) и при необходимости алгоритма генерирования ключей;
• из пароля, с помощью функции формирования ключа (key derivation function — KDF), которая преобразует указанный пользователем пароль в ключ;
• посредством протокола совместной выработки ключа, состоящего из серии обмена сообщениями между двумя или более сторонами, которая завершается выработкой общего ключа.

Сейчас я объясню только простейший метод: случайное генерирование.

Генерирование симметричных ключей

Симметричный ключ — это секретный ключ, известный обеим сторонам. Такие ключи генерировать проще всего. Обычно они имеют такую же длину, как обеспечиваемый ими уровень безопасности: 128-битовый ключ обеспечивает 128-битовую безопасность, и любой из \(2^{128}\) возможных ключей ничем не хуже любого другого.

Чтобы сгенерировать симметричный \(n\)-битовый ключ с помощью криптографически стойкого PRNG, нужно просто запросить \(n\) псевдослучайных бит и использовать их в качестве ключа. Например, для генерирования случайного симметричного ключа можно воспользоваться пакетом OpenSSL; следующая команда выводит псевдослучайные биты (понятно, что на вашей машине результат будет другой):

$ openssl rand 16 -hex
65a4400ea649d282b855bd2e246812c6