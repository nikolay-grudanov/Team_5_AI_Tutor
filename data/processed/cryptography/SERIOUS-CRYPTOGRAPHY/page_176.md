---
source_image: page_176.png
page_number: 176
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.74
tokens: 7824
characters: 2294
timestamp: 2025-12-24T09:14:58.481739
finish_reason: stop
---

Имитовставки Вегмана–Картера

Способ аутентификации нескольких сообщений с помощью универсальной функции хеширования придумали исследователи из IBM Вегман и Картер и описали в статье «New Hash Functions and Their Use in Authentication and Set Equality», опубликованной в 1981 году. В построении Вегмана–Картера МАС строится с помощью универсальной хеш-функции и PRF с использованием двух ключей, \( K_1 \) и \( K_2 \), по формуле

\[
\text{MAC}(K_1, K_2, N, M) = \text{UH}(K_1, M) + \text{PRF}(K_2, N),
\]

где \( N \) — одноразовое число, уникальное для каждого ключа \( K_2 \), а длина выхода PRF совпадает с длиной результата универсальной функции хеширования UH. За счет сложения обоих значений стойкая псевдослучайная функция PRF маскирует криптографическую слабость UH. Это можно рассматривать как шифрование результата универсальной функции хеширования, где PRF играет роль потокового шифра и предотвращает описанную выше атаку, делая возможной аутентификацию нескольких сообщений одним и тем же ключом \( K_1 \).

Подведем итог: построение Вегмана–Картера \( \text{UH}(K_1, M) + \text{PRF}(K_2, N) \) дает безопасную МАС при следующих предположениях:

• UH — безопасная универсальная функция хеширования;
• PRF — безопасная PRF;
• каждое одноразовое число \( N \) используется ровно один раз для каждого ключа \( K_2 \);
• выходные значения UH и PRF достаточно длинные, чтобы обеспечить надлежащую безопасность.

Теперь посмотрим, как в алгоритме Poly1305 построение Вегмана–Картера используется для создания безопасной и быстрой МАС.

Poly1305-AES

Алгоритм Poly1305 первоначально был предложен как Poly1305-AES, т. е. универсальная функция хеширования Poly1305 сочеталась с блочным шифром AES. Poly1305-AES гораздо быстрее МАС на основе HMAC и даже CMAC, потому что вычисляет только один блок AES и обрабатывает сообщение параллельно, выполняя серию простых арифметических операций.

Если даны 128-битовые \( K_1, K_2, N \) и сообщение \( M \), то Poly1305-AES возвращает следующее выражение:

\[
\text{Poly1305}(K_1, M) + \text{AES}(K_2, N)\bmod 2^{128}.
\]

Деление на \( 2^{128} \) гарантирует, что результат поместится в 128 бит. Сообщение \( M \) обрабатывается как последовательность 128-битовых блоков (\( M_1, M_2, ..., M_n \)), и в конец каждого блока дописывается 129-й бит,