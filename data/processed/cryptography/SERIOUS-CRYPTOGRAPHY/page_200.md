---
source_image: page_200.png
page_number: 200
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.97
tokens: 7744
characters: 1838
timestamp: 2025-12-24T09:15:38.643191
finish_reason: stop
---

Тогда из формулы GHASH

\[
X_i = (X_{i-1} \oplus C_i) \otimes H
\]

получаем

\[
X_1 = (X_0 \oplus C_1) \otimes H = (0 \oplus 1) \otimes H = H,
\]

поскольку при подстановке 0 вместо \( X_0 \) и 1 вместо \( C_1 \) имеем:

\[
(0 \oplus 1) = 1.
\]

Пользуясь свойством дистрибутивности \( \otimes \) относительно \( \oplus \), подставляем \( H \) вместо \( X \) и 1 вместо \( C_2 \) и вычисляем следующее значение \( X_2 \)

\[
X_2 = (X_1 \oplus C_2) \otimes H = (H \oplus 1) \otimes H = H^2 \oplus H,
\]

где \( H^2 \) по определению равно \( H \otimes H \).

Теперь выведем \( X_3 \):

\[
X_3 = (X_2 \oplus C_3) \otimes H = (H^2 \oplus H \oplus 1) \otimes H = H^3 \oplus H^2 \oplus H.
\]

Далее мы находим, что \( X^4 = H^4 \oplus H^3 \oplus H^2 \oplus H \), и так далее. В итоге получается, что последнее \( X_i \) равно:

\[
X_n = H^n \oplus H^{n-1} \oplus H^{n-2} \oplus ... H^2 \oplus H.
\]

Вспомним, что мы предположили, что все блоки \( C_i \) равны 1. Если бы они могли принимать произвольные значения, то вместо этой формулы мы получили бы такую:

\[
X_n = C_1 \otimes H^n \oplus C_2 \otimes H^{n-1} \oplus C_3 \otimes H^{n-2} \oplus ... \oplus C_{n-1} \otimes H^2 \oplus C_n \otimes H.
\]

Затем GHASH выполнила бы XOR этого последнего \( X_n \) с длиной сообщения, умножила бы результат на \( H \) и объединила бы через XOR с AES(K, N||0) — это и был бы аутентификационный жетон \( T \).

Где собака зарыта?

И что же здесь может пойти не так? Рассмотрим сначала два простейших случая:

• если \( H = 0 \), то \( X_n = 0 \) вне зависимости от значений \( C_i \), а значит, и вне зависимости от сообщения. Следовательно, при \( H \), равном 0, у всех сообщений будет одинаковый жетон;
• если \( H = 1 \), то жетон равен результату применения XOR ко всем блокам шифртекста, и при изменении порядка этих блоков жетон не изменится.