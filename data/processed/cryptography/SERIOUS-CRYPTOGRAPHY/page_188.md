---
source_image: page_188.png
page_number: 188
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.85
tokens: 7824
characters: 2548
timestamp: 2025-12-24T09:15:17.074772
finish_reason: stop
---

Поскольку аутентификационный жетон зависит от \( A \), дешифрирование с ассоциированными данными вычисляется как \( ADAD(K, C, A, T) = (P, A) \). Для дешифрирования необходим ключ, шифртекст, ассоциированные данные и жетон. Если \( C \) или \( A \) повреждены, дешифрирование завершается неудачно.

Отметим, что при использовании AEAD \( A \) или \( P \) можно оставить пустыми. Если ассоциированные данные \( A \) не заданы, то AEAD превращается в обычный шифр с аутентификацией, а если не задан \( P \), то мы имеем просто MAC.

**Примечание** На момент написания этой книги AEAD считается нормой для шифрования с аутентификацией. Поскольку почти все используемые в настоящее время шифры с аутентификацией поддерживают ассоциированные данные, все упоминания шифров с аутентификацией в этой книге на самом деле относятся к AEAD, если только явно не оговорено противное. Говоря об операциях шифрования и дешифрирования в AEAD, я буду обозначать их соответственно \( AE \) и \( AD \).

**Предотвращение предсказуемости с помощью одноразовых чисел**

Напомним (см. главу 1), что для того, чтобы считаться безопасной, схема шифрования должна быть непредсказуемой и возвращать разные шифртексты при повторных вызовах для шифрования одного и того же открытого текста; в противном случае противник сможет определить, что дважды был зашифрован один и тот же текст. Для обеспечения непредсказуемости блочным и потоковым шифрам передается дополнительный параметр: начальное значение (IV) или одноразовое число, которое можно использовать только один раз. В шифрах с аутентификацией используется такой же прием. Поэтому шифрование с аутентификацией можно выразить в виде \( AE(K, P, A, N) \), где \( N \) — одноразовое число. Ответственность за выбор одноразового числа, которое раньше никогда не использовалось с этим ключом, возлагается на операцию шифрования.

Как и в случае блочных и потоковых шифров, дешифрирование шифра с аутентификацией требует одноразового числа, использованного при шифровании. Поэтому дешифрирование можно описать формулой \( AD(K, C, A, T, N) = (P, A) \), где \( N \) — одноразовое число, которое было использовано при создании \( C \) и \( T \).

**Какой шифр с аутентификацией считать хорошим?**

С начала 2000-х годов исследователи стараются определить, что такое хороший шифр с аутентификацией, и сейчас, когда я пишу эти строки, ответ все еще ускользает. Из-за большого количества входных данных AEAD, играющих разные роли, определить понятие безопасности труднее, чем для обычных шифров, которые только зашифровывают сооб-