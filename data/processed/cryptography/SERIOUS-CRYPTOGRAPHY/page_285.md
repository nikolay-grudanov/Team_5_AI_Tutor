---
source_image: page_285.png
page_number: 285
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.04
tokens: 7700
characters: 2252
timestamp: 2025-12-24T09:18:18.137717
finish_reason: stop
---

кой доверия при первом использовании (trust-on-first-use – TOFU)), принятой в SSH.

Протокол записи

Все данные, которыми стороны обмениваются по протоколу TLS 1.3, передаются в виде последовательности записей TLS, т. е. пакетов данных. Протокол записи TLS (уровень записи) — это, по сути дела, транспортный протокол, ничего не знающий о семантике транспортируемых данных; именно в силу этой особенности TLS пригоден для любых приложений.

Впервые протокол записи TLS используется для передачи данных в процессе квитирования. После того как связь подтверждена и обе стороны знают секретный ключ, данные приложения разбиваются на порции, которые передаются в составе записей TLS.

Структура записи TLS

Запись TLS — это блок данных размером не более 16 килобайт, имеющий следующую структуру.

• Первый байт представляет тип передаваемых данных, он равен 22 для данных квитирования, 23 для зашифрованных данных и 21 для уведомлений. В спецификации TLS 1.3 это значение называется ContentType (тип содержимого).
• Второй и третий байты равны соответственно 3 и 1. Они фиксированы по историческим причинам и не являются уникальной особенностью версии TLS 1.3. В спецификации это 2-байтовое значение называется ProtocolVersion (версия протокола).
• Четвертый и пятый байты кодируют длину передаваемых данных 16-битовым числом, которое не может быть больше \(2^{14}\) (16 КБ).
• Остальные байты — это передаваемые данные (полезная нагрузка), их длина равна значению, закодированному в четвертом и пятом байтах записи.

Примечание Запись TLS имеет сравнительно простую структуру. Как мы видели, заголовок записи состоит всего из трех полей. Для сравнения пакет протокола IPv4 содержит 14 полей, предшествующих полезной нагрузке, а в сегменте TCP таких полей 13.

Если первый байт записи TLS 1.3 (ContentType) равен 23, то полезная нагрузка зашифрована и аутентифицирована с помощью шифра с аутентификацией. Полезная нагрузка состоит из шифртекста и аутентификационного жетона, которые принимающая сторона должна будет дешифрировать. Но откуда получатель знает тип шифра и ключ? Это обеспечивает TLS: если вы получили зашифрованную запись TLS, значит, уже знаете шифр и ключ, потому что они были согласованы в процессе выполнения протокола подтверждения связи.