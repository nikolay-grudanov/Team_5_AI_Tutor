---
source_image: page_142.png
page_number: 142
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.46
tokens: 7894
characters: 2699
timestamp: 2025-12-24T09:14:04.235722
finish_reason: stop
---

Стойкость к восстановлению прообраза

Прообразом данного хеш-значения \( H \) является любое сообщение \( M \) такое, что \( \text{Hash}(M) = H \). Стойкость к восстановлению прообраза означает, что противник, знающий случайное хеш-значение, не сможет найти его прообраз. Иногда хеш-функции называют односторонними функциями, потому что перейти от сообщения к хешу легко, а в обратную сторону невозможно.

Прежде всего отметим, что хеш-функцию невозможно обратить даже при наличии неограниченной вычислительной мощности. Предположим, к примеру, что я хешировал некоторое сообщение функцией SHA-256 и получил такое 256-битовое хеш-значение:

f67a58184cef99d6dfc3045f08645e844f2837ee4bfcc6c949c9f7674367adfd

Даже при наличии неограниченной вычислительной мощности вы никогда не сможете определить, какое именно сообщение породило этот хеш, потому что существует много сообщений с одинаковым хешем. Вы могли бы найти какие-то сообщения, порождающие данное хеш-значение (и, возможно, среди них будет выбранное мной), но никогда не сможете точно сказать, какое сообщение я выбрал.

Например, существует \( 2^{256} \) возможных значений 256-битового хеша (типичная длина практически используемых хеш-функций), но гораздо больше, скажем, 1024-битовых сообщений (а именно \( 2^{1024} \) возможных значений). Отсюда следует, что в среднем у каждого из возможных 256-битовых хеш-значений будет \( 2^{1024} / 2^{256} = 2^{1024 - 256} = 2^{768} \) прообразов длиной 1024 бита.

На практике мы должны быть уверены в практической невозможности найти хотя бы одно сообщение, отображаемое на данное хеш-значение, а не только сообщение, которое фактически было использовано, именно это понимается под стойкостью к восстановлению прообраза. Точнее, речь может идти о стойкости к восстановлению первого и второго прообразов. Стойкость к восстановлению первого прообраза (или просто стойкость к восстановлению прообраза) означает, что практически невозможно найти сообщение, имеющее данное хеш-значение. А стойкость к восстановлению второго прообраза означает, что для данного сообщения \( M_1 \) практически невозможно найти другое сообщение \( M_2 \) с таким же хеш-значением.

Стоимость восстановления прообразов

Если известны хеш-функция и хеш-значение, то первые прообразы можно поискать, проверяя различные сообщения, пока не будет найдено сообщение с таким же хеш-значением. Для этого служит алгоритм типа find-preimage() в листинге 6.1.

В листинге 6.1 функция random_message() генерирует случайное сообщение (скажем, 1024-битовое). Очевидно, что find-preimage() никогда не завершится, если длина хеша в битах, \( n \), достаточно велика, потому что для нахождения прообраза нужно в среднем \( 2^n \) попыток.