---
source_image: page_155.png
page_number: 155
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 40.31
tokens: 7907
characters: 2289
timestamp: 2025-12-24T09:14:25.832105
finish_reason: stop
---

SHA-256

Побудительным мотивом для разработки SHA стало желание генерировать более длинные хеши и тем самым обеспечить более высокий уровень безопасности, чем SHA-1. Например, если в SHA-1 цепные значения 160-битовые, то в SHA-256 они занимают 256 бит, т. е. восемь 32-битовых слов. И SHA-1, и SHA-256 работают с 512-битовыми блоками сообщений, но если SHA-1 выполняет 80 раундов, то SHA-256 — 64 раунда, расширяя 16-словный блок сообщения в 64-словный с помощью функции expand256(), показанной в листинге 6.8.

Листинг 6.8. Функция expand256() из SHA-256

expand256(M) {
    // 512-битовый блок M рассматривается как массив шестнадцати 32-битовых слов
    W = пустой массив, содержащий 64 32-битовых слова
    for i = 0 to 63 {
        if i < 16 then W[i] = M[i]
        else {
            // the “>>” — сдвиг вправо, тогда как “>>>” — циклический сдвиг
            // вправо, это не опечатка
            s0 = (W[i - 15] >>> 7) ⊕ (W[i - 15] >>> 18) ⊕ (W[i - 15] >> 3)
            s1 = (W[i - 2] >>> 17) ⊕ (W[i - 2] >>> 19) ⊕ (W[i - 2] >> 10)
            W[i] = W[i - 16] + s0 + W[i - 7] + s1
        }
    }
    return W
}

Заметим, что функция расширения сообщения expand256() в SHA-2 сложнее, чем функция expand() в SHA-1 (см. листинг 6.6), которая выполняет только XOR и циклический сдвиг на 1 бит. Главный цикл функции сжатия в SHA-256 тоже сложнее, чем в SHA-1, в нем выполняется 26 арифметических операций, а не 11. Операциями являются XOR, логическое AND и циклический сдвиг слова.

Другие алгоритмы семейства SHA-2

Функция SHA-224 из семейства SHA-2 алгоритмически идентична SHA-256, только в качестве начального значения берется другое множество восьми 32-битовых слов, а длина хеш-значения составляет не 256 бит, а 224 — первые 224 бита последнего цепного значения.

Семейство SHA-2 включает также алгоритмы SHA-512 и SHA-384. SHA-512 похож на SHA-256, но работает с 64-битовыми, а не 32-битовыми словами. Поэтому используются 512-битовые цепные значения (восемь 64-битовых слов), блоки сообщения имеют длину 1024 бита (шестнадцать 64-битовых слов), а количество раундов равно 80, а не 64. Функция сжатия почти такая же, как в SHA-256, хотя из-за более широких слов величины циклических сдвигов другие. (Например, SHA-512 включает операцию a >>> 34, которая не имеет смысла для