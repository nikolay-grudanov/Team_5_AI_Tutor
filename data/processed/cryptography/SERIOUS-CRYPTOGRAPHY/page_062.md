---
source_image: page_062.png
page_number: 62
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.84
tokens: 7728
characters: 2111
timestamp: 2025-12-24T09:11:33.699599
finish_reason: stop
---

Какие возможны проблемы

В заключение я покажу несколько примеров ошибок из-за неправильной работы с генераторами случайных чисел. Выбирать тут есть из чего, но я остановился на примерах, которые просты для понимания и иллюстрируют различные проблемы.

Плохие источники энтропии

В 1996 году в реализации SSL в браузере Netscape вычисление 128-битовых начальных значений PRNG было основано на псевдокоде, показанном в листинге 2.6 (скопирован из статьи Голдберга и Вагнера по адресу http://www.cs.berkeley.edu/~daw/papers/ddj-netscape.html).

Листинг 2.6. Псевдокод генерирования 128-битовых начальных значений PRNG в браузере Netscape

global variable seed;

RNG_CreateContext()
    (seconds, microseconds) = time of day; /* время, прошедшее с 1970 года */
    pid = process ID; ppid = parent process ID;
    a = mklcpr(microseconds);
    b = mklcpr(pid + seconds + (ppid << 12));
    seed = MD5(a, b); /* получение 128-битового значения */
        /* с помощью функции хеширования MD5 */

mklcpr(x) /* с точки зрения криптографии, не важна; показана для полноты */
    return ((0xDEECE66D * x + 0x2BBB62DC) >> 1);

MD5() /* очень хорошая стандартная функция перемешивания, исходный код опущен */

Проблема здесь в том, что идентификаторы процессов и число микросекунд — значения, которые можно угадать. В предположении, что значение seconds известно, существует всего \(10^6\) возможных значений microseconds, поэтому энтропия равна \(\log(10^6)\), т. е. приблизительно 20 бит. Идентификатор процесса (PID) и родительского процесса (PPID) — 15-битовые значения, что дает еще 15 + 15 = 30 бит энтропии. Но, внимательно приглядевшись к способу вычисления b в точке ①, мы увидим, что перекрытие трех бит оставляет всего лишь около 15 + 12 = 27 бит энтропии, так что полная энтропия равна только 47 бит, тогда как в 128-битовом начальном значении должно быть 128 бит энтропии.

Недостаточная энтропия на этапе начальной загрузки

В 2012 году исследователи просканировали весь интернет и собрали коллекцию открытых ключей из TLS-сертификатов SSH-хостов. Обнаружилось несколько систем с одинаковыми открытыми ключа-