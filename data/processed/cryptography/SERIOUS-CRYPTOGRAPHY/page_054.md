---
source_image: page_054.png
page_number: 54
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 52.90
tokens: 8059
characters: 2866
timestamp: 2025-12-24T09:11:45.515902
finish_reason: stop
---

ги) в PHP, Python, R, Ruby и многих других системах. МТ генерирует равномерно распределенные случайные биты, статистически несмещенные, но предсказуемые: зная несколько битов, порожденных МТ, не слишком сложно предсказать следующие.

Рассмотрим, что именно делает вихрь Мерсенна небезопасным. Алгоритм МТ гораздо проще криптографически стойких PRNG: в качестве внутреннего состояния используется массив S, состоящий из 624 32-битовых слов. Первоначально массив содержит элементы S_1, S_2, ..., S_{624}, затем S_2, ..., S_{625}, далее S_3, ..., S_{626} и т. д., вычисляемые по формуле

\[
S_{k+624} = S_{k+397} \oplus A((S_k \land 0x80000000) \lor (S_{k+1} \land 0x7fffffff)).
\]

Здесь \( \oplus \) обозначает поразрядную операцию XOR (^ в языке программирования C), \( \land \) — поразрядное AND (& в C), \( \lor \) — поразрядное OR (| в C), а A — функция, преобразующая 32-битовое слово x в (x >> 1), если старший бит x равен 0, или в (x >> 1) \( \oplus \) 0x9908b0df в противном случае.

Обратите внимание, что в этой формуле биты S взаимодействуют друг с другом только посредством операций XOR. Операторы \( \land \) и \( \lor \) никогда не объединяют два бита S, а только биты S с константами 0x80000000 и 0x7fffffff. Таким образом, любой бит S_{625} можно выразить как результат применения XOR к битам S_{398}, S_1 и S_2, и вообще любой бит будущего состояния — в виде результата применения XOR к битам начального состояния S_1, ..., S_{624}. (В выражении S_{228+624} = S_{852} в виде функции от S_{625}, S_{228} и S_{229} можно заменить S_{625} его выражением через S_{398}, S_1 и S_2.)

Поскольку в начальном состоянии имеется ровно 624 × 32 = 19 968 бит (или 624 32-битовых слова), то любой выходной бит можно выразить в виде формулы, содержащей не более 19 969 членов (19 968 бит плюс один постоянный бит). Это примерно 2,5 килобайта данных. Обратное также верно: биты начального состояния можно выразить в виде результата применения XOR к выходным битам.

Небезопасность линейности

Мы называем XOR-комбинацию битов линейной комбинацией. Например, если X, Y и Z — биты, то выражение X \( \oplus \) Y \( \oplus \) Z является линейной комбинацией, а (X \( \land \) Y) \( \oplus \) Z не является из-за присутствия оператора AND (\( \land \)). Если изменить значение бита X на противоположное, то результат вычисления X \( \oplus \) Y \( \oplus \) Z тоже изменится вне зависимости от значений Y и Z. С другой стороны, если изменить на противоположное значение бита X в выражении(X \( \land \) Y) \( \oplus \) Z, то результат изменится, лишь если бит Y в той же позиции равен 1. Таким образом, линейные комбинации предсказуемы, поскольку необязательно знать значения битов, чтобы предсказать, как их изменение отразится на результате.

Если бы алгоритм МТ был криптографически стойким, то его формулы были бы нелинейными и включали бы не только отдельные биты,