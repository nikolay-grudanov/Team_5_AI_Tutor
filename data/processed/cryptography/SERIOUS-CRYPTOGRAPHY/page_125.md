---
source_image: page_125.png
page_number: 125
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.80
tokens: 7771
characters: 2432
timestamp: 2025-12-24T09:13:24.721131
finish_reason: stop
---

исполнения серверами или браузерами, работающими на персональных компьютерах, где мощные процессоры общего назначения выполняют алгоритм шифра как обычную программу.

В настоящее время значительный интерес к программным потоковым шифрам объясняется несколькими причинами. Во-первых, поскольку многие устройства оснащаются мощными процессорами и оборудование дешевеет, отпадает нужда в компактных бит-ориентированных шифрах. Например, оба потоковых шифра, являющихся частью стандарта мобильной связи 4G (европейский SNOW3G и китайский ZUC), оперируют 32-битовыми словами, а не битами, как устаревший A5/1.

Во-вторых, программные потоковые шифры приобрели популярность в противовес блочным шифрам, и особенно после фиаско с атакой на оракул дополнения против блочных шифров в режиме CBC. Кроме того, потоковые шифры проще специфицировать и реализовать, чем блочные: вместо смешивания битов сообщения и ключа потоковые шифры просто вставляют биты ключа в качестве секрета. На самом деле один из самых популярных потоковых шифров фактически является замаскированным блочным шифром: AES в режиме счетчика (CTR).

В одном из способов построения потоковых шифров, применяемом в SNOW3G и ZUC, копируются аппаратные шифры с их FSR, только биты заменяются байтами или словами. Но не они представляют наибольший интерес для криптографа. На момент написания этой книги наибольший интерес вызывали шифры RC4 и Salsa20, используемые в многочисленных системах, несмотря на то что один из них полностью взломан.

RC4

Спроектированный в 1987 году Роном Ривестом из компании RSA Security, затем подвергнутый обратной разработке и опубликованный во всех деталях в 1994 году, RC4 долгое время был самым популярным потоковым шифром. RC4 использовался в бесчисленных приложениях, из которых самые известные — первый стандарт шифрования Wi-Fi, Wired Equivalent Privacy (WEP), и протокол Transport Layer Security (TLS), применяемый для установления HTTPS-соединений. К сожалению, RC4 недостаточно безопасен для большинства приложений, включая WEP и TLS. Чтобы понять, почему, посмотрим, как RC4 работает.

Как работает RC4

RC4 — один из самых простых когда-либо созданных шифров. В нем нет никаких криптографических операций — ни XOR, ни умножений, ни S-блоков... ничего. Он просто меняет местами байты. Внутренним состоянием RC4 является массив S из 256 байт, элементы которого первоначально равны S[0] = 0, S[1] = 1, S[2] = 2, ..., S[255] = 255, а за-