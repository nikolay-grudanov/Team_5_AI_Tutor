---
source_image: page_256.png
page_number: 256
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.83
tokens: 7669
characters: 1974
timestamp: 2025-12-24T09:17:26.268272
finish_reason: stop
---

В результате оба владеют разделяемым секретом. Боб теперь думает, что общается с Алисой.

![Диаграмма атаки с подменой на протокол Диффи–Хеллмана с аутентификацией](https://i.imgur.com/3Q5z5QG.png)

Рис. 11.5. Атака с подменой на протокол Диффи–Хеллмана с аутентификацией

Один из способов защитить DH с аутентификацией от утечки эфемерных секретов — включить долговременные секреты в вычисление разделяемого секрета, так чтобы разделяемый секрет нельзя было определить, не зная долговременного.

Протокол Менезеса–Кью–Вэнстоуна

Протокол Менезеса–Кью–Вэнстоуна (MQV) — веха в истории протоколов на основе DH. Спроектированный в 1998 году, MQV одобрен для защиты самых важных активов, АНБ включило его в свой Комплект В — набор алгоритмов, предназначенных для защиты секретной информации. (В конечном итоге АНБ исключило MQV предположительно потому, что он не использовался. Ниже я еще поговорю о причинах.)

MQV — это усовершенствованный протокол Диффи–Хеллмана. Он безопаснее DH с аутентификацией и лучше последнего по производительности. В частности, MQV разрешает пользователям отправлять только два сообщения, независимо друг от друга и в произвольном порядке. Есть и другие преимущества: пользователи могут обмениваться более короткими сообщениями, чем в DH с аутентификацией, и не обязаны отправлять явно сообщения с подписью и о ее верификации. Иными словами, необязательно использовать схему подписания в дополнение к функции Диффи–Хеллмана.

Как и в DH с аутентификацией, в MQV Алиса и Боб хранят свой долговременный закрытый ключ, а также долговременный открытый ключ другой стороны. Разница в том, что в MQV ключи используются не для подписания, а состоят из закрытого показателя степени x и открытого значения \( g^x \). На рис. 11.6 показано, как работает протокол MQV.

На рис. 11.6 x и y — долговременные закрытые ключи Алисы и Боба соответственно, а X и Y — их открытые ключи. Вначале Боб и Алиса располагают своими собственными закрытыми ключами и открыты-