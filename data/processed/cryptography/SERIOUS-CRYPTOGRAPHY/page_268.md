---
source_image: page_268.png
page_number: 268
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.51
tokens: 8036
characters: 2768
timestamp: 2025-12-24T09:17:58.208696
finish_reason: stop
---

Формула для определения координат \((x_R, y_R)\) точки \(R = P + P\) немного отличается от формулы в случае разных \(P\) и \(Q\). Базовые формулы \(x_R = m^2 - x_P - x_Q, y_R = m(x_P - x_R) - y_P\) остаются такими же, но значение \(m\) другое; оно равно \((3x_P^2 + a) / 2y_P\), где \(a\) — параметр кривой — коэффициент при \(x\) в уравнении \(y^2 = x^3 + ax + b\).

Умножение

Чтобы умножить точку на эллиптической кривой на целое число \(k\), нужно найти точку \(kP\), сложив \(P\) с собой \(k - 1\) раз. То есть \(2P = P + P,\ 3P = P + P + P\) и т. д. Для нахождения координат \(x\) и \(y\) точки \(kP\) следует применить описанное выше правило сложения несколько раз.

Однако для эффективного вычисления \(kP\) наивного применения правила сложения \(k - 1\) раз отнюдь не достаточно. Например, если \(k\) велико (скажем, порядка \(2^{256}\)), как то бывает в криптографических схемах на основе эллиптических кривых, то выполнить \(k - 1\) сложений попросту невозможно.

Но есть один трюк: экспоненциального ускорения можно достичь, применив ту же технику, что была описана в разделе «Алгоритм быстрого возведения в степень» главы 10 для вычисления \(x^e \bmod n\). Например, чтобы вычислить \(8P\) за три сложения вместо семи при наивном способе, нужно сначала вычислить \(P2 = P + P\), затем \(P_4 = P_2 + P_2\) и, наконец, \(P_4 + P_4 = 8P\).

Группы эллиптических кривых

Поскольку точки можно складывать, множество точек на эллиптической кривой образует группу¹. Согласно определению группы (см. раздел «Что такое группа?» главы 9), если точки \(P\) и \(Q\) принадлежат данной кривой, то и точка \(P + Q\) тоже ей принадлежит.

Далее, поскольку сложение ассоциативно, имеем \((P + Q) + R = P + (Q + R)\) для любых точек \(P, Q\) и \(R\). В группе эллиптической кривой единичный элемент называется бесконечно удаленной точкой и обозначается \(O\); это такой элемент, что \(P + O = P\) для любой точки \(P\). Для каждой точки \(P = (x_p, y_p)\) имеется обратная, \(-P = (x_p, -y_p)\), такая, что \(P + (-P) = O\).

На практике большинство криптосистем на основе эллиптических кривых работают с координатами \(x\) и \(y\), которые являются числами по простому модулю \(p\) (т. е. элементами конечного поля \(\mathbb{Z}_p\)). Как безопасность RSA зависит от размера используемых чисел, так и безопасность эллиптической криптосистемы зависит от количества точек на кривой. Но откуда мы знаем количество точек на эллиптической кривой, или ее мощность? Это зависит от кривой и значения \(p\).

¹ Аргументация автора весьма странна. Ему бы надо доказать, что для множества точек на эллиптической кривой выполняются аксиомы группы, а он вместо этого постулирует, что это группа, и отсюда выводит замкнутость операции сложения, ее ассоциативность и т. д. — Прим. перев.