---
source_image: page_088.png
page_number: 88
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.96
tokens: 7848
characters: 2350
timestamp: 2025-12-24T09:12:27.514816
finish_reason: stop
---

в подстановочно-перестановочные сети (substitution–permutation network – SPN).

Подстановка часто встречается в форме S-блоков, или подстановочных блоков, — небольших таблиц перекодировки для преобразования блоков длиной 4 или 8 бит. Например, первый из восьми S-блоков шифра Serpent состоит из 16 элементов (3 8 f 1 a 6 5 b e d 4 2 7 0 9 c), где каждый элемент представляет 4-битовый полубайт. Этот конкретный S-блок отображает полубайт 0000 в 3 (0011), полубайт 0101 (десятичное 5) в 6 (0110) и т. д.

Примечание S-блоки следует тщательно выбирать, обращая внимание на криптографическую стойкость: они должны быть максимально нелинейны (входы и выходы должны быть связаны сложными уравнениями) и не иметь статистического смещения (это означает, например, что изменение одного входного бита потенциально может повлиять на любой из выходных битов).

Перестановка в подстановочно-перестановочной сети может быть совсем простой, например изменение порядка битов, — такую перестановку легко реализовать, но она не очень хорошо перемешивает биты. В некоторых шифрах вместо переупорядочения битов применяется умножение на матрицы, т. е. серия операций умножения на фиксированные значения (элементы матрицы) с последующим сложением результатов. Такие линейно-алгебраические операции могут создавать зависимости между всеми битами, т. е. обеспечивают сильную диффузию. Например, в блочном шифре FOX 4-байтовый вектор \((a, b, c, d)\) преобразуется в \((a', b', c', d')\) следующим образом:

\[
\begin{align*}
a' &= a + b + c + (2 \times d); \\
b' &= a + (253 \times b) + (2 \times c) + d; \\
c' &= (253 \times a) + (2 \times b) + c + d; \\
d' &= (2 \times a) + b + (253 \times c) + d.
\end{align*}
\]

В этих формулах числа 2 и 253 интерпретируются как двоичные полиномы, а не целые числа, поэтому операции сложения и умножения определены несколько иначе, чем мы привыкли. Например, вместо \(2 + 2 = 4\) имеем \(2 + 2 = 0\). Но главное то, что каждый байт начального состояния оказывает влияние на все 4 байта конечного.

Схемы Фейстеля

В 1970-х годах сотрудник компании IBM Хорст Фейстель спроектировал блочный шифр Lucifer, работающий следующим образом:

1. Разделить 64-битовый блок на две половины по 32 бита, \(L\) и \(R\).
2. Положить \(L\) равным \(L \oplus F(R)\), где \(F\) — подстановочно-перестановочный раунд.
3. Обменять местами \(L\) и \(R\).