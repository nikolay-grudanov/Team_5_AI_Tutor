---
source_image: page_051.png
page_number: 51
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.39
tokens: 7753
characters: 2474
timestamp: 2025-12-24T09:11:23.438012
finish_reason: stop
---

называется пулом энтропии. Пул энтропии — это источник энтропии для PRNG, точно так же, как физическая среда является таковым для RNG. Обновляя пул энтропии, PRNG смешивает хранящиеся в нем биты между собой, чтобы избавиться от статистического смещения.

Для генерирования псевдослучайных битов PRNG выполняет алгоритм детерминированного генератора случайных битов (DRBG), который порождает из битов, находящихся в пуле энтропии, гораздо более длинную последовательность. Как следует из самого названия, алгоритм DRBG детерминированный, а не рандомизированный: получив одинаковые данные на входе, он возвращает одинаковые результаты на выходе. PRNG гарантирует, что его DRBG никогда не получит одинаковые входные данные дважды; это необходимо, чтобы генерируемые псевдослучайные последовательности были уникальны.

В процессе работы PRNG выполняет три операции:

• init() инициализирует пул энтропии и внутреннее состояние PRNG;
• refresh(R) обновляет пул энтропии, используя некоторые данные R, обычно получаемые от RNG;
• next(N) возвращает N псевдослучайных бит и обновляет пул энтропии.

Операция init сбрасывает PRNG в начальное состояние: заново инициализирует пул энтропии значением по умолчанию, а переменные и буферы памяти подготавливает к выполнению операций refresh и next.

Операцию refresh часто называют доинициализацией (reseeding), а ее аргумент R — начальным значением (seed). Если RNG недоступен, то в качестве начальных должны использоваться уникальные значения, зашифрованные в код системы. Обычно операцию refresh вызывает операционная система, а операцию next — приложения. Операция next выполняет DRBG и модифицирует пул энтропии, так чтобы следующий вызов гарантированно дал другие псевдослучайные биты.

Вопросы безопасности

Теперь поговорим немного о том, как PRNG решает некоторые высокоуровневые проблемы безопасности. Конкретно PRNG должен гарантировать устойчивость к ретроанализу (backtracking resistance) и устойчивость к предсказанию (prediction resistance). Устойчивость к ретроанализу (ее еще называют секретностью прошлого) означает, что невозможно восстановить ранее сгенерированные биты, а устойчивость к предсказанию (обратная секретность) — что невозможно предсказать будущие биты.

Для обеспечения устойчивости к ретроанализу PRNG должен по-заботиться о том, чтобы преобразования, выполняемые при обновлении состояния операциями refresh и next, были необратимы. Тогда, даже если противник скомпрометирует систему и узнает состояние