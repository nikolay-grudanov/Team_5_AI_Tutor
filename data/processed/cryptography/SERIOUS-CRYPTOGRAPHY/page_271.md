---
source_image: page_271.png
page_number: 271
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.40
tokens: 7782
characters: 2380
timestamp: 2025-12-24T09:17:50.039860
finish_reason: stop
---

ECDH играет ту же роль для ECDLP, что DH для DLP: он безопасен при условии, что задача ECDLP трудная. Поэтому протоколы DH, опирающиеся на DLP, можно адаптировать для работы с эллиптическими кривыми. Например, DH с аутентификацией и протокол Менезеса–Кью–Вэнстоуна (MQV) будут безопасны и на эллиптических кривых. (На самом деле MQV первоначально и был определен над эллиптическими кривыми.)

Подписание с помощью эллиптических кривых

Стандартным алгоритмом цифровой подписи в ECC является ECDSA (elliptic curve digital signature algorithm). Он заменил подписи RSA и классические подписи DSA во многих приложениях. Например, это единственный алгоритм подписания в технологии биткойна, и он же поддерживается многими реализациями TLS и SSH.

Как и все схемы цифровой подписи, ECDSA состоит из алгоритма генерирования подписи, с помощью которого пользователь создает подпись, применяя свой закрытый ключ, и алгоритма верификации, позволяющего проверить действительность подписи, зная открытый ключ подписавшего. Подписывающая сторона хранит число d — закрытый ключ, а проверяющая — открытый ключ P = dG. Обе стороны заранее знают, какую эллиптическую кривую использовать, ее порядок (n, количество точек на кривой), а также координаты базовой точки G.

Генерирование подписи в ECDSA

Чтобы подписать сообщение, подписывающая сторона сначала вычисляет хеш сообщения h с помощью криптографической функции хеширования, например SHA-256 или BLAKE2; он интерпретируется как число от 0 до n − 1. Затем эта сторона выбирает случайное число k от 1 до n − 1 и вычисляет kG, точку с координатами (x, y). После этого подписывающая сторона полагает r = x mod n и вычисляет s = (h + rd)/k mod n, а затем использует эти значения в качестве подписи, (r, s).

Длина подписи зависит от длин используемых координат. Например, если мы работаем с кривой, для которой координаты — 256-битовые числа, то r и s будут 256-битовыми, т. е. длина всей подписи составит 512 бит.

Верификация подписи в ECDSA

В алгоритме верификации используется открытый ключ подписывающей стороны для проверки действительности подписи.

Чтобы верифицировать подпись ECDSA (r, s) и хеш сообщения h, проверяющий сначала вычисляет величину w = 1/s, обратную подписи и равную k/(h + rd)mod n, т. к. s определено как s = (h + rd)/k. Затем проверяющий умножает w на h и находит u по следующей формуле:

\[
wh = hk/(h + rd) = u.
\]