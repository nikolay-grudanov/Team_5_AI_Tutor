---
source_image: page_253.png
page_number: 253
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 24.42
tokens: 7604
characters: 1702
timestamp: 2025-12-24T09:17:08.652058
finish_reason: stop
---

ния и притвориться Бобом (для Алисы) и Алисой (для Боба), как показано на рис. 11.3.

![Атака с человеком посередине на анонимный протокол Диффи–Хеллмана](https://i.imgur.com/3Q5z5QG.png)

Рис. 11.3. Атака с человеком посередине на анонимный протокол Диффи–Хеллмана

Как и в предыдущем случае, Алиса и Боб выбирают случайные показатели степени, \(a\) и \(b\). Алиса вычисляет и отправляет \(A\), но Ева перехватывает и отбрасывает это сообщение. Ева выбирает случайный показатель степени \(c\), вычисляет \(C = g^c\) и отправляет результат Бобу. Поскольку в протоколе не предусмотрена аутентификация, Боб верит, что получил \(C\) от Алисы, и вычисляет \(g^{bc}\). Затем Боб вычисляет \(B\) и отправляет его Алисе, но Ева снова перехватывает и отбрасывает сообщение. Теперь Ева вычисляет \(g^{bc}\), выбирает новый показатель степени, \(d\), вычисляет \(g^{ad}\), вычисляет \(D = g^d\) и отправляет \(D\) Алисе. Алиса тоже вычисляет \(g^{ad}\).

В результате этой атаки противник Ева разделяет один секрет с Алисой (\(g^{ad}\)), а другой с Бобом (\(g^{bc}\)), хотя Алиса и Боб полагают, что разделяют секрет между собой. После завершения протокола Алиса будет формировать симметричные ключи по \(g^{ad}\) и шифровать ими данные, отправляемые Бобу, но Ева будет перехватывать зашифрованные сообщения, дешифрировать их, перешифровывать с помощью ключей, сформированных по \(g^{bc}\), и отправлять Бобу — возможно, по пути изменяя открытый текст. И обо всем этом ни Алиса, ни Боб не подозревают. То есть они обречены.

Чтобы отразить эту атаку, необходим какой-то способ аутентификации сторон, чтобы Алиса могла доказать, что она настоящая Алиса, а Боб — что он настоящий Боб. К счастью, такой способ есть.