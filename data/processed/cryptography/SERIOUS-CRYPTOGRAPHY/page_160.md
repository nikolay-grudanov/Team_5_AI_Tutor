---
source_image: page_160.png
page_number: 160
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.42
tokens: 7722
characters: 2182
timestamp: 2025-12-24T09:14:28.921615
finish_reason: stop
---

• она должна хорошо работать на современных процессорах, поддерживающих параллельные вычисления на нескольких ядрах, а также параллелизм на уровне команд на одном ядре.

Итогом проектирования стали две функции хеширования:
• BLAKE2b (или просто BLAKE2), оптимизированная для 64-разрядных платформ, порождает дайджесты длиной от 1 до 64 байт;
• BLAKE2s, оптимизированная для 8–32-разрядных платформ, может порождать дайджесты длиной от 1 до 32 байт.

У каждой функции есть параллельный вариант, способный задействовать несколько процессорных ядер. Параллельная версия BLAKE2b, BLAKE2bp, работает на четырех ядрах, а BLAKE2sp – на восьми ядрах. Первая функция работает быстрее всех на современных серверах и ноутбуках, на ноутбуке ее быстродействие приближается к 2 Гб/с. На самом деле BLAKE2 – самая быстрая из имеющихся на сегодняшний день хеш-функций; благодаря ее скорости и функциональности она стала самой популярной среди функций, не стандартизованных NIST. BLAKE2 используется в бесчисленных приложениях и включена во все важные криптографические библиотеки, в т. ч. OpenSSL и Sodium.

Примечание Спецификации и эталонный код BLAKE2 находятся по адресу https://blake2.net/, а оптимизированный код и библиотеки можно скачать по адресу https://github.com/BLAKE2/. В эталонном коде имеется также расширение BLAKE2X, умеющее порождать хеш-значения произвольной длины.

Функция сжатия BLAKE2, показанная на рис. 6.8, – это вариант построения Дэвиса–Мейера, который принимает дополнительные параметры — счетчик (гарантирующий, что все функции сжатия ведут себя по-разному) и флаг (показывающий, обрабатывает ли функция сжатия последний блок сообщения, — это повышает безопасность).

![Рис. 6.8. Функция сжатия BLAKE2. Обе половины состояния объединяются с помощью XOR после применения блочного шифра](https://i.imgur.com/3Q5z5QG.png)

Блочный шифр в функции сжатия BLAKE2 основан на потоковом шифре ChaCha, который сам является вариантом потокового шифра Salsa20, рассмотренного в главе 5. Внутри блочного шифра базовая операция BLAKE2b состоит из следующей цепочки операций, которая преобразует четыре 64-битовых слова состояния с помощью двух слов сообщения \( M_i \) и \( M_j \):