---
source_image: page_105.png
page_number: 105
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.66
tokens: 7919
characters: 2638
timestamp: 2025-12-24T09:12:58.285270
finish_reason: stop
---

Как и начальное значение в режиме CBC, одноразовое значение в режиме CTR задается шифрующей стороной и передается вместе с шифртекстом в открытом виде. Но, в отличие от начального значения CBC, от одноразового значения CTR не требуется случайности, оно просто должно быть уникальным. А уникальность необходима по той же причине, по которой нельзя дважды использовать одноразовый блокнот: если \( P_1 \) зашифровывается в \( C_1 = P_1 \oplus S \) с помощью псевдослучайного потока \( S \), а затем \( P_2 \) зашифровывается в \( C_2 = P_2 \oplus S \) с помощью потока с тем же одноразовым числом, то, зная \( C_1 \oplus C_2 \), мы можем узнать \( P_1 \oplus P_2 \).

Случайное одноразовое число годится, если оно достаточно длинное: например, если его длина равна \( n \) бит, то велики шансы, что после \( 2^{n/2} \) шифрований и генерирования такого же количества одноразовых чисел встретятся дубликаты. Поэтому 64 бит недостаточно, т. к. можно ожидать повторения после приблизительно \( 2^{32} \) одноразовых чисел, а это недопустимо часто.

Счетчик гарантированно будет уникален, если он увеличивается на единицу для каждого нового открытого текста и при этом достаточно длинный, например 64-битовый.

Преимущество CTR в том, что он может работать быстрее любого другого режима. Мало того что он допускает распараллеливание, так еще начать шифрование можно, даже не получив сообщения, достаточно выбрать одноразовое число и вычислить поток, который впоследствии будет объединен с открытым текстом операцией XOR.

Какие возможны проблемы

Существует две атаки на блочные шифры, о которых необходимо знать: встреча посередине — техника, открытая в 1970-х годах, но все еще используемая во многих криптоаналитических атаках (не путать с атаками с человеком посередине), и класс атак на оракул дополнения, открытых в 2002 году криптографами из академических учреждений, затем позабытых и заново открытых через десять лет вместе с несколькими уязвимыми приложениями.

Атаки типа встречи посередине

Блочный шифр 3DES — это усовершенствованный вариант стандарта 1970-х годов DES, который принимает ключ длиной \( 56 \times 3 = 168 \) бит (лучше, чем 56-битовый ключ в DES). Но уровень безопасности 3DES составляет 112, а не 168 бит из-за атаки «встреча посередине» (meet-in-the-middle — MitM).

Как показано на рис. 4.11, 3DES шифрует блок с использованием функций шифрования и дешифрирования DES: сначала шифрование с ключом \( K_1 \), затем дешифрирование с ключом \( K_2 \) и, наконец, еще одно шифрование с ключом \( K_3 \). Если \( K_1 = K_2 \), то первые два вызова взаимно уничтожаются и 3DES сводится к DES с ключом \( K_3 \). После-