---
source_image: page_101.png
page_number: 101
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.36
tokens: 7826
characters: 2445
timestamp: 2025-12-24T09:12:50.868375
finish_reason: stop
---

К сожалению, режим СВС часто применяется с постоянным IV вместо случайного, поэтому становятся видны одинаковые открытые тексты и открытые тексты, начинающиеся с одинаковых блоков. Предположим, к примеру, что двухблочный открытый текст \( P_1 \| P_2 \) зашифровывается в режиме СВС в двухблочный шифртекст \( C_1 \| C_2 \). Если \( P_1 \| P_2' \) зашифрован с таким же IV, где \( P_2' \) — блок, отличный от \( P_2 \), то шифртекст будет иметь вид \( C_1 \| C_2' \), где \( C_2' \) отличен от \( C_2 \), но первые блоки совпадают. Таким образом, противник может догадаться, что первые блоки обоих открытых текстов одинаковы, даже если видит только шифртексты.

**Примечание** В режиме СВС при дешифрировании необходимо знать IV, поэтому IV передается вместе с шифртекстом в открытом виде.

В режиме СВС дешифрирование можно значительно ускорить, воспользовавшись распараллеливанием. Если при шифровании очередного блока \( P_i \) необходимо дождаться предыдущего блока \( C_{i-1} \), то при дешифрировании блока вычисляется \( P_i = D(K, C_i) \oplus C_{i-1} \), и необходимости в предыдущем блоке открытого текста, \( P_{i-1} \), не возникает. Это означает, что все блоки можно дешифрировать одновременно при условии, что известен предыдущий блок шифртекста, а так оно обычно и есть.

**Как зашифровать любое сообщение в режиме СВС**

Вернемся к проблеме последнего блока и посмотрим, как обработать открытый текст, длина которого не кратна длина блока. Например, как зашифровать 18-байтовый открытый текст шифром AES-CBC с блоками длиной 16 байт? Что делать с двумя оставшимися байтами? Мы рассмотрим два широко распространенных способа решения этой проблемы. Первый, дополнение, приводит к тому, что шифртекст оказывается немного длиннее открытого текста, а второй, заимствование шифртекста, порождает шифртекст такой же длины, как у открытого текста.

**Дополнение сообщения**

Дополнение позволяет зашифровать сообщение любой длины, даже меньше одного блока. Для блочных шифров дополнение описано в стандарте PKCS#7 и в документе RFC 5652 и используется почти всегда, когда применяется режим СВС, например при шифровании подключений по протоколу HTTPS.

Цель дополнения — расширить сообщение до полного блока, добавив в открытый текст лишние байты. Приведем правила дополнения 16-байтовых блоков.

• Если остался один байт, например если длина открытого текста равна 1, 17 или 33 байтам, то дополнить сообщение 15 байтами 0f (десятичное 15).