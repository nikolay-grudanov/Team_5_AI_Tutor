---
source_image: page_166.png
page_number: 166
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.20
tokens: 7771
characters: 2589
timestamp: 2025-12-24T09:14:42.689036
finish_reason: stop
---

делкой, а восстановление ключа — просто частный случай более общего класса атак с подделкой. Аспект безопасности, постулирующий, что найти подделку невозможно, называется невозможностью подделки. Очевидно, что должно быть невозможно восстановить секретный ключ по списку жетонов, иначе противник смог бы подделывать жетоны, пользуясь этим ключом.

Что может сделать противник для взлома МАС? Иначе говоря, какова модель атаки? Самая простая модель — атака с известным сообщением, когда противник пассивно собирает сообщения и ассоциированные с ними жетоны (например, прослушивая сеть). Но реальный противник организует более действенные атаки, потому что может выбирать, какие сообщения подлежат аутентификации, а значит, получать МАС интересующих его сообщений. Поэтому стандартная модель — атака с подобраным сообщением, когда противник получает жетоны для сообщений по своему выбору.

**Атаки повторным воспроизведением**

МАС не защищены от атак повторным воспроизведением жетонов. Например, если можно организовать прослушивание канала связи между Алексом и Биллом, то можно запомнить сообщение, отправленное Алексом Биллу, и его жетон, а позже отправить их Биллу снова, притворившись Алексом. Чтобы предотвратить такие атаки, протокол включает в каждое сообщение его порядковый номер. Этот номер увеличивается для каждого сообщения и аутентифицируется вместе с сообщением. Принимающая сторона получает сообщения с номерами 1, 2, 3, 4 и т. д. Следовательно, если противник попытается отправить сообщение с номером 1 повторно, то получатель увидит, что сообщение пронумеровано не по порядку, т. е. может быть воспроизведением ранее посланного сообщения с номером 1.

**Псевдослучайные функции (PRF)**

PRF — это функция, которая использует секретный ключ для возврата кажущегося случайным значения PRF(K, M). Поскольку ключ секретный, противник не может предсказать выходные значения.

В отличие от МАС, PRF применяются не самостоятельно, а в составе криптографического алгоритма или протокола. Например, PRF можно использовать для создания блочных шифров в рамках построения Фейстеля, которое рассматривалось в разделе «Как устроены блочные шифры» главы 4. В схемах формирования ключа PRF используются для генерирования криптографических ключей по главному ключу или паролю, а в схемах идентификации — для генерирования ответа на случайный вопрос (когда сервер посылает случайное сообщение-вопрос M, а клиент возвращает в ответ PRF(K, M), чтобы доказать, что знает K). В стандарте телефонии 4G PRF используется для аутентификации SIM-карты и обслуживающего ее оператора, и похожая PRF