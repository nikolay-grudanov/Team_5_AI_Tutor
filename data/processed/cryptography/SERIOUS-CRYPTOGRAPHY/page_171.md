---
source_image: page_171.png
page_number: 171
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.00
tokens: 7710
characters: 1969
timestamp: 2025-12-24T09:14:47.184514
finish_reason: stop
---

Обобщенная атака против МАС на основе функций хеширования

Существует одна атака, которая работает против всех имитовставок, основанных на повторении функции хеширования. Вспомните атаку, описанную в разделе «Построение секретного суффикса» выше, где коллизия хешей использовалась для получения коллизии имитовставок. Ту же стратегию можно применить для атаки на МАС с секретным префиксом или на HMAC, хотя последствия и не такие печальные.

Для иллюстрации этой атаки рассмотрим МАС с секретным префиксом Hash(K||M), показанную на рис. 7.2. Если длина дайджеста равна n бит, то можно найти два сообщения M_1 и M_2 такие, что Hash(K||M_1) = Hash(K||M_2), запросив примерно 2^{n/2} жетонов у системы, хранящей ключ (вспомните атаку на основе парадокса дней рождения, описанную в главе 6). Если хеш-функция уязвима для атаки удлинением сообщения, как SHA-256, то M_1 и M_2 можно использовать для подделки МАС, для чего следует выбрать какие-то произвольные данные M_3 и запросить у оракула МАС значение Hash(K||M_1||M_3), которое будет являться имитовставкой сообщения M_1||M_3. Как выясняется, это также имитовставка сообщения M_2||M_3, поскольку внутреннее состояние хеша M_1 и M_3 такое же, как хеша M_2 и M_3. Таким образом, мы успешно подделали МАС-жетон. (Атака становится неосуществимой, когда n больше, скажем, 128 бит.)

![Принцип обобщенной атаки с подделкой на МАС на основе функций хеширования](https://i.imgur.com/3Q5z5QG.png)

Рис. 7.2. Принцип обобщенной атаки с подделкой на МАС на основе функций хеширования

Эта атака работает, даже если хеш-функция не уязвима к атаке удлинением сообщения, и против HMAC она тоже применима. Стоимость атаки зависит от размера цепного значения и длины МАС: если цепное значение МАС имеет длину 512 бит, а жетоны — 128 бит, то после 2^{64} вычислений будет найдена коллизия МАС, но вряд ли коллизия во внутреннем состоянии, потому что для нахождения такой коллизии потребовалось бы в среднем 2^{512/2} = 2^{256} операций.