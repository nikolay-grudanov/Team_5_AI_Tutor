---
source_image: page_041.png
page_number: 41
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.01
tokens: 7710
characters: 2323
timestamp: 2025-12-24T09:10:57.795624
finish_reason: stop
---

отправленному правомочной стороной, знающей ключ K. Если K известен еще только одной стороне, то жетон гарантирует также, что сообщение было отправлено именно ей, т. е. он неявно аутентифицирует ожидаемого отправителя как фактического создателя сообщения.

Примечание Я употребляю термин «создатель», а не «отправитель», потому что пассивный противник может подслушать и запомнить некоторые пары (C, T), отправленные стороной А стороне B, а затем снова отправить их B, притворившись А. Такую атаку повторным воспроизведением можно предотвратить, например, включив в сообщение счетчик. В момент дешифрирования сообщения его счетчик увеличивается на 1. Таким образом, можно проверить, было ли сообщение отправлено дважды, и если да, то имеет место атака повторным воспроизведением. Одновременно это позволяет обнаружить потерянные сообщения.

Шифрование с аутентификацией и ассоциированными данными (authenticated encryption with associated data – AEAD) — обобщение шифрования с аутентификацией, при котором некоторый открытый текст и незашифрованные данные используются для генерирования аутентификационного жетона AEAD(K, P, A) = (C, T). Типичное применение AEAD — защита дейтаграмм протоколов с открытым заголовком и зашифрованной полезной нагрузкой. В таких случаях по крайней мере какие-то данные заголовка должны оставаться открытыми; например, адреса получателей должны быть открыты, чтобы пакеты можно было маршрутизировать.
Дополнительные сведения о шифровании с аутентификацией см. в главе 8.

Шифрование с сохранением формата

Базовый шифр принимает и возвращает биты; ему безразлично, представляют ли биты текст, изображение или PDF-документ. Шифртекст тоже можно представить в виде неформатированных байтов, шестнадцатеричных символов, в кодировке base64 и в других форматах. Но что, если шифртекст должен иметь такой же формат, как открытый текст? Например, подобное требование предъявляется системами баз данных, которые могут хранить данные только в предписанном формате.
Эту задачу решает шифрование с сохранением формата (format-preserving encryption — FPE). Подобные алгоритмы создают шифртекст, имеющий такой же формат, как открытый текст. Например, FPE можно применить для шифрования IP-адресов (как показано на рис. 1.5), почтовых индексов, номеров кредитных карт с правильной контрольной суммой и т. д.