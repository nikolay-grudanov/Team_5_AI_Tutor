---
source_image: page_179.png
page_number: 179
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.68
tokens: 7720
characters: 2165
timestamp: 2025-12-24T09:15:03.652099
finish_reason: stop
---

\[
\begin{array}{ll}
a += b & c += d \\
b <<<= 13 & d <<<= 16 \\
b \oplus= a & d \oplus= c \\
a <<<= 32 & \\
c += b & a += d \\
b <<<= 17 & d <<<= 21 \\
b \oplus= c & d \oplus= a \\
c <<<= 32 &
\end{array}
\]

Здесь \( a += b \) — сокращенная запись \( a = a + b \), а \( b <<<= 13 \) — сокращенная запись \( b = b << 13 \) (64-битовое слово \( b \) циклически сдвигается влево на 13 бит).

Эти простые операции над 64-битовыми словами — почти все, что необходимо для вычисления SipHash, хотя вовсе необязательно делать это самостоятельно. Готовые реализации имеются на большинстве языков, включая C, Go, Java, JavaScript и Python.

**Примечание** Говоря о версии SipHash, пишут SipHash-x-y, где x — количество раундов перед подачей очередного блока сообщения, а y — количество раундов после подачи. Чем больше раундов, тем больше операций, поэтому работа функции замедляется, зато повышается безопасность. По умолчанию подразумевается SipHash-2-4 (обозначается просто SipHash), и даже она до сих пор она не поддавалась криптоанализу. Но можете перестраховаться и выбрать версию SipHash-4-8, которая выполняет в два раза больше операций и, стало быть, в два раза медленнее.

**Какие возможны проблемы**

Подобно шифрам и хеш-функциям без ключа, МАС и PRF, безопасные на бумаге, могут оказаться уязвимы к атакам при использовании в полевой обстановке, когда атакует реальный противник. Рассмотрим два примера.

**Атаки с хронометражем на верификацию МАС**

Атаки по побочным каналам направлены против реализации криптографического алгоритма, а не против самого алгоритма. В частности, в атаках с хронометражем замеряется время выполнения алгоритма, чтобы получить секретную информацию: о ключах, открытом тексте и секретных случайных значениях. Легко представить себе, что сравнение строк, занимающее переменное время, несет в себе уязвимость, и это справедливо не только для верификации МАС, но и для многих других криптографических алгоритмов и средств обеспечения безопасности.

МАС может быть уязвима к атакам с хронометражем, если время проверки жетонов удаленной системой зависит от значения жетона, что позволяет противнику определить правильный жетон сообще-