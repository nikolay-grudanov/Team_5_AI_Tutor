---
source_image: page_174.png
page_number: 174
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.26
tokens: 7752
characters: 2399
timestamp: 2025-12-24T09:14:52.188023
finish_reason: stop
---

Проектирование специализированных имитовставок

Мы видели, как можно использовать функции хеширования и блочные шифры для построения PRF, являющихся безопасными при условии, что безопасны базовая хеш-функция или шифр. В схемах типа HMAC или CMAC просто комбинируются имеющиеся хеш-функции или блочные шифры для получения безопасных PRF или MAC. Повторное использование алгоритмов — это удобно, но всегда ли это самый эффективный подход?

Интуитивно кажется, что PRF и MAC должны требовать меньше работы, чем хеш-функции без ключа, чтобы считаться безопасными, — ведь включение в них секретного ключа мешает не знающему его противнику экспериментировать с алгоритмом. Кроме того, PRF и MAC раскрывают противнику только короткий жетон, в отличие от блочных шифров, которые порождают шифртекст такой же длины, как исходное сообщение. Поэтому PRF и MAC, по идее, не нужна вся мощь хеш-функций или блочных шифров. Это соображение легло в основу специализированных алгоритмов, предназначенных только для вычисления PRF и/или MAC.

В последующих разделах мы рассмотрим два таких алгоритма, получивших широкое распространение: Poly1305 и SipHash. Я объясню принципы их проектирования и почему они, скорее всего, безопасны.

Poly1305

Алгоритм Poly1305 (произносится «поли тринадцать-ноль-пять») был спроектирован в 2005 году Дэниелем Дж. Бернштейном (автором потокового шифра Salsa20, который обсуждался в главе 5, и шифра ChaCha, легшего в основу хеш-функций BLAKE и BLAKE2, рассмотренных в главе 6). Poly1305 оптимизирован для работы на современных процессорах и на момент написания этой книги используется, в частности, Google для защиты HTTPS-соединений (HTTP поверх TLS) и в пакете OpenSSH. В отличие от Salsa20, дизайн Poly1305 основан на методах, восходящих к 1970-м годам, а именно на универсальных функциях хеширования и построении Вегмана–Картера.

Универсальные функции хеширования

В имитовставке Poly1305 используется универсальная функция хеширования, которая значительно слабее криптографических хеш-функций, но вместе с тем и значительно быстрее. Например, универсальные функции хеширования не обязаны быть стойкими к коллизиям. А это значит, что для для достижения целей им нужно выполнить меньше работы.

Как и PRF, универсальная функция хеширования параметризуется секретным ключом: если даны сообщение M и ключ K, то UH(K, M) обозначает выход универсальной функции хеширования UH. К уни-