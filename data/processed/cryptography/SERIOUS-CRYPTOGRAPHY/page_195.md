---
source_image: page_195.png
page_number: 195
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.44
tokens: 7722
characters: 2071
timestamp: 2025-12-24T09:15:29.850347
finish_reason: stop
---

Внутреннее устройство OCB

На рис. 8.3 показано, как работает OCB: каждый блок открытого текста P преобразуется в блок шифртекста C = E(K, P ⊕ O) ⊕ O, где E – функция шифрования блочного шифра. Здесь O (смещение) – значение, зависящее от ключа и одноразового числа, которое увеличивается при обработке каждого нового блока.

Для порождения аутентификационного жетона OCB сначала вычисляет XOR всех блоков открытого текста, S = P₁ ⊕ P₂ ⊕ P₃ ⊕ …. Тогда жетон T = E(K, S⊕ O*), где O* – смещение, вычисленное по смещению последнего обработанного блока открытого текста.

![Процесс шифрования в OCB при наличии двух блоков открытого текста без ассоциированных данных](../images/chapter8/ocb_process.png)

Рис. 8.3. Процесс шифрования в OCB при наличии двух блоков открытого текста без ассоциированных данных

Как и AES-GCM, OCB поддерживает ассоциированные данные в виде последовательности блоков A₁, A₂ …. Если зашифрованное OCB сообщение содержит ассоциированные данные, то аутентификационный жетон вычисляется по формуле

\[
T = E(K, S \oplus O^*) \oplus E(K, A_1 \oplus O_1) \oplus E(K, A_2 \oplus O_2) \oplus ...
\]

где OCB определяет смещения, отличные от тех, что использовались при шифровании P.

В отличие от GCM и схемы шифрование-затем-МАС, где аутентификационный жетон создается по шифртексту, в OCB жетон вычисляется по данным открытого текста. В этом нет ничего плохого, и безопасность OCB подкреплена солидными доказательствами.

Примечание Дополнительные сведения о том, как корректно реализовать OCB, см. либо в RFC 7253, либо в статье Krovetz and Rogaway «The Software Performance of Authenticated-Encryption Modes» 2011 года, в которой рассматривается последняя и лучшая версия OCB – OCB3. Также см. FAQ, посвященный OCB, по адресу http://web.cs.ucdavis.edu/~rogaway/ocb/ocb-faq.htm.

Безопасность OCB

OCB чуть менее уязвим к повторению одноразовых чисел, чем GCM. Так, если одноразовое число использовано дважды, то противник, который видит оба шифртекста, заметит, что, скажем, третий блок открытого текста первого сообщения идентичен третьему блоку от-