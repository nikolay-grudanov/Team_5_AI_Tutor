---
source_image: page_128.png
page_number: 128
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.24
tokens: 7822
characters: 2590
timestamp: 2025-12-24T09:13:37.931230
finish_reason: stop
---

значение S после трех итераций алгоритма развертки ключа. Из-за этого криптоаналитики обнаружили, что первый байт гаммы сильно зависит от первого секретного байта ключа — четвертого байта, вставленного KSA, — и что это статистическое смещение можно использовать для получения секретного ключа.

Для эксплуатации этих недостатков необходим доступ к шифртекстам и гамме, т. е. известные или подобранные открытые тексты. Но это достаточно просто: известный открытый текст возникает, когда кадры Wi-Fi инкапсулируют данные с известным заголовком, а подобранные открытые тексты — когда противник внедряет известный открытый текст, зашифрованный ключом-мишенью. Таким образом, атака работает практически, а не только на бумаге.

После появления первых атак на WEP в 2001 году исследователи нашли более быстрые атаки, требующие меньше шифртекста. В настоящее время можно даже найти инструменты, например aircrack-ng, которые реализуют атаку целиком, от прослушивания сети до криптоанализа.

Небезопасность WEP вызвана как недостатками RC4, который принимает только ключ, а не ключ и одноразовое число (как любой достойный потоковый шифр), так и недостатками при проектировании самого WEP.

Теперь рассмотрим второй крупный «облом» RC4.

RC4 в TLS

TLS — самый важный протокол безопасности в интернете. Наиболее широкую известность ему принесло использование для установления HTTPS-соединений, но он применяется также для защиты некоторых виртуальных частных сетей (VPN), почтовых серверов, мобильных приложений и многое другое. И как это ни печально, TLS долгое время поддерживал RC4.

В отличие от WEP, в реализации TLS нет такой же вопиющей ошибки — манипулирования спецификацией RC4 с целью использовать открытое одноразовое число. Вместо этого TLS передает RC4 уникальный 128-битовый сеансовый ключ, т. е. в отличие от WEP в нем нет бросающихся в глаза недостатков.

Слабость TLS вызвана только неустранимыми дефектами RC4: статистическим смещением, или неслучайностью, что, как мы знаем, является поводом отказаться от потокового шифра. Например, второй байт гаммы, порождаемой RC4, является нулевым с вероятностью 1/128, тогда как в идеале вероятность должна быть равна 1/256. (Напомним, что байт может принимать 256 значений от 0 до 255, следовательно, истинно случайный байт должен быть равен 0 с вероятностью 1/256.) Поразительно, но большинство экспертов продолжали доверять RC4 аж до 2013 года, хотя о его статистической смещенности было известно с 2001 года.

Известия о статистической смещенности RC4 должно было быть достаточно, чтобы отправить этот шифр на свалку истории, даже если