---
source_image: page_130.png
page_number: 130
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.24
tokens: 7664
characters: 1902
timestamp: 2025-12-24T09:13:34.201611
finish_reason: stop
---

Salsa20

Salsa20 — простой программный шифр, оптимизированный для современных процессоров. Он, а также его вариант ChaCha применяются в различных протоколах и библиотеках. Спроектировавший его авторитетный криптограф Дэниел Дж. Бернштейн представил Salsa20 на конкурс eSTREAM в 2005 году. Шифр был включен в портфель ПО, отобранного по результатам конкурса. Благодаря своей простоте и скорости работы Salsa20 завоевал популярность у разработчиков.

Salsa20 — потоковый шифр на основе счетчика; он генерирует гамму, повторно обрабатывая счетчик, который увеличивается для каждого нового блока. Как видно на рис. 5.10, базовый алгоритм Salsa20 преобразует 512-байтовый блок с помощью ключа (K), одноразового числа (N) и значения (Ctr). Затем Salsa20 прибавляет результат к первоначальному значению блока для порождения блока гаммы. (Если бы алгоритм возвращал перестановку, сгенерированную базовым алгоритмом, непосредственно, то был бы абсолютно небезопасным, потому что его можно было бы обратить. Финальное прибавление начального секретного состояния K||N||Ctr делает преобразование ключа в блок гаммы необратимым.)

![Схема шифрования 512-битового блока открытого текста в алгоритме Salsa20](https://i.imgur.com/3Q5z5QG.png)

Рис. 5.10. Схема шифрования 512-битового блока открытого текста в алгоритме Salsa20

Функция quarterround

В базовом алгоритме Salsa20 используется функция quarterround (QR), которая преобразует 32-битовые слова (a, b, c, d), как показано ниже:

\[
b = b \oplus [(a + d) <<< 7];
c = c \oplus [(b + a) <<< 9];
d = d \oplus [(c + b) <<< 13];
a = a \oplus [(d + c) <<< 18].
\]

Эти четыре выражения вычисляются сверху вниз, т. е. новое значение b зависит от a и d, новое значение c — от a и нового значения b (и, следовательно, также от d) и так далее.

Символом <<< обозначена операция циклического сдвига слова влево на указанное число битов, которое может принимать значение