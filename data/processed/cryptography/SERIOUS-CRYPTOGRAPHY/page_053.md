---
source_image: page_053.png
page_number: 53
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.69
tokens: 7755
characters: 2578
timestamp: 2025-12-24T09:11:26.727050
finish_reason: stop
---

Но даже если Fortuna реализован корректно, возможны ошибки безопасности по причинам, не связанным с правильностью реализации. Например, Fortuna может не заметить, что RNG дает недостаточно случайных битов, и в результате будет порождать псевдослучайные биты низкого качества или вообще прекратит отдавать псевдослучайные биты.

Еще один риск, присущий реализациям Fortuna, — возможность раскрытия файлов начальных значений противнику. Данные, хранящиеся в файлах начальных значений, используются для снабжения вызовов refresh энтропией в тех случаях, когда RNG недоступен, например сразу после перезагрузки системы, еще до того, как системные RNG зарегистрировали какие-то непредсказуемые события. Но если один и тот же файл начального значения будет использован дважды, то Fortuna дважды сгенерирует одну и ту же последовательность битов. Поэтому файл начального значения следует стирать после использования, чтобы предотвратить его повторное использование.

Наконец, если два экземпляра Fortuna находятся в одном и том же состоянии, потому что разделяют общий файл начального значения (а значит, в пулах энтропии находятся одинаковые данные и C и K тоже одинаковы), то операция next обоих экземпляров будет возвращать одни и те же биты.

Криптографически стойкие и нестойкие PRNG

PRNG бывают криптографически стойкими и нестойкими. Криптографически нестойкие PRNG предназначены для порождения равномерных распределений в таких приложениях, как естественно-научное моделирование или видеоигры. Однако их ни в коем случае не следует использовать в криптографических приложениях, поскольку они небезопасны, их основная задача — обеспечить качественное распределение вероятностей битов, а не их непредсказуемость. С другой стороны, криптографически стойкие PRNG непредсказуемы, поскольку в них уделяется внимание также стойкости элементарных операций, применяемых для порождения битов с качественным распределением.

К сожалению, большинство PRNG, доступных из языков программирования, в частности rand и drand48 в libc, rand и mt_rand в PHP, модуль Python random, класс Ruby Random и т. д., являются криптографически нестойкими. Использовать криптографически нестойкий PRNG по умолчанию — прямой путь к беде, потому что часто он просачивается и в криптографические приложения. Поэтому следите за тем, чтобы в криптографических приложениях использовались только криптографически стойкие PRNG.

Популярный криптографически нестойкий PRNG: вихрь Мерсенна

Вихрь Мерсенна (Mersenne Twister — MT) — это криптографически нестойкий алгоритм PRNG, используемый (на момент написания кни-