---
source_image: page_152.png
page_number: 152
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.44
tokens: 7905
characters: 2595
timestamp: 2025-12-24T09:14:19.877243
finish_reason: stop
---

Примечание Функция хеширования Message Digest 5 (MD5) была самой популярной с 1992 года и до ее взлома примерно в 2005 году, после чего многие приложения переключились на одну из функций семейства SHA. MD5 обрабатывает 512-битовые блоки сообщения и обновляет 128-битовое внутреннее состояние, порождая 128-битовый хеш, т. е. обеспечивает не более 128-битовой стойкости к восстановлению прообраза и 64-битовой стойкости к коллизиям. В 1996 году криптоаналитики предупредили о коллизии функции сжатия MD5, но это предупреждение не имело последствий до 2005 года, когда группа китайских криптоаналитиков описала, как вычислить коллизии для полного MD5-хеша. На момент написания этой книги нахождение коллизии в MD5 занимает всего несколько секунд, и тем не менее многие системы все еще поддерживают MD5, чаще всего ради обратной совместимости.

SHA-1

Стандарт SHA-1 появился в результате обнаружения ошибки в оригинальной хеш-функции SHA-0, применявшейся АНБ. В 1993 году NIST стандартизовал алгоритм хеширования SHA-0, но в 1995 году АНБ обнародовало функцию SHA-1, исправляющую неназванную проблему безопасности в SHA-0. Причина выяснилась, когда в 1998 году два исследователя обнаружили, как найти коллизии для SHA-0, выполнив примерно \(2^{60}\) операций вместо \(2^{80}\), ожидаемых для 160-битовых хеш-функций, каковыми являются SHA-0 и SHA-1. Впоследствии сложность атаки удалось уменьшить до примерно \(2^{33}\) операций, что позволяет найти коллизии для SHA-0 меньше, чем за час.

Внутреннее устройство SHA-1

SHA-1 сочетает хеш-функцию Меркла–Дамгора с функцией сжатия Дэвиса–Мейера, основанной на специально сконструированном блочном шифре, который иногда называют SHACAL. То есть SHA-1 повторяет в цикле следующую операцию над 512-битовыми блоками сообщений (\(M\)):

\[
H = E(M, H) + H.
\]

Здесь употребление знака + вместо \( \oplus \) (XOR) – не опечатка. \(E(M, H)\) и \(H\) рассматриваются как массивы 32-битовых целых чисел, и слова в соответственных позициях складываются: первое 32-битовое слово \(E(M, H)\) с первым 32-битовым словом \(H\) и т. д. Начальное значение \(H\) постоянно для любого сообщения, затем \(H\) модифицируется согласно приведенной выше формуле, а конечное значение \(H\) после обработки всех блоков возвращается в качестве хеш-значения сообщения.

После выполнения блочного шифра с блоком сообщения в качестве ключа и текущим 160-битовым цепным значением в качестве блока открытого текста 160-битовый результат рассматривается как массив пяти 32-битовых слов, каждое из которых складывается с соответственной 32-битовой частью начального значения \(H\).