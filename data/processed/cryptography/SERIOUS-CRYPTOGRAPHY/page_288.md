---
source_image: page_288.png
page_number: 288
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.17
tokens: 7815
characters: 2626
timestamp: 2025-12-24T09:18:29.261259
finish_reason: stop
---

рету Диффи–Хеллмана, который сервер вычисляет на основе закрытого ключа Диффи–Хеллмана и открытого ключа клиента.
Получив сообщение ServerHello, клиент проверяет действительность сертификата, вычисляет разделяемый секрет Диффи–Хеллмана, формирует на его основе симметричные ключи и проверяет имитовставку, отправленную сервером. Если все проверки завершились успешно, то клиент готов к отправке зашифрованных сообщений серверу.

Примечание Заметим, однако, что TLS 1.3 поддерживает много параметров и расширений, поэтому может вести себя иначе, чем описано здесь (и показано на рис. 13.1). Например, можно настроить протокол квитирования TLS 1.3 так, что сервер будет требовать от клиента сертификат, чтобы удостоверить его подлинность. TLS 1.3 также поддерживает предварительно разделенные ключи.

Посмотрим, как все это выглядит на практике. Допустим, мы развернули TLS 1.3, чтобы обеспечить безопасный доступ к сайту https://www.nostarch.com/. Если зайти на него в браузере, то браузер отправит серверу сайта сообщение ClientHello, включающее перечень поддерживаемых им шифров. Сайт ответит сообщением ServerHello, содержащим сертификат, который включает открытый ключ, ассоциированный с доменом www.nostarch.com. Клиент проверит действительность сертификата, прибегнув к помощи одного из удостоверяющих центров, прописанных в браузере (полученный сертификат должен быть подписан надежным удостоверяющим центром, сертификат которого должен быть включен в хранилище сертификатов браузера, иначе проверка не пройдет). После того как все проверки завершатся успешно, браузер запросит начальную страницу от сервера www.nostarch.com.
После успешного завершения квитирования весь обмен сообщениями между клиентом и сервером зашифрован и аутентифицирован. Подслушивающий противник может узнать, что клиент с данным IP-адресом общается с сервером с другим IP-адресом, и может наблюдать зашифрованные сообщения, но не сможет ни получить открытый текст, ни изменить зашифрованные сообщения (иначе принимающая сторона заметила бы, что данными манипулируют, поскольку сообщения не только зашифрованы, но и аутентифицированы). Для большинства приложений такой безопасности достаточно.

Криптографические алгоритмы TLS 1.3

Мы знаем, что TLS 1.3 пользуется алгоритмами шифрования с аутентификацией, функцией формирования ключей (хеш-функцией, которая выводит ключи из разделяемого секрета), а также операцией Диффи–Хеллмана. Но как именно все это работает, какие алгоритмы применяются и насколько они безопасны?
Что касается выбора шифров с аутентификацией, то TLS 1.3 поддерживает только три алгоритма: AES-GCM, AES-CCM (этот режим чуть