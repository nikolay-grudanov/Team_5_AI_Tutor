---
source_image: page_259.png
page_number: 259
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.02
tokens: 7750
characters: 2389
timestamp: 2025-12-24T09:17:31.945767
finish_reason: stop
---

а еще лучше функцию формирования ключа (KDF). Примером построения KDF может служить HKDF, или KDF на основе HMAC (описанная в RFC 5869), но в настоящее время у BLAKE2 и SHA-3 есть режимы, в которых они ведут себя как KDF.

Унаследованный протокол Диффи–Хеллмана в TLS

Протокол TLS отвечает за безопасность HTTPS-сайтов, а равно за безопасность почтового протокола SMTP. TLS принимает несколько параметров, в т. ч. тип используемого протокола Диффи–Хеллмана, и большинство реализаций TLS ради обратной совместимости до сих пор поддерживают анонимный протокол DH, несмотря на его небезопасность.

Небезопасные параметры группы

В январе 2016 года лица, отвечающие за сопровождение пакета OpenSSL, исправили весьма серьезную уязвимость (CVE-2016-0701), которая позволяла противнику эксплуатировать небезопасные параметры протокола Диффи–Хеллмана. Главной причиной этой уязвимости был тот факт, что OpenSSL позволял работать с небезопасными параметрами группы (а именно с небезопасным простым p), вместо того чтобы возбудить исключение и прервать выполнение протокола еще до каких-либо арифметических операций.

Суть дела в том, что OpenSSL принимал простое число p, для которого мультипликативная группа \( \mathbb{Z}_p^* \) (в которой и производятся все операции DH) содержала подгруппы малого размера. В начале этой главы мы говорили, что существование малых подгрупп в криптографическом протоколе — зло, потому что сильно ограничивает множество возможных значений разделяемых секретов. Хуже того, противник может изготовить показатель степени x, который в сочетании с открытым ключом жертвы \( g^y \) будет раскрывать информацию о закрытом ключе y и в конце концов раскроет его целиком.

Хотя открытие уязвимости датируется 2016 годом, принцип атаки восходит еще к статье Lim and Lee «A Key Recovery Attack on Discrete Log-based Schemes Using a Prime Order Subgroup» 1997 года. Исправить эту ошибку просто: прежде чем принять простое число p в качестве модуля группы, протокол должен проверить, что p безопасно, т. е. что число \( (p - 1)/2 \) тоже простое, тогда у группы \( \mathbb{Z}_p^* \) не будет малых подгрупп и атака потерпит неудачу.

Для дополнительного чтения

Отмечу несколько вещей, которым не нашлось места в этой главе, но о которых полезно почитать.
Более глубоко изучить протоколы совместной выработки ключей Диффи–Хеллмана позволит чтение стандартов и официальных доку-