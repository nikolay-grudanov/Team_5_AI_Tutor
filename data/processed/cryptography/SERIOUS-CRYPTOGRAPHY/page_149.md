---
source_image: page_149.png
page_number: 149
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.08
tokens: 7857
characters: 2293
timestamp: 2025-12-24T09:14:10.329969
finish_reason: stop
---

Создание функций сжатия: построение Дэвиса–Мейера

Все функции сжатия, используемые в реальных функциях хеширования, таких как SHA-256 и BLAKE2, основаны на блочных шифрах, потому что это самый простой способ. На рис. 6.5 показана наиболее распространенная схема функций сжатия на основе блочного шифра — построение Дэвиса–Мейера.

![Рис. 6.5. Построение Дэвиса–Мейера. Чёрный треугольник показывает, откуда поступает ключ блочного шифра](https://i.imgur.com/3Q5z5QG.png)

Получив блок сообщения \( M_i \) и предыдущее цепное значение \( H_{i-1} \), функция сжатия Дэвиса–Мейера применяет блочный шифр \( E \) для вычисления нового цепного значения:

\[
H_i = E(M_i, H_{i-1}) \oplus H_{i-1}.
\]

Блок сообщения \( M_i \) играет роль ключа блочного шифра, а цепное значение \( H_{i-1} \) — роль блока открытого текста. При условии что блочный шифр безопасен, получающаяся функция сжатия является безопасной и стойкой к коллизиям и восстановлению прообраза. Без операции XOR с предыдущим цепным значением (\( \oplus H_{i-1} \)) построение Дэвиса–Мейера было бы небезопасным, потому что его можно было бы обратить, перейдя от нового цепного значения к предыдущему с помощью функции дешифрирования блочного шифра.

**Примечание** Построение Дэвиса–Мейера обладает удивительным свойством: для него можно найти неподвижные точки, т. е. цепные значения, которые остаются неизменными после применения функции сжатия с заданным блоком сообщения. Достаточно взять в качестве цепного значения \( H_{i-1} = D(M_i, 0) \), где \( D \) — функция дешифрирования, соответствующая \( E \). Тогда новое цепное значение \( H_i \) будет равно предыдущему, \( H_{i-1} \):

\[
\begin{align*}
H_i &= E(M_i, H_{i-1}) \oplus H_{i-1} = E(M_i, D(M_i, 0)) \oplus D(M_i, 0) \\
&= 0 \oplus D(M_i, 0) = D(M_i, 0) = H_{i-1}.
\end{align*}
\]

Мы получаем \( H_i = H_{i-1} \), потому что подстановка результата дешифрирования нуля в функцию шифрования дает нуль — член \( E(M_i, D(M_i, 0)) \) — и в выражении для выхода функции сжатия остается только член \( \oplus H_{i-1} \). Таким образом, можно найти неподвижные точки функций сжатия для хеш-функций семейства SHA-2, равно как и для стандартов MD5 и SHA-1, тоже основанных на построении Дэвиса–Мейера. По счастью, наличие неподвижных точек не ставит безопасность под угрозу.