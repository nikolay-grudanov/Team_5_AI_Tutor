---
source_image: page_165.png
page_number: 165
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.51
tokens: 7765
characters: 2432
timestamp: 2025-12-24T09:14:37.799820
finish_reason: stop
---

ся случайными значениями. В первом разделе этой главы мы поговорим о том, чем и почему алгоритмы MAC и PRF похожи, а затем обсудим, как они работают. Одни MAC и PRF основаны на хеш-функциях, другие — на блочных шифрах, а третьи имеют оригинальный дизайн. Наконец, мы рассмотрим примеры атак на имитовставки.

Имитовставки (MAC)

MAC защищает целостность и подлинность сообщения путем создания значения \( T = \text{MAC}(K, M) \), называемого аутентификационным жетоном сообщения, \( M \) (часто его-то называют имитовставкой \( M \), что ведет к путанице). Точно так же, как можно дешифрировать сообщение, зная ключ шифра, можно проверить, что сообщение не было модифицировано, если знать ключ MAC.

Например, предположим, что Алекс и Билл разделяют ключ, \( K \), и Алекс посылает Биллу сообщение \( M \) вместе с аутентификационным жетоном \( T = \text{MAC}(K, M) \). Получив сообщение и его аутентификационный жетон, Билл тоже вычисляет \( \text{MAC}(K, M) \) и проверяет, что результат равен полученному жетону. Поскольку вычислить это значение мог только Алекс, Билл может быть уверен, что сообщение не было случайно или злонамеренно повреждено в процессе передачи (подтверждение целостности) и что послал его именно Алекс (подтверждение подлинности).

MAC как часть безопасной системы связи

В безопасных системах связи шифр и MAC часто комбинируются для защиты конфиденциальности, целостности и подлинности сообщения. Например, протоколы Internet Protocol Security (IPSec), Secure Shell (SSH) и Transport Layer Security (TLS) генерируют MAC для каждого передаваемого сетевого пакета.

Не во всех системах связи применяется MAC. Иногда аутентификационный жетон добавляет неприемлемые накладные расходы к каждому пакету, особенно если размер пакета составляет от 64 до 128 бит. Например, в стандартах мобильной телефонии 3G и 4G голосовые пакеты шифруются, но не аутентифицируются. Противник может модифицировать зашифрованный звуковой сигнал, и получатель этого не заметит. Таким образом, если противник повредит зашифрованный голосовой пакет, то результатом дешифрирования будет шум, воспринимаемый как статические помехи.

Атаки с подделкой и подобраным сообщением

Что значит «безопасная MAC»? Прежде всего, как и для шифра, ключ должен храниться в секрете. Если MAC безопасна, то противник не должен иметь возможность создать жетон сообщения, не зная ключа. Такая сгенерированная пара из сообщения и жетона называется под-