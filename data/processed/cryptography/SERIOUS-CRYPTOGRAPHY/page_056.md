---
source_image: page_056.png
page_number: 56
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.45
tokens: 7585
characters: 1920
timestamp: 2025-12-24T09:11:21.073040
finish_reason: stop
---

PRNG на практике

Теперь поговорим о практической реализации PRNG. Криптографически стойкие PRNG входят в состав операционных систем (ОС) на большинстве платформ, от персональных компьютеров и ноутбуков до встраиваемых систем, например маршрутизаторов и ТВ-приставок, а также имеются в виртуальных машинах, мобильных телефонах и т. д. Большая часть этих PRNG реализована программно, но встречаются и чисто аппаратные. Такие PRNG используются приложениями, исполняемыми под управлением ОС, а иногда другими PRNG, работающими поверх криптографических библиотек или приложений.

Далее мы рассмотрим самые распространенные PRNG: один работает в Linux, Android и многих других системах на базе Unix, другой — в Windows, а третий, реализованный аппаратно, — в недавних версиях микропроцессоров Intel.

Генерирование случайных битов в системах на базе Unix

Устройство /dev/urandom — работающий в пространстве пользователя интерфейс к криптографически стойкому PRNG в распространенных системах *nix, именно он обычно используется для генерирования надежных случайных битов. Поскольку это устройство, для запроса битов нужно читать его как файл. Например, в следующей команде /dev/urandom используется для записи 10 МБ случайных бит в файл:

$ dd if=/dev/urandom of=<выходной файл> bs=1M count=10

Неправильное использование /dev/urandom

Можно было бы написать на С наивную и небезопасную программу чтения случайных битов типа показанной в листинге 2.1 и надеяться на авось, но это дурная идея.

Листинг 2.1. Небезопасное использование /dev/urandom

int random_bytes_insecure(void *buf, size_t len)
{
    int fd = open("/dev/urandom", O_RDONLY);
    read(fd, buf, len);
    close(fd);
    return 0;
}

Этот код небезопасен; он даже не проверяет значения, возвращаемые функциями open() и read(), а это означает, что буфер, в котором вы ожидаете увидеть случайные биты, может оказаться заполненным нулями или вообще не изменится.