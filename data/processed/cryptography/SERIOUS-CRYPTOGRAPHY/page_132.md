---
source_image: page_132.png
page_number: 132
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 63.20
tokens: 8491
characters: 2911
timestamp: 2025-12-24T09:14:07.883647
finish_reason: stop
---

QR(x_0, x_4, x_8, x_{12});
QR(x_1, x_5, x_9, x_{13});
QR(x_2, x_6, x_{10}, x_{14});
QR(x_3, x_7, x_{11}, x_{15}).

В строковом раунде строки преобразуются следующим образом:

QR(x_0, x_1, x_2, x_3);
QR(x_5, x_6, x_7, x_4);
QR(x_{10}, x_{11}, x_8, x_9);
QR(x_{15}, x_{12}, x_{13}, x_{14}).

Заметим, что в столбцовом раунде каждый вызов QR принимает аргументы x_i, упорядоченные сверху вниз, а в строковом раунде первыми аргументами QR являются слова, расположенные на диагонали (как показано в массиве справа на рис. 5.12), а не слова в первом столбце.

Вычисление Salsa20

В листинге 5.3 показаны начальные состояния первого и второго блоков Salsa20, когда ключ состоит из одних нулей (байтов 00), а одноразовое число — из одних единиц (байтов ff). Эти состояния отличаются только одним битом счетчика, выделенного жирным шрифтом; он равен 0 в первом блоке и 1 во втором.

Листинг 5.3. Начальные состояния первых двух блоков Salsa20, когда ключ состоит из одних нулей, а одноразовое число — из одних единиц

<table>
  <tr>
    <th>61707865</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>3320646e</th>
    <th>ffffffff</th>
    <th>ffffffff</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>79622d32</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>6b206574</th>
  </tr>
  <tr>
    <th>61707865</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>3320646e</th>
    <th>ffffffff</th>
    <th>ffffffff</th>
    <th>00000001</th>
    <th>00000000</th>
    <th>79622d32</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>00000000</th>
    <th>6b206574</th>
  </tr>
</table>

Но, несмотря на различие всего в одном бите, соответствующие внутренние состояния после 10 двойных раундов не имеют ничего общего, как видно из листинга 5.4.

Листинг 5.4. Состояния, показанные в листинге 5.3, после 10 двойных раундов Salsa20

<table>
  <tr>
    <th>e98680bc</th>
    <th>f730ba7a</th>
    <th>38663ce0</th>
    <th>5f376d93</th>
    <th>1ba4d492</th>
    <th>c14270c3</th>
    <th>9fb05306</th>
    <th>ff808c64</th>
  </tr>
  <tr>
    <th>85683b75</th>
    <th>a56ca873</th>
    <th>26501592</th>
    <th>64144b6d</th>
    <th>b49a4100</th>
    <th>f5d8fbbd</th>
    <th>614234a0</th>
    <th>e20663d1</th>
  </tr>
  <tr>
    <th>6dcb46fd</th>
    <th>58178f93</th>
    <th>8cf54cfe</th>
    <th>cfdc27d7</th>
    <th>12e1e116</th>
    <th>6a61bc8f</th>
    <th>86f01bcb</th>
    <th>2efead4a</th>
  </tr>
  <tr>
    <th>68bbe09e</th>
    <th>17b403a1</th>
    <th>38aa1f27</th>
    <th>54323fe0</th>
    <th>77775a13</th>
    <th>d17b99d5</th>
    <th>eb773f5b</th>
    <th>2c3a5e7d</th>
  </tr>
</table>

Напомним, однако, что какими бы случайными ни казались значения слов в блоке гаммы, это еще далеко не гарантия безопасности.