---
source_image: page_291.png
page_number: 291
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.77
tokens: 7700
characters: 2204
timestamp: 2025-12-24T09:18:29.754068
finish_reason: stop
---

са. Трюк состоит в том, чтобы использовать возобновление сеанса — метод, при котором общий ключ, уже выработанный клиентом и сервером в предыдущем сеансе, используется для инициализации нового сеанса. Возобновление сеанса дает два важных преимущества: клиент может сразу же начать отправку зашифрованных данных, и в возобновленных сеансах нет нужды использовать сертификаты.

На рис. 13.2 показано, как работает возобновление сеанса. Сначала клиент отправляет сообщение ClientHello, которое включает идентификатор уже разделенного с сервером ключа (обозначен PSK, от pre-shared key — предварительно разделенный ключ), а также новый открытый ключ DH. Клиент также может включить в первое сообщение зашифрованные данные (они называются данными на нулевом периоде кругового обращения). Отвечая на сообщение ClientHello, сервер включает имитовставку, вычисленную по отправленным данным. Клиент проверяет имитовставку и понимает, что взаимодействует с тем же сервером, что и раньше, поэтому проверять сертификат излишне. Клиент и сервер выполняют протокол выработки ключа Диффи–Хеллмана, как при нормальном квитировании, и последующие сообщения шифруются ключами, зависящими как от PSK, так и от вновь вычисленного разделяемого секрета Диффи–Хеллмана.

Клиент
Сгенерировать пару ключей (c, C = cQ)

ClientHello
- ИД предварительного разделенного ключа (PSK)
- открытый ключ C
- данные на нулевом периоде кругового обращения

Сформировать keys = KDF(PSK, DH(c, S))
Проверить MAC с помощью keys

Сервер
Сгенерировать пару ключей (s, S = sQ)
Сформировать keys = KDF(PSK, DH(s, Q))

ServerHello
- ИД предварительно разделенного ключа (PSK)
- открытый ключ S

MAC, вычисленная по ClientHello, ServerHello

Рис. 13.2. Квитирование при возобновлении сеанса в TLS 1.3. Данные на нулевом периоде кругового обращения посылаются в составе сообщения ClientHello

Стойкость TLS

Мы оценим стойкость TLS 1.3 относительно двух главных аспектов безопасности, рассмотренных в главе 11: аутентификации и секретности прошлого.

Аутентификация

В процессе квитирования TLS 1.3 сервер аутентифицирует себя клиенту с помощью механизма сертификатов. Однако клиент не аутентифицирован, хотя и может аутентифицировать себя в серверном