---
source_image: page_254.png
page_number: 254
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.01
tokens: 7671
characters: 2008
timestamp: 2025-12-24T09:17:14.375584
finish_reason: stop
---

Протокол Диффи–Хеллмана с аутентификацией

Протокол Диффи–Хеллмана с аутентификацией был разработан для противостояния атаке с человеком посередине, вскрывающей анонимный протокол DH. В этом протоколе обе стороны располагают закрытым и открытым ключами, это позволяет Алисе и Бобу подписывать свои сообщения, чтобы Ева не могла отправлять сообщения от их имени. Подписи вычисляются не функцией DH, а по схеме подписания открытым ключом, например RSA-PSS. В результате, чтобы успешно подписывать сообщения от имени Алисы, Ева должна была бы подделать ее подпись, что невозможно, если схема подписания безопасна.

На рис. 11.4 показано, как работает протокол DH с аутентификацией.

![Протокол Диффи–Хеллмана с аутентификацией](https://i.imgur.com/3Q5z5QG.png)

Рис. 11.4. Протокол Диффи–Хеллмана с аутентификацией

Надпись Alice (priv_A, pub_B) в первой строке означает, что Алиса хранит свой закрытый ключ, privA, и открытый ключ Боба, pub_B. Эта пара ключей priv/pub называется долговременным ключом, потому что фиксирована заранее и остается неизменной при всех выполнениях протокола. Разумеется, долговременные ключи следует хранить в секрете, тогда как открытые ключи считаются известными противнику.

Сначала Алиса и Боб выбирают случайные показатели степени, a и b, как в анонимном протоколе DH. Затем Алиса вычисляет A и подпись sig_A, основываясь на сочетании своей функции подписания sign, своего закрытого ключа priv_A и A. Далее Алиса отправляет A и sig_A Бобу, который верифицирует sig_A ее открытым ключом pub_A. Если подпись недействительна, то Боб понимает, что сообщение пришло не от Алисы, и отбрасывает A.

Если подпись правильна, то Боб вычисляет g^{ab} по A и своему случайному показателю степени b. Затем он вычисляет B и свою подпись, основываясь на сочетании функции подписания sign, своего закрытого ключа priv_B и B. Далее Боб отправляет B и sig_B Алисе, которая пытается верифицировать sig_B открытым ключом Боба pub_B. Алиса вычисляет g^{ab}, только если подпись Боба действительна.