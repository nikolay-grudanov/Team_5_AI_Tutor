---
source_image: page_277.png
page_number: 277
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.45
tokens: 7804
characters: 2407
timestamp: 2025-12-24T09:17:57.771203
finish_reason: stop
---

purpose elliptic curves» (см. http://eprint.iacr.org/2013/647/), хотя они используются редко. Подробное описание всех этих кривых выходит за рамки данной книги.

Какие возможны проблемы

Недостатки эллиптических кривых связаны со сложностью и большой поверхностью атаки. Поскольку у них больше параметров, чем у классического протокола Диффи–Хеллмана, открывается больше возможностей для ошибок и неправильного использования, а возможно, и для программных дефектов в реализации. Программное обеспечение на основе эллиптических кривых может быть уязвимо к атакам по побочным каналам из-за больших чисел, участвующих в арифметических операциях. Если скорость вычислений зависит от входных данных, то противник может получить информацию о формулах, используемых при шифровании.

В следующих разделах я разберу два примера уязвимостей, которым подвержены эллиптические кривые, даже если реализация безопасна. Это уязвимости протокола, а не реализации.

ECDSA с недостаточной случайностью

Подписание ECDSA рандомизировано, поскольку в вычислении \( s = (h + rd)/k \bmod n \) участвует секретное случайное число \( k \). Однако если одно и то же \( k \) повторно используется для подписания второго сообщения, то противник мог бы объединить два значения, \( s_1 = (h_1 + rd)/k \) и \( s_2 = (h_2 + rd)/k \), получить \( s_1 - s_2 = (h_1 - h_2)/k \), затем и \( k = (h_1 - h_2)/(s_1 - s_2) \). Если \( k \) известно, то закрытый ключ \( d \) легко восстанавливается:

\[
(ks_1 - h_1)/r = ((h_1 + rd) - h_1)/r = rd/r = d.
\]

В отличие от RSA-подписей, которые не позволяют восстановить ключ, если используется слабый генератор псевдослучайных чисел (PRNG), в ECDSA недостаточно случайные числа могут привести к раскрытию \( k \), как случилось в атаке на игровую консоль PlayStation 3 в 2010 году, представленной группой fail0verflow на 27-м конгрессе хакеров Chaos Communication Congress в Берлине.

Взлом ECDH с помощью другой кривой

ECDH можно элегантно взломать, если пренебречь проверкой входных точек. Основная причина заключается в том, что формулы для вычисления координат суммы точек \( P + Q \) не содержат коэффициента \( b \), а зависят только от координат \( P \) и \( Q \) и коэффициента \( a \) (в случае удвоения точки). У этого факта есть печальное следствие — при сложении двух точек никогда нельзя быть уверенным, что вы работаете с правильной кривой, а не складываете точки, лежащие на кривой