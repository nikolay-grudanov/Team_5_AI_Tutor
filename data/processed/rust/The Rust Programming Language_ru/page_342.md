---
source_image: page_342.png
page_number: 342
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 59.42
tokens: 11730
characters: 2014
timestamp: 2025-12-24T10:33:05.643939
finish_reason: stop
---

CASE_INSENSITIVE . Функция env::var возвращает Result, который будет успешным вариантом ok содержащий значение переменной среды, если переменная среды установлена. Он вернёт вариант Err, если переменная окружения не установлена.

Мы используем метод is_err у Result, чтобы проверить возвращается ли ошибка и следовательно, переменная среды не установлена, что означает, что должен выполняться чувствительный к регистру поиск. Если для переменной среды CASE_INSENSITIVE что-либо задано, то is_err вернёт значение false и программа выполнит поиск без учёта регистра. Мы не заботимся о значении переменной среды, нас интересует только установлена она или нет, поэтому мы проверяем is_err, а не используем unwrap, expect или любой другой метод, который мы видели у Result.

Мы передаём значение переменной case_sensitive экземпляру Config, чтобы функция run могла прочитать это значение и решить, следует ли вызывать search или search_case_insensitive, как мы реализовали в листинге 12-22.

Давайте попробуем! Во-первых, мы запустим нашу программу без установленной переменной среды и с помощью значения запроса to, который должен соответствовать любой строке, содержащей слово «to» в нижнем регистре:

$ cargo run -- to poem.txt
Compiling minigrep v0.1.0 (file:///projects/minigrep)
Finished dev [unoptimized + debuginfo] target(s) in 0.0s
    Running `target/debug/minigrep to poem.txt`
Are you nobody, too?
How dreary to be somebody!

Похоже, все ещё работает! Теперь давайте запустим программу с CASE_INSENSITIVE, установленным в 1, но с тем же значением запроса to.

Если вы используете PowerShell, вам нужно установить переменную среды и запустить программу двумя командами, а не одной:

PS> $Env:CASE_INSENSITIVE=1; cargo run to poem.txt

Это заставит переменную окружения CASE_INSENSITIVE сохраниться до конца сеанса работы консоли. Переменную можно отключить с помощью команды Remove-Item:

PS> Remove-Item Env:CASE_INSENSITIVE

Мы должны получить строки, содержащие «to», которые могут иметь заглавные буквы: