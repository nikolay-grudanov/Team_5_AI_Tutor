---
source_image: page_609.png
page_number: 609
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.70
tokens: 11448
characters: 928
timestamp: 2025-12-24T10:43:51.513618
finish_reason: stop
---

Листинг 20-15: Изменение ThreadPool для хранения экземпляров Worker вместо непосредственного хранения потоков

Мы изменили имя поля в ThreadPool с threads на workers, потому что теперь оно содержит экземпляры Worker вместо экземпляров JoinHandle<()>. Мы используем счётчик в цикле for в качестве аргумента для Worker::new и сохраняем каждый новый Worker в векторе с именем workers.

Внешний код (вроде нашего сервера в src/bin/main.rs) не должен знать подробности реализации касательно использования структуры Worker внутри ThreadPool, поэтому мы делаем структуру Worker и её новую функцию new приватными. Функция Worker::new использует заданный нами id и сохраняет экземпляр JoinHandle<()>, который создаётся путём порождение нового потока с пустым замыканием.

Этот код скомпилируется и будет хранить количество экземпляров Worker, которое мы указали в качестве аргумента функции ThreadPool::new. Но мы все ещё не обрабатываем