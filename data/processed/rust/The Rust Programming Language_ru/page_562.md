---
source_image: page_562.png
page_number: 562
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 65.83
tokens: 11830
characters: 2173
timestamp: 2025-12-24T10:42:25.262495
finish_reason: stop
---

Расширенные типы

Система типов Rust имеет некоторые возможности, которые мы упоминали в этой книге, но ещё не обсуждали. Мы начнём с обсуждения новых типов (newtypes) в целом, по мере изучения того, почему новые типы полезны в качестве типов. Затем мы перейдём к псевдонимам, возможности похожей на новые типы (newtypes), но с немного другой семантикой. Мы также обсудим тип ! и с динамическими типами (dynamically sized type).

Использование Newtype шаблона для безопасности типов и реализации абстракций

Примечание. В следующем разделе предполагается, что вы прочитали предыдущий раздел "Использование шаблона Newtype для реализации внешних типажей у внешних типов"

Шаблон newtype полезен для задач помимо тех, которые мы обсуждали до сих пор, включая статическое обеспечение того, чтобы значения никогда не путались и указывали единицы значения. Вы видели пример использования newtype для обозначения единиц в листинге 19-15. Вспомним, что структуры Millimeters и Meters содержат обёрнутые значения u32 в newtype. Если бы мы написали функцию с параметром типа Millimeters, мы не смогли бы скомпилировать программу, которая случайно пыталась вызвать эту функция со значением типа Meters или обычным u32.

Другое использование шаблона newtype - абстрагирование от некоторых деталей реализации типа: новый тип может предоставлять открытый API, отличный от API приватного внутреннего типа, если мы напрямую использовали новый тип для ограничения доступного функционала, например.

Варианты шаблона (Newtypes) также могут скрывать внутреннюю реализацию. Например, мы могли бы предоставить тип People для оборачивания типа HashMap<i32, String>, которой хранит идентификатор человека связанного с его именем. Код использующий People будет взаимодействовать только с предоставляемым нами открытым API, например метод добавления строки имени в коллекцию People; этому коду не понадобилось бы знать, что мы внутри присваиваем ID код типа i32 именам. Шаблон newtype - это лёгкий способ добиться инкапсуляции, скрыть детали реализации, которые мы обсуждали в разделе "Инкапсуляция, которая скрывает детали реализации" главы 17.

Создание синонимов типа с помощью псевдонимов типа