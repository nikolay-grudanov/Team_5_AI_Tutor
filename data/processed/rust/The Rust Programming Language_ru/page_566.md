---
source_image: page_566.png
page_number: 566
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 55.75
tokens: 11738
characters: 2007
timestamp: 2025-12-24T10:42:15.771873
finish_reason: stop
---

Тип guess в этом коде должен быть целым числом и строкой и Rust требует, чтобы guess имел только один тип. Так что тогда возвращает код continue? Как нам разрешили вернуть u32 из одной ветки и иметь другую ветку заканчивающуюся на continue в листинге 19-26?

Как вы уже возможно догадались, continue имеет значение !. То есть, когда Rust вычисляет тип guess, он смотрит на обе сопоставляемые ветки, первая со значением u32 и последняя со значением!. Так как! никогда не может иметь значение, то Rust решает что типом guess является тип u32.

Формальным способом описания этого поведения является то, что выражения типа! могу быть приведены (coerced) к любому другому типу. Нам разрешено закончить сопоставление этой match ветки с помощью continue, потому что continue не возвращает значение; вместо этого она передаёт контроль обратно в начало цикла, поэтому в случае Err мы никогда не присваиваем guess значение.

Never тип полезен также с макросом panic!. Помните, функцию unwrap, которую мы вызываем для значений Option<T>, чтобы создать значение или вызвать панику? Вот её определение:

```rust
impl<T> Option<T> {
    pub fn unwrap(self) -> T {
        match self {
            Some(val) => val,
            None => panic!("called `Option::unwrap()` on a `None` value"),
        }
    }
}
```

В этом коде происходит то же самое, что и в выражении match из листинга 19-26: Rust видит, что val имеет тип T и panic! имеет тип!, поэтому общим результатом match выражения является T. Этот код работает, потому что panic! не производит значения; он завершает выполнение программы. В случае None, мы не будем возвращать значение из unwrap, поэтому этот код действительно.

Последнее выражение, которое имеет тип! это loop:

```rust
print!("forever ");
loop {
    print!("and ever ");
}
```

Здесь цикл никогда не заканчивается, так что! (never type) является значением выражения. Тем не менее, это не будет правдой, если мы добавим в цикл break, потому что цикл мог бы завершится, когда дело дойдёт до break.