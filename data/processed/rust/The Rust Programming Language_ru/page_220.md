---
source_image: page_220.png
page_number: 220
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 43.02
tokens: 11624
characters: 1586
timestamp: 2025-12-24T10:27:47.826912
finish_reason: stop
---

Чтение файла в строку довольно распространённая операция, так что стандартная библиотека предоставляет удобную функцию `fs::read_to_string`, которая открывает файл, создаёт новую `String`, читает содержимое файла, размещает его в `String` и возвращает её. Конечно, использование функции `fs::read_to_string` не даёт возможности объяснить обработку всех ошибок, поэтому мы сначала изучили длинный способ.

Где можно использовать оператор ?

? может использоваться только в функциях, тип возвращаемого значения которых совместим со значением ? используется на. Это потому, что ? оператор определён для выполнения раннего возврата значения из функции таким же образом, как и выражение match, которое мы определили в листинге 9-6. В листинге 9-6 match использовало значение Result, а ответвление с ранним возвратом вернуло значение Err(e). Тип возвращаемого значения функции должен быть Result, чтобы он был совместим с этим return.

В листинге 9-10 давайте посмотрим на ошибку, которую мы получим, если воспользуемся ? оператор в main функции с типом возвращаемого значения, несовместимым с типом используемого нами значения ? на:

Файл : src/main.rs

use std::fs::File;

fn main() {
    let greeting_file = File::open("hello.txt")?;
}

Листинг 9-10: Попытка использовать ? в main функции, которая возвращает (), не будет компилироваться

Этот код открывает файл, что может привести к сбою. ? оператор следует за значением Result, возвращаемым File::open, но эта main функция имеет возвращаемый тип (), а не Result. Когда мы компилируем этот код, мы получаем следующее сообщение об ошибке: