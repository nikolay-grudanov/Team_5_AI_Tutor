---
source_image: page_602.png
page_number: 602
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.55
tokens: 11592
characters: 1415
timestamp: 2025-12-24T10:43:39.599254
finish_reason: stop
---

Замечательно! Ошибка говорит о том, что нам нужен тип или модуль ThreadPool, поэтому мы создадим его сейчас. Наша реализация ThreadPool будет зависеть от того, какую работу выполняет наш веб-сервер. Итак, давайте переделаем крейт hello из бинарного в библиотечный для хранения реализации ThreadPool. После того, как поменяем в библиотечный крейт, мы также сможем использовать отдельную библиотеку пула потоков для любой работы, которую мы хотим выполнить с его использованием, а не только для обслуживания веб-запросов.

Создайте файл src/lib.rs, который содержит следующее, что является простейшим определением структуры ThreadPool, которую мы можем иметь в данный момент:

Файл: src/lib.rs

pub struct ThreadPool;

Затем создайте новый каталог src/bin и переместите двоичный крейт с корнем в src/main.rs в src/bin/main.rs. Это сделает библиотечный крейт основным крейтом в каталоге hello; мы все ещё можем запустить двоичный файл из src/bin/main.rs, используя cargo run. Переместив файл main.rs, отредактируйте его, чтобы подключить крейт библиотеки и добавить тип ThreadPool в область видимости, добавив следующий код в начало src/bin/main.rs:

Файл: src/bin/main.rs

{{#rustdoc_include ../listings/ch20-web-server/no-listing-01-define-threadpool-struct/src/bin/main.rs:here}}

Этот код по-прежнему не будет работать, но давайте проверим его ещё раз, чтобы получить следующую ошибку, которую нам нужно устранить: