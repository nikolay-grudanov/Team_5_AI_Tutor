---
source_image: page_625.png
page_number: 625
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.17
tokens: 11817
characters: 2112
timestamp: 2025-12-24T10:45:05.247747
finish_reason: stop
---

Обратите внимание на один интересный аспект этого конкретного выполнения: ThreadPool отправил сообщения о завершении в канал и прежде чем какой-либо рабочий получил сообщение, мы пытались присоединить (join) "работника" с номером 0. Рабочий поток 0 ещё не получил сообщение о прекращении, поэтому основной поток заблокировал ожидание потока 0 для завершения. Тем временем каждый из рабочих потоков получил сообщения об завершении. Когда рабочий поток 0 завершился, основной поток ждал окончания завершения выполнения остальных рабочих потоков. В этот момент все они получили сообщение о завершении и смогли завершиться.

Поздравления! Теперь мы завершили проект; у нас есть базовый веб-сервер, который использует пул потоков для асинхронных ответов. Мы можем выполнить корректное завершение работы сервера, который очищает все потоки в пуле.

Вот полный код для справки:

Файл: src/bin/main.rs

```rust
{{#rustdoc_include ../listings/ch20-web-server/no-listing-08-final-code/src/bin/main.rs}}
```

Файл: src/lib.rs

```rust
{{#rustdoc_include ../listings/ch20-web-server/no-listing-08-final-code/src/lib.rs}}
```

В коде можно сделать больше! Если вы хотите продолжить совершенствование этого проекта, вот несколько идей:

• Добавьте больше документации в ThreadPool и его публичным методам.
• Добавьте тесты функционалу из библиотеки.
• Заменить вызовы unwrap на более правильную обработку ошибок.
• Используйте ThreadPool для выполнения некоторых других задач, помимо обслуживания веб-запросов.
• Найдите крейт для пула потоков на crates.io и реализуйте аналогичный веб-сервер, используя такой крейт. Затем сравните его API и надёжность с пулом потоков, который мы реализовали.

Итоги

Отличная работа! Вы сделали это к концу книги! Мы хотим поблагодарить вас за то, что присоединились к нам в этом путешествии по языку Rust. Теперь вы готовы реализовать свои собственные проекты на Rust и помочь с проектами другим людям. Имейте в виду, что существует приветливое сообщество других Rust разработчиков, которые хотели бы помочь вам с любыми сложными задачами с которыми вы столкнётесь в своём Rust путешествии.