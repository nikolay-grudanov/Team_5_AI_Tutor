---
source_image: page_480.png
page_number: 480
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.64
tokens: 7508
characters: 1885
timestamp: 2025-12-24T10:58:26.687685
finish_reason: stop
---

могли протестировать значение внешней переменной. Листинг 18.27 показывает, как использовать ограничитель совпадения для устранения этой проблемы.

Листинг 18.27. Использование ограничителя совпадения для проверки равенства с внешней переменной

src/main.rs
```rust
fn main() {
    let x = Some(5);
    let y = 10;

    match x {
        Some(50) => println!("Получено 50"),
        Some(n) if n == y => println!("Совпадение, n = {:?}", n),
        _ => println!("Вариант по умолчанию, x = {:?}", x),
    }

    println!("в конце: x = {:?}, y = {:?}", x, y);
}
```

Теперь этот код выведет
```
Вариант по умолчанию, x = Some(5)
```

Паттерн во втором рукаве выражения match не вводит новую переменную y, которая затеняла бы внешнюю y, то есть мы можем использовать внешнюю y в ограничителе совпадения. Вместо задания паттерна как Some(y), который затенял бы внешнюю y, мы задаем Some(n). Так создается новая переменная n, которая ничего не затеняет, потому что вне выражения match переменной n нет.

Ограничитель совпадения if n == y не является паттерном и, следовательно, не вводит новые переменные. Эта переменная y является внешней, а не новой затененной переменной y, и мы можем найти такое же значение, как и у внешней y, сравнив n с y.

В ограничителе совпадения также можно использовать оператор или (|) для задания более одного паттерна. Условие ограничителя совпадения будет применяться ко всем паттернам. В листинге 18.28 показан приоритет комбинирования ограничителя совпадения с паттерном, использующим |. Важная часть этого примера заключается в том, что ограничитель совпадения if у применяется к 4, 5 и 6, хотя он может выглядеть так, как будто if у применяется только к 6.

Листинг 18.28. Сочетание нескольких паттернов с помощью ограничителя совпадения
```rust
let x = 4;
let y = false;

match x {
    4 | 5 | 6 if y => println!("да"),
    _ => println!("нет"),
}
```