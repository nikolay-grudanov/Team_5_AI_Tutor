---
source_image: page_288.png
page_number: 288
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.21
tokens: 7497
characters: 2006
timestamp: 2025-12-24T10:53:19.959522
finish_reason: stop
---

также обновили код, который ранее использовал отдельные переменные query и filename, поэтому теперь он использует поля в структуре Config 2 3 4.

Теперь код гораздо четче передает идею о том, что query и filename взаимосвязаны и что их цель — настроить порядок работы программы. Любой код, использующий эти значения, знает, что их можно найти в экземпляре структуры Config в полях, названных по их назначению.

Создание конструктора для Config

Пока что мы извлекли алгоритм, который отвечает за проведение разбора аргументов командной строки, из функции main, и поместили его в функцию parse_config. Это помогло нам увидеть, что значения query и filename взаимосвязаны, и смысл этой связи должен быть передан в коде. Затем мы добавили структуру Config, чтобы обозначить взаимосвязанную цель значений query и filename и иметь возможность возвращать имена этих значений в качестве имен полей структуры из функции parse_config.

Поэтому теперь, когда цель функции parse_config — создание экземпляра структуры Config, мы можем изменить обыкновенную функцию parse_config на функцию с именем new, которая связана со структурой Config. Внесение этого изменения сделает код выразительнее. Мы можем создавать экземпляры типов стандартной библиотеки, таких как String, вызывая String::new. Схожим образом, поменяв parse_config на функцию new, связанную со структурой Config, мы сможем создавать экземпляры Config, вызывая Config::new. Листинг 12.7 показывает, какие изменения необходимо внести.

Листинг 12.7. Замена parse_config на Config::new
src/main.rs
```rust
fn main() {
    let args: Vec<String> = env::args().collect();

    let config = Config::new(&args);
    // --пропуск--
}

impl Config {
    fn new(args: &[String]) -> Config {
        let query = args[1].clone();
        let filename = args[2].clone();
        Config { query, filename }
    }
}
```

Мы обновили функцию main там, где вызывали parse_config, чтобы вызывать Config::new 1. Мы изменили имя parse_config на new 3 и переместили ее в блок