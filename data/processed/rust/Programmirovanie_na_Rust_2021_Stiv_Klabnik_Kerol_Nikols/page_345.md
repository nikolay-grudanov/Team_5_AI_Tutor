---
source_image: page_345.png
page_number: 345
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.72
tokens: 7556
characters: 2144
timestamp: 2025-12-24T10:54:56.518730
finish_reason: stop
---

Ошибки

Если функция возвращает Result, то описание видов ошибок, которые могут возникнуть, и условий, которые могут привести к возвращению этих ошибок, может оказаться полезным для ее пользователей при написании своего кода по обработке разных видов ошибок разными способами.

Безопасность

Если функция помечена как небезопасная для вызова (мы обсудим небезопасность, unsafe, в главе 19), то должен быть раздел, объясняющий, почему функция небезопасна. В нем также должны быть описаны инварианты, которые функция ожидает от вызывающих ее пользователей.

Большинство документационных комментариев не нуждаются в этих разделах, но приведенный выше перечень — это хороший контрольный список, служащий напоминанием о тех аспектах кода, которые будут интересны людям, его вызывающим.

Документационные комментарии в качестве тестов

Добавление демонстрационных блоков кода в документационные комментарии помогает проиллюстрировать способы применения библиотеки, причем, делая так, вы получаете дополнительный бонус: выполнение cargo test запустит примеры кода вашей документации в качестве тестов! Нет ничего лучше документирования с примерами. Но нет ничего хуже примеров, которые не работают, потому что код изменился с момента написания документации. Если мы выполним тест с документацией для функции add_one из листинга 14.1, то увидим раздел в результатах теста, подобный этому:

Doc-tests my_crate

running 1 test
test src/lib.rs - add_one (line 5) ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out

Теперь, если мы изменим либо функцию, либо пример так, что assert_eq! поднимет панику, и снова выполним команду cargo test, то увидим, что документационные тесты фиксируют, что пример и код не синхронизированы друг с другом.

Комментирование внутри элементов

Еще один стиль документационного комментария — //! — добавляет документацию в элемент, содержащий комментарии, а не в элементы, которые следуют за комментариями. Обычно мы используем эти документационные комментарии внутри корневого файла упаковки (по общему правилу в src/lib.rs) или внутри модуля для документирования упаковки или модуля в целом.