---
source_image: page_536.png
page_number: 536
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.78
tokens: 7497
characters: 1851
timestamp: 2025-12-24T10:59:52.615691
finish_reason: stop
---

<title>Привет!</title>
</head>
<body>
<h1>Привет!</h1>
<p>Привет от Rust</p>
</body>
</html>

Это минимальный документ HTML5 с заголовком и некоторым текстом. Для того чтобы вернуть его с сервера при получении запроса, мы изменим функцию handle_connection, как показано в листинге 20.5, так, чтобы прочитать HTML-файл, добавить его в ответ в качестве тела и отправить.

Листинг 20.5. Отправка содержимого hello.html в качестве тела ответа src/main.rs

1 use std::fs;
// --пропуск--

fn handle_connection(mut stream: TcpStream) {
    let mut buffer = [0; 512];
    stream.read(&mut buffer).unwrap();

    let contents = fs::read_to_string("hello.html").unwrap();

    2 let response = format!("HTTP/1.1 200 OK\r\n\r\n{}", contents);
    stream.write(response.as_bytes()).unwrap();
    stream.flush().unwrap();
}

Мы добавили строку вверху, чтобы ввести модуль файловой системы стандартной библиотеки в область видимости 1. Код для чтения содержимого файла в строку должен выглядеть знакомо: мы использовали его в главе 12, когда читали содержимое файла для проекта ввода-вывода в листинге 12.4.

Далее мы используем макрокоманду format! для добавления содержимого файла в тело ответа об успешном выполнении 2.

Выполните этот код с помощью команды cargo run и загрузите 127.0.0.1:7878 в свой браузер. Вы должны увидеть, что HTML отображен на экране!

В настоящее время мы игнорируем данные запроса в переменной buffer и просто отправляем обратно содержимое HTML-файла в безусловном порядке. Это означает, что если вы попытаетесь запросить в браузере 127.0.0.1:7878/что-то-еще, то все равно получите тот же HTML-ответ. Наш сервер очень ограничен и не делает того, что делает большинство веб-серверов. Мы хотим настраивать ответы индивидуально, в зависимости от запроса, и отправлять обратно HTML-файл только для хорошо сформированного запроса ресурса /.