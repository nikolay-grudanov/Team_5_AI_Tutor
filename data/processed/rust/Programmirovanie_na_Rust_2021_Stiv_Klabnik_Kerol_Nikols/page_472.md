---
source_image: page_472.png
page_number: 472
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.15
tokens: 7471
characters: 1687
timestamp: 2025-12-24T10:58:13.479565
finish_reason: stop
---

Приведенный код выведет:

Поменять цвет на красный 0, зеленый 160 и синий 255

Попробуйте изменить значение msg ① и посмотрите, как будет выполняться код из других рукавов.

В случае вариантов перечисления без каких-либо данных, таких как Message::Quit ②, мы не можем деструктурировать значение дальше. Можно выполнить сопоставление только для литературного значения Message::Quit, в этом паттерне никаких переменных нет.

В случае с вариантами перечисления, подобными структуре, такими как Message::Move ③, мы можем использовать паттерн, похожий на тот, который указывается для сопоставления структур. После имени варианта мы помещаем фигурные скобки, а затем перечисляем поля с переменными, чтобы разложить части, используемые в коде для этого рукава. Здесь мы используем сокращенную форму, как и в листинге 18.13.

В случае с вариантами перечисления, подобными кортежу, такими как Message::Write, содержащий кортеж с одним элементом ④ и Message::ChangeColor, который содержит кортеж с тремя элементами ⑤, этот паттерн похож на тот, который мы указываем для сопоставления кортежей. Число переменных в паттерне должно совпадать с числом элементов в варианте, который мы сопоставляем.

Деструктурирование вложенных структур и перечислений

До сих пор во всех примерах сопоставлялись структуры или перечисления, которые были на один уровень в глубину. Сопоставление может работать и с вложенными элементами!

Например, можно выполнить рефакторинг кода из листинга 18.15 для поддержки цветов RGB и HSV в сообщении ChangeColor, как показано в листинге 18.16.

Листинг 18.16. Сопоставление вложенных перечислений

enum Color {
    Rgb(i32, i32, i32),
    Hsv(i32, i32, i32)
}

enum Message {