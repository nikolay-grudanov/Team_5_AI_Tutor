---
source_image: page_236.png
page_number: 236
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.13
tokens: 7578
characters: 2147
timestamp: 2025-12-24T10:52:02.083329
finish_reason: stop
---

ПРИМЕЧАНИЕ

Примеры в листингах 10.17, 10.18 и 10.24 объявляют переменные без указания их начального значения, поэтому имя переменной существует во внешней области видимости. На первый взгляд это может показаться противоречащим тому, что Rust не имеет значений null. Однако если мы попытаемся использовать переменную перед тем, как дать ей значение, то получим ошибку времени компиляции, которая показывает, что Rust действительно не допускает значений null.

Внешняя область видимости объявляет переменную с именем r без начального значения ①, а внутренняя область объявляет переменную с именем x с начальным значением 5 ②. Внутри внутренней области мы пытаемся установить значение r как ссылку на x ③. Затем внутренняя область заканчивается ④, и мы пытаемся напечатать значение в r ⑤. Этот код не компилируется, потому что значение, на которое r ссылается, вышло из области видимости до того, как мы попытаемся его использовать. Вот сообщение об ошибке¹:

error[E0597]: `x` does not live long enough
 --> src/main.rs:7:5
  |
6 |     r = &x;
   |         - borrow occurs here
7 |   }
   | ^ `x` dropped here while still borrowed
...
10 |   }
   | - borrowed value needs to live until here

Переменная x «живет недостаточно долго». Причина в том, что x будет вне области видимости, когда внутренняя область закончится в ④. Но переменная r все еще является действительной для внешней области; поскольку ее область крупнее, мы говорим, что указанная переменная «живет дольше». Если бы Rust позволил этому коду работать, то переменная r ссылалась бы на память, которая высвободилась, когда переменная x вышла из области видимости, и все, что мы попытались бы сделать с r, сработало бы некорректно. Тогда каким образом язык Rust выясняет, что этот код недопустим? Он использует контролер заимствования.

Контролер заимствования

В компиляторе Rust имеется контролер заимствования, который сравнивает области видимости, чтобы выяснить, являются ли все заимствования действительноными. В листинге 10.18 приведен тот же код, что и в листинге 10.17, но с аннотациями, показывающими жизненный цикл переменных.

¹ ошибка[E0597]: `x` живет недостаточно долго