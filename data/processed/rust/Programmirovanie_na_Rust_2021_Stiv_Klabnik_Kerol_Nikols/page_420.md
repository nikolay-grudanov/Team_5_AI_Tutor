---
source_image: page_420.png
page_number: 420
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.48
tokens: 7539
characters: 2180
timestamp: 2025-12-24T10:56:53.529789
finish_reason: stop
---

Получено: сообщения
Получено: для
Получено: потока
Получено: исполнения
Получено: вас

Возможно, вы увидите значения в другом порядке — результат зависит от вашей системы. Именно это делает конкурентность интересной и одновременно сложной. Если вы поэкспериментируете с функцией thread::sleep, давая ей разные значения в разных потоках, то каждый прогон будет менее детерминированным и каждый раз будет создавать разные данные на выходе.

Теперь, познакомившись с работой каналов, давайте посмотрим на другой метод конкурентности.

Конкурентность совместного состояния

Передача сообщений — это прекрасный способ конкурентности, но не единственный. Еще раз обратите внимание на часть слогана из документации языка Go: «Делитесь памятью, общаясь».

Как будет выглядеть общение, при котором делятся памятью? Вдобавок, почему энтузиасты передачи сообщений так не делают, а поступают наоборот?

В некотором смысле каналы в любом языке программирования подобны одинарному владению, потому что после пересылки значения по каналу вы больше не должны использовать это значение. Конкурентность совместной памяти подобна множественному владению: несколько потоков исполнения могут одновременно обращаться к одному и тому же месту в памяти. Как вы видели в главе 15, множественное владение стало возможным благодаря умным указателям. Множественное владение добавляет сложность, потому что разные владельцы нуждаются в управлении. Система типов и правила владения языка Rust значительно обеспечивают надлежащее управление. Для примера давайте рассмотрим мьютексы, один из наиболее часто встречающихся примитивов конкурентности для совместной памяти.

Использование мьютексов для обеспечения доступа к данным из одного потока за один раз

Мьютекс — это сокращение английского термина mutual exclusion, «взаимное исключение», то есть мьютекс позволяет обращаться к неким данным в любой момент времени только одному потоку. Для того чтобы обратиться к данным в мьютексе, поток должен сначала подать сигнал о том, что он хочет получить доступ, сделав запрос на получение замка мьютекса. Замок — это структура данных, часть мьютекса, которая отслеживает, кто в настоящее время имеет исключительный