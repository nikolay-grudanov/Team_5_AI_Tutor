---
source_image: page_145.png
page_number: 145
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.01
tokens: 7576
characters: 2211
timestamp: 2025-12-24T10:49:35.280601
finish_reason: stop
---

Сжатое управление потоком с помощью if let

Синтаксис if let позволяет кратко совместить if и let для обработки значений, которые совпадают с одним паттерном, игнорируя остальные. Рассмотрим программу в листинге 6.6, которая имеет совпадение в значении Option<u8>, но исполнит код только в том случае, если значение равно 3.

Листинг 6.6. Выражение match, которое исполнит код, только когда значение равно Some(3)

let some_u8_value = Some(0u8);
match some_u8_value {
    Some(3) => println!("три"),
    _ => (),
}

Нам нужно произвести определенные действия с совпадением Some(3), но ничего не нужно делать с любым другим значением Some<u8> или значением None. Для того чтобы выражение match было удовлетворено, нам приходится добавить _ => () после обработки только одного варианта, что в итоге приводит к добавлению большого объема стереотипного кода.

Вместо этого мы могли бы сделать более краткую запись, используя if let. Следующий код ведет себя так же, как и выражение match в листинге 6.6:

if let Some(3) = some_u8_value {
    println!("три");
}

Синтаксис if let берет паттерн и выражение, отделенные знаком равенства. Он работает так же, как и синтаксис match, где выражение передается в match, а этот паттерн является его первым рукавом.

Использование if let означает, что нужно печатать меньше текста, делать меньше отступов и писать меньше стереотипного кода. Однако вы теряете исчерпывающую проверку, которую обеспечивает выражение match. Выбор между match и if let зависит от того, что вы делаете в конкретной ситуации и является ли краткость подходящим компромиссом в случае потери исчерпывающей проверки.

Другими словами, вы можете думать об if let как о синтаксическом сахаре для match, которое выполняет код, когда значение совпадает с одним паттерном, а потом игнорирует все остальные значения.

Мы можем добавить вариант else в if let. Блок кода, который сопровождает else, является таким же, как блок кода, который будет идти вместе с _ в случае выражения match, что равносильно if let и else. Вспомните определение перечисления Coin в листинге 6.4, где вариант Quarter также содержал значение UsState. Если бы мы хотели пересчитать все монеты, не являющиеся четвертаками, которые ви-