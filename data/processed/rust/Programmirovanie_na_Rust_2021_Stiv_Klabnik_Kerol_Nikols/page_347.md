---
source_image: page_347.png
page_number: 347
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.33
tokens: 7611
characters: 2206
timestamp: 2025-12-24T10:55:01.206212
finish_reason: stop
---

Экспорт удобного публичного API с использованием pub

В главе 7 мы рассмотрели использование ключевых слов mod, pub и use, способы организации кода в модули с помощью mod, а также то, как делать элементы публичными с помощью pub и как вводить их в область видимости с помощью use. Однако структура, понятная вам, пока вы разрабатываете упаковку, возможно, будет не очень удобной для пользователей. Вы, возможно, захотите организовать свои структуры в иерархию, содержащую несколько уровней, но тогда тем, кто захочет использовать тип, размещенный вами глубоко в иерархии, может быть трудно обнаружить, что он существует. Возможно, их также будет раздражать необходимость вводить use my_crate::некий_модуль::еще_один_модуль::ПолезныйТип; вместо того, чтобы использовать my_crate::ПолезныйТип;.

Структура публичного API — важный фактор при публикации упаковки. Люди, использующие вашу упаковку, мало знакомы с ее структурой, в отличие от вас, и им может быть трудно найти нужные элементы, если в упаковке большая иерархия модулей.

Хорошая новость заключается в том, что если структурой неудобно пользоваться другим людям из другой библиотеки, то вам не нужно перестраивать свою внутреннюю организацию. Вместо этого вы можете реэкспортировать элементы, чтобы создать публичную структуру, отличную от вашей конфиденциальной структуры, с помощью pub use. Реэкспорт берет публичный элемент в одном месте и делает его публичным в другом месте, как если бы он и был там определен.

Допустим, мы создали библиотеку под названием art для моделирования художественных концепций. В этой библиотеке есть два модуля: kinds, содержащий два перечисления с именами PrimaryColor и SecondaryColor, и utils, содержащий функцию mix, как показано в листинге 14.3.

Листинг 14.3. Художественная библиотека с элементами, организованными в модули kinds и utils
src/lib.rs

//! # Художественная живопись
//!
//! Библиотека для моделирования художественных концепций.
pub mod kinds {
    /// Первичные цвета согласно цветовой модели RYB.
    pub enum PrimaryColor {
        Red,
        Yellow,
        Blue,
    }

    /// Вторичные цвета согласно цветовой модели RYB.
    pub enum SecondaryColor {
        Orange,
        Green,
