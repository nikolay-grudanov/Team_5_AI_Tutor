---
source_image: page_443.png
page_number: 443
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.27
tokens: 7517
characters: 2126
timestamp: 2025-12-24T10:57:32.099833
finish_reason: stop
---

Тип String реализует типаж Clone. Вызывая метод clone для экземпляра String, мы получаем обратно экземпляр типа String. Схожим образом, если мы вызываем метод clone для экземпляра типа Vec<T>, то получаем обратно экземпляр типа Vec<T>. Сигнатура метода clone должна знать, какой тип будет использоваться для Self, потому что этот тип возвращается.

Компилятор выдаст сообщение, если вы попытаетесь сделать что-то против правил объектной безопасности в отношении типажных объектов. Допустим, мы попытались реализовать структуру Screen в листинге 17.4 для хранения типов, реализующих типаж Clone вместо типажа Draw, как тут:

pub struct Screen {
    pub components: Vec<Box<dyn Clone>>,
}

получаем такую ошибку¹:

error[E0038]: the trait `std::clone::Clone` cannot be made into an object
 --> src/lib.rs:2:5
  |
2 |     pub components: Vec<Box<dyn Clone>>,
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `std::clone::Clone` cannot be made into an object
  |
  = note: the trait cannot require that `Self : Sized`

Указанная ошибка означает, что вы не можете использовать этот типаж в качестве типажного объекта в таком виде. Если вас интересует более подробная информация об объектной безопасности, то обратитесь к Rust RFC 255 по адресу https://github.com/rust-lang/rfcs/blob/master/text/0255-object-safety.md/.

Реализация объектно-ориентированного паттерна проектирования

Паттерн переходов между состояниями — это объектно-ориентированный паттерн проектирования. Суть этого паттерна в том, что у значения есть некое внутреннее состояние, представленное совокупностью объектов состояния, и поведение данного значения изменяется в зависимости от этого внутреннего состояния. Объекты состояния имеют общий функционал: в Rust, конечно, мы используем структуры и типажи, а не объекты и наследование. Каждый объект состояния отвечает за свое поведение и за управление тем, когда он должен переходить в другое состояние. Значение, содержащее объект состояния, ничего не знает о разном поведении состояний и о том, когда переходить между состояниями.

¹ ошибка[E0038]: типаж 'std::clone::Clone' не может быть переделан в объект