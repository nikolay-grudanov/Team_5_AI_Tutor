---
source_image: page_529.png
page_number: 529
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.30
tokens: 7584
characters: 2237
timestamp: 2025-12-24T10:59:45.367090
finish_reason: stop
---

Но прежде чем начать, мы должны уточнить одну деталь: метод, который мы будем использовать, — не лучший способ сборки веб-сервера с помощью Rust. Ряд готовых к производству упаковок доступен на https://crates.io/, и все они обеспечивают более полные реализации веб-сервера и пула потоков исполнения, чем та, что сделаем мы.

Однако наша цель — помочь вам освоить материал, а не идти по пути наименьшего сопротивления. Поскольку Rust — это язык системного программирования, мы можем выбрать уровень абстракции, с которым хотим работать, а можем перейти на более низкий уровень, чем это возможно в других языках. Мы напишем базовый HTTP-сервер и пул потоков исполнения вручную, чтобы вы могли усвоить общие идеи и технические приемы, лежащие в основе упаковок, которые вы, возможно, будете использовать в будущем.

Сборка однопоточного сервера

Начнем с того, что приведем в рабочее состояние однопоточный веб-сервер. Прежде чем начать, давайте кратко рассмотрим протоколы, участвующие в создании веб-серверов. Подробности выходят за рамки темы данной книги, поэтому мы кратко предоставим самую важную информацию.

Двумя главными протоколами, используемыми в веб-серверах, являются протокол передачи гипертекста (HTTP) и протокол управления передачей (TCP). Оба являются протоколами запросов-ответов, то есть клиент инициирует запросы, а сервер слушает их и дает клиенту ответ. Содержание этих запросов и ответов определяется протоколами.

Протокол TCP находится на более низком уровне и описывает детали того, как информация поступает из одного сервера на другой, но не указывает, что это за информация. HTTP строится поверх TCP, определяя содержимое запросов и ответов. Технически существует возможность использования HTTP с другими протоколами, но в подавляющем большинстве случаев HTTP отправляет данные по протоколу TCP. Мы будем работать с сырыми байтами запросов и ответов TCP и HTTP.

Прослушивание TCP-соединения

Веб-сервер должен прослушивать TCP-соединение, и поэтому данная часть будет первой, над которой мы будем работать. Стандартная библиотека предлагает модуль std::net, позволяющий это сделать. Давайте создадим новый проект обычным образом:

$ cargo new hello
    Created binary (application) `hello` project
$ cd hello