---
source_image: page_294.png
page_number: 294
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.00
tokens: 7449
characters: 1858
timestamp: 2025-12-24T10:53:26.120288
finish_reason: stop
---

тор ? будет возвращать значение ошибки из текущей функции, чтобы вызывающий код обработал ее.

В-третьих, функция run теперь возвращает значение Ok в случае успеха ④. Мы объявили тип успеха функции run как () в сигнатуре — это означает, что нужно обернуть значение пустого типа в значение Ok. Синтаксис Ok(()) на первый взгляд может показаться немного странным, но такое использование () — это идиоматический способ, указывающий, что мы вызываем функцию run только ради ее побочных эффектов. Она не возвращает нужное значение.

Когда вы выполните этот код, он скомпилируется, но выдаст предупреждение¹:

    warning: unused `std::result::Result` that must be used
    --> src/main.rs:17:5
     |
    17 |     run(config);
     |     ^^^^^^^^^^^^
    = note: #[warn(unused_must_use)] on by default
    = note: this `Result` may be an `Err` variant, which should be handled

Код проигнорировал значение Result, а значение Result, возможно, указывает, что произошла ошибка. Но мы не проверяем, была ли ошибка, и компилятор напоминает нам о том, что мы, вероятно, хотели бы иметь здесь некий код обработки ошибок! Давайте пофиксим.

Обработка ошибок в функции main, возвращаемых из функции run

Мы проверим, есть ли ошибки, и обработаем их с помощью приема, аналогичного тому, который мы использовали с Config::new в листинге 12.10, но с небольшим отличием:

src/main.rs
    fn main() {
        // --пропуск--

        println!("Поиск {}", config.query);
        println!("В файле {}", config.filename);

        if let Err(e) = run(config) {
            println!("Ошибка в приложении: {}", e);
            process::exit(1);
        }
    }

Мы используем if let вместо метода unwrap_or_else для проверки, что функция run возвращает значение Err, и вызываем process::exit(1), если это так.

¹ неиспользуемый `std::result::Result`, который должен быть использован