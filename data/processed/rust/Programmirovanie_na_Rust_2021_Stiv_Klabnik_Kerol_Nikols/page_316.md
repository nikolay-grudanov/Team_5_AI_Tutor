---
source_image: page_316.png
page_number: 316
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.17
tokens: 7576
characters: 2309
timestamp: 2025-12-24T10:54:05.146409
finish_reason: stop
---

с пары вертикальных черт (|), внутри которых задаем параметры замыкания. Этот синтаксис был выбран из-за его сходства с определениями замыкания в Smalltalk и Ruby. Это замыкание имеет один параметр с именем num: если бы у нас было больше одного параметра, то мы бы разделили их запятыми, как |param1, param2|.

После параметров мы помещаем фигурные скобки, которые содержат тело замыкания, — они являются необязательными, если тело замыкания представлено одним выражением. В конце замыкания, после фигурных скобок, требуется точка с запятой в завершение инструкции let. Значение, возвращаемое из последней строки в теле замыкания (num), будет значением, возвращаемым из замыкания при его вызове, потому что эта строка кода не заканчивается точкой с запятой, как в телах функций.

Обратите внимание, инструкция let означает, что переменная expensive_closure содержит определение анонимной функции, а не результирующее значение вызова анонимной функции. Вспомните, что мы используем замыкание, потому что хотим определить некий код для того, чтобы вызвать его в одном месте, сохранить и вызвать его позже в другом месте. Код, который мы хотим вызвать, теперь хранится в переменной expensive_closure.

После определения замыкания мы можем изменить код в блоках if так, чтобы вызывать замыкание для выполнения кода и получать результирующее значение. Мы вызываем замыкание так же, как и функцию: указывая имя переменной, содержащей определение замыкания, и круглые скобки, включающие значения аргументов, которые мы хотим использовать, как показано в листинге 13.6.

Листинг 13.6. Вызов замыкания expensive_closure, которое мы определили src/main.rs

fn generate_workout(intensity: u32, random_number: u32) {
    let expensive_closure = |num| {
        println!("вычисляется медленно...");
        thread::sleep(Duration::from_secs(2));
        num
    };

    if intensity < 25 {
        println!(
            "Сегодня сделайте {} отжиманий!",
            expensive_closure(intensity)
        );
        println!(
            "Далее, сделайте {} приседаний!",
            expensive_closure(intensity)
        );
    } else {
        if random_number == 3 {
            println!("Сделайте сегодня перерыв! Пейте больше воды!");
        } else {
            println!(
                "Сегодня пробежка {} минут!",
