---
source_image: page_239.png
page_number: 239
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 42.57
tokens: 7795
characters: 2863
timestamp: 2025-12-24T10:52:13.366723
finish_reason: stop
---

Текст справки раскрывает, что возвращаемый тип нуждается в параметре обобщенного жизненного цикла, потому что Rust не может отличить, к чему относится возвращаемая ссылка — к x или к y. На самом деле мы тоже этого не знаем, потому что блок if в теле этой функции возвращает ссылку на x, а блок else возвращает ссылку на y!

Когда мы определяем эту функцию, мы не знаем конкретных значений, которые будут переданы внутрь нее, а потому не знаем, какой случай будет исполняться — if или else. Нам также неизвестны конкретные жизненные циклы ссылок, которые будут передаваться, поэтому мы не можем посмотреть на области, как это было в листингах 10.18 и 10.19, чтобы выяснить, что ссылка, которую мы возвращаем, всегда будет действительно. Контролер заимствования тоже не может это выяснить, потому что он не знает, как жизненный цикл x и y соотносится с жизненным циклом возвращаемого значения. Для устранения этой ошибки мы добавим параметры обобщенных жизненных циклов, которые определяют связь между ссылками, благодаря чему контролер заимствования сможет выполнить анализ.

Синтаксис аннотаций жизненных циклов

Аннотации жизненных циклов не изменяют протяженность жизни ссылки. Функции могут принимать ссылки с любым жизненным циклом, уточняя параметр обобщенного жизненного цикла подобно тому, как они принимают любой тип, когда сигнатура конкретизирует параметр обобщенного типа. Аннотации жизненных циклов описывают связи между жизненными циклами нескольких ссылок друг с другом, не влияя на жизненный цикл.

У аннотаций жизненных циклов несколько необычный синтаксис: имена параметров должны начинаться с одной кавычки ('). Обычно все они находятся в нижнем регистре и очень короткие, как и обобщенные типы. Большинство людей используют имя 'a. Мы помещаем аннотации параметров жизненных циклов после знака & ссылки, используя пробел для отделения аннотации от типа ссылки.

Вот несколько примеров: ссылка на тип i32 без параметра жизненного цикла, ссылка на тип i32, которая имеет параметр жизненного цикла с именем 'a, и изменяемая ссылка на тип i32, которая также имеет жизненный цикл 'a.

    &i32      // ссылка
    &'a i32   // ссылка с явно выраженным жизненным циклом
    &'a mut i32 // изменяемая ссылка с явно выраженным жизненным циклом

Одна аннотация жизненного цикла сама по себе не имеет большого значения, потому что аннотации задуманы для того, чтобы сообщать компилятору, как параметры обобщенных жизненных циклов нескольких ссылок связаны друг с другом. Допустим, у нас есть функция с параметром first, который является ссылкой на тип i32 с жизненным циклом 'a. Указанная функция также имеет еще один параметр second, который является еще одной ссылкой на тип i32, у которого тоже есть жизненный цикл 'a. Аннотации жизненных циклов указывают на то, что обе ссылки, first и second, должны жить в течение этого обобщенного жизненного цикла.