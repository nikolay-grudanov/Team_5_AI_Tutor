---
source_image: page_326.png
page_number: 326
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.79
tokens: 7535
characters: 1959
timestamp: 2025-12-24T10:54:21.724256
finish_reason: stop
---

и функции main больше не разрешено использовать х в макрокоманде println!. Удаление макрокоманды println! исправит этот пример.

Во время указания одной из границ типажа Fn в большинстве случаев вы можете начать с Fn, а компилятор сообщит о необходимости иметь FnMut или FnOnce, осно-вываясь на том, что происходит в теле замыкания.

В качестве примера, когда замыкания, которые захватывают свою среду, полезны в виде параметров функций, давайте перейдем к следующей теме — итераторам.

Обработка серий элементов с помощью итераторов

Итераторный паттерн позволяет поочередно выполнять работу с последовательностью элементов. Итератор отвечает за логику перебора каждого элемента и определяет, когда эта последовательность закончилась. Когда вы используете итераторы, вам не нужно повторно реализовывать эту логику самим.

В Rust итераторы являются ленивыми, то есть не действуют, пока вы не вызовете методы, которые потребляют итератор до его исчерпания. Например, код в листинге 13.13 создает итератор над элементами вектора v1, вызывая метод iter, определенный для Vec<T>. Этот код сам по себе не делает ничего полезного.

Листинг 13.13. Создание итератора
let v1 = vec![1, 2, 3];
let v1_iter = v1.iter();

После создания итератора можно использовать его различными способами. В листинге 3.5 мы применили итераторы с циклами for, чтобы исполнить код для каждого элемента, хотя тогда мы сознательно умолчали о том, что делает вызов метода iter, отложив это до настоящего момента.

Пример в листинге 13.14 отделяет создание итератора от его использования в цикле for. Итератор хранится в переменной v1_iter, и тогда не происходит никаких итераций. При вызове цикла for с применением итератора в v1_iter каждый элемент в итераторе используется в одной итерации цикла, которая выводит каждое значение.

Листинг 13.14. Использование итератора в цикле for
let v1 = vec![1, 2, 3];
let v1_iter = v1.iter();
for val in v1_iter {
    println!("Получено: {}", val);
}