---
source_image: page_544.png
page_number: 544
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.98
tokens: 7537
characters: 2152
timestamp: 2025-12-24T11:00:07.309742
finish_reason: stop
---

Отлично! Эта ошибка говорит о том, что нужен тип или модуль ThreadPool, поэтому создадим его прямо сейчас. Реализация типа ThreadPool не будет зависеть от вида работы, которую выполняет веб-сервер. Поэтому давайте переключим упаковку hello с двоичной на библиотечную, где будет храниться реализация типа ThreadPool. После перехода к библиотечной упаковке мы также можем использовать отдельную библиотеку пула потоков исполнения для любой работы, которую мы хотим выполнять с помощью указанного пула, а не только для обслуживания веб-запросов.

Создайте файл src/lib.rs, который содержит самое простое определение структуры ThreadPool, возможное на данный момент, а именно:

src/lib.rs
    pub struct ThreadPool;

Затем создайте новый каталог, src/bin, и переместите двоичную упаковку из src/main.rs в src/bin/main.rs. В результате библиотечная упаковка станет первичной в каталоге hello. Мы по-прежнему можем выполнять двоичный код в src/bin/main.rs с помощью команды cargo run. После перемещения файла main.rs отредактируйте его так, чтобы внести библиотечную упаковку и ввести структуру ThreadPool в область видимости, добавив следующий код наверх src/bin/main.rs:

src/bin/main.rs
    use hello::ThreadPool;

Этот код по-прежнему не будет работать, но давайте проверим его еще раз, чтобы получить следующую ошибку, которую нужно уладить¹:

$ cargo check
    Compiling hello v0.1.0 (file:///projects/hello)
error[E0599]: no function or associated item named `new` found for type `hello::ThreadPool` in the current scope
  --> src/bin/main.rs:13:16
   |
13 |     let pool = ThreadPool::new(4);
   |     ^^^^^^^^^^^^^^^^ function or associated item not found in `hello::ThreadPool`

Эта ошибка указывает на то, что далее нужно создать связанную функцию с именем new для структуры ThreadPool. Мы также знаем, что функция new должна иметь один параметр, который может принимать 4 в качестве аргумента, и должна возвращать экземпляр структуры ThreadPool. Давайте реализуем простейшую функцию new с этими характеристиками:

¹ ошибка[E0599]: ни функция, ни связанный элемент с именем `new` не найдены для типа `hello::ThreadPool` в текущей области видимости