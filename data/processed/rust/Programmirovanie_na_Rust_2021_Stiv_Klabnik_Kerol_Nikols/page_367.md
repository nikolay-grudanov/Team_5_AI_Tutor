---
source_image: page_367.png
page_number: 367
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.78
tokens: 7495
characters: 1946
timestamp: 2025-12-24T10:55:20.968260
finish_reason: stop
---

Данная ошибка показывает, что этот тип «имеет бесконечный размер». Причина в том, что мы определили список с рекурсивным вариантом: он непосредственно содержит еще одно значение самого себя. В результате Rust не может выяснить, сколько места нужно для хранения значения списка. Давайте разберемся, почему мы получаем эту ошибку. Сначала посмотрим, как Rust решает, сколько места ему нужно для хранения значения нерекурсивного типа.

Вычисление размера нерекурсивного типа

Вспомните перечисление Message, которое мы определили в листинге 6.2, когда обсуждали тему определения перечисления в главе 6:

enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

Чтобы определить, какой объем пространства следует выделить для значения Message, язык Rust перебирает все варианты и проверяет, какой вариант требует больше всего пространства. Язык Rust видит, что Message::Quit не требует никакого пространства, Message::Move требует пространство, достаточное для хранения двух значений типа i32, и так далее. Поскольку будет использоваться только один вариант, наибольшим пространством для хранения значения Message будет пространство, необходимое для хранения его самого большого варианта.

Сравните, что происходит, когда язык Rust пытается выяснить объем пространства для рекурсивного типа, такого как перечисление List в листинге 15.2. Компилятор начинает с просмотра варианта Cons, который содержит значения типов i32 и List. Следовательно, Cons требует объем пространства, равный размеру типов i32 и List. Чтобы выяснить объем памяти, который требуется типу List, компилятор просматривает варианты, начиная с варианта Cons. Вариант Cons содержит значения типов i32 и List, и этот процесс продолжается бесконечно, как показано на рис. 15.1.

![Бесконечный список, состоящий из бесконечных вариантов Cons](../images/15_1.png)

Рис. 15.1. Бесконечный список, состоящий из бесконечных вариантов Cons