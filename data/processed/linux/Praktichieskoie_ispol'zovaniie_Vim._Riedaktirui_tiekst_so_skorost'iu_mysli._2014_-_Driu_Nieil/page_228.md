---
source_image: page_228.png
page_number: 228
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 20.14
tokens: 5568
characters: 1479
timestamp: 2025-12-24T04:14:25.267376
finish_reason: stop
---

Мы уже наблюдали этот эффект в рецепте 67 выше. Но на сей раз выводы получаются несколько другими. При применении одной и той же операции к последовательности строк мы можем охватить блок одним взглядом. Если что-то пошло не так, мы сразу заметим это.

На этот раз мы работали со множеством файлов, поэтому мы не можем видеть все сразу. Когда макрос выполняется последовательно и терпит неудачу, он останавливается в месте, где возникла ошибка, тогда как при параллельном выполнении макроса, чтобы обнаружить буфер, где возникла ошибка, нам придется последовательно обойти файлы в списке аргументов.

Если в процессе параллельного выполнения возникнет ошибка, обработка может закончиться раньше, но полезная информация будет скрыта.

Рецепт 70. Использование итератора для нумерации элементов в списке

Возможность вставлять значение, изменяющееся при каждом вызове макроса, может оказаться весьма полезной. В данном рецепте мы познакомимся с приемом последовательного увеличения числа с момента записи макроса, чтобы пронумеровать строки от 1 до 5.

Допустим, что нам необходимо создать нумерованный список из последовательности строк. В качестве отправной точки возьмем следующий текст:

macros/incremental.txt
http://media.pragprog.com/titles/dnvim/code/macros/incremental.txt

partridge in a pear tree
turtle doves
French hens
calling birds
golden rings

и преобразуем его в список:

1) partridge in a pear tree
2) turtle doves
3) French hens
4) calling birds
5) golden rings