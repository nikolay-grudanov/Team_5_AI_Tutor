---
source_image: page_231.png
page_number: 231
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.03
tokens: 5703
characters: 1687
timestamp: 2025-12-24T04:14:30.120608
finish_reason: stop
---

манду? Или изменить что-то в начале макроса? В этом рецепте мы узнаем, как можно отредактировать содержимое макроса, как если бы это был простой текст.

Задача: Нестандартное форматирование

Допустим, что мы только что, следуя за примером в разделе «Запись единицы правки» в рецепте 67, записали макрос в регистр а. А теперь мы столкнулись с файлом, отформатированным немного иначе:

macros/mixed-lines.txt
http://media.pragprog.com/titles/dnvim/code/macros/mixed-lines.txt

1. One
2. Two
3. three
4. four

Одни строки начинаются с символов в верхнем регистре, другие — с символов в нижнем регистре. В нашем макросе мы использовали команду ~ переключения регистра символа под курсором (см. :h ~ http://vimdoc.sourceforge.net/htmldoc/change.html#~). Давайте заменим команду ~ на команду vU, которая переводит символ под курсором в верхний регистр (см. :h v_U http://vimdoc.sourceforge.net/htmldoc/change.html#v_U).

Коды клавиш в макросах

В данном примере мы работаем с относительно простым макросом. Но с увеличением макросов в размерах править их становится намного сложнее. Например, взгляните, как выглядит макрос, записанный в рецепте 69:

⇒ :reg a
--- Registers ---
"a Omoul<80>kb<80>kbdule Rank^j>GGoend^[
Ничего странного не заметили? Прежде всего в теле макроса дважды появляется символ ^[. Не важно, какую клавишу вы нажмете, <Esc> или <C-[>, обе они будут представлены в теле макроса именно так.
Еще более странным выглядит символ <80>kb, представляющий клавишу забоя (backspace). Найдите время и изучите коды клавиш. Когда я записывал этот макрос, я ввел буквы «mouI», заметил свою ошибку, дважды нажал клавишу забоя (backspace) и ввел оставшуюся часть «dule» слова «module».