---
source_image: page_244.png
page_number: 244
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.00
tokens: 5786
characters: 2117
timestamp: 2025-12-24T04:14:42.302410
finish_reason: stop
---

Рецепт 75. Использование круглых скобок для захвата совпадений

Заметили грамматическую ошибку? Просто удивительно, как сложно порой бывает заметить такие ошибки из-за того, что наш мозг неосознанно исправляет ее сам, но она станет более заметной, если выделить ее: «Paris in the the springtime.». Когда последовательность из двух одинаковых слов разрывается переносом строки, наш мозг не замечает повторения. Этот эффект называется лексической иллюзией¹.

Следующее регулярное выражение позволяет находить повторяющиеся слова:

⇒ /\v<(\w+)\s+\1>

Попробуйте выполнить поиск по этому шаблону во фрагменте текста, представленном выше, и вы увидите, что в результате поиска пара слов «the the» окажется подсвечена. Теперь попробуйте объединить строки (например, командой vipJ) — регулярное выражение все равно будет находить совпадение. Самое замечательное, что этот шаблон позволяет найти не только последовательность «the the», но и любых других двух одинаковых слов. Давайте разберем это регулярное выражение на составные части и посмотрим, как оно работает.

Вся хитрость поиска повторяющихся слов заключается в комбинации () и \1. Все, что совпадет с подвыражением в круглых скобках, автоматически будет сохранено во временном буфере. Мы можем сослаться на совпавший фрагмент с помощью конструкции \1. Если шаблон содержит более одной пары круглых скобок, на совпадения с подвыражениями в каждой паре () можно сослаться с помощью конструкций \1, \2 и т. д., вплоть до \9. Элемент \0 всегда ссылается на совпадение со всем регулярным выражением, независимо от наличия в нем круглых скобок.

Регулярное выражение для поиска лексических иллюзий содержит еще несколько хитростей. Мы уже видели в рецепте 73 выше, что ключ \v включает самый волшебный (very magic) режим интерпретации регулярных выражений. Символы < и > соответствуют границам слова, как описывается в рецепте 76 ниже. Наконец, последовательность \s соответствует пробельным символам и разрывам строк (см. :h /_\ i http://vimdoc.sourceforge.net/htmldoc/

________
¹ http://matt.might.net/articles/shell-scripts-for-passive-voice-weasel-words-duplicates/