---
source_image: page_233.png
page_number: 233
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.07
tokens: 5778
characters: 1958
timestamp: 2025-12-24T04:14:34.365787
finish_reason: stop
---

вызвать проблемы позднее. Команда dd выполняет удаление целой строки. В результате в конец макроса добавляется символ ^J:

⇒ :reg a
    0f.r)wvUj^J

Это символ перевода строки, присутствие которого в большинстве случаев не играет никакой роли. Но иногда завершающий символ перевода строки может изменять значение макроса. Для предупреждения неожиданностей всегда копируйте макросы из документа в регистры как последовательности символов:

<table>
  <tr>
    <th>Нажатия клавиш</th>
    <th>Содержимое буфера</th>
  </tr>
  <tr>
    <td>{start}</td>
    <td>// last line of the file proper<br>0f.r)wvUj</td>
  </tr>
  <tr>
    <td>0</td>
    <td>// last line of the file proper<br>0f.r)wvUj</td>
  </tr>
  <tr>
    <td>"ay$</td>
    <td>// last line of the file proper<br>0f.r)wvUj</td>
  </tr>
  <tr>
    <td>dd</td>
    <td>// last line of the file proper</td>
  </tr>
</table>

Когда вслед за командой 0 выполняется команда "ay$, она захватывает все символы в строке, кроме символа перевода строки. Сохранив все необходимое в регистре a, можно выполнить команду dd, чтобы удалить строку. Копия удаленной строки сохранится в регистре по умолчанию, но мы не собираемся использовать его.

После выполнения этих шагов в регистре окажется новый, улучшенный макрос. Мы можем использовать его, чтобы изменить фрагмент текста, представленный в начале этого рецепта.

Обсуждение

Возможность вставить макрос в документ, отредактировать его и скопировать обратно в регистр является неоспоримым удобством. Но тело макроса может оказаться трудночитаемым по причинам, описанным во врезке «Коды клавиш в макросах» выше. Если требуется лишь добавить команду в конец макроса, проще следовать процедуре, описанной в рецепте 68.

Так как регистры в редакторе Vim — не более чем контейнеры, предназначенные для хранения текста, ими можно манипулировать программно, используя сценарии на языке Vim. Например, для правки макроса, описывавшегося выше, можно было бы использовать