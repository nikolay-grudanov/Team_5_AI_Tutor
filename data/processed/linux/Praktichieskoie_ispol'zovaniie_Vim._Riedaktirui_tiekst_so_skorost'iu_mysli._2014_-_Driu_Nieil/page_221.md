---
source_image: page_221.png
page_number: 221
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.49
tokens: 5652
characters: 1708
timestamp: 2025-12-24T04:14:11.437700
finish_reason: stop
---

ли заключительную команду j, перемещающую курсор на следующую строку. На этот раз она не нужна.

Команда :normal @a выполнит макрос для каждой строки выделенной строки. Как и прежде, макрос благополучно выполнится в первых двух строках и прервется в третьей строке, но на этот раз он не остановится — он продолжит выполнение. Почему?

В предыдущем примере мы поставили в очередь пять повторений, выполнив команду 5@a. Когда в третьем повторении возникла ошибка, она прервала выполнение всей цепочки. На этот раз мы расположили пять итераций параллельно. Каждый вызов макроса не зависит от результатов предыдущих вызовов. Поэтому когда третья итерация потерпела неудачу, это произошло в изоляции от других.

Выбор: последовательно или параллельно

Какой способ лучше, последовательный или параллельный? Ответ (как всегда): это зависит от ситуации.

Независимое применение макроса к нескольким элементам обеспечивает более высокую надежность. В данном примере это оказалось более удачным решением. Но если ошибки, возникающие при выполнении макроса, играют для вас важную роль, возможно, более удачным решением будет последовательное применение макроса. В последнем случае мы ясно сможем увидеть, где и почему возникают ошибки.

Попробуйте использовать оба способа, и вы разовьете в себе способность быстро определять, в каких случаях какой подход использовать.

Рецепт 68. Добавление команд в макросы

Иногда в процессе записи макроса мы по ошибке пропускаем важную операцию. Обнаружив это, не нужно бросаться тут же переписывать макрос с самого начала — мы всегда можем добавить необходимые команды в конец существующего макроса.

Представьте, что мы записали следующий макрос (заимствованный из рецепта 67):