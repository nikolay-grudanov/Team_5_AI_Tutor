---
source_image: page_269.png
page_number: 269
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 18.69
tokens: 5635
characters: 1554
timestamp: 2025-12-24T04:15:11.744053
finish_reason: stop
---

4: Последний штрих

Наш шаблон обнаруживает все желаемые фрагменты, но, прежде чем выполнить команду подстановки, необходимо добавить последний штрих. Нам нужно сохранить все, что заключено в одиночные кавычки, заключив подвыражение в круглые скобки. В окончательном виде наш шаблон выглядит, как показано ниже:

⇒ /\v'(([^\']|\'\w)+)'

Здесь можно было бы ввести команду /<Up> и отредактировать шаблон в команде поиска, или воспользоваться командой q/ и внести изменения в окне командной строки. Используйте тот способ, который вам больше по душе. Результаты поиска с применением последней версии шаблона не отличаются от предыдущих, но теперь текст внутри одиночных кавычек сохраняется в регистре захвата \1. Благодаря этому можно выполнить следующую команду подстановки:

⇒ :%s/"\1"/g

Мы можем оставить поле шаблона пустым, и Vim будет повторно использовать последнюю команду поиска (за дополнительными подробностями обращайтесь к рецепту 90 в главе 14). Ниже приводится результат выполнения команды подстановки:

This string contains a "quoted" word.
This string contains "two" quoted "words."
This "string doesn't make things easy."

Обсуждение

Все, что было сделано выше, фактически идентично команде:

⇒ :%s/\v'(([^\']|\'\w)+)'/"\1"/g

Смогли бы вы ввести такую команду с первой попытки и без ошибок?
Не волнуйтесь, если вам не удастся создать нужное регулярное выражение с первой попытки. Редактор Vim сохранит шаблон на расстоянии двух нажатий на клавиши, и вы легко сможете восстановить его. Начинайте с поиска максимального совпадения, затем