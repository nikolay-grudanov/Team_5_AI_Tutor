---
source_image: page_338.png
page_number: 338
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.58
tokens: 5692
characters: 1835
timestamp: 2025-12-24T04:16:39.813029
finish_reason: stop
---

Рецепт 110. Поиск с использованием внутреннего механизма поиска Vim

Команда :vimgrep дает возможность осуществлять поиск по множеству файлов с использованием механизма регулярных выражений, встроенного в редактор Vim.

Vim поддерживает команду :vimgrep, использующую встроенный механизм регулярных выражений Vim. (Эта команда имеет более краткую форму: :vim.) Она имеет следующий синтаксис:

:vim[grep][!] /{pattern}/[g][j] {file} ...

Когда в одной строке есть несколько совпадений, флаг g создает отдельную запись для каждого из них. В противном случае будет создана единственная запись для целой строки. По умолчанию Vim будет переходить непосредственно к первому совпадению, но вы можете воспрепятствовать этому с помощью флага j.

Аргумент {file} не должен оставаться пустым. В нем можно передавать те же параметры, что и команде :args (подробно обсуждалась в разделе «Заполнение списка аргументов» в главе 6), включая имена файлов, групповые символы, выражения в обратных кавычках и любые их комбинации. Групповой символ * соответствует любым файлам и каталогам. Групповой символ ** соответствует любым файлам в указанном каталоге и во всех вложенных подкаталогах. Кроме того, есть возможность использовать символ ##, представляющий имена файлов в списке аргументов (:h :_## http://vimdoc.sourceforge.net/htmldoc/cmdline.html#:_##).

Поиск в файле с последующим поиском в проекте

Главное достоинство команды :vimgrep — в том, что она принимает те же шаблоны, что и команда поиска в Vim, благодаря чему мы можем сначала сконструировать регулярное выражение, опробовав его, выполняя поиск в текущем файле, а затем передать этот же шаблон команде :vimgrep, чтобы выполнить поиск во множестве файлов. В следующем примере используется шаблон, сконструированный нами в рецепте 85 в главе 13:

⇒ /\v'(([^\']|'\w)+)'
⇒ :vim /<C-r>// **