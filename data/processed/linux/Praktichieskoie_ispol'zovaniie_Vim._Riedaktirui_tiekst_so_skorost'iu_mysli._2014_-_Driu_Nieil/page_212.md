---
source_image: page_212.png
page_number: 212
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.70
tokens: 5697
characters: 1731
timestamp: 2025-12-24T04:14:08.056631
finish_reason: stop
---

фактическое действие. Для начала неплохо, но у нас есть возможность для дальнейшего усовершенствования.

В нашем распоряжении имеется пара приемов, позволяющих выполнять макрос многократно. Подготовительные операции в обоих случаях несколько отличаются, и, что более важно, они по-разному реагируют на встречающиеся ошибки. Я постараюсь объяснить различия, опираясь на аналогию с елочными гирляндами.

Если вы приобрели недорогую елочную гирлянду, лампочки в ней, скорее всего, будут соединены последовательно. Если одна из них перегорит, светиться перестанет вся гирлянда. Если вы приобрели дорогую гирлянду, лампочки в ней наверняка будут соединены параллельно. То есть выход из строя одной лампочки не скажется на работоспособности всей гирлянды.

Я заимствовал из области электротехники слова «последовательно» и «параллельно», чтобы описать различия между двумя способами многократного выполнения макроса. Прием, опирающийся на последовательный подход, прекращает повторное выполнение макроса после первой же встретившейся ошибки. Подобно недорогой елочной гирлянде, он легко ломается. Прием, опирающийся на параллельный подход, более устойчив к ошибкам.

Последовательное выполнение макроса

На рис. 11.1 изображены робот и конвейерная лента с деталями, которые обрабатываются роботом. Запись макроса сродни процессу программирования робота на выполнение некоторой операции. На заключительном этапе мы даем роботу команду запустить конвейер и взять следующую ближайшую деталь. При таком подходе у нас может быть только один робот, выполняющий одну и ту же операцию.

![Макросы Vim позволяют быстро выполнять повторяющиеся операции](../images/11_1.png)

Рис. 11.1. Макросы Vim позволяют быстро выполнять повторяющиеся операции