---
source_image: page_295.png
page_number: 295
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 24.86
tokens: 5695
characters: 1897
timestamp: 2025-12-24T04:15:50.638007
finish_reason: stop
---

которые файлы в проекте содержат фразу «Pragmatic Bookshelf», но не содержат фразу «Pragmatic Vim». Поэтому когда команда подстановки применяется к таким файлам, Vim сообщает об ошибке.
Это сообщение является излишним в данной ситуации. Vim продолжит обработку файлов независимо от успеха команды подстановки. В этой ошибке нет ничего критичного, но она может вызывать беспокойство, особенно при обработке большого количества файлов. Если в команду подстановки добавить флаг e, он подавит вывод сообщений об ошибках. То есть мы с тем же успехом могли бы выполнить команду:

⇒ :argdo %s//Practical/ge

И тем самым избавить себя от лишнего беспокойства.
Давайте приостановимся на минутку и подумаем о том, что было сделано. Командой :args **/*.txt мы загрузили все файлы из текущего проекта в список аргументов. Затем, когда мы вызвали команду :argdo %s//Practical/ge, Vim применил команду подстановки ко всем файлам в списке. В нашем примере количество буферов невелико, но в реальной ситуации список может содержать сотни и даже тысячи файлов. Используя описанный прием, можно быть уверенными, что подстановка будет произведена везде, где это необходимо, но мы применили команду подстановки и к тем файлам, где отсутствуют искомые совпадения. Поэтому сейчас самое время попробовать перейти от стрельбы по площадям к прицельному огню.
Давайте посмотрим, как можно этого добиться.

Конструирование списка файлов, содержащих совпадения с шаблоном

Можно ли разбить решение данной задачи на два этапа? На первом этапе можно было бы отыскать все файлы в проекте, содержащие искомый шаблон. А на втором применить команду подстановки к этим файлам.
Выполнить поиск по всему проекту можно с помощью команды :vimgrep (см. главу 18 «Поиск в пределах проекта с помощью команд grep, vimgrep и других»). Поскольку она использует тот же механизм поиска в Vim, мы можем повторно использовать тот же самый шаблон: