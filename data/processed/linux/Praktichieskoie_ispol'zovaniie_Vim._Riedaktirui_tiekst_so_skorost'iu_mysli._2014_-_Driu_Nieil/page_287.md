---
source_image: page_287.png
page_number: 287
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 21.50
tokens: 5648
characters: 1638
timestamp: 2025-12-24T04:15:37.609804
finish_reason: stop
---

Исправление команды &

Команда & является синонимом команды :s, которая выполняет последнюю подстановку. К сожалению, если использовались какие-либо флаги, команда & игнорирует их, а это означает, что ее результат может отличаться от предыдущей команды подстановки.
Команда :&&, основанная на команде &, выглядит предпочтительнее. Она сохраняет флаги и потому производит более ожидаемые результаты. Следующие привязки исправляют поведение команды & в командном режиме и создают эквивалент для визуального режима:

nnoremap & :&&<CR>
xnoremap & :&&<CR>

Рецепт 93. Переупорядочение полей в файле CSV

В этом рецепте рассказывается, как можно использовать сохраняемые совпадения с подвыражениями в круглых скобках в поле со строкой замены.
Допустим, у нас имеется файл в формате CSV, содержащий список электронных адресов с именами и фамилиями адресатов:

substitution/subscribers.csv
http://media.pragprog.com/titles/dnvim/code/substitution/subscribers.csv

last name,first name,email
neil,drew,drew@vimcasts.org
doe,john,john@example.com

Теперь допустим, что нам требуется изменить порядок следования полей так, чтобы электронный адрес находился в первом поле, имя — во втором, а фамилия — в третьем. Для решения этой задачи можно было бы использовать следующую команду подстановки:

⇒ /\v^([^,]*),([^,]*),([^,]*)$
⇒ :%s//\3,\2,\1

В этом шаблоне класс [^,] соответствует любым символам, кроме запятой. Поэтому подвыражение ([^,]*) соответствует последовательности из нуля или более символов, не являющихся запятыми, и сохраняет ее (см. рецепт 75 в главе 12). Это подвыражение повторяется трижды, чтобы захватить каждое поле в файле CSV.