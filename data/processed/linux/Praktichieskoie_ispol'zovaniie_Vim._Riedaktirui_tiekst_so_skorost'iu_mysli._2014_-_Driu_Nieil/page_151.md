---
source_image: page_151.png
page_number: 151
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 21.82
tokens: 5675
characters: 1759
timestamp: 2025-12-24T04:12:47.018070
finish_reason: stop
---

Рецепт 44. Сохранение файлов в несуществующие каталоги

Редактор Vim с радостью позволяет править файлы, пути к которым включают отсутствующие каталоги. Но только пока не будет предпринята записать буфер в такой файл. В этом рецепте рассказывается, как решить данную проблему.

Для открытия уже существующих файлов чаще других используется команда :edit {file}. Но если указать имя несуществующего файла, Vim создаст новый пустой буфер. Если нажать комбинацию <C-g>, буфер будет помечен как «new file» («новый файл»). Команда <C-g> выводит имя и состояние текущего файла (см. :h ctrl-G http://vimdoc.sourceforge.net/htmldoc/editing.html#ctrl-G). Если затем выполнить команду :write, Vim попытается записать содержимое буфера в новый файл по указанному пути.

Если в команде :edit {file} был указан путь, содержащий несуществующие каталоги, редактор выведет сообщение об ошибке:

⇒ :edit madeup/dir/doesnotexist.yet
⇒ :write
"madeup/dir/doesnotexist.yet" E212: Can't open file for writing

В данном случае каталоги madeup/dir не существуют в файловой системе. Vim создаст новый буфер в любом случае, который будет помечен как «new DIRECTORY» («новый КАТАЛОГ»). Но ошибка возникнет только при попытке записать буфер на диск. Мы можем исправить ситуацию, вызвав внешнюю команду mkdir:

⇒ :!mkdir -p %:h
⇒ :write

Флаг -р указывает команде mkdir на необходимость создавать промежуточные каталоги. Описание значений символов %:h приводится в разделе «Как открыть файл, указав путь относительно активного каталога» выше.

Рецепт 45. Сохранение файла с привилегиями суперпользователя

Обычно не принято запускать редактор Vim с привилегиями суперпользователя, но иногда бывает необходимо сохранить изменения в файл, доступный для записи только суперпользователю. Это