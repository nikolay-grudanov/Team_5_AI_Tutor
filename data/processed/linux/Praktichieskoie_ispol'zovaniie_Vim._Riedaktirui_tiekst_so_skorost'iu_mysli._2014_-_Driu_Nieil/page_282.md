---
source_image: page_282.png
page_number: 282
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.32
tokens: 5656
characters: 1653
timestamp: 2025-12-24T04:15:29.166464
finish_reason: stop
---

Рецепт 91. Замена содержимым регистра

Если текст в регистре 0 содержит какие-либо символы, имеющие специальное значение в строке замены (например, такие как & или ~), нам может потребоваться вручную отредактировать команду, чтобы экранировать такие символы. Кроме того, если регистр 0 содержит многострочный текст, он может не уместиться в командную строку.
Чтобы избежать подобных неприятностей, можно вместо содержимого регистра передать ссылку на этот регистр.

Передача по ссылке

Допустим, что мы сохранили многострочный текст в регистре 0. Теперь нам нужно использовать этот текст в качестве строки замены в команде подстановки. Мы могли бы ввести такую команду:

⇒ :%s/\/=@0/g

Последовательность \= в поле замены предписывает редактору выполнить выражение. В выражениях можно указывать ссылки на регистры, имеющие вид: @{register}. Ссылка @0 вернет содержимое регистра захвата, а ссылка @"» вернет содержимое регистра по умолчанию (неименованный регистр). То есть выражение :%s/\/=@0/g предписывает редактору заменить совпадения с последним шаблоном поиска содержимым регистра захвата.

Сравнение

Взгляните на следующую команду:

⇒ :%s/Pragmatic Vim/Practical Vim/g

Сравните ее с последовательностью команд:

⇒ :let @/= 'Pragmatic Vim'
⇒ :let @a= 'Practical Vim'
⇒ :%s/\/=@a/g

Команда :let @/= 'Pragmatic Vim' — это удобный способ определения шаблона поиска. Она производит тот же эффект, что и команда поиска /Pragmatic Vim<CR> (за исключением того, что команда :let @/= 'Pragmatic Vim' не создает запись в истории поиска).
Аналогично команда :let @a= 'Practical Vim' сохраняет содержимое в регистре a. Конечный результат получается тем же,