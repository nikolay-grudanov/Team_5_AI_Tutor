---
source_image: page_119.png
page_number: 119
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.11
tokens: 5706
characters: 1919
timestamp: 2025-12-24T04:12:07.945806
finish_reason: stop
---

Первые две предают содержимое буфера на стандартный ввод внешней команде sh. Последняя команда записывает содержимое буфера в файл с именем sh, вызывая команду :write!. В последнем случае восклицательный знак сообщает редактору Vim, что он должен перезаписать файл sh, если таковой существует. Как видите, местоположение восклицательного знака оказывает существенное влияние на результат. Будьте внимательны при составлении команд такого рода!

В результате вызова команды :write !sh в командной оболочке будет выполнена каждая строка из текущего буфера. Отличный пример использования этой команды можно найти в справке :h rename-files http://vimdoc.sourceforge.net/htmldoc/tips.html#rename-files.

Фильтрация содержимого буфера с помощью внешней команды

Команда :!{cmd} приобретает иной смысл, когда ей передается диапазон строк. Строки, определяемые диапазоном [range], передаются на стандартный ввод команды {cmd}, а ее вывод затирает оригинальное содержимое диапазона. Или, говоря иными словами, команда {cmd} фильтрует указанный диапазон [range] строк (см. :h :range! http://vimdoc.sourceforge.net/htmldoc/change.html#:range!). Редактор Vim определяет фильтр как «программу, принимающую текст со стандартного ввода, изменяющую его некоторым способом и возвращающую результат в стандартный вывод».

Для демонстрации воспользуемся внешней командой sort и переупорядочим записи в файле CSV:

ex_mode/emails.csv
media.pragprog.com/titles/dnvim/code/ex_mode/emails.csv

first name,last name,email
john,smith,john@example.com
drew,neil,drew@vimcasts.org
jane,doe,jane@example.com

Отсортируем записи по второму полю: по фамилии. Сообщить команде sort, что поля разделены запятой, можно с помощью ключа -t ',' , а указать номер поля, по которому следует выполнять сортировку, — с помощью ключа -k2.

Первая строка в файле содержит заголовочную информацию. Ее желательно оставить в начале файла, поэтому мы исключим ее из