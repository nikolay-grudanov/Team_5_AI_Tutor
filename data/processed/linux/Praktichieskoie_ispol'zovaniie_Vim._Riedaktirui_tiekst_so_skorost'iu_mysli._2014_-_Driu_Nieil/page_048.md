---
source_image: page_048.png
page_number: 48
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.83
tokens: 6023
characters: 2493
timestamp: 2025-12-24T04:10:50.401601
finish_reason: stop
---

Рецепт 4. Действие, повтор, возврат

рить последнюю команду подстановки :substitute (которая также является командой редактора Ex).

Если известно, как повторять действия, избегая необходимости вводить их каждый раз, мы можем добиться высочайшей эффективности. Сначала мы выполняем действие, затем повторяем его.

Но когда многое можно добиться лишь несколькими нажатиями клавиш, приходится быть внимательными. Слишком легко допустить ошибку. Многократное повторение j.j.j. снова и снова начинает напоминать барабанную дробь. Что, если по ошибке мы нажмем клавишу j два раза подряд? Или хуже того, два раза нажмем клавишу .?

Всякий раз, когда редактор Vim упрощает повторение действия или перемещения, он всегда предоставляет способ отступить назад, если, войдя в раж, мы зайдем слишком далеко. В случае с командой «точка» мы всегда можем нажать клавишу u, чтобы отменить последнее изменение. Если лишний раз нажать клавишу ; после использования команды f{char}, можно пропустить искомый символ. Но мы можем вернуться назад, нажав клавишу , которая повторяет последнюю команду поиска f{char} в обратном направлении (см. рецепт 49 в главе 8).

Всегда полезно знать, как включается обратная передача, на случай, если по ошибке мы зайдем слишком далеко. В табл. 1 перечислены команды повторения, поддерживаемые редактором Vim, и соответствующие им обратные команды. В большинстве случаев можно использовать команду отмены. Неудивительно, что самая потертая клавиша на моей клавиатуре — это клавиша u!

Таблица 1.1. Команды повторения и обратные им команды

<table>
  <tr>
    <th>Цель</th>
    <th>Команда</th>
    <th>Повторение</th>
    <th>Возврат</th>
  </tr>
  <tr>
    <td>Выполнить изменение</td>
    <td>{edit}</td>
    <td>.</td>
    <td>u</td>
  </tr>
  <tr>
    <td>Найти следующий символ в строке</td>
    <td>f{char}/t{char}</td>
    <td>;</td>
    <td>,</td>
  </tr>
  <tr>
    <td>Найти предыдущий символ в строке</td>
    <td>F{char}/T{char}</td>
    <td>;</td>
    <td>,</td>
  </tr>
  <tr>
    <td>Найти следующее совпадение в документе</td>
    <td>/pattern<CR></td>
    <td>n</td>
    <td>N</td>
  </tr>
  <tr>
    <td>Найти предыдущее совпадение в документе</td>
    <td>?pattern<CR></td>
    <td>n</td>
    <td>N</td>
  </tr>
  <tr>
    <td>Выполнить подстановку</td>
    <td>:s/target/replacement</td>
    <td>&</td>
    <td>u</td>
  </tr>
  <tr>
    <td>Выполнить последовательность изменений</td>
    <td>qx{changes}q</td>
    <td>@x</td>
    <td>u</td>
  </tr>
</table>