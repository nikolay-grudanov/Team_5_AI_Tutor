---
source_image: page_108.png
page_number: 108
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.84
tokens: 5797
characters: 2247
timestamp: 2025-12-24T04:12:01.910684
finish_reason: stop
---

Рецепт 31. Повторяйте последнюю команду Ex

Ex — команду @:. Знание, как отменить последнюю команду, всегда полезно, поэтому мы рассмотрим и эту тему.

В главе 1 «Путь Vim» мы видели, что команду . можно использовать для повторения последнего изменения. Но команда «точка» не повторяет изменений, выполненных в режиме командной строки. Вместо нее для этой цели следует использовать команду @: (см. :h @: http://vimdoc.sourceforge.net/htmldoc/repeat.html#@:).

Например, эта команда может пригодиться для обхода элементов в списке буферов. Выполнить обход списка в прямом направлении можно с помощью команды :bn[ext], а в обратном — с помощью команды :bp[revious] (более подробное обсуждение списка буферов приводится в рецепте 36 в главе 6). Допустим, что в списке буферов имеется с десяток элементов, и нам необходимо осмотреть каждый из них. Мы могли бы ввести следующую команду один раз:

⇒ :bnnext

А затем использовать @: для повторения команды. Обратите внимание на сходство между этой командой и способом выполнения макроса (см. раздел «Повторное выполнение последовательности команд вызовом макроса» в главе 11). Отметьте также, что регистр : всегда хранит самую последнююю команду, выполненную в режиме командной строки (см. :h quote_: http://vimdoc.sourceforge.net/htmldoc/change.html#quote_). После выполнения команды @: первый раз ее можно повторить командой @@.

Допустим, что мы, набравшись терпения, выполнили команду @: очень много раз и в конце концов выполнили ее лишний раз. Как теперь исправить промах? Можно было бы выполнить команду :bprevious. Но что произойдет, если после этого снова воспользоваться командой @:? Она вернет нас на еще один шаг назад в списке буферов, в противоположность тому, что она делала прежде. Это может привести в замешательство.

В данном случае лучше всего было бы использовать команду <C-o> (см. рецепт 55 в главе 9). При каждом выполнении команды :bnnext (или ее повторении с помощью команды @:) в список переходов добавляется новая запись. Команда <C-o> производит переход к предыдущей записи в этом списке.

Мы могли бы выполнить :bnnext один раз и затем повторять с помощью @:. При необходимости вернуться можно было бы воспользоваться командой <C-o>. А затем, чтобы продолжить движение впе-