---
source_image: page_345.png
page_number: 345
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.76
tokens: 6445
characters: 1542
timestamp: 2025-12-24T04:03:37.739973
finish_reason: stop
---

Удаленный сервер своими руками

Проверять работоспособность сайта можно двумя способами: или пытаться получить реальный файл (можно для этого создать пустой файл в корне, важно получить 200-ый ответ от сервера) или же мониторить наличие сервисов apache/mysql в памяти. Второй способ не защищает от ситуации, когда сервисы «подвисли» — в памяти они есть, но на самом деле сайт «лежит». Первый способ не позволяет убедиться в работоспособности MySQL: файл веб-сервер может и «отдать», а база данных может не работать.

20.2.1. Проверка работоспособности веб-сервера

Проще всего проверить работоспособность веб-сервера путем обращения к его главной странице: если получен ответ 200, значит с сервером все хорошо. Bash-сценарий будет выглядеть так (адрес можно заменить на https://, если используется защищенный протокол):

#!/bin/bash

if curl -s --head --request GET http://site.name | grep "200 OK" > /dev/null; then
    echo "Site is UP"
else
    echo "site is DOWN, restarting Apache"
    /usr/sbin/service apache2 restart
fi

Вызов сценария нужно поместить в расписание cron. Периодичность зависит от частоты падения сервера — если сервер сбоит иногда, можно раз в 5-10 минут, если сайт «лежит» часто — раз в минуту. Да, это создаст дополнительную нагрузку на сервер, но зато обеспечит его перезапуск в течение одной минуты.

20.2.2. Проверка работоспособности MySQL

Напишем небольшой PHP-сценарий, подключающийся к БД и возвращающий 1, если соединение удалось и 0, если соединение не работает. Собственно, код этого сценария очень прост: