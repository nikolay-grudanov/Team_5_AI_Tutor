---
source_image: page_245.png
page_number: 245
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.71
tokens: 6386
characters: 1403
timestamp: 2025-12-24T04:01:31.195070
finish_reason: stop
---

Осталось создать остальные файлы:

./build-dh
openvpn --genkey --secret keys/ta.key

Команда build-dh создает ключи протокола Диффи-Халлмана, вторая команда - генерирует подпись HMAC. В зависимости от мощности вашего сервера, эти команды могут работать несколько минут каждая. Так что сервер не завис, он работает.

Осталось создать сертификат и ключи для клиента и мы сможем наконец-то приступить к настройке самого сервера. Создать данные ключи можно, как на клиенте (а потом подписать полученный ключ центром сертификации на сервере), так и на сервере. Проще это делать на сервере.

Сейчас мы создадим ключ и сертификат для одного клиента. Клиентов у нас несколько, поэтому данный процесс нужно будет повторить для каждого из них. Можете оформить последовательность действий в bash-сценарий для экономии времени.

Команда build-key используется для создания файлов без пароля для облегчения автоматических соединений:

cd ~/openvpn-ca
source vars
./build-key client1

Если нужны файлы, защищенные паролем, используйте команду build-key-pass:

cd ~/openvpn-ca
source vars
./build-key-pass client1

14.5.2. Настройка сервера

Когда все сертификаты и ключи сгенерированы, можно приступить к настройке сервера. Первым делом скопируйте сгенерированные ранее файлы из каталога openvpn-ca/keys в /etc/openvpn:

cd ~/openvpn-ca/keys
sudo cp ca.crt ca.key server.crt server.key ta.key dh2048.
rem /etc/openvpn