---
source_image: page_237.png
page_number: 237
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.49
tokens: 6438
characters: 1471
timestamp: 2025-12-24T04:01:19.799651
finish_reason: stop
---

ignoreip = 127.0.0.1/8

где:

• maxretry — количество действий, которые разрешено совершить до бана;
• findtime — время в секундах, в течение которого учитывается maxretry;
• bantime — время, на которое будет блокироваться IP-адрес;
• action — действия, которое будет выполняться, если Fail2ban обнаружит активность, соответствующую критериям поиска;
• ignoreip — игнорировать защиту, если запросы приходят с перечисленных адресов.

В данном примере, если в течение 8 минут (480) будет найдено 5 строк (maxretry = 4), содержащих критерий фильтра, Fail2ban заблокирует IP-адрес, с которого идет подключение на 12 минут (720);

В секции [DEFAULT] хранятся общие настройки для всех правил. Каждую из настроек можно переопределить при конфигурировании самого правила.

Для настройки новых правил нужно создать новый конфигурационный файл в каталоге /etc/fail2ban/jail.d. Например, создадим файл ssh.conf, в котором будут правила для защиты сервиса ssh:

[ssh]
enabled = true
port    = ssh
filter  = sshd
action  = iptables[name=sshd, port=ssh, protocol=tcp]
          sendmail-whois[name=ssh, dest=****@gmail.com,
sender=fail2ban@myhost.ru]
logpath = /var/log/auth.log
maxretry = 3
bantime = 600

Внимание! Следите за тем, чтобы путь к файлу хранения логов (logpath) был указан корректно.

Примечание. Вы можете хранить конфигурацию защиты отдельного сервиса в отдельном файле, а можете собрать все приведенные далее секции в один файл — services.conf. Как вам будет удобнее.