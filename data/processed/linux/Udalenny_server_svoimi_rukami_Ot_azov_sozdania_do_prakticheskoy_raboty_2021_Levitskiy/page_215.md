---
source_image: page_215.png
page_number: 215
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.31
tokens: 6484
characters: 1665
timestamp: 2025-12-24T04:01:00.262636
finish_reason: stop
---

Удаленный сервер своими руками

Опции czf означают, что нам нужно создать архив (c) в файле (параметр f) и при этом его сжать. Команда tar может создавать архивы и на ленточных устройствах, поэтому важно задать параметр f. Второй параметр - это имя архива, в нашем случае это будет /mnt/backup/<имя_пользователя>.tar.gz. Третий параметр - это имя каталога, который мы будем архивировать.

Каталог /mnt/backup должен существовать и к нему должен быть подмонтирован внешний жесткий диск. Об этом наш сценарий не заботиться, но при желании никто не помешает вам добавить строку вроде этой:

mount /dev/sdc1 /mnt/backup

Эта строку нужно поместить до команды rm, а в самой команде нужно изменить имя устройства (в нашем случае это /dev/sdc1).

Если вы решились управлять монтированием через сценарий, то в конце сценария нужно добавить строку размонтирования диска:

umount /mnt/backup

Также мы можем скопировать по SSH созданные архивы на удаленную машину. Тогда у вас будет две резервных копии, что повышает надежность нашего плана резервного копирования. После команды tar добавьте команду:

scp $dn.tar.gz user@example.com:/backups

Данная команда скопирует файл <имя_пользователя>.tar.gz на SSH-сервер example.com в каталог /backups. Вот только есть один момент: программа scp запрашивает пароль пользователя для копирования файлов на удаленный сервер. Чтобы этого не происходило (тогда вам нужно присутствовать в 4 утра перед компьютером и вводить пароль), нужно настроить аутентификацию с помощью ключей. Пока не будем на этом останавливаться, а рассмотрим измененную версию нашего сценария:

#!/bin/bash

mount /dev/sdc1 /mnt/backup

rm /mnt/backup/*

cd /home