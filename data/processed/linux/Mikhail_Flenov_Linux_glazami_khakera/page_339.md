---
source_image: page_339.png
page_number: 339
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.13
tokens: 7991
characters: 2532
timestamp: 2025-12-24T04:28:26.390979
finish_reason: stop
---

нистратор должен сделать так, чтобы осложнить этот процесс или запутать взломщика.

Самый простой и один из наиболее информативных методов — сканирование портов. Чтобы выяснить, кто, когда и откуда произвел попытку проникновения, необходимо отлавливать любые нестандартные события портов. Конечно же, вручную это сделать сложно, поэтому лучше запастись хорошей программой.

Средства автоматического выявления атак достаточно хороши, но не всегда приемлемы. Например, если ваш сервер популярен, то количество сканирований в день будет довольно большим. Я думаю, что узлы, такие как www.yahoo.com или www.microsoft.com, сканируют тысячи, а то и миллионы раз в день, и на каждую попытку обращать внимание бесполезно. А самое главное, автоматическое выявление атак требует ресурсов, а иногда и немалых. Если попытаться протоколировать каждое сканирование, то злоумышленник может направить на ваш сервер пакеты, имитирующие атаки, и тогда вся вычислительная мощь сервера уйдет на выявление этих насоков. Получится классический отказ от обслуживания (DoS), потому что сервер уже не сможет обрабатывать запросы клиентов.

Но если у вас локальный сервер в организации или просто домашний компьютер в небольшой сети, то определение любителей сканирования поможет заведомо предотвратить взлом.

Еще один недостаток автоматического определения атак — вы сами не сможете воспользоваться утилитами сканирования безопасности своих серверов, потому что это будет воспринято как нападение. Когда вы сами сканируете систему, то обязательно отключайте программы обнаружения атак, иначе ваши действия не принесут результата.

12.4.1. Klaxon

Самой простой и эффективной является утилита Klaxon (www.eng.auburn.edu/users/doug/second.html). Она следит за неиспользуемыми системой портами и при обращении к ним пытается определить всю возможную информацию о сканирующем IP-адресе и сохранить ее в журнале.

Программа устанавливается достаточно просто. В конфигурационный файл /etc/inetd.conf нужно добавить следующие строки:

#
# Local testing counterintelligence
#
rexec stream tcp nowait root    /etc/local/klaxon klaxon rexec
link   stream tcp nowait root    /etc/local/klaxon klaxon link
supdup stream tcp nowait root    /etc/local/klaxon klaxon supdup
tftp   dgram  udp wait  root     /etc/local/klaxon klaxon tftp

Подразумевается, что программа установлена в каталоге /etc/local/klaxon. Описанные в конфигурационном файле сервисы перенаправляются на Klaxon, и вы сможете контролировать, кто и когда пытался к ним обратиться. Реально эти сервисы не