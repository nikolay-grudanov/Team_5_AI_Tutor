---
source_image: page_349.png
page_number: 349
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.76
tokens: 7892
characters: 1905
timestamp: 2025-12-24T04:28:45.788112
finish_reason: stop
---

на FTP, чтобы иметь возможность размещать свой "боевой софт" на сервере. С помощью анализа журнала вы быстро узнаете, кто и что закачивал.

Посмотрим на строку из файла /var/log/xferlog (здесь опять длинная строка разбита на две):

Sun Jan 16 13:21:28 2005 1 192.168.77.10 46668 /home/flenov/sendmail.cf
b _ o r flenov ftp 0 * c

Из нее видно, что 16 января в 13:21 пользователь с адреса 192.168.77.10 скачал файл /home/flenov/sendmail.cf.

Протокол FTP является наиболее опасным, потому что через него злоумышленник может скачать секретные данные (например, файл с паролями) или положить на сервер свою программу (в частности, rootkit или трояна). Необходимо научиться понимать каждую запись, чтобы знать, что происходит с файлами в системе. Давайте рассмотрим в строке журнала каждый параметр:

- полная дата, которая состоит из дня недели, месяца, числа, времени и года;
- продолжительность сеанса или время, потраченное на скачивание/закачивание файла;
- имя или IP-адрес удаленного хоста;
- размер файла в байтах;
- полный путь к файлу, который был скачан или закачан;
- тип передачи — буква a (символьная) или b (бинарная);
- символ, определяющий специальные действия над файлом:
  • C — сжат;
  • U — разархивирован;
  • T — обработан программой tar;
  • _ — не было никаких действий;
- символ, определяющий направление передачи: o (скачивание с сервера) или i (закачивание на сервер);
- символ, определяющий тип пользователя: a (анонимный), g (гость) или r (действительный);
- локальное имя пользователя. Для анонимных пользователей здесь можно увидеть номер ID;
- имя сервиса, обычно это слово ftp;
- способ аутентификации. Здесь можно увидеть 0, если определение подлинности отсутствовало, или 1 в случае идентификации по RFC 931;
- идентификатор пользователя. Если он не определен, то можно увидеть звездочку;
- символ, определяющий состояние передачи: c (прошла успешно) или i (была прервана).