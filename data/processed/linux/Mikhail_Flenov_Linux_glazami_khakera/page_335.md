---
source_image: page_335.png
page_number: 335
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.20
tokens: 8087
characters: 2661
timestamp: 2025-12-24T04:28:26.390057
finish_reason: stop
---

130337   64 -rwsr-xr-x   1 root root   60104 Jul 29   2002 /bin/mount
130338   32 -rwsr-xr-x   1 root root   30664 Jul 29   2002 /bin/umount
130341   36 -rwsr-xr-x   1 root root   35040 Jul 19   2002 /bin/ping
130365   20 -rwsr-xr-x   1 root root   19072 Jul 10   2002 /bin/su

...

Самое страшное, что все программы из этого списка принадлежат пользователю root и, значит, будут выполняться от его имени. В системе есть и файлы с SUID- и SGID-битом, выполняющиеся от имени других пользователей, но таких меньшинство.

Если вы видите, что программа вами не используется, то ее стоит удалить или снять биты. Если таких программ, по вашему мнению, нет, то подумайте еще раз. Может, все-таки стоит от чего-то отказаться? Например, программа ping не является обязательной для сервера, и у нее бит SUID можно снять.

Если и после корректировки привилегированных программ осталось все равно много, то советую для начала убрать бит со всех программ. Конечно же, тогда пользователи не смогут монтировать устройства или менять себе пароль. Но нужно ли это им? Если уж возникнет острыя необходимость, то всегда можно вернуть им такую возможность, восстановив SUID-бит.

А ведь можно сделать владельцем программы другую учетную запись, у которой будет меньше прав. Это сложно, а иногда и невозможно, реализовать, и придется вручную изменять разрешения, но это сделает ваш сон более спокойным.

Почему необходимо регулярно проверять файлы на наличие SUID- или SGID-битов? Взломщики, проникая в систему, очень часто стремятся укрепиться в ней, спрятаться, и при этом иметь максимальные права. Для этого может использоваться простейший метод — установка SUID-бита на интерпретатор команд bash. В этом случае интерпретатор для любого пользователя будет выполнять команды с правами root, и взломщику для выполнения любых действий достаточно находиться в системе с гостевыми правами.

Следите за любыми появляющимися новыми программами с битами SUID или SGID и убирайте все, что вызывает подозрение.

12.3. Проверка конфигурации

Мы рассмотрели достаточно много правил конфигурирования системы, однако помнить все невозможно. Настройка системы — достаточно сложный процесс, во время которого очень легко ошибиться. Но так как есть определенные правила конфигурирования, то существует и возможность автоматизировать проверку.

Как мы уже знаем, имеются программы, которые могут проверять конфигурацию. Это должно происходить на компьютере локально. В настоящее время уже написано достаточно много утилит для автоматизации контроля. Некоторые из них устарели и давно не обновлялись, а какие-то появились недавно и еще только наращивают свою функциональность (количество проверок).