---
source_image: page_167.png
page_number: 167
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.74
tokens: 8025
characters: 2527
timestamp: 2025-12-24T04:23:44.564846
finish_reason: stop
---

Если сетевой экран пропускает ICMP-пакеты, то сканирование можно провести с помощью traceroute. Возможно, появится сообщение об ошибке. В данном случае строка 18 сообщает о превышении времени ожидания ответа. Это значит, что пакет отправлен, но сервер отбросил запрос, а значит, вероятнее всего пакет с TTL, равным 18, был уничтожен без предупреждения и информирования отправителя, и мы не можем узнать IP-адрес этого хоста.

Для сканирования этой сети за пределами Firewall достаточно выполнить команду соединения с компьютерами внутри сети с TTL, равным 19. Во время трассировки мы увидим первые 17 ответов, 18-й пропадет, а 19-й пройдет дальше в сеть, потому что на сетевом экране такой пакет появится с TTL, равным 2, и не будет удален, а вот в локальной сети первый же маршрутизатор вернет ошибку.

Протокол ICMP очень удобен, потому что если он разрешен и работает, то вы в любой момент можете узнать, работает ли сейчас ваш сервер, просто отправив такой запрос. Если ответ вернулся, значит сервер доступен. Но хакеры могут использовать этот протокол и для сканирования. Достаточно просто отправить сотни пакетов на разные IP-адреса и посмотреть, какие вернутся. По ответам можно будет узнать, какие IP реальные и в данный момент работающие, и уже в зависимости от этого предпринимать какие-то действия.

Внутреннюю сеть можно просканировать и через DNS-сервер, если он находится внутри нее и доступен для всеобщего использования. Но это уже отдельная история, не касающаяся сетевого экрана.

4.11.3. Дополнительная защита

Помимо фильтров на основе определенных администратором правил в сетевом экране может быть реализовано несколько дополнительных защитных механизмов, которые работают вне зависимости от вашей конфигурации или могут включаться специальными опциями.

Одним из популярных методов обхода Firewall и проведения атаки является фальсификация IP-адреса отправителя. Например, у хакера может быть адрес 100.1.1.1, но с него запрещено подключаться к сервису FTP. Чтобы получить доступ, хакер может послать пакеты, в которых в качестве отправителя указан, например, 100.2.2.2, с которого доступ разрешен.

Но это еще не все. Просто воспользовавшись чужим именем, хакер ничего не добьется — он не увидит отклика сервера (рис. 4.3). Чтобы хакер смог получить ответ на свой запрос, в IP-пакет должна быть добавлена специальная информация, по которой сервер найдет реальный адрес хакера 100.1.1.1.

Современные сетевые экраны (в том числе и поставляемые с Linux) легко определяют подделку и блокируют такие пакеты.