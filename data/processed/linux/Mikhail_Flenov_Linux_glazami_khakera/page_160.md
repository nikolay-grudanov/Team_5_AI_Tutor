---
source_image: page_160.png
page_number: 160
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.74
tokens: 8013
characters: 2352
timestamp: 2025-12-24T04:23:25.638737
finish_reason: stop
---

классический пример указания прав доступа, необходимых любому веб-серверу, т. е. разрешение обращений к 80-му порту нашего компьютера и возврат данных от нашего компьютера:

iptables -A INPUT -p tcp -m tcp --sport 80 -j ACCEPT
iptables -A OUTPUT -p tcp -m tcp --dport 80 -j ACCEPT

В первой строке мы добавляем новое правило в цепочку INPUT. Правило действует на протокол TCP, о чем говорит значение tcp ключа -m. Веб-сервер использует как раз этот протокол для передачи данных. С помощью ключа --sport указываем порт источника данных: 80. И, наконец, последний параметр -j ACCEPT указывает, что если пакет соответствует всем правилам, то нужно его пропустить и обработать.

Сложно? Попробую другими словами: первая строка разрешает любые входящие пакеты по протоколу TCP, в которых происходит подключение на порт 80. Вторая строка разрешает передавать ответы от сервера.

Для того чтобы разрешить подключения по https, нужно добавить следующие две строки:

iptables -A INPUT -p tcp -m tcp --sport 443 -j ACCEPT
iptables -A OUTPUT -p tcp -m tcp --dport 443 -j ACCEPT

Здесь делается то же самое, только разрешается работа с портом 443.

Следующий пример разрешает подключения по SSH:

iptables -A INPUT -p tcp --dport 22 -j ACCEPT
iptables -A OUTPUT -p udp --sport 22 -j ACCEPT

Следующая команда создает фильтр, по которому запрещается принимать Echo-запросы от любых компьютеров:

iptables -A INPUT -s 0/0 -d localhost \
-p icmp --icmp-type echo-request -j DROP

Здесь -s 0/0 указывает, что правило относится ко всем адресам отправителя. Как и всегда, символ \ указывает на то, что следующая строка является продолжением команды. Вы можете убрать этот символ и записать все в одну строку.

Следующая команда запрещает доступ к FTP-порту:

iptables -A INPUT -s 0/0 -d localhost -p tcp --dport 21 -j DROP

Чтобы запретить доступ с определенного интерфейса, добавим ключ -i и укажем интерфейс eth0:

iptables -A INPUT -i eth0 -s 0/0 -d localhost -p tcp --dport 21 -j DROP

Теперь запретим исходящие пакеты с порта 21. Для этого используем команду:

iptables -A OUTPUT -i eth0 -s localhost -d 0/0 -p tcp --dport 21 -j DROP

Очень мощной особенностью iptables является возможность проверки содержимого пакетов. Это очень удобно, например, для фильтрации веб-запросов. Можно разрешить доступ к порту 80, но контролировать, чтобы пакеты содержали только до-