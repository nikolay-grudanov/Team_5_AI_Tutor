---
source_image: page_246.png
page_number: 246
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.73
tokens: 7983
characters: 2614
timestamp: 2025-12-24T04:25:56.311196
finish_reason: stop
---

ность защитить сервер вне зависимости от этих факторов. Отличное решение данной проблемы — бесплатный модуль для Apache под названием mod_security.

Принцип действия модуля схож с сетевым экраном, который встроен в ОС, только в данном случае он специально разработан для обеспечения взаимодействия по протоколу HTTP. Модуль на основе правил, которые задает администратор, анализирует запросы пользователей к серверу и выносит свое решение о возможности пропустить пакет к веб-серверу.

Правила определяют, что может быть в запросе, а что нет. Там обычно содержится URL-адрес, с которого необходимо взять документ или файл. Как можно сформулировать правило для модуля с точки зрения безопасности системы?

Рассмотрим простейший пример — для сервера опасно незаконное обращение к файлу /etc/passwd, а, значит, его не должно быть в строке URL. Таким образом, сетевой экран проверяет на основе заданных фильтров адрес URL, и если он нарушает правила, то запрос отклоняется.

Модуль mod_security надо скачать с сайта www.modsecurity.org. После его установки в файле httpd.conf появляется возможность применять дополнительные директивы фильтрации запросов. Рассмотрим наиболее интересные из них:

☐ SecFilterEngine On — включить режим фильтрации запросов;
☐ SecFilterCheckURLEncoding On — проверять кодировку URL;
☐ SecFilterForceByteRange 32 126 — использовать символы только из указанного диапазона. Существует достаточное количество служебных символов (например, перевод каретки, конец строки), коды которых менее 32. Большинство из них невидимы, но требуют обработки нажатия соответствующих клавиш. Но как же тогда хакер может ввести такой символ в URL? Только через их код. Например, чтобы поместить в URL символ "перевод строки", необходимо указать в адресе %13. В примере коды символов менее 32 и более 126 объявляются недопустимыми для адреса, и такие пакеты не пропускаются к веб-серверу;
☐ SecAuditLog logs/audit_log — определяет файл журнала, в котором будет сохраняться информация об аудите;
☐ SecFilterDefaultAction "deny,log,status:406" — задает действие по умолчанию. В данном случае указан запрет (deny);
☐ SecFilter xxx redirect:http://www.webkreator.com — обеспечивает переадресацию. Если правила соблюдены, то пользователя отправляют на сайт http://www.webkreator.com;
☐ SecFilter yyy log,exec:/home/apache/report-attack.pl — запускает сценарий. Если фильтр срабатывает, то будет выполнен скрипт /home/apache/report-attack.pl;
☐ SecFilter /etc/passwd — устанавливает запрет на использование в запросе пользователя подстроки /etc/passwd. Таким же образом нужно добавить ограничение на файл /etc/shadow;