---
source_image: page_164.png
page_number: 164
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.82
tokens: 8117
characters: 2900
timestamp: 2025-12-24T04:23:37.228805
finish_reason: stop
---

единения. Параметры каждого такого пакета должны сравниваться со всеми установленными правилами.

В то же время для отправки syn-пакетов больших ресурсов и мощного канала не надо. Хакер без проблем может забросать разрешенный порт сервера syn-пакетами, в которых адрес отправителя подставляется случайным образом. Процессоры атакуемой машины могут не справиться с большим потоком запросов, которые надо сверять с фильтрами, и выстроится очередь, которая не позволит обрабатывать подключения добропорядочных пользователей.

Очень часто для совершения атаки нужно намного меньше ресурсов, чем для защиты. Если атака идет только с одного хоста, то его IP можно блокировать, но что, если атака идет сразу с многих IP-адресов (DDoS)? В таких случаях иногда блокируют целые сети. Например, есть такая компания Prolexic, которая защищает от DDoS-атак. Их мониторы следят за активностью и, судя по моему опыту работы с их системой, в случае атаки как раз целые сети они и отключают.

У меня один из сайтов клиента защищается этой компанией. Весь трафик идет через их центры данных, где интернет-каналы очень широкие и оборудование мощное. Иногда бывает так, что все пользователи крупнейшего провайдера Канады в Торонто не могут соединиться с каким-либо сайтом. Начинаем выяснять, а оказывается, что Prolexic просто заблокировал всю сеть.

Атака не может проходить вечно, и блокирование целыми сетями приносит свои плоды. Тем более, что этот сайт — для американцев, канадцам там пользоваться нечем, поэтому чуть что их отключают.

Если клиент посылает слишком много данных, которые не могут быть помещены в один пакет, то информация разбивается на несколько блоков. Этот процесс называется фрагментацией пакетов. Некоторые старые сетевые экраны анализировали только первые блоки в сессии, а все остальные считали правильными. Логика такого поведения понятна — если первый пакет верен, то зачем проверять их все и тратить на это драгоценные ресурсы сервера? В противном случае от остальных не будет толка, потому что соединение не установлено, и нарушена целостность информации.

Чтобы сетевой экран пропустил данные хакера, пакеты могут быть специальным образом фрагментированы. От подобной атаки можно защититься, только если Firewall осуществляет автоматическую сборку фрагментированных пакетов и просматривает их в собранном виде.

Данной уязвимости были ранее подвержены даже некоторые экраны, используемые в Linux, но ошибка уже давно исправлена, и сейчас так обойти Firewall невозможно. Если в будущем разработчики не совершат ошибки при обновлении кода, то подобная атака будет исключена.

Сетевой экран очень часто становится объектом атаки, и не факт, что попытка не окажется успешной. Если злоумышленнику удастся захватить Firewall, то сеть станет открытой как на ладони. В этом случае вас смогут спасти от тотального разгрома только персональные сетевые экраны на каждом компьютере. На практике по-