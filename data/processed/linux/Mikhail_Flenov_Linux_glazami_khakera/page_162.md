---
source_image: page_162.png
page_number: 162
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.18
tokens: 8022
characters: 2518
timestamp: 2025-12-24T04:23:30.345704
finish_reason: stop
---

работает NAT. С помощью NAT адрес компьютера из локальной сети подменяется интернет-адресом, и пакет продолжает свой путь из локальной сети во Всемирную. Таким образом, достаточно иметь только один интернет-адрес, который присваивается шлюзу, и вся локальная сеть сможет работать с ресурсами Всемирной сети.

Для настройки NAT команда может выглядеть следующим образом:

iptables -t nat -A FORWARD -o ppp0 -j MASQUERADE

Ключ -t nat указывает на необходимость загрузить модуль iptable_nat. Если он не загружен, то это легко сделать вручную с помощью следующей команды:

modprobe iptable_nat

Здесь iptable_nat — модуль ядра, который позволяет сетевому экрану работать с NAT.

4.11. Замечания по работе Firewall

Как вы помните, теперь у нас по три записи для цепочек INPUT и OUTPUT. Если вам уже не нужен больше доступ по FTP, вы захотите его убрать. Отключив FTP-сервер, не забудьте удалить разрешающие правила из цепочек.

Очень тяжело, если IP-адреса распределяются динамически и могут регулярно меняться. Если в вашей сети используется сервер DHCP (Dynamic Host Configuration Protocol, протокол динамической конфигурации хоста), то нужно позаботиться о том, чтобы компьютеры, которым необходим особый доступ и правила (например, основной шлюз), все же имели жестко закрепленный адрес. Это предотвратит и случайное попадание IP-адреса в недобросовестные руки, и потерю привилегий теми, кто в них нуждается.

То есть, чтобы четко контролировать IP-адреса, желательно использовать DHCP-сервер, но жестко фиксировать адреса тем, кто нуждается в привилегированном доступе и имеет фильтры в цепочках.

Некоторые сервисы (такие как FTP) могут требовать для своей работы более одного порта. Если вы не откроете все нужные порты, то можете не получить необходимого результата.

Тестируйте все используемые соединения после каждого изменения конфигурации сетевого экрана. После внесения нескольких модификаций найти ошибку очень тяжело.

Для поиска конфликтных цепочек я сохраняю конфигурацию во временный файл и распечатываю ее. На бумаге намного проще, чем на экране монитора, видеть всю картину в целом. Обращайте внимание на правильность указания параметров (адрес и порт) источника и получателя пакета. Очень часто администраторы путают, где и что прописывать. Я и сам регулярно путаюсь.

При контроле записей, относящихся к TCP, помните, что этот протокол устанавливает соединение, а значит, необходимо, чтобы пакеты проходили в обе стороны. Протокол UDP не требует подключения, и пакеты можно пропускать в одну сторо-