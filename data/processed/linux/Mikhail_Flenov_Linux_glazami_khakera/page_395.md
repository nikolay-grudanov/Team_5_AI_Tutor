---
source_image: page_395.png
page_number: 395
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 17.92
tokens: 7721
characters: 1465
timestamp: 2025-12-24T04:29:54.106851
finish_reason: stop
---

Выполните команду who. Все вроде нормально, но если проверить почту, то в вашем почтовом ящике окажется новое письмо с заголовком "attack" (рис. 14.1), и в нем будут находиться параметры (все, что вернет команда id) пользователя, выполнившего команду. Это из-за того, что запустилась не системная команда, а наш файл, который содержит две строки:

/usr/bin/system_who — сначала запускаем системный файл who, который мы переименовали, чтобы взломщик ничего не заподозрил;

id | mail -n -s attack root@FlenovM — выполняется команда id, и результат направляется с помощью почтовой программы mail в почтовый ящик root@FlenovM. Ключ -s задает заголовок письма. Ключ -n предотвращает чтение файла /etc/mail.rc. Я рекомендую указывать только эти атрибуты, чтобы на экране ничего лишнего не появлялось и взломщик ничего не заподозрил. Хакер не должен знать, что программа отправила администратору какое-то сообщение.

![Пример сообщения об атаке](../images/chapter14/fig14_1.png)

Рис. 14.1. Пример сообщения об атаке

Таким образом можно подменить все опасные программы, которые должны быть недоступны простым пользователям.

Хакеры чаще всего не проверяют утилиты, которые запускают, а ведь угрозу можно увидеть, если выполнить команду:

cat /usr/bin/who

Вот тут и проявляется недостаток использования сценариев — их можно просмотреть. Программы, написанные на языке С и откомпилированные в исполняемый файл, при просмотре показывают абсолютно ничего не говорящий мусор.