---
source_image: page_159.png
page_number: 159
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.20
tokens: 7992
characters: 2581
timestamp: 2025-12-24T04:23:22.323370
finish_reason: stop
---

Сразу же необходимо заметить, что для сохранения цепочек iptables нужно выполнить команду:

service iptables save

Если не сохранить правила, то они будут действовать только до первой перезагрузки, после которой настройки будут сброшены, и все придется настраивать заново. А оно вам нужно?

Теперь пора переходить к практическим примерам конфигурирования сетевого экрана. Ключ -P служит для указания значения по умолчанию. А что должно быть по умолчанию для максимальной защиты? Конечно же, запрет. Чтобы запретить любые входящие, исходящие и переадресуемые пакеты, выполняем команды:

iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP

Рассмотрим эти команды подробнее. После имени команды идет ключ, который указывает, что мы делаем. Ключ -P говорит, что мы задаем значение по умолчанию. После этого должно идти имя цепочки, куда добавляется правило. В первом случае это цепочка INPUT, а значит, правило будет действовать на входящие данные. Во втором — OUTPUT, т. е. исходящие данные, а в третьем случае — FORWARD. Последний параметр говорит о том, что нужно делать с пакетами, удовлетворяющими условием, которые мы перечислили. Слово DROP говорит о необходимости удаления.

Давайте сделаем небольшое лирическое отступление, чтобы понять разницу между REJECT и DROP. В качестве последнего параметра (действия) можно указать вместо DROP значение REJECT, что тоже будет являться запретом. Разница в том, что в случае REJECT отправитель запроса получит уведомление о том, что запрошенный доступ для него запрещен. Что не есть хорошо — ведь это лишняя информация, которую хакеру не нужно знать. При ключе DROP полученный запрещенный пакет будет просто удален без каких-либо уведомлений и предупреждений.

Если стоит выбор между REJECT и DROP, а вы не знаете что выбрать, я рекомендую выбирать DROP.

Некоторые специалисты по безопасности рекомендуют журнализировать обращения, добавив в сетевой экран фильтр:

iptables -A INPUT -j LOG

Я бы не рекомендовал это делать. У публичных серверов за день происходит несколько сотен, а то и тысяч сканирований портов. Если обращать внимание на каждую такую попытку, вам придется устанавливать на сервер слишком большие жесткие диски для хранения журналов. А ведь если диск будет заполнен, то система выйдет из строя. Соответственно, хакер может просто направить бесконечные обращения на запрещенный порт и через некоторое время добиться удачно завершенной DoS-атаки.

Чтобы лучше понять работу фильтрации, желательно увидеть как можно больше примеров, поэтому дальше мы будем много практиковаться. Для начала посмотрим