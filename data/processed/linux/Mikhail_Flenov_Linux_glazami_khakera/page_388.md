---
source_image: page_388.png
page_number: 388
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.30
tokens: 8044
characters: 2755
timestamp: 2025-12-24T04:30:01.521025
finish_reason: stop
---

Тут есть два пути:

☐ если есть возможность выполнять команды chown и chmod, то хакер сможет без проблем реализовать все необходимые действия;
☐ можно подменить программу на ту, которая уже имеет установленный SUID- или SGID-бит.

Вот почему в разд. 12.2 мы так усердно вычищали все SUID- и SGID-программы. Каждая из них — это дыра в безопасности, но иногда без такой прорехи жить невозможно. Вы должны все время следить за подобными программами, и в случае появления удалять из системы. Также нужно держать под контролем все изменения, которые происходят с программами, у которых установлен бит SUID или SGID. Если их размер изменился, следует бить тревогу и восстанавливать исходное состояние программы, а также искать причину изменений.

Вы должны быть внимательны, когда проверяете SGID-программы. Хакеры знают, что администраторы стараются свести количество таких программ к минимуму, поэтому идут на разные уловки. Например, они могут создать файл /mnt/mount со SUID-битом. Программа mount действительно требует этого бита, но должна находиться в каталоге /bin. Если вы просматриваете список найденных SUID-программ бегло, то можете не заметить отличие в пути или вообще не обратить на это внимание.

Кроме того, в названиях программ может применяться игра букв. Например, /bin/login не требует такого бита. Хакер может создать файл /bin/10gin (первая буква l заменена цифрой 1), и, поскольку визуально программа действительно должна быть в системе, хотя и без SUID- и SGID-бита, при беглом анализе вы не заподозрите ее в злодеянии.

Пакеты rootkit не ограничиваются только предоставлением доступа к выполнению команд от имени пользователя root. Они могут включать еще и различные вспомогательные утилиты, такие как анализаторы сетевого трафика (sniffer), программы управления файлами журналов, позволяющие чистить следы пребывания хакера в системе, и другие полезные для взломщика средства.

Для облегчения задач администраторов добрыми людьми была разработана программа chkrootkit. Ее можно найти на сайте www.chkrootkit.org. На текущий момент она способна обнаружить более 60 известных пакетов rootkit. Таким образом, вы без особых усилий можете отыскать и уничтожить в системе потайную дверь для хакера.

Но, как говорится, на бога надейся, а сам не плошай. Готовыми наборами rootkit пользуются только начинающие хакеры или любители. Профессиональный взломщик хорошо знаком с программированием и создаст себе инструмент самостоятельно. Тем более, что это не так уж сложно, достаточно знать особенности работы ОС Linux. Поэтому и вы должны научиться самостоятельно находить и удалять rootkit.

Определить появление rootkit-пакета вручную поможет сканирование портов. Чтобы воспользоваться потайной дверью, нужно открыть в системе порт, на котором