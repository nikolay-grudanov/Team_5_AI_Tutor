---
source_image: page_304.png
page_number: 304
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.97
tokens: 7785
characters: 1735
timestamp: 2025-12-24T04:27:25.936952
finish_reason: stop
---

Регулярные выражения позволяют записывать множество сайтов в одну строку, но злоупотреблять ими не следует, т. к. проверка соответствия может занимать много времени.

Теперь посмотрим, как можно написать правило, которое запретит в рабочее время смотреть сайты для взрослых (porn), рекламу (adv) для экономии трафика и сайты с нелегальными программами (warez) для защиты каналов от перегруза:

acl {
    all within worktime {
        pass !adv !porn !warez all
    }
    else {
        pass all
    }
    default {
        pass none
        redirect http://localhost/block.html
    }
}

Это разрешающее правило acl (Access Control List). В нем три блока:

☐ all within worktime — для всех в рабочее время — разрешено все, кроме перечисленных трех запретов, о которых мы говорили ранее. На то, что они запрещены, указывает восклицательный знак перед их названиями;

☐ else — все остальное время разрешено все;

☐ default — по умолчанию — вообще ничего (none) не разрешено, а происходит переадресация на http://localhost/block.html.

Разумеется, чтобы это правило работало, нужно еще описать списки адресов adv и warez при помощи директивы dest, подобно тому, как был описан porn.

Таким образом мы написали правило, которое касается всех. А что, если вы хотите указать исключение для себя? Администраторы — привилегированные люди, и глупо ограничивать самого себя. Для этого можно прописать группу — например, admins, вписать туда адреса компьютеров, которые должны быть привилегированными, и обрабатывать их отдельно:

src admins {
    ip 192.168.1.1-192.168.1.3
}
src others {
    ip 192.168.1.4-192.168.1.255
}

Затем права доступа можно подкорректировать следующим образом:

acl {
    admins within worktime {
        pass all
    }