---
source_image: page_043.png
page_number: 43
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 44.16
tokens: 11939
characters: 2373
timestamp: 2025-12-24T03:17:14.066535
finish_reason: stop
---

Как брандмауэры, так и сокрытие адресов реализуются в ядре Linux ветви 2.2 при помощи утилиты ipchains, а в ядре ветви 2.4 — при помощи iptables. В ядре ветви 2.0 использовалась команда ipfwadm, которая описана в разделе, посвященном командам для старых систем, но здесь она опущена. Две более новые команды очень похожи, но отличаются организацией используемых правил. Возможности создания брандмауэров, встроенные в ядра ветви 2.4, задумывались как расширяемые. Если какая-то возможность отсутствует в текущей реализации, ее можно добавить. В документе «Linux netfilter Hacking HOWTO» подробно описано, как это сделать.

В большинстве дистрибутивов поддержка брандмауэров уже встроена в ядро, но если в вашем дистрибутиве это не так, вам придется пересобрать ядро, чтобы добавить поддержку брандмауэров. Для этого необходимо выполнить make config для ядра 2.2 и выбрать следующие параметры:

• Network firewalls
• TCP/IP networking
• IP: firewalling

Для того чтобы включить поддержку брандмауэром прозрачного прокси-сервера, следует выбрать следующий параметр:
• IP: transparent proxy support

Для поддержки сокрытия адресов нужно выбрать также параметры:
• IP: masquerading
• IP: ICMP masquerading

Для ядер ветви 2.4 необходимо выбрать параметры:
• Network packet filtering (замена ipchains)
• IP tables support (требуется для filtering/masq/NAT)
• Packet filtering

Существует несколько расширенных модулей целей и наборов правил, которые также могут пригодиться. Поведение этих расширенных модулей описано вместе с командой iptables. При наличии работающего брандмауэра на ядре ветви 2.2 или 2.0 можно добавить поддержку этих более старых команд и использовать их с новым ядром вместо более современного стиля фильтрации пакетов, присущего iptables.

Брандмауэр предоставляет набор встроенных правил, или цепей (chains), на соответствие которым проверяется каждый сетевой пакет. В ядрах ветви 2.4 эти цепи, помимо прочего, сводятся в таблицы, в которых функции фильтрации отделены от функций сокрытия адресов и искажения пакетов. В любом ядре, если пакет соответствует правилу, увеличивается соответствующий счетчик и выполняется действие, связанное с правилом. Пакет может быть принят, отвергнут, подвергнут сокрытию адреса или даже передан в другую цепь для обработки. Более подробные принципы работы цепей в iptables и ipchains можно найти в описании этих команд.