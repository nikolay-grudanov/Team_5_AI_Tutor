---
source_image: page_140.png
page_number: 140
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.44
tokens: 7812
characters: 2681
timestamp: 2025-12-24T04:35:59.271539
finish_reason: stop
---

[lich@centos ~]$ ps -ZC dhclient

<table>
  <tr>
    <th>LABEL</th>
    <th>PID</th>
    <th>TTY</th>
    <th>TIME</th>
    <th>CMD</th>
  </tr>
  <tr>
    <td>system_u:system_r:dhcpc_t:s0</td>
    <td>2120</td>
    <td>?</td>
    <td>00:00:00</td>
    <td>dhclient</td>
  </tr>
  <tr>
    <td>system_u:system_r:dhcpc_t:s0</td>
    <td>4320</td>
    <td>?</td>
    <td>00:00:00</td>
    <td>dhclient</td>
  </tr>
</table>

4.5.2. Привилегии

Еще одним важным атрибутом процесса, определяющим его возможности по использованию системных вызовов, являются привилегии процесса capabilities(7). Например, обладание привилегией CAP_SYS_PTRACE разрешает процессам трассировщиков strace(1) и ltrace(1), использующих системный вызов ptrace(2), трассировать процессы любых пользователей (а не только «свои», EUID которых совпадает с EUID трассировщика). Аналогично, привилегия CAP_SYS_NICE разрешает изменять приоритет, устанавливать привязку к процессорам и назначать алгоритмы планирования (см. разд. 4.6) процессов и нитей любых пользователей, а привилегия CAP_KILL разрешает посылать сигналы (см. разд. 4.8) процессам любых пользователей.

Явная привилегия «владельца» CAP_FOWNER позволяет процессам изменять режим и списки доступа (см. разд. 3.5.1), мандатную метку (см. разд. 3.6.2), расширенные атрибуты (см. разд. 3.7.1) и флаги (см. разд. 3.7.2) любых файлов так, словно процесс выполняется от лица владельца файла. Привилегия CAP_LINUX_IMMUTABLE разрешает управлять флагами файлов t, immutable и a, append (см. разд. 3.7.2), а привилегия CAP_SETFCAP — устанавливать «файловые» привилегии (см. далее) запускаемых программ.

Необходимо отметить, что именно обладание полным набором привилегий делает пользователя root (UID=0) в Linux суперпользователем. И наоборот, обычный, не-привилегированный пользователь (в смысле UID≠0) не обладает никакими явными¹ привилегиями. Назначение² привилегий процесса происходит при запуске программы при помощи системного вызова exec(3), исполняемый файл которого помечен «файловыми» привилегиями.

В примере из листинга 4.23 иллюстрируется получение списка привилегий процесса при помощи утилиты getpcaps. Как и ожидалось, процесс postgres (PID=6711), работающий от лица обычного (непривилегированного, в смысле UID≠0) псевдопользователя postgres, не имеет 1 никаких привилегий, а процесс apache2 (PID=10129), работающий от лица суперпользователя root (UID=0), имеет полный 2 набор привилегий. Однако процесс NetworkManager (PID=646) выполняется от лица

¹ Неявно он обладает привилегией владельца для всех своих объектов.
² Здесь допущено намеренное упрощение механизма наследования и назначения привилегий при fork(2) и exec(3) без потери смысла.