---
source_image: page_230.png
page_number: 230
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.64
tokens: 7661
characters: 2332
timestamp: 2025-12-24T04:38:37.248276
finish_reason: stop
---

щи встроенной команды интерпретатора read, причем на каждой итерации переменные sum и file принимают значения соответственно первого и второго столбцов строки, при этом во временном каталоге создаются файлы классификатора, именованные значениями $sum, в содержимое которых добавляются имена $file. Если контрольные суммы нескольких обрабатываемых файлов одинаковые, то их имена будут добавлены в разные строки одного и тот же файла классификатора. Остается только найти те файлы классификатора, которые содержат более одной строки, они и будут содержать имена дубликатов. Для поиска по классификатору используется аналогичная связка find(1), xargs(1) и wc(1), формирующая на потоке вывода текстовую таблицу по два столбца в строке, в первом из которых указано количество строк в файле классификатора, а во втором — его имя. Затем при помощи процессора текстовых таблиц awk(1) на стандартный поток вывода печатаются только те имена файлов классификатора из второго столбца строк таблицы (print $2), в первом столбце которых содержится число, большее единицы ($1 > 1). Полученный поток имен файлов отправляется на xargs(1) для вывода имен (-t) и содержимого при помощи cat(1). Необходимо заметить, что сам классификатор размещен в каталоге файловой системы W:[tmpfs], использующей для хранения оперативную память, и имеет случайное имя, сгенерированное при помощи mktemp(1).

Листинг 5.49. Цикл «ПОКА»: поиск дублирующихся фотографий

bender@ubuntu:~$ df -h /run/shm
Файл.система    Размер Использовано Дост Использовано % Смонтировано в
none`           4,0G   26M 3,9G      1% /run/shm
kotoff@ubuntu:~$ findmnt /run/shm
TARGET   SOURCE FSTYPE OPTIONS
/run/shm   tmpfs rw,nosuid,nodev,relatim
bender@ubuntu:~$ T=$(mktemp -d /run/shm/XXXXXX)
bender@ubuntu:~$ find DCIM -type f -print0 | xargs -0 -n1 md5sum |
> while read sum file ; do echo $file >> $T/$sum ; done;
> bender@ubuntu:~$ find $T -type f | xargs -n1 wc -l |
> awk '$1 > 1 { print $2 }' | xargs -n1 -t cat
cat /dev/shm/fjYfn/4f7ba191573ded309bc0f04e08309d8a
DCIM/Camera/IMG_20140731_212625+.jpg
DCIM/Camera/IMG_20140731_212625.jpg
cat /dev/shm/fjYfn/4329ae8006b6935d0c7fd66b57e07c0c
DCIM/DSC_0046+.JPG
DCIM/DSC_0046.JPG

В листинге 5.50 проиллюстрирована вторая форма цикла с условием — составной список until, который применяется для ожидания доступности подключения к Ин-