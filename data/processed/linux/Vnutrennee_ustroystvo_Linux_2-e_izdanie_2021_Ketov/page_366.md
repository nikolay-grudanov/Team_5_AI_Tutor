---
source_image: page_366.png
page_number: 366
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.42
tokens: 7639
characters: 2307
timestamp: 2025-12-24T04:42:53.612129
finish_reason: stop
---

Листинг 10.4. Установленные ядра Linux

morty@ubuntu:~$ ls /boot
...
initrd.img
initrd.img-5.3.0-18-generic
initrd.img-5.3.0-24-generic
initrd.img.old
...
System.map-5.3.0-24-generic
vmlinuz
vmlinuz-5.3.0-18-generic
vmlinuz-5.3.0-24-generic

Ядро (если точнее, то его остов, т. е. vmlinuz), получив управление от загрузчика, должно выполнить два простейших, но очень важных действия: смонтировать корневую файловую систему и запустить первую программу, по традиции /sbin/init в процессе с PID = 1. В силу модульности ядра и того факта, что большинство драйверов устройств (включая дисковые накопители) являются его модулями, а остов не содержит ни одного модуля, смонтировать корневую файловую систему невозможно, т. к. на этом этапе загрузки ядру недоступны ни драйверы накопителей, где она размещается, ни сам драйвер файловой системы. Поэтому остов ядра распаковывает архив модулей initrd.img и «загружает» оттуда нужные модули — драйверы накопителей корневой файловой системы и самой файловой системы.

На самом деле все происходит немного не так. Образ «временной» корневой файловой системы initrd.img — это не просто пассивный «архив модулей» (см. W:[initial ramdisk]), а микроверсия операционной системы, содержащая набор утилит и компонент (листинг 10.5), достаточных для обнаружения дисковых устройств, загрузки их драйверов, инициализации (если нужно) программных массивов дисков, поиска «настоящей» корневой файловой системы, загрузки драйвера этой ФС, инициализации драйвера ее расшифровки (если зашифрована) и, наконец, ее монтирования. После монтирования образа «временной» корневой ФС ядро находит на ней и запускает «временный» /init, задача которого и состоит в исполнении всех вышеперечисленных действий, приводящих к монтированию «настоящей» корневой ФС, после чего «временный» /init подменяет себя настоящим /sbin/init с «настоящей» корневой ФС. Кроме всего, эта микроверсия ОС содержит командный интерпретатор и набор утилит (обычно на основе busybox, см. листинг 9.3) на случай аварийного останова на одном из этапов монтирования «настоящей» корневой ФС, перечисленных выше.

Листинг 10.5. Содержимое образа «временной» корневой ФС

morty@ubuntu:~$ lsinitramfs /boot/initrd.img-5.3.0-18-generic | grep .ko$
1122
morty@ubuntu:~$ lsinitramfs /boot/initrd.img-5.3.0-18-generic | grep bin/