---
source_image: page_167.png
page_number: 167
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.38
tokens: 7622
characters: 2230
timestamp: 2025-12-24T04:36:41.227465
finish_reason: stop
---

fstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(0x88, 0x1), ...}) = 0
write(1, "ubuntu\n", 7)      = 7
ubuntu
exit_group(0)                = ?
+++ exited with 0 +++

Трасса команды hostname(1), показанная в листинге 4.38, поясняет работу загрузчика и компоновщика (loader, ld) динамических библиотек ld-linux(8).

Системный вызов exec(2) отображает для запуска в память процесса не только заданный ELF-файл /bin/hostname, но и (указанный в этом ELF-файле) загрузчик библиотек /lib64/ld-linux-x86-64.so.2, которому и передаются управление до самой программы.

Загрузчик библиотек, в свою очередь, отображает в процесс свой «конфигурационный» файл /etc/ld.so.cache, а затем посегментно отображает файлы всех библиотек и выделяет им требуемую дополнительную память. Загруженные библиотеки присоединяются (линууются или же компонуются, linking) к программе /bin/hostname, после чего страницам их отображенных сегментов назначается соответствующий режим доступа системным вызовом mprotect(2). По завершении компоновки отображение конфигурационного файла /etc/ld.so.cache снимается при помощи munmap(2), а управление передается исходной программе.

4.7.3. Потребление памяти

Суммарное распределение страниц памяти по сегментам процесса можно получить при помощи третьего набора столбцов (активировав его клавишами G3, а затем добавив столбец SWAP клавишей F) команды top(1), как показано в листинге 4.39. В столбце VIRT (VSZ в терминах ps(1)) изображается суммарный объем (в килобайтах) всех страниц процесса, а в столбце RES (RSS в терминах ps(1)) — объем резидентных страниц (находящихся в страничных кадрах оперативной памяти). В столбце SWAP указывается объем всех страниц, находящихся во вторичной памяти — как «анонимных» страниц, выгруженных в специальную область подкачки, так и «файловых» страниц, возможно никогда не загружавшихся в оперативную память.

Столбцы CODE и DATA показывают объемы (в килобайтах) памяти, выделенных под сегменты кода и данных, а столбец SHR — объем резидентных страниц, которые используется (или могут быть использованы) совместно с другими процессами.

Листинг 4.39. Распределение памяти по назначению

fitz@ubuntu:~$ top -p 26958
G3 top - 22:10:12 up 1:48, 2 users, load average: 0.01, 0.02, 0.00