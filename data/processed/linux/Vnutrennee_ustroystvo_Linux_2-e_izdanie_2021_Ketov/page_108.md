---
source_image: page_108.png
page_number: 108
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.83
tokens: 7458
characters: 2003
timestamp: 2025-12-24T04:34:57.486761
finish_reason: stop
---

Mode from config file: enforcing
Policy MLS status: enabled
Policy deny_unknown status: allowed
Max kernel policy version: 29

В отличие от AppArmor, модуль SELinux оперирует не профилями отдельных программ, а общим набором правил 1, называемых политикой (policy). Сами правила политики описывают возможные отношения между процессами и файлами согласно их меткам безопасности. Каждая метка состоит из четырех компонент user:role:type:level, которые могут быть использованы лишь частично. Например, в целевой политике используются только составляющая «тип» (type) и принцип «соблюдения типов» (TE, type enforcement), согласно которому доступ программы к файлу разрешается, если они имеют «совместимые» типы.

В примере из листинга 3.51 показаны метки безопасности процессов bash и ps сеанса пользователя lich и процесса httpd системной службы Web-сервера. В целевой (targeted) политике программы, запускаемые в пользовательских сеансах, и, соответственно, их процессы никак не ограничиваются, что и обозначает тип unconfined_t их метки безопасности. Наоборот, процессы всех системных служб и являются собственно «целями» принудительного контроля доступа целевой политики, поэтому выполняются со своими типами, например httpd_t для службы Web-сервера.

Листинг 3.51. Мандатные метки процессов

[lich@centos ~]$ ps -Z
LABEL PID TTY TIME CMD
unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 8893 pts/0 00:00:00 bash
unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 9454 pts/0 00:00:00 ps

[lich@centos ~]$ ps -ZC httpd
LABEL PID TTY TIME CMD
system_u:system_r:httpd_t:s0 3262 ? 00:00:00 httpd
...
system_u:system_r:httpd_t:s0 3267 ? 00:00:00 httpd

Политика содержит правила назначения меток процессам тех программ, исполняемые файлы которых тоже имеют свои метки, проиллюстрированные в листинге 3.52. Так, например, целевая политика содержит правила, согласно которым процессы Web-сервера httpd получают метку с типом httpd_t, потому что выполняют программы /usr/sbin/httpd с меткой httpd_exec_t.