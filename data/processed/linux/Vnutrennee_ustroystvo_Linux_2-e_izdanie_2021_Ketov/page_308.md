---
source_image: page_308.png
page_number: 308
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.31
tokens: 7567
characters: 1952
timestamp: 2025-12-24T04:40:59.374493
finish_reason: stop
---

7.6. Расширения X-протокола

Оконная система X(1) и ее X-протокол на текущий момент времени обросли массой расширений, одним из которых является расширение W:[MIT-SHM], широко используемое современными библиотеками виджетов для организации наиболее эффективного обмена растровыми изображениями между X-клиентами и X-сервером. Ранние тулкиты, например Xaw и Motif, практически полностью полагались на примитивы векторной графики X-протокола, тогда как современные Gtk или Qt в гораздо большей степени используют растровые изображения (для визуальных эффектов типа выпуклых кнопок, градиентной заливки и т. д.), подготавливаемые целиком на X-клиенте и затем пересылаемые X-серверу для вывода.

Очевидно, что пересылка большого количества растровых изображений с использованием «последовательных» средств межпроцессного взаимодействия, таких как сокеты¹, заставляет жертвовать либо визуальными эффектами, либо производительностью оконной системы. Однако если заметить, что в большинстве «настольных» применений оконной системы X-клиенты и X-сервера в реальности выполняются на одном и том же узле, то очевидно, что разделяемая память является наиболее эффективным средством IPC. Вместе с тем необходимо констатировать факт утери пресловутой «сетевой прозрачности» в угоду приемлемой производительности визуальных эффектов.

Листинг 7.19. Расширения X-сервера: MIT-SHM

homer@ubuntu:~$ xdpyinfo | grep -i shm
MIT-SHM

homer@ubuntu:~$ ipcs -mp
------ Shared Memory Creator/Last-op PIDs --------
shmid   owner   cpid   lpid
15      homer   9190   8498
20      homer   8588   8498
27      homer   9514   8498
31      homer   9661   8498

homer@ubuntu:~$ ps up 8498,9190,8588,9514,9661
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
homer 8498 0.0 1.4 256652 53136 tty2 Sl+ 06:07 0:28 /usr/lib/xorg/Xorg vt2 ...
homer 8588 0.1 6.0 2775368 222432 ? Ssl 06:07 1:10 /usr/bin/gnome-shell

¹ Даже при использовании файловых сокетов, не говоря уже о сетевых.