---
source_image: page_111.png
page_number: 111
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.27
tokens: 7621
characters: 2452
timestamp: 2025-12-24T04:35:05.438975
finish_reason: stop
---

модуля SELinux и соответствующих sandbox_*_t-типов. В примере из листинга 3.55 текстовый Web-браузер links(1), выполненный в процессе с типом sandbox_net_t, в действительности оказывается ограниченным 3 в доступе к SSH-ключам пользователей, что и требовалось получить.

3.7. Дополнительные свойства файлов

3.7.1. Расширенные атрибуты файлов

Как было показано выше (см. листинг 3.4), базовые права доступа, дополнительные атрибуты SUID/SGID, владельцы, счетчик имен и другие основные свойства файлов хранятся в их метаданных. Кроме этого, файлам могут быть назначены списки контроля доступа (см. листинг 3.44) и метки безопасности SELinux (см. листинг 3.50), которые являются их дополнительными свойствами и хранятся за пределами метаданных, при помощи расширенных атрибутов attr(5).

Каждый расширенный атрибут имеет имя вида namespace.attrname, при этом пространства имен namespace определяют назначение атрибута. Пространство имен system используется системными (ядерными) компонентами, например, для списков контроля доступа POSIX ACL. Пространство имен security используется системными компонентами безопасности, в частности для хранения привилегий исполняемых программ (capabilities(7), см. разд. 4.5.2) и меток модуля принудительного контроля доступа SELinux (см. листинги 3.52 и 3.53). Пространства имен trusted и user предназначены для атрибутов внеядерных компонент — программ, выполняющихся привилегированным и обычными пользователями, соответственно.

Для просмотра и назначения внеядерных (пользовательских) расширенных атрибутов используются утилиты getfattr(1) и setfattr(1). Читать пользовательские расширенные атрибуты файла разрешено тем же субъектам, которым разрешено чтение данных этого файла. Аналогично, устанавливать (изменять) и удалять пользовательские расширенные атрибуты файла могут субъекты, допущенные к записи данных этого файла.

Ядерные (системные) атрибуты обычно управляются специально предназначенными командами: например, getfacl(1) и setfacl(1) предназначены для списков контроля доступа, команды getcap(8) и setcap(8) — для привилегий исполняемых программ, команды chcon(1) и ls(1)-Z — для мандатных меток. Системные атрибуты, как правило, всегда доступны для чтения, но их установка и изменение требуют определенных привилегий процесса (см. разд. 4.5.2).

Листинг 3.56. Расширенные системные атрибуты файлов

finn@ubuntu:~$ getcap /usr/bin/gnome-keyring-daemon
/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep ①