---
source_image: page_244.png
page_number: 244
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.90
tokens: 7598
characters: 2432
timestamp: 2025-12-24T04:39:00.885116
finish_reason: stop
---

Кроме выбора отдельных строк инструкциями вида /RE/CMD, sed(1) позволяет адресовать блоки строк, подлежащих редактированию. При помощи инструкций вида /RE1/,/RE2/ CMD команда редактирования применяется ко всем строкам, начиная с той, которая соответствует выражению RE1, заканчивая той, которая соответствует выражению RE2.

Так, например, в листинге 5.65 из потока вывода команды lspci(8) выделяется блок текста, начиная со строки, содержащей слово Ethernet, вплоть до следующей пустой строки (^$ между началом и концом которой не содержится ни одного символа).

Листинг 5.65. Выборка блоков текста

bender@ubuntu:~$ lspci -v | sed '/Ethernet/,/^$/!d'

00:19.0 Ethernet controller: Intel Corporation 82579LM Gigabit Network Connection (Lewisville) (rev 04)
    Subsystem: Dell 82579LM Gigabit Network Connection (Lewisville)
    Kernel driver in use: e1000e
    Kernel modules: e1000e

В листинге 5.66 показан типичный пример самого распространенного варианта использования sed(1) с командой s — замены одних подстрок другими. При помощи трех нежитрых подстановок отсортированный командой sort(1) вывод команды find(1) превращается в дерево файлов и каталогов, аналогичное тому, что строит команда tree(1). Команда подстановки подстрок имеет форму /RE/s/FND/RPL/F, при этом во всех строках, соответствующих RE, будут найдены подстроки, соответствующие FND, и заменены на RPL согласно флагам замены F. Регулярное выражение RE может отсутствовать, тогда замены производятся во всех строчках, а регулярные выражения FND и RPL могут быть ограничены любым другим символом, например : вместо /. Флаги уточняют место замены. Например, флаг g (global) требует произвести столько замен, сколько будет найдено слева направо соответствий выражению FND, а флаг i (case insensitive) указывает на нечувствительность выражения FND к регистру букв.

Таким образом, подстановка s:^..:: выполняет удаление ^.. двух любых символов в начале строки (замену на «ничто»). Это отрежет ненужные префиксы ./ относительных путевых имен, выводимых как результат find(1). Подстановка s:[^/.][^/]*$:++- B: заменяет подстроки, состоящие из любого символа, кроме слеша и точки [^/.], и следующих за ним любого количества * любых, кроме слеша [^/], символов вплоть до конца строки $ на тоже самое значение &, перед которым поставлены символы ++-. Такое действие изобразит имена найденных find(1) файлов и каталогов как ++- file. Последняя подстановка s:[^/]*/:| :g