---
source_image: page_105.png
page_number: 105
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.71
tokens: 7452
characters: 2032
timestamp: 2025-12-24T04:34:52.833800
finish_reason: stop
---

системы — файлам, сетевым протоколам, портам TCP/UDP и пр. Правила AppArmor идентифицируют программы и файлы на основе их полных путевых имен. При этом каждый профиль описывает ограничения для одной определенной запускаемой программы (а также для других, запускаемых этой программой, т. е. «подчиненных» программ), а программы, для которых профили не определены, никак не ограничиваются (unconfined).

В примере из листинга 3.48 проиллюстрировано использование команды aa-status(8), показывающей статус модуля принудительного контроля доступа AppArmor. В распоряжении модуля имеются профиль 1 программы skype в режиме принуждения (enforce) и профиль 2 программы firefox(1) в режиме оповещения (complain). Более того, процесс skype с идентификатором 30173 принуждается (enforce) модулем контроля к выполнению правил профиля, а процесс firefox с идентификатором 10335 только отслеживается (complain) на предмет нарушений правил.

Листинг 3.48. Модуль мандатного разграничения доступа AppArmor

finn@ubuntu:~$ sudo aa-status
apparmor module is loaded.
50 profiles are loaded.
26 profiles are in enforce mode.
1 /usr/bin/skype
   24 profiles are in complain mode.
2 /usr/lib/firefox/firefox{,[^s][^h]}
   18 processes have profiles defined.
   3 processes are in enforce mode.
   6 processes are in complain mode.
   0 processes are unconfined but have a profile defined.

Нарушения мандатных правил процессами, находящимися в режиме оповещения (complain), приводят только к журнализации сообщений аудита об обнаруженных нарушениях. Попытки нарушения мандатных правил процессами, находящимися в режиме принуждения (enforce), пресекаются модулем контроля доступа в виде отказа в доступе к тому или иному запрашиваемому объекту.

Выполненный (листинг 3.49) при помощи команды apparmor_parser(8) анализ полного (-p) набора правил профиля программы /usr/bin/firefox показывает, что обращения к любым файлам каталога .ssh явно запрещены указанием deny и подлежат обязательному аудиту согласно указанию audit. При помощи команды aa-enforce(8)