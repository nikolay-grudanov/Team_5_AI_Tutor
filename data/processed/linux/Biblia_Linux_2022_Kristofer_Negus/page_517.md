---
source_image: page_517.png
page_number: 517
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.10
tokens: 7709
characters: 2475
timestamp: 2025-12-24T05:00:00.248734
finish_reason: stop
---

Чтобы открыть постоянный доступ к FTP-службе, щелкните на поле Configuration (Конфигурация) и выберите вариант Permanent (Постоянная). Затем установите флажок ftp на вкладке Services (Службы). В брандмауэре автоматически откроется TCP-порт 21 (FTP) и загрузит модули ядра, необходимые для обеспечения доступа к пассивной службе FTP. Выберите Options ▸ Reload Firewalld (Параметры ▸ Перезагрузить Firewalld), чтобы раз и навсегда применить правило брандмауэра.

Для RHEL 6 и более ранних систем добавьте правила непосредственно в файл /etc/sysconfig/iptables. Если вы используете брандмауэр с настройками по умолчанию, первые правила открывают доступ к запросам на любые службы, поступающие с локального хоста, и позволяют получать пакеты, связанные с установленными соединениями или относящиеся к ним. В середине находятся правила, открывающие порты для запросов на обслуживание, которые уже разрешены, например, служба secure shell (sshd на TCP-порте 22). В конце находится последнее правило, которое обычно отбрасывает (DROP) или отклоняет (REJECT) любой неразрешенный запрос.

Чтобы дать публичный доступ на ваш FTP-сервер тому, кто его запрашивает, необходимо разрешить новые запросы к TCP-порту 21. Обычно это правило добавляется где-то перед окончательным правилом DROP или REJECT. В следующем примере показана часть содержимого файла /etc/sysconfig/iptables с правилом, разрешающим доступ к FTP-серверу (выделено полужирным):

*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT
...
-A INPUT -j REJECT --reject-with icmp-host-prohibited
COMMIT

В примере видно, что для таблицы фильтров брандмауэр принимает пакеты от установленных подключений, подключений от локальных хостов и любых новых запросов на TCP-порт 22 (служба SSH). Строка, которую мы только что добавили (--dport 21), позволяет принимать любые пакеты на новых соединениях с TCP-портом 21.

ПРИМЕЧАНИЕ
Важно установить строку ESTABLISHED, RELATED в правилах брандмауэра iptables. Без нее пользователи смогли бы подключиться к службам SSH (порт 22) и FTP (порт 21), то есть пройти аутентификацию, но не смогли бы передавать данные.

Следующее, что нужно сделать в RHEL 6 и более ранних системах, — настроить модуль отслеживания FTP-соединений, который будет загружаться каждый