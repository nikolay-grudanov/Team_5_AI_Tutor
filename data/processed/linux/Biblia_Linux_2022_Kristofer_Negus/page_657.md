---
source_image: page_657.png
page_number: 657
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.05
tokens: 7733
characters: 2609
timestamp: 2025-12-24T05:03:57.166306
finish_reason: stop
---

Поиск вторжений. Система обнаружения вторжений (Intrusion Detection System, IDS) — это пакет программ, который отслеживает действия системы (или ее сети) на предмет потенциальных вредоносных действий и сообщает о них, помогая обнаружить вторжения. Тесно связан с этой системой программный пакет Intrusion Prevention System. Пакеты могут быть объединены, чтобы обеспечить обнаружение и предотвращение вторжений.

Для системы Linux доступны несколько пакетов программ обнаружения вторжений. Некоторые из наиболее популярных утилит перечислены в табл. 22.7. Вы должны знать, что tripwire больше не является частью открытого исходного кода. Тем не менее ее исходный код по-прежнему доступен. Более подробную информацию см. на сайте tripwire, приведенном в табл. 22.7.

Таблица 22.7. Популярные системы обнаружения вторжений Linux

<table>
  <tr>
    <th>Система</th>
    <th>Инсталлятор</th>
    <th>Сайт</th>
  </tr>
  <tr>
    <td>aide</td>
    <td>yum install aide apt-get install aide</td>
    <td>aide.sourceforge.net</td>
  </tr>
  <tr>
    <td>Snort</td>
    <td>Пакеты с сайта rpm or tarbal</td>
    <td>snort.org</td>
  </tr>
  <tr>
    <td>tripwire</td>
    <td>yum install tripwire apt-get install tripwire</td>
    <td>tripwire.org</td>
  </tr>
</table>

Advanced Intrusion Detection Environment (aide, усовершенствованная система обнаружения вторжений) IDS использует метод сравнения для поиска вторжений. Ребенком вы, возможно, играли в игру, где нужно сравнить две картинки и найти между ними различия. Утилита aide применяет тот же метод. Создается база данных (первая картинка), через некоторое время создается еще одна база данных (вторая картинка), и aide сравнивает их, сообщая о различиях.

Итак, нужно сделать начальную базу данных (первую картинку). Лучше всего, когда система только установлена. Команда aide -i используется для создания исходной базы данных, и это может занять много времени. Примеры из вывода команды приведены далее. Обратите внимание на то, что команда aide сообщает, где она создает свою первую картинку:

# aide -i
AIDE, version 0.16.11

### AIDE database at /var/lib/aide/aide.db.new.gz initialized.

Далее необходимо переместить исходную базу данных в новое место. Это защитит ее от перезаписи. Кроме того, сравнение не сработает, если база данных не была перемещена. Команда для перемещения базы данных и присвоения ей нового имени выглядит следующим образом:

# cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz

Чтобы проверить, не подделаны ли ваши файлы, нужно создать новую базу данных (вторую картинку) и сравнить ее с исходной базой данных. Параметр