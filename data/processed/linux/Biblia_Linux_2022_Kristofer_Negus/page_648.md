---
source_image: page_648.png
page_number: 648
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.16
tokens: 7691
characters: 2132
timestamp: 2025-12-24T05:03:38.915161
finish_reason: stop
---

в группах, также является превышением прав. Наблюдая за файлами /etc/passwd и /etc/group, можно отслеживать эти потенциальные нарушения.

Для контроля файлов /etc/passwd и /etc/group вы можете применить демон аудита. Это чрезвычайно мощный инструмент, который позволяет выбирать системные события, чтобы отслеживать их и записывать, а также создает отчеты.

Чтобы начать аудит файлов /etc/passwd и /etc/group, нужно использовать команду auditctl. Для запуска этого процесса требуется как минимум два варианта команд:

- -w filename. Установите нужное имя файла на filename. Демон аудита отслеживает файл по его номеру индексных узлов. Номер индексного узла — это структура данных, содержащая информацию о файле, включая его местоположение;
- -p trigger(s—). Если реализуется один из типов доступа (=read, =write, =execute, =attribute) к имени файла, то запись аудита начинается.

В следующем примере наблюдение было направлено в файл /etc/passwd с помощью команды auditctl. Демон аудита будет контролировать доступ любых действий: чтения, записи или изменения атрибутов файлов:

# auditctl -w /etc/passwd -p rwa

После запуска аудита файлов вы можете отключить его в любой момент. Чтобы отключить аудит, используйте команду

# auditctl -W имя_файла -p trigger(s)

Чтобы просмотреть список текущих проверяемых файлов и настройки их наблюдения, введите auditctl -l в командной строке.

Чтобы просмотреть журналы, примените команду ausearch демона аудита. Единственный параметр, необходимый здесь, — это -f, который указывает, какие записи нужно просмотреть из журнала. Далее приведен пример данных аудита /etc/passwd:

# ausearch -f /etc/passwd
time->Fri Feb 7 04:27:01 2020
type=PATH msg=audit(1328261221.365:572):
item=0 name="/etc/passwd" inode=170549
dev=fd:01 mode=0100644 ouid=0 ogid=0
rdev=00:00 obj=system_u:object_r:etc_t:s0
type=CWD msg=audit(1328261221.365:572): cwd="/"
...
time->Fri Feb 7 04:27:14 2020
type=PATH msg=audit(1328261234.558:574):
item=0 name="/etc/passwd" inode=170549
dev=fd:01 mode=0100644 ouid=0 ogid=0
rdev=00:00 obj=system_u:object_r:etc_t:s0
type=CWD msg=audit(1328261234.558:574):
cwd="/home/johndoe"