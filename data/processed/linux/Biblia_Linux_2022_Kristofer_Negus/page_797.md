---
source_image: page_797.png
page_number: 797
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.03
tokens: 7679
characters: 2561
timestamp: 2025-12-24T05:07:49.644060
finish_reason: stop
---

Глава 28. Развертывание приложений Linux в облаке

Предлагаю выполнить действия, описанные далее, на одном из гипервизоров, настроенных в главе 27 «Облачные вычисления с помощью системы Linux». Это позволяет не только создавать настраиваемые данные для облачного образа Linux, но и запускать образ как виртуальную машину на этом гипервизоре.

Чтобы добавить данные и запустить существующий облачный образ, требуется иметь сам облачный образ и создать файлы данных и новый образ, объединяющий эти элементы. Процедура должна быть очень простой для загрузки облачного изображения. Позже я расскажу, как добавить дополнительные функции в эти файлы данных. Чтобы настроить и запустить облачный образ, выполните следующие действия.

1. Создайте файл cloud-init meta-data. Создайте файл с именем meta-data для хранения данных, идентифицирующих информацию об инстансе облака извне. Например, вы можете добавить имя для идентификации инстанса (instance-id), имя хоста (local-hostname) и другую информацию. Чтобы первая попытка была попроще, я назначаю только два поля (можете дать им любые имена):

instance-id: FedoraWS01
local-hostname: fedora01

2. Создайте файл cloud-init user-data. Создайте файл с именем user-data для хранения данных, которые настраиваются внутри операционной системы на самом образе. В качестве простого примера я установил пароль для пользователя по умолчанию (fedora) в значение cloudpass и убедился, что срок действия пароля cloud-init не истечет:

#cloud-config
password: cloudpass
chpasswd: {expire: False}

3. Объедините данные в отдельный образ. Используя файлы meta-data и user-data в текущем каталоге, создайте ISO-образ, содержащий эти данные. Позже мы представим этот образ в виде CD с образом Linux, чтобы служба cloud-init знала, как настроить образ Linux. (Сначала установите пакеты genisoimage и cloud-init, если еще этого не сделали. Пакет cloud-init не нужен на гипервизоре.)

# yum install genisoimage cloud-init
# genisoimage -output fedora31-data.iso -volid cidata \
    -joliet-long -rock user-data meta-data

4. Загрузите базовый образ облака. Облачные образы для систем Ubuntu, Fedora и RHEL настроены для работы с cloud-init. Загрузите официальный облачный образ Fedora (образы для других дистрибутивов описаны далее) и выполните следующие действия:
   ▪ откройте браузер и перейдите на страницу getfedora.org/en/cloud/download;
   ▪ нажмите кнопку Download у образа OpenStack, чтобы загрузить образ qcow2, который можно использовать в среде OpenStack. Имя образа — это что-то вроде Fedora-Cloud-Base-31-1.9.x86_64.qcow2.