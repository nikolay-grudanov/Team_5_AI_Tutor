---
source_image: page_717.png
page_number: 717
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.70
tokens: 7702
characters: 2570
timestamp: 2025-12-24T05:05:31.554556
finish_reason: stop
---

<table>
  <tr>
    <th>Утилита</th>
    <th>Описание</th>
  </tr>
  <tr>
    <td>restorecon</td>
    <td>Делает то же самое, что и утилита setfiles, но у нее другой интерфейс</td>
  </tr>
  <tr>
    <td>setfiles</td>
    <td>Проверяет и/или исправляет метки контекста безопасности. Может быть запущена для проверки меток файлов и/или их смены при добавлении в систему нового модуля политики. Делает то же самое, что и команда restorecon, но у нее другой интерфейс</td>
  </tr>
</table>

Команды chcat и chcon, показанные в табл. 24.2, позволяют изменить контекст безопасности файла. В следующем примере команда chcon применяется для изменения пользователя SELinux, связанного с file.txt, от undefined_u к system_u:

# ls -Z file.txt
-rw-rw-r--. johndoe johndoe
unconfined_u:object_r:user_home_t:s0 file.txt
# chcon -u system_u file.txt
# ls -Z file.txt
-rw-rw-r--. johndoe johndoe
system_u:object_r:user_home_t:s0 file.txt

Рассматривая табл. 24.2, обратите внимание на то, что команды fixfiles, restorecon и setfiles — это, по сути, одна и та же утилита. Однако restorecon чаще всего используется при фиксации меток файлов. Команда restorecon filename возвращает файл в контекст безопасности по умолчанию.

Управление контекстом безопасности процесса

Процесс — это запущенная программа. Когда вы запускаете программы или службы в системе Linux, каждой из них присваивается идентификатор процесса (см. главу 6 «Управление активными процессами»). В системе с SELinux процесс также имеет контекст безопасности.

То, как процесс получает свой контекст безопасности, зависит от того, какой процесс его запустил. Помните, что процесс systemd (ранее init) является «матерью» всех процессов (см. главу 15 «Запуск и остановка служб»). Таким образом, многие демоны и процессы запускаются systemd. Процессы, запускаемые systemd, получают новые контексты безопасности. Например, когда демон apache запускается systemd, ему присваивается тип (он же домен) httpd_t. Назначенный контекст обрабатывается политикой SELinux, написанной специально для этого демона. Если для процесса не существует политики, то ему присваивается тип по умолчанию unconfined_t

Новый процесс (дочерний) программы или приложения, запущенного пользователем (родительский процесс), наследует контекст безопасности пользователя. Конечно, это происходит только в том случае, если пользователю разрешено запускать программу. Процесс также может запускать программу. Дочерний процесс в этом случае тоже наследует контекст безопасности родительского процесса, то есть дочерний процесс выполняется в том же домене.