---
source_image: page_654.png
page_number: 654
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.79
tokens: 7658
characters: 2170
timestamp: 2025-12-24T05:03:50.246594
finish_reason: stop
---

Таблица 22.6. Дополнительное сканирование файловой системы

<table>
  <tr>
    <th>Файл или настройка</th>
    <th>Команда сканирования</th>
    <th>Проблемы с файлом или настройкой</th>
  </tr>
  <tr>
    <td>Права SUID</td>
    <td>find / -perm -4000</td>
    <td>Позволяет любому пользователю временно стать владельцем файла, пока тот выполняется в памяти</td>
  </tr>
  <tr>
    <td>Права SGID</td>
    <td>find / -perm -2000</td>
    <td>Позволяет любому пользователю временно стать членом группы файла, пока тот выполняется в памяти</td>
  </tr>
  <tr>
    <td>Файлы rhost</td>
    <td>find /home -name.rhost</td>
    <td>Позволяет системе полностью доверять другой системе. Не должен находиться в каталогах /home</td>
  </tr>
  <tr>
    <td>Файлы без владельца</td>
    <td>find / -nouser</td>
    <td>Указывает на файлы, не связанные с каким-либо именем пользователя</td>
  </tr>
  <tr>
    <td>Файлы без группы</td>
    <td>find / -nogroup</td>
    <td>Указывает на файлы, не связанные ни с одним именем группы</td>
  </tr>
</table>

Команда rpm -V пакет может сообщить об изменениях, произошедших в файле после его установки из пакета RPM. Для каждого файла из выбранного пакета, который изменился с момента установки, отображается следующая информация:

● S — отличается размер файла;
● M — права или тип файла (режим) различаются;
● 5 — хеш отличается (ранее сумма MD5);
● D — главный/второстепенный номер устройства отличается;
● L — отличается путь readLink(2);
● U — отличается владелец;
● G — отличается группа;
● T — отличается mTime;
● P — отличаются возможности.

По умолчанию отображаются только измененные файлы. Добавьте параметр -v (verbose), чтобы показать и файлы, которые не изменились, например:

# rpm -V samba
S.5....T. /usr/sbin/eventlogadm

В этом примере я повторил несколько символов в двоичном файле eventlogadm. Он показывает, что размер файла изменился, дайджест больше не соответствует исходному дайджесту и время модификации файла изменилось.

Такие проверки файловой системы помогают отслеживать происходящее в системе и обнаруживать вредоносные атаки. Но к файлам могут быть применены и другие типы атак, включая вирусы и руткиты.