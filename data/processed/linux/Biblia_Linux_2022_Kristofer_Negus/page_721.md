---
source_image: page_721.png
page_number: 721
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.97
tokens: 7525
characters: 1973
timestamp: 2025-12-24T05:05:36.963836
finish_reason: stop
---

Мониторинг и устранение неполадок в системе SELinux

Система SELinux — это еще один инструмент для мониторинга вашей системы. Он регистрирует все отказы в доступе, что может помочь вам определить, была ли система атакована. Эти же файлы журнала SELinux полезны и при устранении неполадок SELinux.

Журнал SELinux

SELinux использует кэш, называемый кэшем вектора доступа (access vector cache, AVC), при просмотре правил политики для конкретных контекстов безопасности. При отказе в доступе, называемом отказом AVC, сообщение об этом помещается в файл журнала.

Сообщения об отказе могут помочь вам диагностировать и устранять обычные нарушения политики SELinux. Место сохранения сообщений об отказе зависит от состояния демонов auditd и rsyslogd.

● Если демон auditd запущен, сообщения об отказе регистрируются в файле /var/log/audit/audit.log.
● Если демон auditdis не запущен, но запущен демон rsyslogd, сообщения об отказе регистрируются в файле /var/log/messages.

ПРИМЕЧАНИЕ
Если и auditd, и rsyslogd запущены и в системе есть демон setroubleshootd, сообщения об отказе отправляются как в файлы журнала audit.log, так и в файлы журнала messages. Однако информация об отказе в файле журнала messages сохраняется в формате, который демон setroubleshootd понимает лучше.

Просмотр сообщений SELinux

Если запущен демон auditd, вы можете быстро увидеть, были ли зарегистрированы какие-либо отказы AVC с помощью команды aureport. В следующем примере показано использование команд aureport и grep для поиска отказов AVC. По крайней мере один отказ был зарегистрирован в файле /var/log/audit/audit.log:

# aureport | grep AVC
Number of AVC's: 1

После обнаружения отказа AVC в журнале audit.log вы можете использовать команду ausearch для просмотра сообщений об отказе. В следующем примере показана команда ausearch, применяемая для просмотра зарегистрированного сообщения об отказе AVC:

# ausearch -m avc
type=AVC msg=audit(1580397837.344:274): avc: denied { getattr } for