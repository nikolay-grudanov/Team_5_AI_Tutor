---
source_image: page_909.png
page_number: 909
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.27
tokens: 7524
characters: 1937
timestamp: 2025-12-24T05:10:43.709073
finish_reason: stop
---

Файл lemon отличается от оригинала по размеру файла (S), по md4sum (5) и времени его модификации (T). В системе Ubuntu установите пакет с apt-get install lemon и введите команду debsums lemon, чтобы проверить его.

7. Если вы подозреваете, что ваша система атакована и были изменены важные двоичные файлы, их можно найти, введя в командной строке find directory-mtime -1 для каталогов /bin, /sbin, /usr/bin и /usr/sbin.

8. Чтобы установить и запустить chkrootkit и увидеть, был ли установлен руткит после вредоносной атаки, выберите свой дистрибутив и выполните следующие действия:
   а) на Fedora или RHEL введите команду yum install chkrootkit;
   б) на Ubuntu и в дистрибутивах на базе Debian введите команду sudo apt-get nstall chkrootkit;
   в) чтобы запустить проверку, введите chkrootkit в командной строке и просмотрите результаты.

9. Чтобы найти файлы в любой точке системы с установленным правом UID или SGID, введите команду find / -perm /6000 -ls.

10. Чтобы установить пакет aide, выполните команду aide для инициализации базы данных aide, скопируйте базу данных в нужное место и выполните команду aide для проверки того, изменены ли какие-либо важные файлы в вашей системе:

# yum install aide
# aide -i
# cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz
# aide -C

Чтобы сделать вывод более интересным, можете установить пакет lemon (описан в упражнении 6) и изменить его перед запуском команды aide -C, чтобы увидеть, как выглядит модифицированный двоичный файл.

Глава 23. Продвинутые методы обеспечения безопасности

Для выполнения первых нескольких упражнений у вас должен быть установлен пакет gnupg2. Он не установлен по умолчанию в дистрибутиве Ubuntu, но имеется в последних версиях дистрибутивов Fedora и RHEL.

1. Чтобы зашифровать файл с помощью утилиты gpg2 и симметричного шифра, введите следующую команду (утилита gpg2 запрашивает ключевую фразу для защиты симметричного шифра):

$ gpg2 -c filename