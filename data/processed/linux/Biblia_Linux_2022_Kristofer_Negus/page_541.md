---
source_image: page_541.png
page_number: 541
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.21
tokens: 7656
characters: 2555
timestamp: 2025-12-24T05:00:38.382324
finish_reason: stop
---

Samba и демоном smbd, которые имеют предустановленные контексты файлов, выполните следующие команды:

# semanage fcontext -l | grep -i samba
# semanage fcontext -l | grep -i smb

Часть нужных контекстов заканчивается на _t, например, samba_etc_t, samba_log_t и samba_var_t для каталогов /etc/samba, /var/log/samba и /var/lib/samba соответственно.

Вы можете обнаружить, что следует изменить контекст файла, например, при перемещении файлов в нестандартные места (допустим, перемещая файл smb.conf в /root/smb.conf) или когда нужно поделиться каталогом (за исключением домашних каталогов, которые можно включить, установив логические типы). В отличие от серверов vsftpd (FTP) и httpd (web), которые поставляются вместе с Linux, Samba не имеет общих каталогов содержимого по умолчанию (упоминавшиеся ранее используют каталоги /var/ftp и /var/www/html).

Вы можете навсегда изменить контекст файла, создав новое правило контекста, а затем применив его к нужному файлу или каталогу. Сделать это можно с помощью команд semanage, чтобы создать правило, и restorecon, чтобы его применить. Например, если вы хотите поделиться каталогом /mystuff, то должны создать его с соответствующими правами и выполнить приведенную далее команду, чтобы сделать его доступным для чтения/записи с сервера:

# semanage fcontext -a -t samba_share_t "/mystuff(/.*)?"
# restorecon -v /mystuff

После выполнения этих команд каталог /mystuff вместе с любыми расположенными ниже файлами и каталогами будет иметь контекст файла samba_share_t. Затем необходимо назначить правильного владельца Linux и правильные права доступа к файлам, чтобы разрешить доступ к выбранным вами пользователям. В разделе «Настройка сервера Samba» приведен пример создания общего ресурса, а также показано, как добавить разрешения и права собственности в общий каталог с помощью стандартных команд Linux.

Настройка прав хоста/пользователя сервера Samba

В самом файле smb.conf вы можете разрешить или ограничить доступ ко всему серверу Samba или к определенным общим ресурсам в зависимости от хостов или пользователей, пытающихся получить доступ. Можете также ограничить доступ к серверу Samba, предоставив службу только определенным интерфейсам.

Например, если одна карта сетевого интерфейса подключена к Интернету, а другая — к локальной сети, вы можете указать серверу Samba, чтобы он обслуживал запросы только на локальном сетевом интерфейсе. В следующем разделе описано, как настроить Samba, в том числе как определить, какие хосты, пользователи или сетевые интерфейсы могут получить доступ к серверу.