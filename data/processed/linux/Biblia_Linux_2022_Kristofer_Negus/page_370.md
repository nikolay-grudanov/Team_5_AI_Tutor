---
source_image: page_370.png
page_number: 370
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.38
tokens: 7625
characters: 2297
timestamp: 2025-12-24T04:55:43.971504
finish_reason: stop
---

Команда rsync знает, что все файлы уже скопированы, поэтому не будет делать это снова. Это позволяет экономить пропускную способность сети для каталогов с гигабайтами файлов, где изменяются лишь несколько мегабайт.

Обратите также внимание на выходные данные команды ls -l, где символические ссылки были сохранены в файле batch.1.gz и поэтому на файле появилась метка даты/времени. Если понадобится восстановить эти файлы позже, их можно вернуть к первоначальному состоянию.

В таком варианте команда rsync хорошо подходит для резервного копирования. Но что, если вы хотите зеркально отразить два каталога, сделав содержимое двух структур каталогов абсолютно одинаковым на двух компьютерах? Команды, приведенные далее, иллюстрируют, как создать точное зеркало структуры каталогов на обоих компьютерах, используя каталоги, показанные с предыдущими командами rsync.

Сначала в удаленной системе скопируйте новый файл в копируемый каталог:

# cp /etc/services /usr/share/man/man1

Затем в локальной системе запустите rsync, чтобы скопировать все новые файлы (в данном случае только каталог и новый файл services):

$ rsync -avl johndoe@10.140.67.23:/usr/share/man/man1 /tmp
johndoe@10.140.67.23's password: ***************
sending incremental file list
man1/
man1/services

После этого вернитесь в удаленную систему и удалите новый файл:

$ sudo rm /usr/share/man/man1/services

Теперь в локальной системе снова запустите команду rsync и обратите внимание на то, что в этот раз ничего не происходит. На этом этапе удаленный и локальный каталоги различаются, потому что локальная система имеет файл служб, а удаленная — нет. Это правильное поведение каталога резервных копий. (Резервные копии хранятся на случай, если что-то было удалено по ошибке.) Но если вы хотите, чтобы удаленные и локальные каталоги были зеркально отражены, вам придется добавить параметр --delete. В результате файл служб в локальной системе удаляется, что приводит к синхронизации удаленных и локальных структур каталогов:

$ rsync -avl /usr/share/man/man1 localhost:/tmp
johndoe@10.140.67.23's password: ***************
sending incremental file list
man1/
$ rsync -avl --delete johndoe@10.140.67.23:/usr/share/man/man1 /tmp
johndoe@10.140.67.23's password: ***************
sending incremental file list
deleting man1/services