---
source_image: page_246.png
page_number: 246
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.80
tokens: 7617
characters: 2401
timestamp: 2025-12-24T03:07:31.081837
finish_reason: stop
---

полезный пример — реализация более информативного отчета о том, что тест не пройден.

При разработке API HTTP мы порой обнаруживали отсутствие практической пользы от непрохождения тестов, применяющих HTTP-запросы к приложению: система просто сообщала о срабатывании оператора контроля, поскольку вместо ожидаемого ответа (HTTP 200) была получена ошибка HTTP 500. Мы хотели больше узнать о запросе: к конечной точке с каким URL он производился? Если это был запрос POST, включал ли он данные? И если да, то какие? Вся эта информация присутствует в объекте HTTP-ответа, так что мы написали точку подключения, чтобы заглянуть внутрь этого объекта и включить все упомянутые элементы в отчет о том, что тест не пройден.

Точки подключения — продвинутая возможность pytest, которая, возможно, вам и не понадобится, однако не помешает понимать, что фреймворк pytest достаточно гибок, чтобы удовлетворить самые разные требования. В следующих разделах мы рассмотрим, как расширить возможности этого фреймворка, почему оператор assert настолько ценен, как параметризовать тесты с целью сокращения повторов, как создавать вспомогательные функции с помощью фикстур, а также как использовать уже имеющиеся встроенные.

conftest.py

Почти все программное обеспечение позволяет расширять функциональность с помощью плагинов (например, в веб-браузерах они называются расширениями (extensions)), и в pytest также имеется обладающий большими возможностями API для разработки плагинов. Мы рассмотрим не весь API, а лишь более простой подход — файл conftest.py. В нем можно расширять функциональность утилит совершенно так же, как плагинами. При этом не нужно знать во всех деталях, как создать отдельный плагин, преобразовать его в пакет и установить. Фреймворк pytest загружает файл conftest.py (при его наличии) и считывает из него все инструкции. Все происходит автоматически!

Обычно файл conftest.py включает точки подключения, фикстуры и вспомогательные функции для последних. Если объявить эти фикстуры в качестве аргументов, можно использовать их внутри тестов (этот процесс описан далее в разделе, посвященном фикстурам).

Фикстуры и вспомогательные функции имеет смысл добавлять в этот файл, если его будут использовать несколько модулей. Если же файл теста только один или фикстура либо точка подключения будет применяться только в одном файле, создавать или использовать файл conftest.py смысла нет. Фикстуры