---
source_image: page_257.png
page_number: 257
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.50
tokens: 7573
characters: 2377
timestamp: 2025-12-24T03:07:47.810333
finish_reason: stop
---

на систему новые соединения перенаправлялись на другие, менее загруженные серверы.

При развертывании новой версии приложение необходимо было перезапустить. Перезапуск означал для клиентов в лучшем случае, что приложение будет вести себя странно, а то и работать откровенно плохо. Во избежание этого процесс перезапуска ждал завершения всех клиентских соединений, система отказывала клиентам в новых соединениях, чтобы можно было завершить операции с имеющимися клиентами, а остальная часть системы брала на себя работу. А когда не оставалось активных соединений, развертывание продолжалось и сервисы останавливались для включения нового кода.

На каждом этапе этого процесса выполнялась проверка: до того, как средство развертывания указывает балансировщику прекратить отправку заданий от новых клиентов, и позднее, чтобы убедиться в отсутствии активных клиентов. Если превратить этот технологический процесс в тест, то описание его могло быть примерно следующим: убедиться, что в настоящий момент никакие клиенты не работают. После внесения нового кода нужно еще убедиться, что балансировщик подтвердил готовность сервера к работе. Еще один возможный тест: балансировщик считает сервер активным. Наконец, необходимо удостовериться, что сервер получает новые клиентские соединения, — еще один тест, который нужно написать!

Из этих шагов, для которых можно написать соответствующие тесты, и состоит верификация подобного технологического процесса.

Мониторинг общего рабочего состояния сервера (или серверов в кластерной среде) также может относиться к проверке системы либо может быть составной частью непрерывной интеграции при разработке приложения и функциональном тестировании. К этим ситуациям, а равно и к любым другим, в которых может оказаться полезна верификация состояния, отлично применимы базовые идеи проверки. Их не следует использовать исключительно для тестирования, хотя для начала это и неплохо!

Введение в Testinfra

Написание модульных тестов для тестирования инфраструктуры — замечательная идея, и из нашего более чем годичного опыта работы с проектом Testinfra мы можем сделать вывод, что он позволил улучшить качество приложений, которые мы поставляли для промышленной эксплуатации. В следующих разделах обсудим различные подробности, в частности подключение к разным узлам и выполнение проверочных тестов, а также поговорим о доступных типах фикстур.