---
source_image: page_141.png
page_number: 141
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.95
tokens: 7518
characters: 1998
timestamp: 2025-12-24T03:04:37.084535
finish_reason: stop
---

Этот фрагмент кода проходит по всем файлам и каталогам, выводя все найденные файлы, название которых оканчивается на .ру. Вот как включить эту возможность в Bash 4:

$ shopt -s globstar

Поиск и замена с запросами подтверждения

В механизме поиска/замены редактора Vim есть очень интересная возможность — запрос подтверждения замены (выполнять замену или пропустить это вхождение). Особенно удобно это, когда не удается подобрать регулярное выражение, точно соответствующее вашим требованиям, и некоторые близкие совпадения необходимо игнорировать. Мы неплохо разбираемся в регулярных выражениях, но старались не слишком углубляться в их изучение, чтобы избежать соблазна применять их повсюду. Чаще всего вам достаточно будет простого поиска и не захочется ломать голову над идеальным регулярным выражением.

Чтобы включить запросы подтверждения в Vim, необходимо добавить в команду флаг с:

:%s/исходный_терм/заменитель/gc

Эта команда обозначает: искать исходный_терм во всем файле и заменить его на заменитель, во всех случаях запрашивая у пользователя, заменять его или пропустить. При обнаружении вхождения Vim выведет сообщение наподобие следующего:

Заменить на заменитель (y/n/a/q/l/^E/^Y)?

Процесс подтверждения в целом может показаться глупым, но позволяет предъявлять к регулярному выражению менее жесткие требования или вообще не применять регулярное выражение в простых случаях поиска/замены. Небольшой пример этого — недавние изменения API в утилите, когда атрибут объекта был заменен на вызываемую функцию. Код возвращал True или False в зависимости от того, требовались ли полномочия суперпользователя. Сама замена в файле выполнялась примерно следующим образом:

:%s/needs_root/needs_root()/gc

Дополнительная сложность заключалась в том, что строка needs_root часто встречалась в комментариях и docstring, а подобрать такое регулярное выражение, чтобы не делать замены внутри блока комментариев или docstring, было очень непросто. При использовании же флага с можно просто нажать