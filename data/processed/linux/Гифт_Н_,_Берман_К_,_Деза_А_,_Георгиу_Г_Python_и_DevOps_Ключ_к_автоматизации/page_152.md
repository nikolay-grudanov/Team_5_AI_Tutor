---
source_image: page_152.png
page_number: 152
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.36
tokens: 7683
characters: 2378
timestamp: 2025-12-24T03:04:54.755682
finish_reason: stop
---

Моя система довольно старая, под python в этих результатах подразумевается python2.7, так что он просматривает файловую систему в поисках нужного исполняемого файла и проходит несколько каталогов, пока не доберется до /usr/bin/python, представляющего собой ссылку на /usr/bin/python2, который, в свою очередь, представляет собой еще одну ссылку, отправляющую процесс в каталог /usr/bin/python2.7. Далее он вызывает stat для каталога /usr/bin/Modules/Setup, о котором мы как разработчики Python никогда и не слышали, и просто переходит далее к модулю os.

Затем Python переходит к pybuilddir.txt и lib-dynload. Ничего себе путешествие! Без strace, вероятно, мы читали бы реализующий эти действия код, пытаясь понять последовательность переходов. Утилита strace нескажанно облегчает эту задачу, отображая все промежуточные шаги и сопровождая их полезной информацией о каждом вызове.

У этой утилиты есть множество интересных флагов, например, она умеет подсоединяться к процессу с конкретным PID. Если вы знаете идентификатор процесса, можете запросить у strace отчет обо всем происходящем с ним.

В число полезных флагов входит -f, при указании которого утилита strace отслеживает создаваемые исходной программой дочерние процессы. В примере файла Python производится вызов модуля subprocess, который, в свою очередь, вызывает команду ls. Если модифицировать вызов strace, добавив флаг -f, будет выведена информация со всеми подробностями этого вызова.

При выполнении follow.py в домашнем каталоге с флагом -f можно заметить немало отличий, в частности вызовы lstat и readlink для файлов настроек (некоторые из них представляют собой символические ссылки):

[pid 30127] lstat(".vimrc", {st_mode=S_IFLNK|0777, st_size=29, ...}) = 0
[pid 30127] lgetxattr(".vimrc", "security.selinux", 0x55c5a36f4720, 255)
[pid 30127] readlink(".vimrc", "/home/alfredo/dotfiles/.vimrc", 30) = 29
[pid 30127] lstat(".config", {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0

Здесь не только отображаются обращения к этим файлам, но и выводятся идентификаторы процессов в начале строк, благодаря чему становится проще выяснить, какой дочерний процесс что делает. Вызов strace без флага -f, в частности, не отображает идентификаторы процессов.

Наконец, для детального анализа выведенной информации удобно было бы сохранить ее в файл. Для этого служит флаг -o:

$ strace -o output.txt python follow.py