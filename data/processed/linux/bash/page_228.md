---
source_image: page_228.png
page_number: 228
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 10.94
tokens: 7509
characters: 2066
timestamp: 2025-12-23T23:10:29.043674
finish_reason: stop
---

STRCAT

Почему же функция С strcat может переполнить буфер? Поскольку strcat копирует одну строку (источник) в конец другой строки (назначение), функция не знает, какой объем памяти доступен в месте назначения. Независимо от того, сколько байт находится или сколько места доступно в месте назначения, функция копирует из источника байт за байтом до тех пор, пока не столкнется с нулевым байтом. В результате strcat может скопировать в место назначения слишком много данных и перезаписать другие разделы памяти. Опытный злоумышленник может воспользоваться этим свойством функции для внедрения в память вредоносного кода, который впоследствии будет выполняться компьютером.

Более безопасной функцией является strncat, требующая от вас указать параметр, который ограничивает количество копируемых байтов. В этом случае вы будете знать, что в строке назначения останется достаточно места.

Полное объяснение механизма переполнения буфера выходит за рамки этой книги, но мы вам настоятельно рекомендуем прочитать статью Smashing The Stack for Fun and Profit (http://bit.ly/2TAiw1P).

В примере 15.1 переменная combined[] имеет максимальную длину 50 байт. Вот что происходит, если комбинация двух аргументов программы слишком велика для хранения в переменной:

$ ./fuzzme.exe arg1aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

The two arguments combined is: arg1 aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Segmentation fault (core dumped)(Ошибка сегментации (сбросить ядро))

Как вы можете видеть, данные переполнили пространство, выделенное в памяти для combined[], и вызвали сбой программы из-за ошибки сегментации. Факт сбоя программы означает, что она не выполняет нормальную проверку ввода и может быть уязвима для атаки.

Метод fuzzer предназначен для автоматизации процесса идентификации областей целевой программы, выходящих из строя из-за недопустимого ввода.

Реализация этого метода показана в примере 15.2.

Пример 15.2. fuzzer.sh

#!/bin/bash -
#