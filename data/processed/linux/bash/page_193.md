---
source_image: page_193.png
page_number: 193
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 8.34
tokens: 7450
characters: 1876
timestamp: 2025-12-23T23:09:08.032663
finish_reason: stop
---

trap cleanup EXIT

# запустить процесс bg
TMPFILE=$(tempfile)
{ bash tailcount.sh $1 | \
    bash livebar.sh > $TMPFILE ; } & ⑧
BGPID=$!

clear
while true
do
    printf '%s' "$UPTOP"
    # заголовок:
    echo "${REV}Rapid Cyber Ops Ch. 12 -- Security Dashboard${OFF}" \
        | prSection 1
    #---------------------------------------------
    {
        printf 'connections:%4d %s\n' \
            $(netstat -an | grep 'ESTAB' | wc -l) "$(date)"
    } | prSection 1
    #---------------------------------------------
    tail -5 /var/log/syslog | cut -c 1-16,45-105 | prSection 5
    #---------------------------------------------
    { echo "${SMUL}yymmdd${RMUL}" \
        "${SMUL}hhmmss${RMUL}" \
        "${SMUL}count of events${RMUL}"
        tail -8 $TMPFILE
    } | prSection 9
    sleep 3
done

① Команда tput предоставляет независимую от терминала последовательность символов, позволяющую переместиться в левый верхний угол экрана. Чтобы не вызывать данную команду при каждом цикле, мы вызываем ее только один раз и сохраняем вывод для повторного использования при каждой итерации. Далее следуют другие вызовы специальных последовательностей, сохраненных для повторного использования.

② Существует несколько способов создания пунктирной линии. Здесь мы выбрали один, хоть немного и замысловатый, но очень интересный вариант. При этом двухэтапном процессе используется заполнение функцией printf всей пустой результирующей строки. Символ * указывает функции printf использовать для задания ширины отформатированного поля первую переменную. В результате получается строка из 49 пробелов и одного знака минус. Напечатанная строка сохраняется в переменной, заданной параметром -v. Вторая часть создания пунктирной линии заключается в том, чтобы заменить каждый пробел знаком минус (двойной слеш указывает bash заменить не только первое, но и все остальные вхождения).