---
source_image: page_284.png
page_number: 284
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 9.82
tokens: 7387
characters: 1556
timestamp: 2025-12-23T23:12:28.665360
finish_reason: stop
---

Чтобы показать разнообразие решений, которые вы можете найти и использовать при написании сценариев оболочки, мы привели три варианта сценария. Существует множество компромиссных решений как по стилю, так и по сути, которые можно использовать при выполнении вашей задачи.

Пакетная обработка электронных адресов

Если нужно проверить несколько адресов электронной почты на их наличие в базе данных сайта Have I Been Pwned?, можете автоматизировать процесс. В примере 22.5 показано, как считать файл со списком подлежащих проверке адресов электронной почты и выполнить для каждого электронного адреса сценарий checkemail.sh. Если адрес электронной почты был взломан, он будет показан на экране.

Пример 22.5. emailbatch.sh

#!/bin/bash -
#
# Bash и кибербезопасность
# emailbatch.sh
#
# Описание:
# Чтение файла с адресами электронной почты
# и проверка их на сайте Have I Been Pwned?
#
# Использование: ./emailbatch.sh [<filename>]
# <filename> Файл с одним адресом электронной почты в каждой строке
# по умолчанию: читать из stdin
#

cat "$1" | tr -d '\r' | while read fileLine
do
    ./checkemail.sh "$fileLine" > /dev/null
    if (( "$?" == 0 ))
    then
        echo "$fileLine is Pwned!"
    fi
    sleep 0.25
done

① Прочитайте файл, переданный через первый аргумент. Команда td используется для удаления разрывов строк Windows, поэтому они не включаются в адрес электронной почты.

② Запускается сценарий checkemail.sh и в качестве аргумента передаются адреса электронной почты. Вывод перенаправляется в /dev/null, поэтому не отображается на экране.