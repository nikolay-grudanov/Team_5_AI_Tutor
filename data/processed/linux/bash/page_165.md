---
source_image: page_165.png
page_number: 165
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 10.90
tokens: 7511
characters: 2126
timestamp: 2025-12-23T23:08:04.909672
finish_reason: stop
---

1 В этой функции весь вывод stdout перенаправляется в stderr. Таким образом, нам не нужно задавать перенаправление для каждого оператора echo. Мы отправляем вывод в stderr, потому что это не предполагаемый вывод программы, а просто сообщения об ошибках.

2 Данная функция выполняет основную работу по созданию sha1sum для всех файлов в указанных каталогах. Программа xargs выведет столько имен файлов, сколько может поместиться в командной строке команды sha1sum. Это позволяет избежать необходимости каждый раз отдельно вызывать sha1sum для каждого файла (вызов sha1sum для всех файлов сильно замедлит работу программы). Вместо этого при каждом вызове sha1sum обрабатывает 1000 или более имен файлов.

3 Для поиска параметра -d со связанным с ним аргументом (обозначенным :) используем встроенный цикл getopts. Для получения дополнительной информации о getopts см. пример 5.4.

4 Поскольку нам требуется разрешить указывать несколько каталогов, мы добавляем каждый каталог в массив DIR.

5 После завершения цикла getopts нам нужно настроить количество аргументов. Чтобы избавиться от аргументов, которые были «использованы» getopts, применяем shift.

6 Если каталоги не указаны, то по умолчанию данные расположены в корне файловой системы. Если для выполнения данной операции ваших прав доступа будет достаточно, все файлы окажутся в файловой системе.

7 Эта строка считывает значение хеша и имя файла. Но откуда эти данные считываются, если нет конвейера команд, передающих данные на чтение? Ответ можно найти в конце цикла while.

8 Вот ответ, указывающий на источник данных. Помещая перенаправление в оператор while/do/done, вы в этом цикле перенаправляете все операторы в stdin (в данном случае). Для нашего сценария это означает, что оператор read получает входные данные из файла, указанного в $B2ND.

Вот результат выполнения примера:

$ bash baseline.sh -d . baseline.txt baseln2.txt

<filesystem host="mysys" dir=".">
    <new>./analyze/Project1/fd2.bck</new>
    <relocated orig="./farm.sh">./analyze/Project1/farm2.sh</relocated>
    <changed>./caveat.sample.ch</changed>
    <removed>./x.x</removed>
</filesystem>