---
source_image: page_217.png
page_number: 217
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 13.58
tokens: 7694
characters: 2245
timestamp: 2025-12-23T23:10:07.458729
finish_reason: stop
---

Создание собственного метода криптографии

Предыдущий метод шифрования отлично работает, если в целевой системе установлен OpenSSL. Но что делать, если его там нет? Вы можете установить OpenSSL (но это действие может быть замечено системным администратором целевой системы и возрастет операционный риск) или же создать внутри сценария собственную реализацию криптографического алгоритма.

В большинстве случаев не стоит создавать собственный криптографический алгоритм или даже пытаться реализовать существующий, например AES. Вместо этого лучше использовать общепринятые алгоритмы, которые были проверены криптографическим сообществом.

В данном случае мы будем реализовывать алгоритм только для производственной необходимости и для того, чтобы продемонстрировать фундаментальные криптографические принципы. Здесь следует учесть, что этот алгоритм небезопасен, а информация зашифрована плохо.

Алгоритм, который мы будем использовать, состоит из нескольких основных шагов и прост в реализации. Это основной потоковый шифр, который использует генератор случайных чисел для создания ключа той же длины, что и обычный, подлежащий шифрованию текст. Далее каждый байт (символ) обычного текста пропускается через операцию исключающего ИЛИ (метод XOR) с соответствующим байтом ключа (случайным числом). Вывод представляет собой зашифрованный шифротекст. Таблица 14.1 иллюстрирует использование метода XOR для шифрования.

Таблица 14.1. Пример шифрования

<table>
  <tr>
    <th>Обычный текст</th>
    <th>e</th>
    <th>c</th>
    <th>h</th>
    <th>o</th>
  </tr>
  <tr>
    <td>ASCII (шестнадцатеричный)</td>
    <td>65</td>
    <td>63</td>
    <td>68</td>
    <td>6f</td>
  </tr>
  <tr>
    <td>Ключ (шестнадцатеричный)</td>
    <td>ac</td>
    <td>27</td>
    <td>f2</td>
    <td>d9</td>
  </tr>
  <tr>
    <td>XOR</td>
    <td>—</td>
    <td>—</td>
    <td>—</td>
    <td>—</td>
  </tr>
  <tr>
    <td>Зашифрованный текст (шестнадцатеричный)</td>
    <td>c9</td>
    <td>44</td>
    <td>9a</td>
    <td>b6</td>
  </tr>
</table>

Если при расшифровке текста, зашифрованного методом XOR, будет использован тот же ключ (последовательность случайных чисел), который применялся для шифрования, мы получим расшифрованный исходный текст. Как и AES, этот