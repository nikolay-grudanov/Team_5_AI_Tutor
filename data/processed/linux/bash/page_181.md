---
source_image: page_181.png
page_number: 181
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 12.32
tokens: 7555
characters: 2100
timestamp: 2025-12-23T23:08:45.080871
finish_reason: stop
---

print VIRUS, "- result:", RESLT
    }
}'
① Мы начинаем с той же предварительной обработки входных данных, что и в предыдущем сценарии. На этот раз передаем результаты в awk.

② Код внутри этих фигурных скобок будет выполняться только для входных строк с девятью полями.

③ Мы устанавливаем переменные для хранения этих строковых констант. Обратите внимание, что мы не можем использовать одинарные кавычки вокруг одного символа двойной кавычки. Почему? Потому что весь сценарий awk защищен (от интерпретации специальных символов в оболочке) одинарными кавычками (вернитесь на три строки назад или перейдите в конец этого сценария). Вместо этого мы экранируем двойную кавычку, поставив перед ней обратный слеш.

④ Здесь третье поле входной строки сравнивается со строкой "true", поскольку в awk сочетание строк подразумевает конкатенацию. Мы не используем знак плюс для добавления двух строк, как это делается в некоторых языках; мы просто указываем их рядом друг с другом.

⑤ Как и в случае с $3, который используется в условии if, $1 здесь относится к номеру поля входной строки — первому слову ввода. Это не переменная оболочки, ссылающаяся на параметр сценария. Помните про одинарные кавычки, в которые заключен этот сценарий awk.

⑥ gsub — это функция awk, выполняющая глобальное замещение. При поиске через третий аргумент она заменяет все вхождения первого аргумента вторым. Поскольку второй аргумент — это пустая строка, то из строки в переменной VIRUS (которой было присвоено значение первого поля строки ввода) удаляются все символы кавычек.

Остальная часть сценария, выполняющая эти замены и выводящая результаты, во многом совпадает с предыдущим. Помните, что в awk сценарий продолжает читать stdin и выполнять код по одному разу для каждой строки ввода до его конца.

Сканирование файла

Вы можете выгрузить новые файлы для анализа в VirusTotal, если информации о них еще нет в базе данных. Для этого вам нужно отправить запрос HTML POST на URL-адрес https://www.virustotal.com/vtapi/v2/file/scan. Вы также должны предоставить свой ключ API и путь для выгрузки файла. Ниже приведен пример