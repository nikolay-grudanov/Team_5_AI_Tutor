---
source_image: page_221.png
page_number: 221
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 9.90
tokens: 7516
characters: 1947
timestamp: 2025-12-23T23:10:12.235098
finish_reason: stop
---

переменная оболочки, которая возвращает случайное (целое) число в диапазоне от 0 до 16 383 (3FFF). Здесь, чтобы очистить все, кроме последних 7 бит, используется поразрядный оператор and.

7 Мы печатаем новое закодированное значение в виде двухзначного шестнадцатеричного числа с нулевым заполнением.

8 Оператор echo печатает новую строку в конце строки шестнадцатеричных цифр.

9 Для расшифровки будет вызвана функция Decrypt.

10 Ввод для расшифровки — шестнадцатеричные цифры, поэтому одновременно мы берем два символа.

11 Мы строим подстроку с литералом 0x, за которым следует двухсимвольная подстрока входного текста.

12 Задав шестнадцатеричную цифру в формате, который понимает bash, мы можем рассматривать ее как математическое выражение (используя символы dollar-double-parens), после чего bash вернет ее значение. Вы могли бы написать это выражение следующим образом:

$(( $CHAR + 0 ))

13 Используемый нами алгоритм кодирования/декодирования один и тот же. Мы берем случайное число и сопоставляем (exclusive-or) его с нашим вводом. Последовательность случайных чисел должна быть такой же, как и при шифровании нашего сообщения, поэтому нам нужно использовать такое же значение, как и при шифровании.

14 Функция aschar преобразует числовое значение в символ ASCII и выводит его (помните, что это пользовательская функция, а не bash).

15 Параметр (-n) запрашивает значение аргумента. Если оно не равно нулю, выполняется проверка, соотносится ли параметр -d с тем сообщением, которое мы хотим расшифровать (а не зашифровать). Если результат положительный (то есть параметр -d соотносится с сообщением), тогда устанавливается флаг для проверки.

16 Этот параметр -d отбрасывается командой shift, потому что первым аргументом ($1) становится следующий аргумент (если он есть).

17 Ключу переменной присваивается первый аргумент (если таковой имеется). Если аргумент не указан, в качестве значения по умолчанию мы будем использовать 1776.