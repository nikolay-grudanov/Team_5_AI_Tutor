---
source_image: page_135.png
page_number: 135
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 8.84
tokens: 7511
characters: 1998
timestamp: 2025-12-23T23:06:53.472112
finish_reason: stop
---

будет записывать каждую найденную строку в буфер, и не потребуется много времени, чтобы добраться до конца файла. По достижении конца файла, когда поступление данных прекратится, буфер будет очищен, то есть содержимое буфера будет записано, даже если он заполнен только частично. Когда входные данные поступают из файла, обычно этот процесс идет быстро.

Но при чтении из конвейера, особенно для нашего примера, когда tail -f вносит данные в конвейер не так часто (только когда происходят определенные события), данных для заполнения буфера может не хватить. Буфер, чтобы мы увидели его содержимое в «реальном времени», в ближайшее время не будет очищен. Нам придется подождать его заполнения. А на это может уйти несколько часов или даже дней.

Решение состоит в том, чтобы по мере нахождения каждой строки указать egrep использовать менее эффективную технику записи, по одной строке за раз. Команда при обнаружении каждого совпадения будет сохранять данные, перемещающиеся по конвейеру.

Обнаружение вторжений с помощью журнала

Для мониторинга журнала и вывода любых записей, которые соответствуют известным шаблонам подозрительной или вредоносной деятельности, часто называемым IОС, можно использовать возможности команд tail и egrep. Вы можете создать простую систему обнаружения вторжений (IDS). Для начала создадим файл, содержащий шаблоны регулярных выражений для IОС, как показано в примере 8.1.

Пример 8.1. ioc.txt

\.\./ ①
etc/passwd ②
etc/shadow
cmd\.exe ③
/bin/sh
/bin/bash

① Этот шаблон (../) является показателем обходной атаки каталога: злоумышленник пытается выйти из текущего рабочего каталога и добраться к файлам, доступ к которым ему закрыт.

② Файлы Linux etc/passwd и etc/shadow используются для аутентификации системы и никогда не должны быть доступны через веб-сервер.

③ Обслуживание файлов cmd.exe, /bin/sh или /bin/bash является показателем наличия обратного подключения, возвращаемого веб-сервером. Обратное подключение часто говорит об успешной попытке эксплуатации.