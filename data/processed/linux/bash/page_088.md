---
source_image: page_088.png
page_number: 88
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 9.49
tokens: 7473
characters: 1866
timestamp: 2025-12-23T23:04:57.073914
finish_reason: stop
---

case "${opt}" in
    c) # копировать найденные файлы в указанный каталог
        COPY=YES
        DESTDIR="$OPTARG"
        ;;
    i) # игнорировать регистр при поиске
        CASEMATCH='-i'
        ;;
    [Rr]) # рекурсивно
        unset DEEPORNOT;;
    *) # неизвестный/неподдерживаемый вариант
        # при получении ошибки msg от gretops просто выйти
        exit 2 ;;
esac
done
shift $((OPTIND - 1))

PATTERN=${1:-PDF document}
STARTDIR=${2:-.}      # по умолчанию начать здесь

find $STARTDIR $DEEPORNOT -type f | while read FN
do
    file $FN | egrep -q $CASEMATCH "$PATTERN"
    if (( $? == 0 ))   # найден один
    then
        echo $FN
        if [[ $COPY ]]
        then
            cp -p $FN $DESTDIR
        fi
    fi
done

1 Этот сценарий поддерживает параметры, которые, как описано во вступительных комментариях, изменяют его поведение. Сценарий должен проанализировать все эти параметры, чтобы определить, какие из них были предоставлены, а какие — опущены. Если параметров больше двух, имеет смысл использовать встроенную оболочку getopts. С помощью цикла while мы будем продолжать вызывать getopts до тех пор, пока она не вернет ненулевое значение, сообщая нам, что параметров больше нет. Параметры, которые мы хотим найти, представлены в строке с:irR. Какой бы параметр ни был найден, в opt будет возвращено указанное нами имя переменной.

2 Здесь мы используем оператор case, который является многопрофильной веткой; будет найдена ветвь, соответствующая шаблону, заданному перед левой круглой скобкой. Мы могли бы использовать конструкцию if/elif/else, но ветвь и так хорошо читается и показывает все параметры.

3 Параметр с сопровождается двоеточием (:), находящимся в списке поддерживаемых опций, — оно указывает getopts, что пользователь также предоставит аргумент для этого параметра. В нашем сценарии этот необязательный аргумент является