---
source_image: page_151.png
page_number: 151
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 11.89
tokens: 7619
characters: 2199
timestamp: 2025-12-23T23:07:33.134774
finish_reason: stop
---

do
    LOOKFOR=$portb NotInList ${PORTSA[@]} && echo " new: $portb"
done

done 4< ${1:-day1.data} 5< ${2:-day2.data}
# day1.data и day2.data являются именами по умолчанию, что упрощает тестирование

① Функция NotInList написана так, чтобы возвращать значение, приравненное к true или false. Помните, что в оболочке (за исключением значений в двойных скобках) 0 считается истинным. (После выполнения команды возвращается 0, когда ошибки не возникает; ненулевые возвращаемые значения обычно указывают на ошибку, поэтому считаются ложными.)

② «Уловка» в этом сценарии заключается в том, что можно читать из двух разных потоков ввода. Для этого в сценарии мы используем файловые дескрипторы 4 и 5. Здесь переменная aline заполняется данными, прочитанными из файлового дескриптора 4. Мы вскоре увидим, где дескрипторы 4 и 5 получают свои данные. Символ &, который находится перед дескриптором файла 4, обозначает, что это дескриптор файла 4. Без символа & bash будет пытаться читать из файла с именем 4. После прочтения последней строки входных данных, когда мы достигнем конца файла, команда read возвращает ошибку. В этом случае будет выполнена команда break, завершающая цикл.

③ Аналогично bline будет считывать свои данные из дескриптора 5. Поскольку предполагается, что два файла имеют одинаковое количество строк (то есть одни и те же хосты), то команда break здесь тоже нужна, так как она выполняется и в предыдущей строке. Такая симметрия делает файл более читаемым.

④ Если две строки идентичны, нет необходимости разбирать их на отдельные номера портов, поэтому мы сразу переходим к следующей итерации цикла.

⑤ Мы изолируем имя хоста, удалив все символы, находящиеся после первого пробела (включая и сам первый пробел).

⑥ И наоборот, мы можем извлечь все номера портов, удалив имя хоста и все символы из начала строки вплоть до первого пробела (включая и сам первый пробел). Обратите внимание: мы не просто присваиваем этот список переменной, а используем скобки, чтобы инициализировать ее как массив, в котором каждая запись — номер порта.

⑦ Посмотрите на это выражение. За присвоением переменной в той же строке сразу идет команда echo. Для оболочки это означает, что значение переменной