---
source_image: page_157.png
page_number: 157
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 6.84
tokens: 7285
characters: 1313
timestamp: 2025-12-23T23:07:42.855221
finish_reason: stop
---

10 Инструмент: контроль файловой системы

Заражение файловой системы целевого объекта вредоносными программами и другие вторжения часто обнаруживаются по изменениям, которые вредоносные программы вносят в эту файловую систему. Для идентификации файлов, которые были добавлены, удалены или изменены, можно использовать свойства криптографической хеш-функции и возможности командной строки. Эта методика может быть наиболее эффективной в таких системах, как серверы или встраиваемые устройства, которые на регулярной основе не претерпевают существенных изменений.

В этой главе мы разработаем инструмент для создания в файловой системе базового файла, в котором зафиксируем текущее состояние файловой системы. Далее, используя этот базовый файл, мы сравним зафиксированное состояние системы с более поздним и определим, были ли файлы добавлены, удалены или изменены. Для этого требуется следующее.

1. Записать путь к каждому файлу в данной системе.
2. Создать для каждого файла этой системы хеш SHA-1.
3. Повторно запустить инструмент и вывести имена всех файлов, которые были изменены, удалены, перемещены, или имена новых файлов.

Используемые команды

В этой главе для сравнения файлов мы воспользуемся командой sdiff.

sdiff

Команда sdiff сравнивает два файла, находящихся рядом, и показывает все их различия.