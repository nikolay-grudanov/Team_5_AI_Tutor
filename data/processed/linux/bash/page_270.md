---
source_image: page_270.png
page_number: 270
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 6.51
tokens: 7287
characters: 1313
timestamp: 2025-12-23T23:11:53.579285
finish_reason: stop
---

21 Инструмент: проверка конфигурации

Для системного администратора или специалиста по безопасности полезно иметь инструмент, который позволит проверить текущую конфигурацию системы, например существующие файлы, значения реестра или учетные записи пользователей. В дополнение к проверке конфигурации этот инструмент может использоваться в качестве облегченной системы обнаружения вторжений. Для этого следует сравнить запись базовой конфигурации с текущим состоянием системы и выявить изменения. Вы также можете использовать его для поиска конкретных данных, содержащихся в записях или файлах системного журнала, несущих угрозу для работы системы или сети (индикаторов компрометации).

В этой главе мы разработаем инструмент для чтения ряда конфигураций, хранящихся в текстовом файле. При этом нам нужно проверить, есть ли этот файл, заданы ли права на его чтение и существует ли данная конфигурация в системе. Этот инструмент предназначен для работы в операционной системе Windows, но его можно легко изменить для работы в Linux.

Реализация

Сценарий validateconfig.sh проверяет следующее:

☐ наличие или отсутствие файла;
☐ хеш SHA-1 файла;
☐ значение раздела реестра Windows;
☐ наличие или отсутствие пользователя или группы.

В табл. 21.1 показан синтаксис файла конфигурации, который будет считан сценарием.