---
source_image: page_121.png
page_number: 121
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 8.82
tokens: 7395
characters: 1529
timestamp: 2025-12-23T23:06:20.378370
finish_reason: stop
---

{
    local -i i raw maxraw scaled
    raw=$1
    maxraw=$2
    ((scaled=(MAXBAR*raw)/maxraw)) ③
    # гарантированный минимальный размер
    ((raw > 0 && scaled == 0)) && scaled=1 ④

    for((i=0; i<scaled; i++)) ; do printf '#' ; done
    printf '\n'

} # pr_bar

#
# "main"
#
declare -A RA
declare -i MAXBAR max
max=0
MAXBAR=50 # размер самой длинной строки

while read labl val
do
    let RA[$labl]=$val
    # сохранить наибольшее значение; для масштабирования
    (( val > max )) && max=$val
done

# масштабировать и вывести
for labl in "${!RA[@]}"
do
    printf '%-20.20s ' "$labl"
    pr_bar ${RA[$labl]} $max ⑧
done

① Мы определяем функцию, с помощью которой нарисуем один столбец гистограммы. Определение должно находиться перед самой функцией, поэтому имеет смысл поместить все определения функций в начале нашего сценария. Данная функция в будущем сценарии будет использована повторно, поэтому ее можно поместить в отдельный файл и подключать с помощью команды source. Но мы сделали по-другому.

② Мы объявляем все эти переменные локальными, так как не хотим, чтобы они мешали определению имен переменных в остальной части данного сценария (или любых других, если мы копируем/вставляем этот сценарий для использования в другом месте). Мы объявляем все эти переменные целыми числами (это параметр -i), потому что будем вычислять только целые значения и не станем использовать строки.

③ Вычисление выполняется в двойных скобках. Внутри них не нужно использовать символ $ для указания значения каждого имени переменной.