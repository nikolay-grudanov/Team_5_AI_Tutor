---
source_image: page_153.png
page_number: 153
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 9.78
tokens: 7497
characters: 1942
timestamp: 2025-12-23T23:07:36.193662
finish_reason: stop
---

./fd2.sh ${FILES[0]} ${FILES[1]} > $TMPFILE

if [[ -s $TMPFILE ]]   # не пустой
then
    echo "mailing today's port differences to $USER"
    mail -s "today's port differences" $USER < $TMPFILE
fi
# очистка
rm -f $TMPFILE

① При выполнении сценария scan.sh будут проверены все хосты, находящиеся в файле с именем hostlist. Поскольку сценарию scan.sh имя файла в качестве аргумента мы не предоставляем, это имя сценарий сгенерирует сам. При этом используется числовой формат «год-месяц-день».

② Проименованные файлы, выводимые из сценария scan.sh, по умолчанию будут отсортированы. Команда ls вернет эти файлы в порядке, определенном датами их создания. При этом не потребуется указывать команде ls какие-либо специальные параметры. Используя команду tail, мы получим два последних имени из данного списка. Чтобы облегчить разделение на две части, поместим имена в массив.

③ Создание с помощью команды tempfile временного имени файла — самый надежный способ убедиться, что файл не используется или не может быть записан.

④ С помощью параметра -s проверяется размер файла: если он больше нуля, значит, файл не пустой. Временный файл не будет пустым, если при сравнении его размера с размером файла fd2.sh обнаружится разница.

⑤ Для переменной $USER автоматически устанавливается идентификатор пользователя, однако, если адрес электронной почты отличается от идентификатора пользователя, в эту переменную может потребоваться поместить другое значение.

⑥ Существуют более надежные способы убедиться, что файл удален, независимо от того, где и когда сценарий будет завершен. Но это минимум, позволяющий предотвратить накопление рабочих файлов. Сценарии захвата, использующие встроенную команду trap, вы найдете далее.

В операционной системе Windows запуск сценария autoscan.sh с заданным интервалом можно настроить с помощью команды schtasks. Для запуска этого сценария в Linux с заданным интервалом следует воспользоваться командой crontab.