---
source_image: page_090.png
page_number: 90
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 9.94
tokens: 7518
characters: 2069
timestamp: 2025-12-23T23:05:04.485309
finish_reason: stop
---

не является обязательным, и вы можете удалить его, если хотите иметь возможность искать файлы конкретного типа. Имена найденных файлов передаются в цикл while, который будет читать их по одному в переменной FN.

10 Параметр -q команды egrep говорит о том, что эта команда работает незаметно и ничего не выводит. Нам не обязательно видеть, какая именно фраза найдена в данный момент, только ради того, чтобы знать, что она найдена.

11 Конструкция $? — это значение, возвращаемое предыдущей командой. Успешный результат означает, что egrep обнаружила предоставленный шаблон.

12 Здесь проверяется, имеет ли COPY значение. При отсутствии значения результатаом if будет false.

13 Параметр -r команды cp при копировании позволяет сохранить всю информацию о копируемом файле: имя владельца и временные метки файла. Эта информация может быть важной для вашего анализа.

Если вы ищете более легкое решение, но с меньшими возможностями, можете выполнить аналогичный поиск с помощью параметра exes команды find, как показано далее:

find / -type f -exec file '{}' \; | egrep 'PNG' | cut -d' ' -f1

Здесь мы отправляем каждый элемент, найденный командой find, в команду file, которая определит тип найденного файла. Далее вывод файла передается команде egrep, где происходит его фильтрация, в результате чего выполняется поиск ключевого слова PNG. Команда cut используется, чтобы очистить вывод и сделать его более удобным для чтения.

Будьте осторожны при использовании команды file в ненадежной системе. Команда использует файл магического шаблона, расположенный в /usr/share/misc/. Злоумышленник может изменить этот файл таким образом, что определенные типы файлов не будут идентифицированы. Лучше всего подключить подозрительный диск к компьютеру с надежной системой и провести поиск оттуда.

Поиск по хеш-значению

Криптографическая хеш-функция — это необратимая функция, которая преобразует входное сообщение произвольной длины в список сообщений фиксированной длины. К общим алгоритмам хеширования относятся MD5, SHA-1 и SHA-256. Рассмотрим два файла (примеры 5.5 и 5.6).