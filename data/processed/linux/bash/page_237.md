---
source_image: page_237.png
page_number: 237
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 8.27
tokens: 7370
characters: 1420
timestamp: 2025-12-23T23:10:42.754990
finish_reason: stop
---

Пользовательский инструмент удаленного доступа

Несмотря на эффективность однорядного бэкдора, вы можете создать инструмент с более гибкими настройками, используя полный сценарий bash. Ниже приведены требования к такому сценарию.

- Инструмент должен подключаться к указанному серверу и порту.
- Инструмент получит команду от сервера, выполнит ее в локальной системе и выведет все результаты обратно на сервер.
- Инструмент будет выполнять сценарии, отправленные ему с сервера.
- Инструмент закроет сетевое соединение, когда получит от сервера команду quit.

На рис. 16.3 показано взаимодействие между средствами удаленного доступа в системе злоумышленника (функция LocalRat.sh) и инструментом удаленного доступа в целевой системе (функция RemoteRat.sh).

![Логика инструмента удаленного доступа](../images/ch16_03.png)

Рис. 16.3. Логика инструмента удаленного доступа

Реализация. Этот инструмент состоит из двух сценариев. Сначала в собственной системе злоумышленника выполняется сценарий LocalRat.sh. Он прослушивает соединение, созданное вторым сценарием, RemoteRat.sh, выполняемым в целевой системе. Сценарий RemoteRat.sh через сокет TCP открывает соединение с локальной атакующей системой.

Что происходит дальше? Прослушиватель nc, запущенный в атакующей системе, получит от сокета соединение и предоставит удаленное управление атакующей системе. Вывод из оболочки bash, запущенной в скомпрометированной системе,