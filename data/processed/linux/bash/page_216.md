---
source_image: page_216.png
page_number: 216
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 9.94
tokens: 7518
characters: 1960
timestamp: 2025-12-23T23:09:59.315362
finish_reason: stop
---

1 Это зашифрованный внутренний сценарий, хранящийся в переменной encrypted. Причина, по которой ранее мы кодировали вывод OpenSSL в Base64, состоит в том, что он может быть включен в сценарий wrapper.sh. Если ваш зашифрованный сценарий очень большой, вы можете сохранить его в отдельном файле. Но в этом случае вам нужно будет загрузить в целевую систему два файла.

2 Здесь в переменную считывается ключ расшифровки. Чтобы пользовательский ввод не отображался на экране, используется параметр -s.

3 Данный конвейер команд передает в OpenSSL зашифрованный сценарий для расшифровки. Результат сохраняется в переменной innerScript.

4 С помощью команды eval начинается выполнение кода, сохраненного в переменной innerScript.

В самом начале выполнения программы пользователю будет предложено ввести ключ. Если он введет соответствующий ключ ( тот же ключ, который использовался при шифровании ), внутренний сценарий будет расшифрован и выполнен:

$ ./wrapper.sh

This is an encrypted script
running uname -a
MINGW64_NT-6.3 MySystem 2.9.0(0.318/5/3) 2017-10-05 15:05 x86_64 Msys

Шифрование имеет два существенных преимущества перед обфускацией синтаксиса и логики.

- Если используется хороший алгоритм шифрования и достаточно длинный ключ, этот способ шифрования математически безопасен, а зашифрованная информация практически не подвержена несанкционированному доступу. Методы обфускации синтаксиса и логики не обеспечивают полную защиту хранящейся или передаваемой информации и только заставляют аналитика тратить больше времени на анализ сценария.

- Тот, кто, не зная правильного ключа, попытается реконструировать внутренний сценарий, не сможет даже выполнить его.

Недостаток этого метода шифрования заключается в том, что выполняемый сценарий в незашифрованном виде сохраняется в оперативной памяти компьютера. Незашифрованный сценарий может быть извлечен из оперативной памяти компьютера с помощью соответствующих методов криминалистической экспертизы.