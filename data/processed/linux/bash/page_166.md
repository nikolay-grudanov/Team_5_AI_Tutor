---
source_image: page_166.png
page_number: 166
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 8.94
tokens: 7407
characters: 1749
timestamp: 2025-12-23T23:08:04.862162
finish_reason: stop
---

1 Этот тег определяет хост и относительный путь.

2 Данный тег идентифицирует новый файл, созданный после созания исходного базового файла.

3 Данный файл после создания базового файла был перемещен в новое место.

4 После создания базового файла содержимое файла изменилось.

5 После создания базового файла этот файл был удален.

Выводы

Создание базового файла и периодическая его проверка — это эффективный способ выявления подозрительного поведения в ваших системах. Это особенно полезно для систем, состояние которых редко изменяется.

В следующей главе мы подробнее разберем, как использовать командную строку и bash для анализа отдельных файлов, чтобы определить, являются ли они вредоносными.

Упражнения

1. Улучшите для baseline.sh пользовательский интерфейс, предотвратив случайную перезапись базового файла. Как? Если пользователь указывает только один файл, проверьте, существует ли этот файл. Если это так, спросите пользователя, можно ли перезаписать файл, и в зависимости от ответа выберите один из вариантов: продолжить или выйти.

2. Измените сценарий baseline.sh следующим образом: напишите функцию оболочки для преобразования записей в массиве DIR в абсолютные пути. Вызовите эту функцию непосредственно перед печатью XML, чтобы тег filesystem в атрибуте dir перечислял абсолютные пути.

3. Измените сценарий baseline.sh следующим образом: для тега relocated проверьте, находятся ли исходный и перемещенный файл в одном каталоге (то есть имеют одно и то же имя каталога); если это так, выведите только basename в атрибуте orig = "". Например, то, что печаталось так:
<relocated orig="./ProjectAA/farm.sh">./ProjectAA/farm2.sh</relocated>
будет выводиться таким образом:
<relocated orig="farm.sh">./ProjectAA/farm2.sh</relocated>