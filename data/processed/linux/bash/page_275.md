---
source_image: page_275.png
page_number: 275
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 10.60
tokens: 7471
characters: 1931
timestamp: 2025-12-23T23:12:09.939608
finish_reason: stop
---

4 Здесь для переключения используется удобочитаемый, но более громоздкий оператор if.

5 После запуска команды sha1sum вывод будет сохранен в переменной x. Вывод состоит из двух «слов»: хеш-значения и имени файла.

6 Чтобы проверить, совпадают ли значения хеш-функции, нам нужно из вывода команды sha1sum удалить имя файла и второе слово. %% означает самое длинное возможное совпадение.

7 Команда type проинформирует нас о существовании команды net; если команда net не будет найдена, вместо нее используем команду id.

8 Напоминание: эта строка принимает подстроку cmd, начинающуюся в позиции 0 и принимающую только один символ; то есть это первый символ подстроки cmd. Это восклицательный знак? Данный символ часто используется в программировании для обозначения «нет».

9 Нам нужно удалить символ восклицательного знака из названия команды.

10 Как уже было сказано в комментарии, так вызывается наша функция vhash, аргумент делится на две части — первое слово и остаток.

11 Оператор case в bash в отдельных случаях позволяет сопоставлять шаблоны между собой. Общим шаблоном является звездочка, соответствующая любой строке, она применяется как крайний вариант, чтобы выполнить действие по умолчанию. Он будет использоваться, если остальные шаблоны не будут найдены. Если входные данные не соответствуют ни одному из вариантов, значит, это неправильные входные данные. В этом случае для окончания работы мы вызываем функцию errexit.

Выводы

Сценарий validateconfig.sh позволяет проверить, существует ли в системе определенная конфигурация. Это полезно для проверки соответствия, а также для понимания того, есть ли в системе вредоносные программы или следы вторжения. Следы вторжения или наличие вредоносных программ выявляются в процессе поиска конкретных индикаторов компрометации.

YARA является отличным источником индикаторов компрометации на основе хоста. Чтобы узнать больше, посетите сайт YARA: http://bit.ly/2FEsDPx.