---
source_image: page_118.png
page_number: 118
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.48
tokens: 6316
characters: 1763
timestamp: 2025-12-24T10:05:02.490312
finish_reason: stop
---

**Глава 3. Событийно-ориентированная архитектура**

**Нет отброшенных событий**

![Коммутатор событий для непрерывной обработки событий](https://i.imgur.com/3Q5z5QG.png)

Рис. 3.3. Коммутатор событий для непрерывной обработки событий

Коммутатор событий гарантирует, что никакие события не будут отброшены и что ни одно из них не будет отправлено старому слушателю. Как говорится, лучше один раз увидеть, чем сто раз услышать, поэтому посмотрите на рис. 3.3. На этом рисунке время идет сверху вниз. Модуль слева регистрируется для прослушки одноадресного события, и события стали поступать к нему. Чуть позже регистрируется новый модуль (справа) для прослушки того же одноадресного события. В результате этого первый модуль получает событие done, теперь все новые запросы будут отправлены модулю справа, в то время как модуль слева закончит обработку полученных событий и закончит работу. Новый модуль продолжит обработку запросов событий, пока какой-либо еще другой модуль не уведомит коммутатор, что теперь он должен быть ответственным за обработку этого одноадресного события.

**Широковещательные события**

Безопасное закрытие широковещательных слушателей происходит аналогичным образом. Однако слушатель события самостоятельно передает широковещательное событие eventClient:done, чтобы сообщить остальным слушателям указанного события, что они должны закрыться. У коммутатора событий же достаточно «мозгов», чтобы передать это событие всем слушателям, кроме того, кто его отправил. Слушатель, получивший данное событие, больше не будет получать определенные события. После обработки оставшихся событий слушатели могут безопасно завершить работу:

eventHub.on('eventClient:done', function(event) {
    console.log('Мне больше не нужно прослушивать событие: '