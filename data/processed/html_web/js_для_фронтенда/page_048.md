---
source_image: page_048.png
page_number: 48
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.36
tokens: 6324
characters: 1772
timestamp: 2025-12-24T10:03:31.971940
finish_reason: stop
---

Данный код можно переписать следующим образом с использованием таблицы поиска:

function doSomething(a) {
    var lookup = { x: doX, y: doY }, def = doZ;
    lookup[a] ? lookup[a]() : def();
}

Заметьте, что, проведя рефакторинг условного выражения в таблицу поиска, мы не сократили цикломатическую сложность (а значит, не сократили и число необходимых модульных тестов и не упростили сопровождение). Методы с высокой цикломатической сложностью лучше разбивать на несколько меньших методов. После чего у вас будет несколько функций с более низкой цикломатической сложностью, а такие функции значительно более удобны в сопровождении.

Добавление проверки цикломатической сложности в ваш процесс сборки осуществляется довольно просто. Просто посмотрите на ваш код и примите соответствующие меры. Для существующего ранее проекта разбейте сначала самые сложные методы и объекты, но ни в коем случае не делайте это перед написанием модульных тестов, только после — сначала должны быть готовы модульные тесты!

Правило номер один рефактлинга — «не причини вреда», но вы не можете быть уверены, что следуете этому правилу, пока у вас не будет модульных тестов, чтобы проверить версии «до» и «после» изменений вашего кода.

Очень полезна для вычисления цикломатической сложности каждой вашей функции и каждого вашего метода утилита jscheckstyle (https://github.com/nomiddlename/jscheckstyle). В главе 8 мы интегрируем ее с утилитой Jenkins, чтобы автоматически отмечать код, который может быть чрезмерно сложным и готовым к рефакторингу. Сейчас же рассмотрим утилиту саму по себе.

Следующая команда устанавливает пакет jscheckstyle:

% sudo npm install jscheckstyle -g

Теперь запустим эту утилиту для проверки JavaScript-файла:

findresult-lm:- trostler$ jscheckstyle firefox.js