---
source_image: page_073.png
page_number: 73
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 22.18
tokens: 6252
characters: 1644
timestamp: 2025-12-24T10:04:00.113522
finish_reason: stop
---

Фабрики позволяют нам инстанцировать объекты ниже по стеку вызовов, эти объекты получаются все еще связанными, но связь эта значительно слабее. Вместо явной зависимости от фактического объекта у нас теперь есть только зависимость от фабрики. У фабрики есть зависимости от объектов, которые она создает; однако для тестирования мы представляем фабрику, которая создает мок-объекты (объекты-имитаторы) или заглушки, а не реальные объекты. Таким образом, мы приходим к выводу, что нам нужны абстрактные фабрики.

Давайте начнем с обычной фабрики:

var TableClothFactory = {
    getTableCloth: function(color) {
        return Object.create(TableCloth,
            { color: { value: color }});
    }
};

Я параметризовал цвет скатерти в списке параметров нашей фабрики, чтобы получить новый экземпляр, который зеркально отражает список параметров конструктора. Использование этой фабрики довольно просто:

var tc = TableClothFactory.getTableCloth('purple');

Для тестирования нам не нужен реальный объект TableCloth. При желании протестировать наш код изолированно мы вместо реального объекта используем имитацию или заглушку:

var TableClothTestFactory = {
    getTableCloth: function(color) {
        return Y.Mock(); // или что-то еще
    }
};

Здесь я использую фреймворк YUI, который будет подробно рассмотрен в главе 4. Код фабрики для получения сымитированной версии объекта TableCloth таков:

var tc = TableClothTestFactory.getTableCloth('purple');

Теперь, вот если бы только был некоторый способ согласовать вышеприведенные две фабрики так, чтобы наш код всегда правильно работал... Конечно, такой способ есть: все, что мы должны сделать,