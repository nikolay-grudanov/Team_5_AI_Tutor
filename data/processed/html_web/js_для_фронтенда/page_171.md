---
source_image: page_171.png
page_number: 171
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 21.72
tokens: 6195
characters: 1402
timestamp: 2025-12-24T10:06:00.781369
finish_reason: stop
---

ся для одних акций, а HTTP — для других? Гибкость, предоставляемая инъекциями (injection) в таких случаях, будет очень к месту и отлично подойдет в данной ситуации.

Написание теста для максимального покрытия кода — почти всегда тривиальный процесс. Первым делом нам нужно заглушить объект http:

/**
 * Простая заглушка для объекта HTTP
 */
var events = require('events').EventEmitter
    , util = require('util')
    , myhttp = function() { // Макет объекта 'http'
        var _this = this;
        events.call(this);
        this.get = function(options, cb) {
            cb(_this);
            return _this;
        };
    }
    ;
util.inherits(myhttp, events);

Важно понять, что мы не тестируем модуль http, предоставленный Node.js. Да, в нем могут быть ошибки, но мы не пытаемся найти их. Нам нужно протестировать только код нашей функции, а не какой-либо внешний объект, независимо от того, кто его написал. Интеграционные тесты найдут любые ошибки взаимодействия между нашим кодом и его зависимостями.

После того, как мы заглушим объект http, можно приступать к тестированию. Далее показано, как мы можем использовать асинхронные методы тестирования YUI Tests (я опускаю шаблонное содержимое тестового кода для ясности):

testPrice: function() {
    var symbol = 'YHOO'
        , stockPrice = 50   // Принятие желаемого за действительное??
        , _this = this
        , http = new myhttp()