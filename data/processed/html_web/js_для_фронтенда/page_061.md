---
source_image: page_061.png
page_number: 61
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.47
tokens: 6332
characters: 1832
timestamp: 2025-12-24T10:03:52.046529
finish_reason: stop
---

this.addMatchers({
    toBeYummy: function(expected) {
        return this.actual.attr.isCooked
            && this.actual.attr.isMixed;
    }
});
var ingredients = new Ingredients('петрушка', 'соль')
    , dinner = makeChickenDinner(ingredients)
    ;
expect(dinner).toBeYummy();
});
});

Столь много всего! И что мы фактически здесь тестируем? Мы должны имитировать все ссылающиеся объекты и все объекты, на которые ссылаются ссылающиеся объекты, а также создаем новый объект Ingredients для выполнения метода makeChickenDinner, который тогда инстанцирует и использует наши сымитированные иерархии объектов. Имитация и замена всех объектов — сложная работа, особенно учитывая, что нам нужно протестировать всего один метод. Давайте осуществим рефакторинг и сделаем код хорошим: поддерживаемым и тестируемым.

Итак, исходная функция нуждается в пяти объектах — ChickenBreast, ConventionalOven, Mixer, FDegrees и Timer, число 5 для значения разветвления на выходе вполне нормально. Однако, связанность всех этих объектов очень высока. Связанность и разветвление на выходе обычно идет рука об руку, но не всегда. Мы можем уменьшить связанность с помощью инъекции или обработки событий, а обработку на выходе можем уменьшить, используя шаблон проектирования «Фасад» (facade)7, которым мы охватим сразу несколько объектов (в дальнейшем, имея в виду конструкцию, созданную на основе шаблона «Фасад», мы будем просто говорить фасад). Подробнее обо всем этом мы поговорим в следующей главе, а сейчас вернемся к примеру.

Сперва мы можем создать фасад, представляющий "духовку" (oven). Создав "духовку", нам нужно установить ее "температуру"

7 Фасад — структурный шаблон проектирования, позволяющий скрыть сложность системы путем сведения всех возможных внешних вызовов к одному объекту, делегирующему их соответствующим объектам системы.