---
source_image: page_080.png
page_number: 80
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.95
tokens: 7501
characters: 2157
timestamp: 2025-12-24T09:55:43.327560
finish_reason: stop
---

7.7 Как работают массивы

два элемента. Ожидается, что она возвратит отрицательное число, если первый элемент должен быть первым, положительное число, если первым должен быть второй элемент, и нуль, если функции сравнения будет нечего сказать.

Эта функция способна правильно отсортировать числовой массив, если, конечно, все элементы будут конечными числами:

    function compare(first, second) {
        return first - second;
    }

Если нужно сравнивать неконечные числа вроде NaN и Infinity, функции сравнения придется поработать интенсивнее.

Следующим в списке проблем, связанных с функцией sort, станет дефицит стабильности. Функция sort стабильна, если порядок равных сравниваемых элементов (для которых функция сравнения возвратила нуль) остается неизменным. JavaScript не гарантирует стабильности. При сортировке массива строк или массива чисел это неактуально, а вот при сортировке массива объектов и массива массивов становится серьезной проблемой. Сложная сортировка может потребовать сортировки по фамилиям, а при их совпадении — по именам. Один из способов решения задачи — предварительная сортировка по именам, а затем повторная — по фамилиям. Но этот прием не работает, поскольку сортировка нестабильна и информация, добавленная в ходе сортировки по именам, может быть утрачена.

Уменьшить нестабильность реально за счет применения более сложной функции сравнения. Чтобы упростить задачу, создадим фабрику по производству функций сравнения:

    function refine(collection, path) {

Она получает массив или объект и путь в форме массива строк и возвращает значение в конце пути. Если значения нет, возвращается неопределенность.

    return path.reduce(
        function (refinement, element) {
            try {
                return refinement[element];
            } catch (ignore) {}
        },
        collection
    );
}

    function by(...keys) {

Эта фабрика создает функцию сравнения, чтобы помочь в сортировке массива объектов или массива массивов. Аргументами служат одна или несколько строк или целых чисел, определяющих сравниваемые свойства или элементы. Если первый аргумент видит связь, пробуется второй, затем третий...