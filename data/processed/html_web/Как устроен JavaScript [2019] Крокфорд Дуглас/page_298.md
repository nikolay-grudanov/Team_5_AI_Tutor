---
source_image: page_298.png
page_number: 298
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 14.03
tokens: 7387
characters: 1579
timestamp: 2025-12-24T10:01:15.322699
finish_reason: stop
---

Глава 31

Как устроена эта книга

Я прошу одного — свободы. Свободны же бабочки.
Гарольд Скимпол (Harold Skimpole)

Функция include

Чтобы было проще собрать книгу, я создал событийную функцию include. И воспользовался этой функцией, чтобы собрать отдельные файлы глав в один большой файл книги, а также для вставки исполняемого исходного кода JavaScript в главы. Кроме того, она применялась для сбора фрагментов кода JavaScript в файлы с расширением .js, которые можно найти по адресу github.com/douglascrockford.

include(обратный_вызов, строка, получение_включения, максимальная_глубина)

Функция include заменяет выражения @include в строке другими строками. Если выражений @include нет, возвращается исходная строка.

Ваша функция обратный_вызов(результат) выдает в итоге получившуюся в результате обработки строку результат.

Ваша строка может содержать ноль и более выражений @include.

@include "ключ"

Между @include и открывающей двойной кавычкой ("") ставится пробел. Каждое выражение @include заменяется, если это возможно, строкой включения, связанной с ключом. Ключ, которым может быть имя файла, заключается в круглые скобки.

Функция получение_включения(обратный_вызов, ключ) принимает строковое значение ключ и в итоге передает получившуюся строку включения функции обратный_вызов(включение). Функция получение_включения способна обращаться к файловой системе, базе данных, системе контроля версий, контент-менеджеру или объекту JSON. Если включения поступают из файлов и средой является Node.js, то функция получение_включения может выглядеть следующим образом: