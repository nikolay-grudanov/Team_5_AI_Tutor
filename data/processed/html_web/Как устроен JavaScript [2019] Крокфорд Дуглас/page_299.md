---
source_image: page_299.png
page_number: 299
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 14.04
tokens: 7422
characters: 1759
timestamp: 2025-12-24T10:01:15.700469
finish_reason: stop
---

function my_little_get_inclusion(callback, key) {
    return (
        (key[0] >= "a" && key[0] <= "z")
        ? fs.readFile(key, "utf8", function (ignore, data) {
            return callback(data);
        })
        : callback()
    );
}

Если каким-то образом пакет включения станет неконтролируемым (этим грешат управляемые пакеты), он не сможет причинить с помощью my_little_get_inclusion значительный ущерб, но смог бы нанести огромный вред, если бы имел прямой доступ к файловой системе.

Строка включения может содержать дополнительные выражения @include. Аргумент максимальная_глубина ограничивает глубину рекурсии, чтобы предотвратить бесконечные циклы включения.

Рассмотрим реализацию:

const rx_include = /
    @include \u0020 " ( [^ " @ ]+ ) "
/;

// Перехватываемые группы:
// [0] все выражение '@include'
// [1] Ключ

export default Object.freeze(function include(
    callback,
    string,
    get_inclusion,
    max_depth = 4
) {

Функция include не нуждается в непосредственном допуске к файловой системе или сведениях о ней, то же самое касается базы данных или чего-либо еще, поскольку эта возможность передана ей в качестве функции получение_включения. Благодаря этому функция include становится универсальной и заслуживающей доверия.

Ничто не возвращается. Результат в итоге сообщается через обратный_вызов.

let object_of_matching;
let result = "";

Всю работу делают функция minion (ближайшее окружение) и ее помощники. Основная функция minion ищет выражения @include и вызывает функцию получение_включения в том, что было найдено. Вспомогательная функция assistant_minion выполняет рекурсивный вызов include для обработки включения. Функция junior_assistant_minion добавляет обработанные включения в результат.

function minion() {