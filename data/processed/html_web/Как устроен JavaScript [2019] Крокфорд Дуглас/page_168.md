---
source_image: page_168.png
page_number: 168
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.77
tokens: 7547
characters: 2220
timestamp: 2025-12-24T09:58:10.938411
finish_reason: stop
---

20.9 Как работает событийное программирование

альтернативным (fallback) или состязательным (race). Каждая фабрика возвращает новый запросчик. В результате запросчики легко поддаются компоновке.

Библиотека Parseq может решать проблемы истечения лимита времени. Допустим, некая работа должна быть завершена за 100 мс. Если срок истечет, ее нужно будет считать неудавшейся и перейти к альтернативному ответу. Это и есть то, что очень трудно сделать, используя любую из рассмотренных ранее трех ошибок. Применяя Parseq, вам останется всего лишь указать лимит времени в миллисекундах.

parseq.sequence(
    массив_запросчиков,
    миллисекунды
)

Фабрика sequence принимает массив функций-запросчиков и необязательный лимит времени, а возвращает запросчик, вызывающий каждый запросчик, имеющийся в массиве. Значение, переданное новому запросчику, передается нулевому запросчику в массиве. Получаемое значение передается первому запросчику. Таким образом, значения передаются от запросчика к запросчику. Результат последнего запросчика и есть результат последовательности.

parseq.parallel(
    обязательный_массив,
    необязательный_массив,
    миллисекунды,
    параметр_времени,
    регулятор
)

Фабрика parallel запускает все свои запросчики одновременно. Она не добавляет параллелизм в JavaScript, зато разрешает JavaScript использовать природный параллелизм Вселенной. Тем самым допускается распределение вычислительной нагрузки среди многих серверов. Это может дать огромное преимущество в производительности. Если мы обрабатываем все запросчики параллельно, то затрачиваемое время — это время выполнения работы самым медленным запросчиком, а не общее время работы всех запросчиков. Это весьма важная оптимизация.

Фабрику parallel следует задействовать только в том случае, если у запросчиков нет взаимозависимости. Всем запросчикам дается одно и то же значение. Результатом становится массив, содержащий результаты всех запросчиков. Этим созданный запросчик напоминает метод массива map.

Фабрика parallel способна принимать два массива запросчиков. В первом из них содержатся обязательные запросчики. Для успешного завершения параллельной операции все обязательные запросчики должны успешно завершить свою работу.