---
source_image: page_224.png
page_number: 224
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.25
tokens: 7427
characters: 1691
timestamp: 2025-12-24T09:59:41.980812
finish_reason: stop
---

23.23        Как работает тестирование

});
});
});

Ecomcon

Если у файла имеются сильные зависимости от другого кода, я хочу поместить тесты этих отношений в тот же файл. Единственный способ определить, что модуль А хорошо работает с модулями В и С, — это запустить их вместе в едином контексте.

Я разработал простой инструмент включения условных комментариев под названием ecomcon (Enable Comments Conditionally). Я могу поместить тестирование и регистрацию в исходный код в виде снабжённых тегами комментариев:

// Код тега

Тегом способно стать любое слово, например test. За ним может следовать код JavaScript. В обычной обстановке роль этих комментариев не меняется и они игнорируются. При минификации — удаляются. Функция ecomcon может их включить, удалив двойной слеш (//) и тег и оставив код JavaScript, который теперь может быть выполнен.

Можно создать особый вариант с массой проверок в ходе выполнения программы, а также с регистрационными записями и анализом. Будет разрешен доступ к переменным, которые обычно скрыты в областях видимости функций. Можно будет отслеживать значения по мере того, как они принимаются и сбрасываются. А еще тестировать целостность программы, убеждаясь, что особо важные ресурсы не повреждены.

Комментарии могут задействоваться также в качестве документации, поскольку в них показываются внутренние особенности файла и приводятся примеры его операций.

function ecomcon(исходная_строка, массив_тегов)

Массив_тегов содержит строки, разрешенные к использованию в качестве тегов.

В функции ecomcon нет ничего сложного:

const rx_crlf = /
    \n
|
    \r \n?
/;

const rx_ecomcon = /
    ^/
    \/
    ( [ a-z A-Z 0-9 _ ]+ )
    \u0020?
    ( .* )