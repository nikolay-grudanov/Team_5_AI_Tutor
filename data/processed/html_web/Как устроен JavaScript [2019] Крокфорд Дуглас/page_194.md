---
source_image: page_194.png
page_number: 194
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.76
tokens: 7463
characters: 2164
timestamp: 2025-12-24T09:58:45.917079
finish_reason: stop
---

22.8 Как работает JSON

К примеру, если нужно автоматически превратить Date-объекты в ISO-строки, можно предоставить функцию заменитель. Результат работы функции заменитель передается функции JSON.stringify и включается в текст.

const json_text = JSON.stringify(my_little_object, function (key, value) {
    return (
        value instanceof Date
            ? value.toISOString()
            : value
    );
});

(Получается, что нам этого не нужно делать, поскольку все это выполняется автоматически методом Date.prototype.toJSON. См. далее описание метода toJSON.)

Аргумент заменитель может быть также массивом строк. В текст включаются только те свойства, имена которых есть в массиве. Это белый список, с помощью которого отфильтровываются неинтересные на данный момент свойства. Этот массив может быть и отдельным аргументом, не перезагружающим функцию заменитель.

Формат JSON допускает применение в тексте JSON пробельных символов, облегчающих его чтение человеком. По умолчанию JSON.stringify не добавляет пробельные символы, чтобы текст был компактнее для передачи. Если используется параметр пробел, применяется перевод строки и вставляются отступы. Корректным значением для параметра пробел будет число 4. И это вполне очевидно. Мне нужно было сделать это значение булевым.

toJSON()

Любой объект может иметь метод toJSON, вызываемый методом JSON.stringify, когда объект получает строковое представление. В результате JSON-представление могут иметь свободные от классов объекты. Подобный объект, содержащий только функции, получает строковое представление как пустой объект. Но если у него есть метод toJSON, то объект преобразуется в строку, как и возвращаемое значение метода toJSON.

Объекты Date наследуют метод toJSON, который кодирует объекты данных в виде строк ISO.

Последствия для безопасности

Первые пользователи JSON применяли для декодирования текста JSON JavaScript-функцию eval или ее эквивалент. Этой функции присущи определенные риски безопасности, но в данном случае потенциально опасный текст поступал с того самого сервера, который предоставлял HTML и все сценарии, поэтому его безопасность была не хуже, чем в Интернете в целом.