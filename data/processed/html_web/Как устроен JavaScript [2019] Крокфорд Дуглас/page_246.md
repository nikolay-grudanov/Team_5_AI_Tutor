---
source_image: page_246.png
page_number: 246
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.42
tokens: 7377
characters: 1507
timestamp: 2025-12-24T10:00:17.806760
finish_reason: stop
---

Глава 27

Как работает парсер

Некоторые полагали, что нам не хватает языка программирования для описания вашего идеального мира. Но я верю, что как вид люди определяют свою реальность через муки и страдания.

Агент Смит

При парсинге поток объектов-лексем сплетается в дерево. В ходе парсинга выполняется также поиск ошибок в источнике. Объекты-лексемы дополняются новыми свойствами. Наиболее важные свойства — zeroth, wunth и twoth. Они задают древовидную структуру. Например, два операнда сложения хранятся в свойствах zeroth и wunth лексемы +. Лексема if хранит выражение условия в zeroth, элемент then хранится в wunth, а элемент else — в twoth. Будут встречаться и другие свойства. Рассмотрим их в ходе изучения главы.

Отчет об ошибках создается с помощью функции error. Можно было бы сохранить список ошибок и продолжить, но я хочу остановиться после первой ошибки. Находясь в режиме разработки, я хочу, чтобы ошибка переместила курсор редактора к следующему проблемному месту. А в режиме сборки я не ищу список, а смотрю, прошла сборка или нет.

let the_error;

function error(zeroth, wunth) {
    the_error = {
        id: "(error)",
        zeroth,
        wunth
    };
    throw "fail";
}

В объекте primordial (фундаментальный объект) содержатся объекты, встроенные в язык. В их числе такие константы, как true, и такие функции, как neg. Объект primordial создан с помощью Object.create(null), потому что я не хочу засорять объект цепочкой прототипов. К примеру, Object.prototype содержит метод