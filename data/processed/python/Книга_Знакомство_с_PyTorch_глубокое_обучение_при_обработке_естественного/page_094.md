---
source_image: page_094.png
page_number: 94
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.14
tokens: 7739
characters: 2577
timestamp: 2025-12-24T02:23:46.239484
finish_reason: stop
---

процедуру обучения. Она очень напоминает уже виденную вами в подразделе «Процедура обучения» на с. 114, так что для краткости мы не станем рассматривать ее так подробно, как там. Мы очень рекомендуем вам вернуться к этому подразделу за дополнительными пояснениями.

Завершается этот пример оценкой модели на контрольной порции набора данных и описанием процедуры вывода для новой фамилии. В многоклассовых предсказаниях хорошо то, что можно получить не только наиболее вероятное предсказание, и мы дополнительно обсудим, как вывести \( k \) наиболее вероятных предсказаний для новой фамилии.

Набор данных фамилий

В этом примере мы воспользуемся набором данных фамилий, состоящим из 10 000 фамилий людей 18 разных национальностей, собранных авторами из различных источников в Интернете. Этот набор данных будет использоваться в нескольких примерах в книге. Он обладает несколькими интересными свойствами. Первое из них — относительная несбалансированность. Три наиболее многочисленных класса охватывают более 60 % данных: 27 % английских, 21 % русских и 14 % арабских. Частота оставшихся 15 национальностей убывает — свойство, присущее и языкам. Второе свойство — достоверная и интуитивно понятная связь между национальностью и написанием фамилии. Многие особенности написания фамилий сильно связаны со страной происхождения (например, O’Neill (О’Нил), Antonopoulos (Антонопулос), Nagasawa (Нагасава) или Zhu (Чжу)).

Начнем создание итогового набора данных с несколько менее обработанной версии, чем та, что предложена в прилагаемых к книге материалах, и произведем несколько операций модификации набора данных. Первая нацелена на исправление дисбаланса — в исходном наборе данных было более 70 % русских фамилий, возможно, из-за систематической ошибки выборки или большого числа неповторяющихся русских фамилий. Для этого выполним прореживание этого слишком широко представленного класса, выбрав случайным образом подмножество фамилий из числа помеченных как русские. Далее группируем набор данных по национальностям и разбиваем его на три фрагмента: 70 % отводим на обучающий набор данных, 15 % на проверочный и 15 % на контрольный, чтобы распределения меток классов между фрагментами были сравнимыми.

Реализация SurnameDataset практически идентична классу ReviewDataset, показанному в разделе «Пример: классификация тональностей обзоров ресторанов» на с. 76, с единственными небольшими отличиями в реализации метода __getitem__()¹. Напомним, что представленные в книге классы наборов данных

¹ Изменены также некоторые имена переменных, чтобы отразить их роль/содержимое.