---
source_image: page_115.png
page_number: 115
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.26
tokens: 7687
characters: 2303
timestamp: 2025-12-24T02:24:18.069298
finish_reason: stop
---

здесь свертываются в один. Таким образом, NiN (свертка 1 × 1) представляет собой малозатратный способ подключения дополнительных нелинейностей с небольшим количеством параметров (см. статью Лина и др. [Lin et al., 2013]).

Остаточные связи/остаточный блок

Одна из важнейших тенденций в сверточных нейронных сетях, делающая возможными по-настоящему глубокие сети (более 100 слоев), — остаточная связь, называемая также связью с пропуском слоя (skip-layer connection). Если обозначить функцию свертки как conv, то на выходе остаточного слоя получим¹:

выходные данные = conv(входные данные) + входные данные.

Эта операция, впрочем, отличается неприметной уловкой, которую мы продемонстрируем на рис. 4.15. Для добавления входных данных к выходным данным свертки их формы должны совпадать. Для этого перед сверткой обычно выполняют дополнение нулями. На рис. 4.15 производится дополнение нулями матрицы размером 1 для свертки размером 3. Больше об остаточных связях вы можете узнать из статьи-первоисточника (Хи и др. [He et al., 2016]). Пример использования остаточных сетей в NLP можно найти в статье Хуанга и Ванга (Huang, Wang, 2017).

![Схема остаточной связи](../images/chapter_4/fig_4_15.png)

К входной матрице применяется сверточный слой с целью создания матрицы того же размера
К выходу сверточного слоя прибавляется входная матрица

Рис. 4.15. Остаточная связь — метод прибавления исходной матрицы к выходному результату свертки. Выше это проиллюстрировано наглядно, на применении к входной матрице сверточного слоя и прибавлении к ней же результата. Для получения выходных данных того же размера, что и входные, часто задают следующие значения гиперпараметров: kernel_size=3 и padding=1. Вообще говоря, любое нечетное значение гиперпараметра kernel_size при padding=(floor(kernel_size)/2 – 1) приведет к выходным данным того же размера, что и входные. Наглядную иллюстрацию дополнения нулями при свертке можно найти на рис. 4.11. Получаемая от сверточного слоя матрица прибавляется к входным данным, а итоговый результат представляет собой результат вычислений остаточной связи (этот рисунок основан на рисунке 2 из статьи Хи и др. (He et al., 2016))

¹ В данном случае под входными данными имеются в виду входные данные остаточного блока, а не обязательно входные данные всей нейронной сети.