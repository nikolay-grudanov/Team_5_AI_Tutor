---
source_image: page_106.png
page_number: 106
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.33
tokens: 7730
characters: 2654
timestamp: 2025-12-24T02:24:11.437760
finish_reason: stop
---

Классические варианты свертки¹ ориентированы на указание значений ядра², CNN ориентированы на задание значений гиперпараметров, определяющих поведение CNN, с последующим поиском оптимальных параметров для заданного набора данных методом градиентного спуска. Два основных гиперпараметра определяют форму свертки (kernel_size) и позиции (шаг свертки. — Примеч. пер.) во входном тензоре данных, которые свертка будет перемножать (stride). Есть и дополнительные гиперпараметры для управления степенью дополнения входного тензора данных нулями (padding) и дистанция между умножаемыми ячейками при применении к входному тензору данных (dilation). В следующих подразделах мы расскажем, как лучше чувствовать эти гиперпараметры.

Размерность операции свертки

Первое понятие, с которым нам нужно разобраться, — размерность (dimensionality) операции свертки. На рис. 4.6 и остальных рисунках этого подраздела используется двумерная свертка, но бывают свертки и других размерностей, более подходящие к данным определенных видов. Во фреймворке PyTorch свертки могут быть одномерными, двумерными и трехмерными (реализуются модулями Conv1d, Conv2d и Conv3d соответственно). Одномерная свертка удобна для работы с временными рядами, в которых каждому шагу по времени соответствует вектор признаков. В подобной ситуации можно обучаться паттернам в пространственном измерении последовательности. Большинство операций свертки в NLP одномерные. Двумерная свертка, с другой стороны, предназначена для улавливания пространственно-временных паттернов по двум направлениям в данных, например в изображениях — по осям высоты и ширины, вследствие чего двумерные свертки так часто применяются для обработки изображений. Аналогично в трехмерных свертках улавливаются пространственно-временные паттерны по трем направлениям в данных. Например, в видеоаннотация информация является трехмерной (два измерения отражают кадр изображения, а измерение времени отражает последовательность кадров). В этой книге мы в основном будем использовать Conv1d.

Каналы

Неофициально канал (channel) — одно из измерений пространства признаков по точкам входных данных. Например, в изображениях каждому пикселу соответствует три канала (по одному для каждого из компонентов RGB). Это понятие в контексте свертки можно перенести и на текстовые данные. Фактически, если

¹ См. дополнительную информацию о классических вариантах сверток во врезке «Исторический контекст» на с. 121.
² Подобным образом работает множество фильтров в программах редактирования изображений наподобие Photoshop. Например, для подсветки границ можно воспользоваться специально разработанным для этой цели сверточным фильтром.