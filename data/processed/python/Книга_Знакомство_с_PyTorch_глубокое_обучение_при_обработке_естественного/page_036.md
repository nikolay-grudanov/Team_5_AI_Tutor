---
source_image: page_036.png
page_number: 36
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.94
tokens: 7591
characters: 2156
timestamp: 2025-12-24T02:22:08.191651
finish_reason: stop
---

например, при работе с метриками мониторинга вычислений, не включенными в граф вычислений. При работе с двумя объектами-тензорами убедитесь, что они располагаются на одном устройстве.

Пример 1.17. Совместное использование CUDA- и CPU-тензоров

<table>
  <tr>
    <th>Input[0]</th>
    <td>y = torch.rand(3, 3)<br>x + y</td>
  </tr>
  <tr>
    <th>Output[0]</th>
    <td>
      <pre>
        ---------------------------------------------------------------------------
        RuntimeError                              Traceback (most recent call last)
        1 y = torch.rand(3, 3)
        ----&gt; 2 x + y
        RuntimeError: Expected object of type torch.cuda.FloatTensor but found type torch.FloatTensor for argument #3 'other'
      </pre>
    </td>
  </tr>
  <tr>
    <th>Input[1]</th>
    <td>cpu_device = torch.device("cpu")<br>y = y.to(cpu_device)<br>x = x.to(cpu_device)<br>x + y</td>
  </tr>
  <tr>
    <th>Output[1]</th>
    <td>tensor([[ 0.7159,  1.0685,  1.3509],
             [ 0.3912,  0.2838,  1.3202],
             [ 0.2967,  0.0420,  0.6559]])</td>
  </tr>
</table>

Помните, что перемещение данных из/в GPU — процесс весьма ресурсозатратный. Следовательно, обычно выполняется множество допускающих распараллеливание вычислений на GPU, а обратно в CPU перемещается только итоговый результат. Благодаря этому можно полностью задействовать возможности имеющихся GPU. Если у вас в системе есть несколько видимых для CUDA устройств (то есть несколько GPU), разумнее всего будет воспользоваться при выполнении программы переменной среды CUDA_VISIBLE_DEVICES, как показано здесь:

CUDA_VISIBLE_DEVICES=0,1,2,3 python main.py

Мы не станем обсуждать в этой книге параллелизм и обучение на нескольких GPU, но они очень важны для экспериментов по масштабированию (scaling) и иногда даже при обучении больших моделей. Рекомендуем вам заглянуть в документацию PyTorch и на дискуссионные форумы за дополнительной информацией по этому вопросу.

Упражнения

Решение задач — лучший способ разобраться в чем-либо. Вот несколько разминочных упражнений. Большинство из этих задач требует обращения к официальной документации и поиска подходящих функций.