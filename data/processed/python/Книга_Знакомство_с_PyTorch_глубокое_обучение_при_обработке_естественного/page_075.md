---
source_image: page_075.png
page_number: 75
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.42
tokens: 7585
characters: 2392
timestamp: 2025-12-24T02:23:15.655730
finish_reason: stop
---

# Гиперпараметры модели отсутствуют
# Гиперпараметры обучения
batch_size=128,
early_stopping_criteria=5,
learning_rate=0.001,
num_epochs=100,
seed=1337,
# Настройки времени выполнения не приводятся для экономии места
)

В оставшейся части подраздела мы опишем состояние обучения (training state). Оно будет представлять собой небольшой словарь, с помощью которого мы станем отслеживать информацию о процессе обучения. Этот словарь будет расти по мере увеличения количества отслеживаемых вами нюансов процедуры обучения, и при необходимости вы можете его систематизировать. Представленный в нашем следующем примере словарь содержит лишь основную информацию, отслеживаемую при обучении модели. После описания состояния обучения мы вкратце опишем набор объектов, которые необходимо создать для обучения модели. В их числе будут сама модель, набор данных, оптимизатор и функция потерь. В другие примеры и прилагаемый к книге код включены дополнительные компоненты, но перечислять их в тексте мы не станем. Наконец, завершим раздел кодом самого цикла обучения и продемонстрируем стандартный паттерн оптимизации PyTorch.

Подготовка условий для обучения

Пример 3.20 демонстрирует компоненты обучения, создаваемые для этого примера. Первый из них — начальное состояние обучения. Функция принимает в качестве аргумента объект args, чтобы обеспечить возможность обработки сложной информации, но в книге мы не станем показывать подобных сложностей. В прилагаемых материалах можно найти информацию о том, что еще можно использовать в состоянии обучения. Показанный здесь минимальный набор включает индекс эпохи и списки для значений потерь на этапах обучения и проверки, а также значения точности на этапах обучения и проверки. Он также включает два поля для потерь и точности на этапе контроля.

Далее создаются компоненты для набора данных и модели. В этом примере, а также в остальных примерах книги наборы данных отвечают за создание экземпляров векторизаторов. В прилагаемых к книге материалах создание экземпляра набора данных вложено в оператор if, что позволяет или загружать ранее созданные векторизаторы, или создавать новый, с сохранением векторизатора на диск. Важно также, что модель размещается на нужном устройстве в соответствии с пожеланиями пользователя (из параметра args.cuda), причем, конечно, есть условный оператор для проверки доступности GPU. Целевое устройство указывается при