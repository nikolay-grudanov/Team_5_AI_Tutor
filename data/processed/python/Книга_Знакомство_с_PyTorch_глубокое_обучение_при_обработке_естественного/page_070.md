---
source_image: page_070.png
page_number: 70
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.16
tokens: 7643
characters: 2547
timestamp: 2025-12-24T02:23:06.638360
finish_reason: stop
---

Класс Vectorizer

Вторая фаза преобразования текста в векторизованный мини-пакет — проход в цикле по токенам входных данных и преобразование каждого из них в цифровую форму. В результате этого должен получиться вектор. А поскольку этот вектор затем объединяется с векторами для других точек данных, возникает ограничение, гласящее, что длина создаваемых классом Vectorizer векторов должна быть одинаковой.

Для этого класс Vectorizer инкапсулирует Vocabulary обзора, задающий соответствие слов в обзоре целым числам. В примере 3.16 декоратор @classmethod языка Python используется для метода from_dataframe() класса Vectorizer — указывает точку входа для создания экземпляра Vectorizer. Метод from_dataframe() проходит в цикле по строкам объекта DataFrame библиотеки Pandas с двумя целями. Первая цель — подсчет частоты каждого из токенов набора данных. Вторая — создание объекта Vocabulary, в котором присутствуют только токены, встречающиеся не реже, чем указано в аргументе cutoff данного метода. По существу, этот метод ищет все слова, встречающиеся как минимум cutoff раз, и добавляет их в объект Vocabulary. Поскольку токен UNK также добавлен в Vocabulary, то при вызове метода lookup_token() класса Vocabulary для любого из не добавленных в него слов, будет возвращено значение unk_index.

Основная функциональность класса Vectorizer инкапсулирована в методе vectorize(). Он принимает в качестве аргумента строковое значение, содержащее обзор, и возвращает векторизованное представление этого обзора. В данном примере мы используем свернутое унитарное представление, с которым познакомили вас в главе 1. Оно содержит бинарный вектор — вектор из 0 и 1. Его длина равна длине словаря. На соответствующих словам обзора позициях в векторе содержится 1. Отметим, что у этого представления есть некоторые ограничения. Во-первых, оно является разреженным — количество уникальных слов в обзоре всегда намного меньше количества уникальных слов в словаре. Во-вторых, в нем не учитывается порядок, в котором слова встречаются в обзоре (такой подход называется «мульти множество слов»). В последующих главах мы рассмотрим и другие методы, у которых нет таких ограничений.

Пример 3.16. Класс Vectorizer, преобразующий текст в числовые векторы

class ReviewVectorizer(object):
    """ Векторизатор, приводящий словари в соответствие друг другу
        и использующий их
    """
    def __init__(self, review_vocab, rating_vocab):
        """
        Аргументы:
            review_vocab (Vocabulary): отображает слова
            в целочисленные значения