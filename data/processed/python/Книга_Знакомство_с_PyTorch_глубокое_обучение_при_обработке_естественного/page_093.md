---
source_image: page_093.png
page_number: 93
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.27
tokens: 7667
characters: 2452
timestamp: 2025-12-24T02:23:41.116783
finish_reason: stop
---

Пример: классификация фамилий с помощью MLP

В этом разделе мы воспользуемся MLP для классификации фамилий по стране их происхождения. Вывод демографической информации (такой как национальность) на основе общедоступных данных применяется во множестве сфер, начиная от рекомендаций товаров до обеспечения равных возможностей пользователей из разных стран. Тем не менее демографические характеристики и другие не обезличенные атрибуты относятся к «защищаемым законом атрибутам». Использовать их при моделировании и в программных продуктах следует осторожно1. Мы начнем с разбиения фамилий на символы и их обработки методом, аналогичным обработке слов, описанной в разделе «Пример: классификация тональностей обзоров ресторанов» на с. 76. Помимо различий в данных, модели на уровне символов практически схожи по структуре и реализации с основанными на словах моделями2.

Важный урок, который следует вынести из этого примера: реализация и обучение MLP представляет собой очевидное развитие методики реализации и обучения перцептрона из главы 3. На самом деле мы будем на протяжении всей книги вспоминать пример из главы 3 для более подробного описания этих компонентов. Далее, мы не станем включать код, приведенный в разделе «Пример: классификация тональностей обзоров ресторанов» на с. 76. Чтобы увидеть код примеров целиком, обратитесь к прилагаемым к книге материалам3.

Данный раздел начинается с описания набора данных фамилий и его предварительной обработки. Далее мы пошагово опишем конвейер преобразования строки с фамилией в векторизованный мини-пакет с помощью классов Vocabulary, Vectorizer и DataLoader. Прочитавшие главу 3 встретят эти классы как старых приятелей, только с небольшими модификациями.

Далее в этом разделе вас ждет описание модели surnameclassifier и обоснование ее архитектуры. MLP здесь схож с примером перцептрона из главы 3, но, помимо изменений модели, в этом примере появятся многоклассовые выходные данные и соответствующие функции потерь. После описания модели мы рассмотрим

1 Обсуждение этических вопросов NLP можно найти на сайте ethicsinnlp.org.
2 Интересно, что недавние исследования показали: включение моделей на уровне символов в модели на уровне слов могут повысить эффективность последних. См. книгу Петерса и др. (Peters et al., 2018).
3 См. блокнот /chapters/chapter_4/4_2_mlp_surnames/4_2_Classifying_Surnames_with_an_MLP.ipynb из репозитория GitHub этой книги (https://nlproc.info/PyTorchNLPBook/repo/).