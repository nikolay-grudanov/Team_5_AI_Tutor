---
source_image: page_147.png
page_number: 147
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.35
tokens: 7522
characters: 2093
timestamp: 2025-12-24T02:25:08.308657
finish_reason: stop
---

Пример: классификация национальной принадлежности фамилий с помощью символьного RNN

Теперь, когда мы вкратце описали основные свойства RNN и прошлись по реализации ElmanRNN, можно воспользоваться этими знаниями для решения какой-нибудь задачи. Рассмотрим задачу классификации фамилий из главы 4, где последовательности символов (фамилии) классифицируются по национальной принадлежности.

Класс SurnameDataset

В этом примере мы воспользуемся набором данных фамилий, описанным в главе 4. Точки данных представляют собой фамилии и соответствующие национальности. Мы не станем повторяться, рассказывая обо всех нюансах набора данных, рекомендуем вам заглянуть в подраздел «Набор данных фамилий» на с. 110.

В этом примере, как и в разделе «Пример: классификация фамилий с помощью CNN» на с. 130, мы рассматриваем фамилии как последовательности символов. Как и всегда, мы реализуем класс набора данных, показанный в примере 6.2, который возвращает векторизованную фамилию вместе с соответствующим ее национальной принадлежности целочисленным значением. Кроме того, возвращается длина последовательности, используемая в вычислениях далее по конвейеру для определения местоположения завершающего вектора в последовательности. Это одна из частей уже привычной нам последовательности шагов — реализовать Dataset, Vectorizer и Vocabulary перед собственно обучением.

Пример 6.2. Реализация класса SurnameDataset
class SurnameDataset(Dataset):
    @classmethod
    def load_dataset_and_make_vectorizer(cls, surname_csv):
        """ Загружает набор данных и создает новый векторизатор с нуля

        Аргументы:
            surname_csv (str): местоположение набора данных
        Возвращает:
            экземпляр SurnameDataset
        """
        surname_df = pd.read_csv(surname_csv)
        train_surname_df = surname_df[surname_df.split=='train']
        return cls(surname_df, SurnameVectorizer.from_dataframe(train_surname_df))

    def __getitem__(self, index):
        """ Основной метод — точка входа для наборов данных PyTorch

        Аргументы:
            index (int): индекс точки данных