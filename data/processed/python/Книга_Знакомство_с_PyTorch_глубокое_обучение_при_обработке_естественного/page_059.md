---
source_image: page_059.png
page_number: 59
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.63
tokens: 7622
characters: 2317
timestamp: 2025-12-24T02:22:48.634470
finish_reason: stop
---

из целых чисел, поскольку реализация PyTorch функции CrossEntropyLoss() предполагает, что каждому входному параметру соответствует один конкретный класс, а каждому классу — уникальный индекс. Именно поэтому вектор targets состоит из трех элементов индекса, соответствующих правильным классам для каждого входного значения. Исходя из этих допущений операция индексации выходных данных модели с вычислительной точки зрения выполняется более эффективно¹.

Функция потерь на основе бинарной перекрестной энтропии

Функция потерь на основе дискретной перекрестной энтропии, которую мы рассмотрели в предыдущем разделе, очень удобна для решения задач классификации в случае нескольких классов. Иногда задача (называемая в таком случае бинарной классификацией) заключается в разделении только двух классов. В подобных ситуациях целесообразно воспользоваться функцией потерь на основе бинарной перекрестной энтропии (binary cross-entropy, BCE). Мы рассмотрим ее в действии в примере из раздела «Пример: классификация тональностей обзоров ресторанов» на с. 76.

В примере 3.9 мы создаем выходной вектор бинарных вероятностей, probabilities, применяя сигма-функцию активации к случайному вектору, представляющему выходные значения сети. Далее создается вектор контрольных значений, состоящий из 0 и 1². Наконец, мы вычисляем BCE на основе вектора бинарной вероятности и вектора контрольных значений.

Пример 3.9. Функция потерь на основе бинарной перекрестной энтропии

Input[0]
bce_loss = nn.BCELoss()
sigmoid = nn.Sigmoid()
probabilities = sigmoid(torch.randn(4, 1, requires_grad=True))
targets = torch.tensor([1, 0, 1, 0], dtype=torch.float32).view(4, 1)
loss = bce_loss(probabilities, targets)
print(probabilities)
print(loss)

¹ Использование унитарных векторов в формуле перекрестной энтропии означает, что результаты всех операций умножения, кроме одной, будут нулевыми. Это колоссальная напрасная трата вычислительных ресурсов.
² Обратите внимание, что в примере кода вектор контрольных значений состоит из элементов с плавающей точкой. Хотя бинарная перекрестная энтропия почти аналогична дискретной перекрестной энтропии (просто классов только два), при ее вычислении значения 0 и 1 используются в формуле бинарной перекрестной энтропии, а не служат лишь в качестве индексов, как для дискретной перекрестной энтропии.