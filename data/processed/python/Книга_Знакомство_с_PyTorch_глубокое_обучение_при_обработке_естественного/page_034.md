---
source_image: page_034.png
page_number: 34
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.10
tokens: 7490
characters: 1835
timestamp: 2025-12-24T02:21:59.174981
finish_reason: stop
---

<table>
  <tr>
    <th>Output[1]</th>
    <td>Type: torch.FloatTensor<br>Shape/size: torch.Size([2, 2])<br>Values:<br>tensor([[ 21.,  21.],<br>        [ 21.,  21.]])<br>True</td>
  </tr>
  <tr>
    <th>Input[2]</th>
    <td>z = y.mean()<br>describe(z)<br>z.backward()<br>print(x.grad is None)</td>
  </tr>
  <tr>
    <th>Output[2]</th>
    <td>Type: torch.FloatTensor<br>Shape/size: torch.Size([])<br>Values:<br>21.0<br>False</td>
  </tr>
</table>

Когда тензор создается с параметром requires_grad=True, тем самым от PyTorch требуется хранить вспомогательную информацию, необходимую для вычисления градиентов. Во-первых, PyTorch будет отслеживать значения, получаемые при прямом проходе. Затем, в конце вычислений, для определения обратного шага используется одно скалярное значение. Обратный шаг запускается путем вызова метода backward() для тензора, полученного в результате вычисления функции потерь. При обратном шаге вычисляется значение градиента для объекта-тензора, участвовавшего в прямом шаге.

В целом градиент представляет собой значение, отражающее угол наклона выходного значения функции по отношению к ее входному значению. В сфере графов вычислений градиенты существуют для всех параметров модели, их можно считать вкладом каждого параметра в сигнал рассогласования. В PyTorch получить доступ к градиентам узлов графа вычислений можно с помощью переменной экземпляра .grad. Она используется при оптимизации для обновления значений параметров.

Тензоры CUDA

До сих пор наши тензоры располагались в памяти CPU. При выполнении операций линейной алгебры имеет смысл воспользоваться GPU, если в вашей системе он есть. Для применения GPU необходимо сначала выделить под тензор место в памяти GPU. Доступ к GPU производится с помощью специализированного API — CUDA. API CUDA был создан компанией NVIDIA, его можно использо-