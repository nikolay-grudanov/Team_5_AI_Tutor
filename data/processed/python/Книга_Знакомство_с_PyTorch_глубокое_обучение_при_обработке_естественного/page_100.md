---
source_image: page_100.png
page_number: 100
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.88
tokens: 7435
characters: 1781
timestamp: 2025-12-24T02:23:35.997081
finish_reason: stop
---

обучения осталась такой же. На основе обучающих данных вычисляются выходные данные модели, потерь и градиентов. Затем модель обновляется на основе градиентов.

Пример 4.10. Фрагмент цикла обучения

# Процедура обучения состоит из следующих пяти шагов:

# ---------------------------------------------
# Шаг 1. Обнуляем градиенты
optimizer.zero_grad()

# Шаг 2. Вычисляем выходные значения
y_pred = classifier(batch_dict['x_surname'])

# Шаг 3. Вычисляем функцию потерь
loss = loss_func(y_pred, batch_dict['y_nationality'])
loss_batch = loss.to("cpu").item()
running_loss += (loss_batch - running_loss) / (batch_index + 1)

# Шаг 4. Получаем градиенты на основе функции потерь
loss.backward()

# Шаг 5. Оптимизатор обновляет значения параметров по градиентам
optimizer.step()

Оценка модели и получение предсказаний

Чтобы выяснить эффективность модели, необходимо проанализировать модель с помощью количественных и качественных методов. Количественные методы включают оценку погрешности на специально выделенных контрольных данных для определения того, способен ли классификатор выполнить обобщение на еще не виденные выборки. Качественные методы включают ваше личное представление о том, чему обучилась модель, на основе первых k предсказаний классификатора для новой выборки.

Оценка на контрольном наборе данных

Для оценки SurnameClassifier на контрольных данных мы поступим так же, как и в примере с классификацией текстов обзоров ресторанов в подразделе «Оценка, вывод и просмотр» на с. 95: выберем фрагмент данных 'test', вызовем метод classifier.eval() и пройдем в цикле по контрольным данным аналогично прочим фрагментам. В этом примере фреймворк PyTorch из-за вызова метода classifier.eval() не обновляет параметры модели при использовании контрольных/проверочных данных.