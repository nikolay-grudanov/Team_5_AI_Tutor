---
source_image: page_135.png
page_number: 135
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.70
tokens: 7683
characters: 2540
timestamp: 2025-12-24T02:24:53.825244
finish_reason: stop
---

После описания набора данных и способа формирования векторизованных минипакетов мы рассмотрим загрузку предобученных векторов слов в слой вложений и покажем, как подогнать их под нашу задачу. Далее, модель сочетает предобученный слой вложений с CNN, использовавшимся в разделе «Пример: классификация фамилий с помощью CNN» на с. 130. В попытке повышения сложности модели до более реалистического уровня мы также отметим места, где в качестве метода регуляризации применяется дропаут. Затем мы обсудим процедуру обучения. Наверное, вы не удивитесь, узнав, что она практически не поменялась с предыдущих примеров в главе 4 и этой главе. Наконец, мы завершим пример оценкой эффективности модели на контрольном наборе и обсудим результаты.

Набор данных AG News

Набор данных AG News (http://bit.ly/2SbWzpL) представляет собой коллекцию из более чем миллиона новостных статей, собранных учеными в 2005 году для экспериментов с методами интеллектуального анализа данных и извлечения информации. Цель этого примера — продемонстрировать эффективность применения предобученных вложений слов при классификации текстов. В примере мы воспользуемся сокращенной версией набора данных, состоящей из 120 000 новостных статей, распределенных равномерно по четырем категориям: спорт, наука/технология, мир и бизнес. Помимо сокращения объема набора данных, мы будем рассматривать в качестве наблюдений заголовки статей и создадим задачу многоклассовой классификации для предсказания категории по заголовку.

Как и ранее, выполним предварительную обработку текста, удалим знаки препинания, добавив вокруг них (запятых, апострофов и точек) пробелы, и преобразуем текст в нижний регистр. Кроме того, мы разобьем набор данных на обучающий, проверочный и контрольный наборы, сначала агрегировав точки данных по метке класса, а затем распределив их по трем фрагментам. Таким образом, мы гарантируем одинаковое распределение классов во всех трех фрагментах.

Метод NewsDataset.__getitem__() показанный в примере 5.11, следует уже знакомой вам простой формуле: из конкретной строки набора данных извлекается строковое значение, представляющее входные данные модели, векторизуется и объединяется с целочисленным значением, соответствующим категории новости (метке класса).

Пример 5.11. Метод NewsDataset.__getitem__()
class NewsDataset(Dataset):
    @classmethod
    def load_dataset_and_make_vectorizer(cls, news_csv):
        """Загружает набор данных и создает новый векторизатор с нуля

        Аргументы:
            news_csv (str): местоположение набора данных