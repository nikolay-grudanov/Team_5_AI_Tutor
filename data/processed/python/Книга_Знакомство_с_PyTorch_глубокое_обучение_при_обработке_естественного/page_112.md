---
source_image: page_112.png
page_number: 112
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.63
tokens: 7628
characters: 2278
timestamp: 2025-12-24T02:24:14.259503
finish_reason: stop
---

используется унитарный вектор, то последовательность унитарных векторов формирует матрицу, а мини-пакет унитарных матриц — трехмерный тензор. На языке сверток размер каждого из унитарных векторов (обычно равный размеру словаря) представляет собой число «входных каналов», а длина последовательности символов — «ширину».

Как показано в примере 4.14, первый шаг конструирования вектора признаков — применение экземпляра класса Conv1d фреймворка PyTorch к трехмерному тензору данных. По информации о размере выходных данных можно составить представление о том, насколько сильно был уменьшен тензор. Наглядная иллюстрация причин сжатия выходного тензора приведена на рис. 4.9.

Пример 4.14. Искусственные данные и применение класса Conv1d¹

<table>
  <tr>
    <th>Input[0]</th>
    <td>
      batch_size = 2<br>
      one_hot_size = 10<br>
      sequence_width = 7<br>
      data = torch.randn(batch_size, one_hot_size, sequence_width)<br>
      conv1 = Conv1d(in_channels=one_hot_size, out_channels=16,<br>
                     kernel_size=3)<br>
      intermediate1 = conv1(data)<br>
      print(data.size())<br>
      print(intermediate1.size())
    </td>
  </tr>
  <tr>
    <th>Output[0]</th>
    <td>
      torch.Size([2, 10, 7])<br>
      torch.Size([2, 16, 5])
    </td>
  </tr>
</table>

Существует три основных метода для дальнейшего сжатия выходного тензора. Первый состоит в создании дополнительных операций свертки и последовательного их применения. В конце концов у соответствующего sequence_width (dim=2) измерения получится size=1. Мы покажем результаты применения двух дополнительных сверток в примере 4.15. Вообще, процесс применения сверток для уменьшения размера выходного тензора носит итеративный характер и требует определенных допущений. Наш пример устроен таким образом, что в последнем измерении полученного после трех сверток результата получится size=1².

¹ Для работы этого примера следует указать пакет для Conv1d. Например, вот так:
import torch.nn as nn
...
conv1 = nn.Conv1d(... — Примеч. пер.
² Для тензоров большего размера требуется больше сверток. Кроме того, необходимо также модифицировать сами свертки для более быстрого сжатия тензора. Для этого можно попробовать увеличить значение таких гиперпараметров, как stride, dilation и kernel_size.