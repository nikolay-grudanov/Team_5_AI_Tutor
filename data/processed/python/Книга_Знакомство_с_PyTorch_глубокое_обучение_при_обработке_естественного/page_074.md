---
source_image: page_074.png
page_number: 74
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.59
tokens: 7499
characters: 2065
timestamp: 2025-12-24T02:22:59.970269
finish_reason: stop
---

""" Прямой проход классификатора

Аргументы:
    x_in (torch.Tensor): входной тензор данных
        x_in.shape должен быть (batch, num_features)
    apply_sigmoid (bool): флаг для сигма-функции активации
        при использовании функции потерь на основе перекрестной энтропии должен равняться false
Возвращает:
    итоговый тензор. tensor.shape должен быть (batch,).
"""
y_out = self.fc1(x_in).squeeze()
if apply_sigmoid:
    y_out = F.sigmoid(y_out)
return y_out

Процедура обучения

В этом подразделе мы в общих чертах опишем компоненты процедуры обучения и их взаимодействие с набором данных и моделью с целью подбора параметров модели и повышения ее эффективности. По сути, процедура обучения отвечает за воплощение модели, проход в цикле по набору данных, вычисление (на основе переданных входных данных) выходных значений модели, определение потерь (того, насколько модель ошиблась в предсказаниях) и обновление модели в соответствии с потерями. Хотя на первый взгляд здесь есть масса нюансов, на самом деле точек модификации процедуры обучения не так уж много, поэтому вы скоро привыкнете к ней в процессе разработки алгоритмов глубокого обучения. Для упрощения управления высокоуровневыми решениями мы сосредоточим в объекте args (который показан в примере 3.19) все точки принятия решений¹.

Пример 3.19. Гиперпараметры и настройки программы для классификатора обзоров Yelp на основе перцептрона
from argparse import Namespace

args = Namespace(
    # Информация о данных и путях
    frequency_cutoff=25,
    model_state_file='model.pth',
    review_csv='data/yelp/reviews_with_splits_lite.csv',
    save_dir='model_storage/ch3/yelp/',
    vectorizer_file='vectorizer.json',

¹ Мы воспользовались классом Namespace из встроенного пакета argparse, поскольку он прекрасно инкапсулирует словарь свойств и хорошо работает со статическими анализаторами кода. Кроме того, если вам понадобится создавать процедуры обучения моделей на основе командной строки, можете переключиться на класс ArgumentParser из пакета argparse без необходимости менять остальной код.