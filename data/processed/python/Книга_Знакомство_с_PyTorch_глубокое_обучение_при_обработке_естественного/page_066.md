---
source_image: page_066.png
page_number: 66
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.47
tokens: 7707
characters: 2846
timestamp: 2025-12-24T02:23:01.261154
finish_reason: stop
---

В некоторых случаях разбиение на обучающий, проверочный и контрольный наборы может быть уже выполнено; такое часто встречается в наборах данных для задач оценки производительности. В подобных случаях важно использовать обучающие данные только для обновления параметров модели, проверочные данные — только для оценки качества модели в конце каждой эпохи, а тестовые данные применять только один раз, после анализа всех вариантов модели, при выдаче окончательных результатов. Последнее чрезвычайно важно, поскольку, чем больше специалист по машинному обучению «подглядывает» за тем, насколько модель эффективна на контрольном наборе данных, тем больше оказывается систематическая ошибка в сторону значений параметров, хорошо проявляющих себя на контрольном наборе. В подобном случае невозможно определить, насколько хорошо модель будет работать на не виденных ею данных, без сбора дополнительных сведений.

Оценка эффективности модели при k-блочной перекрестной проверке очень похожа на вариант с предварительной разбивкой набора данных, но содержит еще один предварительный этап разбивки всего набора данных на k блоков равного размера. Один из этих блоков предназначен для оценки, а оставшиеся k − 1 блоков — для обучения. Этот процесс итеративно повторяется k раз, всякий раз со сменой оценочного блока. Поскольку блоков всего k, то каждый из них сможет побывать оценочным, в результате чего получится k значений точности. Итоговая точность представляет собой просто среднее значение со стандартным отклонением. k-блочная оценка требует значительных затрат вычислительных ресурсов, но исключительно важна для маленьких наборов данных, когда ошибочное разбиение может привести или к излишнему оптимизму (поскольку контрольный результат оказывается слишком хорошим), или к излишнему пессимизму (поскольку контрольный результат оказывается слишком плохим).

Когда прекращать обучение

В приведенном ранее примере модель обучалась на протяжении фиксированного количества эпох. Хотя это простейший подход, подобный выбор произволен и не нужен. Одна из важнейших задач должной оценки эффективности модели — определение на основе этой оценки момента для останова обучения. Чаще всего применяют эвристический метод, называемый ранней остановкой (early stopping). Ранняя остановка заключается в отслеживании эффективности модели на проверочном наборе данных в каждой эпохе и выявлении момента, когда эффективность перестает улучшаться. Если далее эффективность по-прежнему не увеличивается на протяжении заданного количества эпох, называемого терпением (patience), то обучение завершается. Вообще говоря, момент, когда показатели модели перестают улучшаться на каком-либо наборе данных, называется моментом, когда модель сошлась. На практике редко дожидаются, чтобы модель полностью сошлась, поскольку это требует времени и может привести к переобучению.