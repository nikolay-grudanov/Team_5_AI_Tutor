---
source_image: page_057.png
page_number: 57
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.31
tokens: 7558
characters: 2051
timestamp: 2025-12-24T02:22:40.655062
finish_reason: stop
---

MSE — это просто среднее значение квадратов разностей предсказанных и целевых значений. Можно использовать для задач регрессии и несколько других функций потерь, например среднюю абсолютную погрешность (mean absolute error, MAE) и корень среднеквадратичной погрешности (root mean squared error, RMSE), но все они связаны с вычислением вещественного расстояния между выходным и целевым значениями. Пример 3.7 демонстрирует вариант реализации функции потерь MSE с помощью фреймворка PyTorch.

Пример 3.7. Функция потерь MSE

Input[0]
import torch
import torch.nn as nn

mse_loss = nn.MSELoss()
outputs = torch.randn(3, 5, requires_grad=True)
targets = torch.randn(3, 5)
loss = mse_loss(outputs, targets)
print(loss)

Output[0]
tensor(3.8618)

Функции потерь на основе дискретной перекрестной энтропии

Дискретная перекрестная энтропия обычно используется при постановке задачи многоклассовой классификации, при которой выходные значения интерпретируются как предсказания вероятностей принадлежности определенным классам.

Целевая переменная (\( y \)) представляет собой вектор из \( n \) элементов, соответствующий истинному полиномиальному распределению\(^1\) по всем классам. Если правильно определен только один класс, то вектор будет унитарным. Выходные данные сети (\( \hat{y} \)) также представляют собой вектор из \( n \) элементов, но соответствующий уже предсказанному сетью полиномиальному распределению. Дискретная перекрестная энтропия оценивает потери путем сравнения этих двух векторов (\( y, \hat{y} \)):

\[
L_{\text{перекрестная\_энтропия}}(y, \hat{y}) = - \sum_i y_i \log(\hat{y}_i).
\]

Истоки понятия перекрестной энтропии и выражения для нее лежат в теории информации, но для наших целей удобно рассматривать их как метод вычисления разности двух распределений. Нам нужно, чтобы вероятность правильно определенного класса была близка к 1, а остальных — к 0.

\footnotetext{1}{К вектору полиномиального распределения предъявляется два требования: сумма элементов вектора должна быть равна 1, а все элементы вектора — неотрицательны.}