---
source_image: page_039.png
page_number: 39
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.05
tokens: 7282
characters: 1321
timestamp: 2025-12-24T02:28:11.278206
finish_reason: stop
---

f = open('hello.txt', 'w')
try:
    f.write('привет, мир!')
finally:
    f.close()

Вы сразу можете сказать, что он довольно многословен. Обратите внимание: инструкция try...finally имеет важное значение. Просто написать что-то типа этого было бы недостаточно:

f = open('hello.txt', 'w')
f.write('привет, мир!')
f.close()

Если во время вызова f.write() случится исключение, то такая реализация не будет гарантировать, что файл будет закрыт, и поэтому наша программа может допустить утечку дескриптора файла. Вот почему инструкция with имеет столь важное значение. Она превращает надлежащее получение и высвобождение ресурсов в пустяковую работу.

Еще одним хорошим примером, где инструкция with эффективно используется в стандартной библиотеке Python, является класс threading.Lock:

some_lock = threading.Lock()
# Вредно:
some_lock.acquire()
try:
    # Сделать что-то...
finally:
    some_lock.release()
# Лучше:
with some_lock:
    # Сделать что-то...

В обоих случаях использование инструкции with позволяет абстрагироваться от большей части логики обработки ресурса. Вместо необходимости всякий раз писать явную инструкцию try...finally, инструкция with выполняет эту работу за нас.

Инструкция with может сделать программный код, который работает с системными ресурсами, более удобочитаемым. Она также помогает из-