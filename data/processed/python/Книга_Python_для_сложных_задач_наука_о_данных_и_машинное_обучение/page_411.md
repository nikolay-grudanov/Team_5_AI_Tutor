---
source_image: page_411.png
page_number: 411
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.36
tokens: 7494
characters: 1841
timestamp: 2025-12-24T01:01:57.887219
finish_reason: stop
---

Перекрестная проверка модели

Потеря части наших данных для обучения модели — один из недостатков использования отложенного набора данных для проверки модели. В предыдущем случае половина набора данных не участвует в обучении модели! Это неоптимально и может стать причиной проблем, особенно если исходный набор данных невелик.

Один из способов решения этой проблемы — перекрестная проверка (cross-validation), то есть выполнение последовательности аппроксимаций, в которых каждое подмножество данных используется как в качестве обучающей последовательности, так и проверочного набора. Наглядно его можно представить в виде рис. 5.22.

<table>
  <tr>
    <th>Попытка 1</th>
    <th>Проверочный набор</th>
  </tr>
  <tr>
    <th>Попытка 2</th>
    <th>Проверочный набор</th>
  </tr>
</table>

Рис. 5.22. Визуализация двухблочной перекрестной проверки

Мы выполняем две попытки проверки, попеременно используя каждую половину данных в качестве отложенного набора данных. Воспользовавшись полученными выше разделенными данными, мы можем реализовать это следующим образом:

In[6]: y2_model = model.fit(X1, y1).predict(X2)
       y1_model = model.fit(X2, y2).predict(X1)
       accuracy_score(y1, y1_model), accuracy_score(y2, y2_model)

Out[6]: (0.959999999999999996, 0.90666666666666662)

Полученные числа — две оценки точности, которые можно обобщить (допустим, взяв от них среднее значение) для получения лучшей меры общей работы модели. Этот конкретный вид перекрестной проверки, в которой мы разбили данные на два набора и по очереди использовали каждый из них в качестве проверочного набора, называется двухблочной перекрестной проверкой (two-fold cross-validation).

Можно распространить эту идею на случай большего числа попыток и большего количества блоков данных, например, на рис. 5.23 представлена пятиблочная перекрестная проверка.