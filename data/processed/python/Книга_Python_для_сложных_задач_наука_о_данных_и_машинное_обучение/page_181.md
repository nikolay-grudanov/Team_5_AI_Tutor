---
source_image: page_181.png
page_number: 181
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.05
tokens: 7684
characters: 2173
timestamp: 2025-12-24T00:56:12.604609
finish_reason: stop
---

Объединение наборов данных: конкатенация и добавление в конец

In[8]: df3 = make_df('AB', [0, 1])
    df4 = make_df('CD', [0, 1])
    print(df3); print(df4); print(pd.concat([df3, df4], axis='col'))
df3        df4        pd.concat([df3, df4], axis='col')
    A   B           C   D           A   B   C   D
  0  A0  B0         0  C0  D0         0  A0  B0  C0  D0
  1  A1  B1         1  C1  D1         1  A1  B1  C1  D1

Мы могли задать ось и эквивалентным образом: axis=1, здесь же мы использовали более интуитивно понятный вариант axis='col'\(^1\).

Дублирование индексов

Важное различие между функциями np.concatenate() и pd.concat() состоит в том, что конкатенация из библиотеки Pandas сохраняет индексы, даже если в результате некоторые индексы будут дублироваться. Рассмотрим следующий пример:

In[9]: x = make_df('AB', [0, 1])
    y = make_df('AB', [2, 3])
    y.index = x.index  # Дублируем индексы!
    print(x); print(y); print(pd.concat([x, y]))
x        y        pd.concat([x, y])
    A   B           A   B           A   B
  0  A0  B0         0  A2  B2         0  A0  B0
  1  A1  B1         1  A3  B3         1  A1  B1
                        0  A2  B2
                        1  A3  B3

Обратите внимание на повторяющиеся индексы. Хотя в объектах DataFrame это допустимо, подобный результат часто может быть нежелателен. Функция pd.concat() предоставляет нам несколько способов решения этой проблемы.

Перехват повторов как ошибки. Если вам нужно просто гарантировать, что индексы в возвращаемом функцией pd.concat() результате не перекрываются, можно задать флаг verify_integrity. В случае равного True значения этого флага конкатенация приведет к генерации ошибки при наличии дублирующихся индексов. Вот пример, в котором мы для большей ясности перехватываем и выводим в консоль сообщение об ошибке:

\footnotetext{1}{В текущей (0.19.2) версии библиотеки Pandas допустимы следующие варианты синтаксиса:
axis='columns'
или
axis=1
Указанный вариант синтаксиса приведет к ошибке. Впрочем, в версии 0.18.1 библиотеки Pandas, используемой автором книги, документированный синтаксис для этой функции допускает только применение числовых значений для параметра axis.}