---
source_image: page_569.png
page_number: 569
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 15.85
tokens: 7343
characters: 1389
timestamp: 2025-12-24T01:05:46.742391
finish_reason: stop
---

```python
ax.axis('off')

Ni, Nj = positive_patches[0].shape
indices = np.array(indices)

for i, j in indices[labels == 1]:
    ax.add_patch(plt.Rectangle((j, i), Nj, Ni, edgecolor='red',
        alpha=0.3, lw=2,
        facecolor='none'))
```

![Окна, в которых были обнаружены лица](../images/5.152.png)

Рис. 5.152. Окна, в которых были обнаружены лица

Все обнаруженные фрагменты перекрываются и содержат имеющееся на изображении лицо! Отличный результат для всего нескольких строк кода на языке Python.

Предостережения и дальнейшие усовершенствования

Если посмотреть на предшествующий код и примеры немного внимательнее, можно обнаружить, что нужно сделать еще немало, прежде чем можно будет назвать наше приложение распознания лиц готовым к промышленной эксплуатации. В нашем коде имеется несколько проблемных мест. Кроме того, в него не помещает внести несколько усовершенствований.

- Наша обучающая последовательность, особенно в части отрицательных признаков, неполна. Основная проблема заключается в том, что существует множество напоминающих лица текстур, не включенных в нашу обучающую последовательность, поэтому нынешняя модель будет склонна выдавать ложноположительные результаты. Это будет заметно, если попытаться выполнить предыдущий алгоритм для полного изображения астронавта: текущая модель приведет к множеству ложных обнаружений лиц в других областях изображения.