---
source_image: page_050.png
page_number: 50
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.87
tokens: 7520
characters: 2033
timestamp: 2025-12-24T00:52:45.040951
finish_reason: stop
---

знаменитому афоризму Дональда Кнута: «Лучше не держать в голове подобные “малые” вопросы производительности, скажем, 97% времени: преждевременная оптимизация — корень всех зол».

Однако, как только ваш код начинает работать, будет полезно немного заняться его производительностью. Иногда бывает удобно проверить время выполнения заданной команды или набора команд, а иногда — покопаться в состоянии из множества строк процессе и выяснить, где находится узкое место какого-либо сложного набора операций. Оболочка IPython предоставляет широкий выбор функциональности для выполнения подобного мониторинга скорости выполнения кода и его профилирования. Здесь мы обсудим следующие «магические» команды оболочки IPython:

□ %time — длительность выполнения отдельного оператора;
□ %timeit — длительность выполнения отдельного оператора при неоднократном повторе, для большей точности;
□ %prun — выполнение кода с использованием профилировщика;
□ %lprun — пошаговое выполнение кода с применением профилировщика;
□ %memit — оценка использования оперативной памяти для отдельного оператора;
□ %mprun — пошаговое выполнение кода с применением профилировщика памяти.

Последние четыре команды не включены в пакет IPython — для их использования необходимо установить расширения line_profiler и memory_profiler, которые мы обсудим в следующих разделах.

Оценка времени выполнения фрагментов кода: %timeit и %time

Мы уже встречались со строчной «магической» командой %timeit и блочной «магической» командой %%timeit во введении в «магические» функции в разделе «“Магические” команды IPython» данной главы; команду %%timeit можно использовать для оценки времени многократного выполнения фрагментов кода:

In[1]: %timeit sum(range(100))

100000 loops, best of 3: 1.54 µs per loop

Обратите внимание, что, поскольку данная операция должна выполняться очень быстро, команда %timeit автоматически выполняет ее большое количество раз. В случае более медленных команд команда %timeit автоматически подстроится и будет выполнять их меньшее количество раз: