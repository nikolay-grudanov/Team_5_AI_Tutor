---
source_image: page_412.png
page_number: 412
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.90
tokens: 7300
characters: 1207
timestamp: 2025-12-24T01:01:52.620147
finish_reason: stop
---

Рис. 5.23. Визуализация пятиблочной перекрестной проверки

В этом случае мы разбиваем данные на пять групп и по очереди используем каждую из них для оценки обучения модели на остальных 4/5 данных. Делать это вручную довольно утомительно, так что воспользуемся удобной утилитой cross_val_score библиотеки Scikit-Learn для большей краткости синтаксиса:

In[7]: from sklearn.cross_validation import cross_val_score
    cross_val_score(model, X, y, cv=5)

Out[7]: array([ 0.96666667, 0.96666667, 0.93333333, 0.93333333, 1. ])

Повторение проверки по различным подмножествам данных дает нам лучшее представление о качестве работы алгоритма.

Библиотека Scikit-Learn реализует множество схем перекрестной проверки, удобных в определенных конкретных ситуациях. Они реализованы с помощью итераторов в модуле cross_validation. Например, мы взяли предельный случай, при котором количество блоков равно количеству точек данных, и обучаем модель в каждой попытке на всех точках, кроме одной. Такой тип перекрестной проверки известен под названием перекрестной проверки по отдельным объектам (leave-one-out cross-validation — дословно «перекрестная проверка по всем без одного»), ее можно использовать следующим образом: