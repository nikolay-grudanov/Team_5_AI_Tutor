---
source_image: page_564.png
page_number: 564
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 20.21
tokens: 7392
characters: 1534
timestamp: 2025-12-24T01:05:40.390299
finish_reason: stop
---

ax[1].imshow(hog_vis)
ax[1].set_title('visualization of HOG features');
Исходное изображение        Визуализация HOG-признаков

Рис. 5.149. Визуализация HOG-признаков, вычисленных для изображения

Метод HOG в действии: простой детектор лиц

На основе этих признаков HOG можно создать простой алгоритм обнаружения лиц с помощью любого из оценивателей библиотеки Scikit-Learn. Мы воспользуемся линейным методом опорных векторов (см. раздел «Заглянем глубже: метод опорных векторов» данной главы). Алгоритм включает следующие шаги.

1. Получение миниатюр изображений, на которых представлены лица, для формирования набора «положительных» обучающих выборок.
2. Получение миниатюр изображений, на которых не представлены лица для формирования набора «отрицательных» обучающих выборок.
3. Выделение HOG-признаков из этих обучающих выборок.
4. Обучение линейного SVM-классификатора на этих выборках.
5. В случае «незнакомого» изображения перемещаем по изображению скользящее окно, применяя нашу модель для определения того, содержится ли в этом окне лицо или нет.
6. Если обнаруженные лица частично пересекаются, объединяем их в одно окно.

Пройдемся по этим шагам подробнее.

1. Получаем набор положительных обучающих выборок.
Найдем положительные обучающие выборки с разнообразными лицами. У нас есть уже подходящий набор данных Labeled Faces in the Wild (LFW), который можно скачать с помощью библиотеки Scikit-Learn:

In[3]: from sklearn.datasets import fetch_lfw_people
    faces = fetch_lfw_people()
    positive_patches = faces.images