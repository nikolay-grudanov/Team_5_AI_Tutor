---
source_image: page_166.png
page_number: 166
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.20
tokens: 7573
characters: 1859
timestamp: 2025-12-24T00:55:36.183787
finish_reason: stop
---

Проиндексировав заново наши ряды данных с помощью MultiIndex, мы увидим иерархическое представление данных:

In[6]: pop = pop.reindex(index)
    pop

Out[6]:   California  2000      33871648
              2010      37253956
           New York  2000      18976457
              2010      19378102
           Texas     2000      20851820
              2010      25145561
    dtype: int64

Здесь первые два столбца представления объекта Series отражают значения мультииндекса, а третий столбец — данные. Обратите внимание, что в первом столбце отсутствуют некоторые элементы: в этом мультииндексном представлении все пропущенные элементы означают то же значение, что и строкой выше.

Теперь для выбора всех данных, второй индекс которых равен 2010, можно просто воспользоваться синтаксисом срезов библиотеки Pandas:

In[7]: pop[:, 2010]

Out[7]:   California      37253956
           New York      19378102
           Texas         25145561
    dtype: int64

Результат представляет собой массив с одиночным индексом и только теми ключами, которые нас интересуют. Такой синтаксис намного удобнее (а операция выполняется гораздо быстрее!), чем мультииндексное решение на основе кортежей, с которого мы начали. Сейчас мы обсудим подробнее подобные операции индексации над иерархически индексированными данными.

Мультииндекс как дополнительное измерение

Мы могли с легкостью хранить те же самые данные с помощью простого объекта DataFrame с индексом и метками столбцов. На самом деле библиотека Pandas создана с учетом этой равнозначности. Метод unstack() может быстро преобразовать мультииндексный объект Series в индексированный обычным образом объект DataFrame:

In[8]: pop_df = pop.unstack()
    pop_df

Out[8]:        2000      2010
           California  33871648  37253956
           New York    18976457  19378102
           Texas       20851820  25145561