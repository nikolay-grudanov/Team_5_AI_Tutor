---
source_image: page_051.png
page_number: 51
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.34
tokens: 7533
characters: 1999
timestamp: 2025-12-24T00:52:53.363581
finish_reason: stop
---

In[2]: %timeit
    total = 0
    for i in range(1000):
        for j in range(1000):
            total += i * (-1) ** j

1 loops, best of 3: 407 ms per loop

Иногда повторное выполнение операции — не лучший вариант. Например, в случае необходимости отсортировать список повтор операции мог бы ввести нас в заблуждение. Сортировка предварительно отсортированного списка происходит намного быстрее, чем сортировка неотсортированного, так что повторное выполнение исказит результат:

In[3]: import random
    L = [random.random() for i in range(100000)]
    %timeit L.sort()

100 loops, best of 3: 1.9 ms per loop

В этом случае лучшим выбором будет «магическая» функция %timeit. Она также подойдет для команд с более длительным временем выполнения, в случае которых короткие системно обусловленные задержки вряд ли существенно повлияют на результат. Оценим время сортировки неотсортированного и предварительно отсортированного списков:

In[4]: import random
    L = [random.random() for i in range(100000)]
    print("sorting an unsorted list:")
    %time L.sort()

sorting an unsorted list:
CPU times: user 40.6 ms, sys: 896 μs, total: 41.5 ms
Wall time: 41.5 ms

In[5]: print("sorting an already sorted list:")
    %time L.sort()
sorting an already sorted list:
CPU times: user 8.18 ms, sys: 10 μs, total: 8.19 ms
Wall time: 8.24 ms

Обратите внимание на то, насколько быстрее сортируется предварительно отсортированный список, а также насколько больше времени занимает оценка с помощью функции %time по сравнению с функцией %timeit, даже в случае предварительно отсортированного списка! Это происходит в результате того, что «магическая» функция %timeit незаметно для нас осуществляет некоторые хитрые трюки, чтобы системные вызовы не мешали оценке времени. Например, она не допускает удаления неиспользуемых объектов Python (известного как сбор мусора), которое могло бы повлиять на оценку времени. Именно поэтому выдаваемое функцией %timeit время обычно заметно короче выдаваемого функцией %time.