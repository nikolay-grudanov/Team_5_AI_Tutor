---
source_image: page_257.png
page_number: 257
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.72
tokens: 7563
characters: 1642
timestamp: 2025-12-24T00:58:07.086017
finish_reason: stop
---

In[15]: result1 = df2.T[0] + df3.iloc[1]
    result2 = pd.eval('df2.T[0] + df3.iloc[1]')
    np.allclose(result1, result2)

Out[15]: True

Другие операции. Другие операции, например вызовы функций, условные выражения, циклы и другие, более сложные конструкции, пока в функции pd.eval() не реализованы. При необходимости выполнения подобных сложных видов выражений можно воспользоваться самой библиотекой Numexpr.

Использование метода DataFrame.eval() для выполнения операций по столбцам

У объектов DataFrame существует метод eval(), работающий схожим образом с высокоуровневой функцией pd.eval() из библиотеки Pandas. Преимущество метода eval() заключается в возможности ссылаться на столбцы по имени. Возьмем для примера следующий маркированный массив:

In[16]: df = pd.DataFrame(rng.rand(1000, 3), columns=['A', 'B', 'C'])
    df.head()

Out[16]:
      A         B         C
0  0.375506  0.406939  0.069938
1  0.069087  0.235615  0.154374
2  0.677945  0.433839  0.652324
3  0.264038  0.808055  0.347197
4  0.589161  0.252418  0.557789

Воспользовавшись функцией pd.eval() так, как показано выше, можно вычислять выражения с этими тремя столбцами следующим образом:

In[17]: result1 = (df['A'] + df['B']) / (df['C'] - 1)
    result2 = pd.eval("(df.A + df.B) / (df.C - 1)")
    np.allclose(result1, result2)

Out[17]: True

Метод DataFrame.eval() позволяет описывать вычисления со столбцами гораздо лаконичнее:

In[18]: result3 = df.eval('(A + B) / (C - 1)')
    np.allclose(result1, result3)

Out[18]: True

Обратите внимание, что мы обращаемся с названиями столбцов в вычисляемом выражении как с переменными и получаем желаемый результат.