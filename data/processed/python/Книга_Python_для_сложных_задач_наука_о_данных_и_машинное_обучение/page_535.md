---
source_image: page_535.png
page_number: 535
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 40.24
tokens: 7630
characters: 2192
timestamp: 2025-12-24T01:05:20.130655
finish_reason: stop
---

In[6]: rng = np.random.RandomState(13)
    X_stretched = np.dot(X, rng.randn(2, 2))

    kmeans = KMeans(n_clusters=4, random_state=0)
    plot_kmeans(kmeans, X_stretched)

Визуально заметно, что форма этих преобразованных кластеров некруглая, а значит, круглые кластеры плохо подойдут для их описания. Тем не менее метод \( k \)-средних недостаточно гибок для учета этого нюанса и пытается втиснуть данные в четыре круглых кластера. Это приводит к перепутанным меткам кластеров в местах перекрытия получившихся окружностей, см. нижнюю правую часть графика.

Можно было бы попытаться решить эту проблему путем предварительной обработки данных с помощью РСА (см. раздел «Заглянем глубже: метод главных компонент» этой главы), но на практике нет никаких гарантий, что подобная глобальная операция позволит разместить по окружностям отдельные точки данных.

Отсутствие гибкости в вопросе формы кластеров и отсутствие вероятностного присвоения меток кластеров — два недостатка метода \( k \)-средних, означающих, что для многих наборов данных (особенно низкоразмерных) он будет работать не столь хорошо, как хотелось бы.

Можно попытаться избавиться от этих недостатков путем обобщения модели \( k \)-средних. Например, можно оценивать степень достоверности присвоения меток кластеров, сравнивая расстояния от каждой точки до всех центров кластеров, а не сосредотачивая внимание лишь на ближайшем. Можно также разрешить эллипсовидную форму границ кластеров, а не только круглую, чтобы учесть кластеры некруглой формы. Оказывается, что это базовые составляющие другой разновидности модели кластеризации — смеси Гауссовых распределений.

Обобщение EM-модели: смеси Гауссовых распределений

Смесь Гауссовых распределений (gaussian mixture model, GMM) нацелена на поиск многомерных Гауссовых распределений вероятностей, моделирующих наилучшим возможным образом любой исходный набор данных.

В простейшем случае смеси Гауссовых распределений можно использовать для поиска кластеров аналогично методу \( k \)-средних (рис. 5.127):

In[7]: from sklearn.mixture import GMM
    gmm = GMM(n_components=4).fit(X)
    labels = gmm.predict(X)
    plt.scatter(X[:, 0], X[:, 1], c=labels, s=40, cmap='viridis');