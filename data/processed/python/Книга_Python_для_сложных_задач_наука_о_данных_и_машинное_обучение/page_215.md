---
source_image: page_215.png
page_number: 215
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.82
tokens: 7684
characters: 2206
timestamp: 2025-12-24T00:57:02.963339
finish_reason: stop
---

In[13]:
births['decade'] = 10 * (births['year'] // 10)
births.pivot_table('births', index='decade', columns='gender', aggfunc='sum')

Out[13]: gender      F      M    decade
         1960  1753634  1846572
         1970  16263075  17121550
         1980  18310351  19243452
         1990  19479454  20420553
         2000  18229309  19106428

Сразу же видим, что в каждом десятилетии мальчиков рождается больше, чем девочек. Воспользуемся встроенными средствами построения графиков библиотеки Pandas для визуализации общего количества новорожденных в зависимости от года (рис. 3.2; см. обсуждение построения графиков с помощью библиотеки Matplotlib в главе 4):

In[14]:
%matplotlib inline
import matplotlib.pyplot as plt
sns.set()  # Используем стили библиотеки Seaborn
births.pivot_table('births', index='year', columns='gender',
                   aggfunc='sum').plot()
plt.ylabel('total births per year');   # общее количество новорожденных
                                       # в течение года

Благодаря сводной таблице и методу plot() мы можем сразу же увидеть ежегодный тренд новорожденных по полу. В последние 50 с лишним лет мальчиков рождалось больше, чем девочек, примерно на 5%.

Дальнейшее исследование данных. Хотя это, возможно, и не имеет отношения к сводным таблицам, есть еще несколько интересных вещей, которые можно извлечь из этого набора данных с помощью уже рассмотренных инструментов библиотеки Pandas. Нам придется начать с небольшой очистки данных, удалив аномальные значения, возникшие из-за неправильно набранных дат (например, 31 июня) или отсутствующих значений (например, 99 июня). Простой способ убрать сразу их все — отсечь аномальные значения. Мы сделаем это с помощью надежного алгоритма сигма-отсечения (sigma-clipping):

In[15]: quartiles = np.percentile(births['births'], [25, 50, 75])
        mu = quartiles[1]
        sig = 0.74 * (quartiles[2] - quartiles[0])

1 Узнать больше об операциях сигма-отсечения вы можете из книги, которую я написал совместно с Желько Ивечичем, Эндрю Дж. Конолли и Александром Греем: Statistics, Data Mining and Machine Learning in Astronomy: A Practical Python Guide for the Analysis of Survey Data (Princeton University Press, 2014).