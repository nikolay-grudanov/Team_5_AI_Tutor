---
source_image: page_566.png
page_number: 566
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 18.08
tokens: 7316
characters: 1248
timestamp: 2025-12-24T01:05:45.748610
finish_reason: stop
---

Рис. 5.150. Отрицательные фрагменты изображений, не содержащие лиц

Надеемся, что они достаточно хорошо охватывают пространство «не лиц», которые могут встретиться нашему алгоритму.

3. Объединяем наборы и выделяем HOG-признаки.
При наличии положительных и отрицательных выборок мы можем их объединить и вычислить HOG-признаки. Этот шаг займет некоторое время, поскольку признаки HOG требуют непростых вычислений для каждого изображения.

In[7]: from itertools import chain
    X_train = np.array([feature.hog(im)
        for im in chain(positive_patches,
            negative_patches)])
    y_train = np.zeros(X_train.shape[0])
    y_train[:positive_patches.shape[0]] = 1

In[8]: X_train.shape

Out[8]: (43233, 1215)

Итак, мы получили 43 000 обучающих выборок в 1215-мерном пространстве и наши данные находятся в подходящем для библиотеки Scikit-Learn виде!

4. Обучаем метод опорных векторов.
Воспользуемся изученными ранее в данной главе инструментами для создания классификатора фрагментов миниатюр. Линейный метод опорных векторов — хороший выбор для задачи бинарной классификации в случае столь высокой размерности. Воспользуемся классификатором LinearSVC, поскольку он обычно лучше масштабируется при росте числа выборок по сравнению с SVC.