---
source_image: page_516.png
page_number: 516
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.10
tokens: 7350
characters: 1392
timestamp: 2025-12-24T01:04:35.764358
finish_reason: stop
---

Этот рисунок дает нам представление о разнообразии рукописных цифр в наборе данных.

Вычислим с помощью обучения на базе многообразий проекцию для этих данных, показанную на рис. 5.108. Для ускорения будем использовать только 1/30 часть данных, то есть примерно 2000 точек данных (из-за относительно плохой масштабируемости методов обучения на базе многообразий я пришел к выводу, что несколько тысяч выборок — хорошее количество для начала, чтобы относительно быстро исследовать набор, прежде чем перейти к полномасштабным вычислениям):

In[24]:
# используем только 1/30 часть данных:
# вычисления для полного набора данных занимают длительное время!
data = mnist.data[:30]
target = mnist.target[:30]

model = Isomap(n_components=2)
proj = model.fit_transform(data)
plt.scatter(proj[:, 0], proj[:, 1], c=target, cmap=plt.cm.get_cmap('jet', 10))
plt.colorbar(ticks=range(10))
plt.clim(-0.5, 9.5);

![Isomap-вложение для набора данных цифр MNIST](../images/chapter_5/fig_5_108.png)

Рис. 5.108. Isomap-вложение для набора данных цифр MNIST

Полученная диаграмма рассеяния демонстрирует некоторые зависимости между точками данных, но точки на ней расположены слишком тесно. Можно получить больше информации, изучая за раз данные лишь об одной цифре (рис. 5.109):

In[25]: from sklearn.manifold import Isomap

    # Выбираем для проекции 1/4 цифр "1"
    data = mnist.data[mnist.target == 1][:4]