---
source_image: page_528.png
page_number: 528
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.88
tokens: 7554
characters: 2077
timestamp: 2025-12-24T01:05:02.275924
finish_reason: stop
---

Как и можно было ожидать, судя по визуализированным ранее центрам кластеров, больше всего путаницы между единицами и восьмерками. Но все равно, с помощью метода k-средних мы фактически создали классификатор цифр без каких-либо известных меток!

Попробуем пойти еще дальше. Воспользуемся для предварительной обработки данных до выполнения k-средних алгоритмом стохастического вложения соседей на основе распределения Стьюдента (t-SNE), упоминавшимся в разделе «Заглянем глубже: обучение на базе многообразий» этой главы. t-SNE — нелинейный алгоритм вложения, особенно хорошо умеющий сохранять точки внутри кластеров. Посмотрим, как он работает:

In[17]: from sklearn.manifold import TSNE

    # Проекция данных: выполнение этого шага займет несколько секунд
    tsne = TSNE(n_components=2, init='pca', random_state=0)
    digits_proj = tsne.fit_transform(digits.data)

    # Расчет кластеров
    kmeans = KMeans(n_clusters=10, random_state=0)
    clusters = kmeans.fit_predict(digits_proj)

    # Перестановка меток местами
    labels = np.zeros_like(clusters)
    for i in range(10):
        mask = (clusters == i)
        labels[mask] = mode(digits.target[mask])[0]

    # Оценка точности
    accuracy_score(digits.target, labels)

Out[17]: 0.93356149137451305

Точность, даже без использования меток, составляет почти 94%. При разумном использовании алгоритмы машинного обучения без учителя демонстрируют отличные результаты: они могут извлекать информацию из набора данных даже тогда, когда сделать это вручную или визуально очень непросто.

Пример 2: использование метода k-средних для сжатия цветов

Одно из интересных приложений кластеризации — сжатие цветов в изображениях. Например, допустим, что у нас есть изображение с миллионами цветов. Почти во всех изображениях большая часть цветов не используется и цвета многих пикселов изображения будут похожи или даже совпадать.

Например, рассмотрим изображение, показанное на рис. 5.120, взятом из модуля datasets библиотеки Scikit-Learn (для работы следующего кода у вас должен быть установлен пакет pillow языка Python):