---
source_image: page_252.png
page_number: 252
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.37
tokens: 7717
characters: 2463
timestamp: 2025-12-24T00:58:07.037546
finish_reason: stop
---

Этот график демонстрирует существенное различие между количеством велосипедов в будние и выходные дни: с понедельника по пятницу мост пересекает в среднем вдвое больше велосипедистов, чем в субботу и воскресенье.

С учетом этого выполним сложную операцию groupby и посмотрим на почасовой тренд в будни по сравнению с выходными. Начнем с группировки как по признаку выходного дня, так и по времени суток:

In[45]: weekend = np.where(data.index.weekday < 5, 'Weekday', 'Weekend')
    by_time = data.groupby([weekend, data.index.time]).mean()

Теперь воспользуемся некоторыми инструментами из раздела «Множественные субграфики» главы 4, чтобы нарисовать два графика бок о бок (рис. 3.17):

In[46]: import matplotlib.pyplot as plt
    fig, ax = plt.subplots(1, 2, figsize=(14, 5))
    by_time.ix['Weekday'].plot(ax=ax[0], title='Weekdays',
        xticks=hourly_ticks, style=[':', '--', '-'])
    by_time.ix['Weekend'].plot(ax=ax[1], title='Weekends',
        xticks=hourly_ticks, style=[':', '--', '-']);

Результат оказался очень интересным: мы видим бимодальный паттерн, связанный с поездками на работу в город на протяжении рабочей недели, и унимодальный паттерн, связанный с досугом/отдыхом во время выходных. Было бы интересно дальше покопаться в этих данных и изучить влияние погоды, температуры, времени года и других факторов на паттерны поездок в город на велосипедах. Дальнейшее обсуждение этих вопросов см. в сообщении «Действительно ли в Сиэтле наблюдается оживление в сфере поездок на велосипедах?» (https://jakevdp.github.io/blog/2014/06/10/is-seattle-really-seeing-an-uptick-in-cycling/) из моего блога, в котором используется подмножество этих данных. Мы также вернемся к этому набору данных в контексте моделирования в разделе «Заглянем глубже: линейная регрессия» главы 5.

Увеличение производительности библиотеки Pandas: eval() и query()

Основные возможности стека PyData основываются на умении библиотек NumPy и Pandas передавать простые операции на выполнение программам на языке C посредством интуитивно понятного синтаксиса: примерами могут послужить векторизованные/транслируемые операции в библиотеке NumPy, а также операции группировки в библиотеке Pandas. Хотя эти абстракции весьма производительны и эффективно работают для многих распространенных сценариев использования, они зачастую требуют создания временных вспомогательных объектов, что приводит к чрезмерным накладным расходам как процессорного времени, так и оперативной памяти.