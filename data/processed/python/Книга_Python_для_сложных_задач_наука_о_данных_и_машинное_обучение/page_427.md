---
source_image: page_427.png
page_number: 427
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.21
tokens: 7579
characters: 2242
timestamp: 2025-12-24T01:02:20.583709
finish_reason: stop
---

Проектирование признаков

В предыдущих разделах мы обрисовали базовые понятия машинного обучения, но во всех предполагалось, что наши данные находятся в аккуратном формате [n_samples, n_features]. На практике же данные редко поступают к нам в подобном виде. Поэтому одним из важнейших этапов использования машинного обучения на практике становится проектирование признаков (feature engineering), то есть преобразование всей касающейся задачи информации в числа, пригодные для построения матрицы признаков.

В этом разделе мы рассмотрим несколько часто встречающихся примеров задач проектирования признаков: признаки для представления категориальных данных (categorical data), признаки для представления текста и признаки для представления изображений. Кроме того, мы обсудим использование производных признаков (derived features) для повышения сложности модели и заполнение отсутствующих данных. Этот процесс часто называют векторизацией, так как он включает преобразование данных в произвольной форме в аккуратные векторы.

Категориальные признаки

Категориальные данные — один из распространенных типов нечисловых данных. Например, допустим, что мы анализируем какие-то данные по ценам на жилье и, помимо числовых признаков, таких как «цена» и «количество комнат», в них имеется информация о микрорайоне (neighborhood). Например, пусть наши данные выглядят следующим образом:

In[1]: data = [
    {'price': 850000, 'rooms': 4, 'neighborhood': 'Queen Anne'},
    {'price': 700000, 'rooms': 3, 'neighborhood': 'Fremont'},
    {'price': 650000, 'rooms': 3, 'neighborhood': 'Wallingford'},
    {'price': 600000, 'rooms': 2, 'neighborhood': 'Fremont'}
]

Вам может показаться соблазнительным кодировать эти данные с помощью задания прямого числового отображения:

In[2]: {'Queen Anne': 1, 'Fremont': 2, 'Wallingford': 3};

Но оказывается, что в библиотеке Scikit-Learn такой подход не очень удобен: модели данного пакета исходят из базового допущения о том, что числовые признаки отражают алгебраические величины. Следовательно, подобное отображение будет подразумевать, например, что Queen Anne < Fremont < Wallingford или даже что Wallingford – Queen Anne = Fremont, что, не считая сомнительных демографических шуток, не имеет никакого смысла.