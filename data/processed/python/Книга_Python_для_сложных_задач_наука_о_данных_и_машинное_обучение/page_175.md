---
source_image: page_175.png
page_number: 175
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 20.12
tokens: 7460
characters: 1653
timestamp: 2025-12-24T00:55:33.628199
finish_reason: stop
---

Если мы попытаемся выполнить частичный срез этого индекса, то получим ошибку:

In[35]: try:
        data['a':'b']
    except KeyError as e:
        print(type(e))
        print(e)

<class 'KeyError'>
'Key length (1) was greater than MultiIndex lexsort depth (0)'

Хотя из сообщения об ошибке¹ это не вполне понятно, ошибка генерируется, потому что объект MultiIndex не отсортирован. По различным причинам частичные срезы и другие подобные операции требуют, чтобы уровни мультииндекса были отсортированы (лексикографически упорядочены). Библиотека Pandas предоставляет множество удобных инструментов для выполнения подобной сортировки. В качестве примеров можем указать методы sort_index() и sortlevel() объекта DataFrame. Мы воспользуемся простейшим из них — методом sort_index():

In[36]: data = data.sort_index()
        data

Out[36]: char   int
          a      1     0.003001
                2     0.164974
          b      1     0.001693
                2     0.526226
          c      1     0.741650
                2     0.569264
        dtype: float64

После подобной сортировки индекса частичный срез будет выполняться как положено:

In[37]: data['a':'b']

Out[37]: char   int
          a      1     0.003001
                2     0.164974
          b      1     0.001693
                2     0.526226
        dtype: float64

Выполнение над индексами операций stack и unstack

Существует возможность преобразовывать набор данных из вертикального мультииндексированного в простое двумерное представление, при необходимости указывая требуемый уровень:

¹ «Длина ключа была больше, чем глубина лексикографической сортировки объекта Multi-Index».