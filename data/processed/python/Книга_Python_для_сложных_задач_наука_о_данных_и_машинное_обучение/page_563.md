---
source_image: page_563.png
page_number: 563
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.00
tokens: 7510
characters: 1957
timestamp: 2025-12-24T01:05:45.130968
finish_reason: stop
---

информацию признакам изображения, без учета таких факторов, как освещенность. Мы воспользуемся этими признаками для разработки простого конвейера распознавания лиц, используя алгоритмы и идеи машинного обучения, которые мы обсуждали ранее в этой главе. Начнем с обычных импортов:

In[1]: %matplotlib inline
    import matplotlib.pyplot as plt
    import seaborn as sns; sns.set()
    import numpy as np

Признаки в методе HOG

Гистограмма направленных градиентов — простая процедура выделения признаков, разработанная для идентификации пешеходов на изображениях. Метод HOG включает следующие этапы.

1. Необязательная предварительная нормализация изображений. В результате получаются признаки, слабо зависящие от изменений освещенности.
2. Операция свертывания изображения с помощью двух фильтров, чувствительных к горизонтальным и вертикальным градиентам яркости. Это позволяет уловить информацию о границах, контурах и текстурах изображения.
3. Разбивка изображения на ячейки заранее определенного размера и вычисление гистограммы направлений градиентов в каждой из ячеек.
4. Нормализация гистограмм в каждой из ячеек путем сравнения с несколькими близлежащими ячейками. Это еще больше подавляет влияние освещенности на изображение.
5. Формирование одномерного вектора признаков из информации по каждой ячейке.

В проект Scikit-Image¹ встроена процедура выделения признаков на основе HOG, которую мы сможем достаточно быстро применить на практике и визуализировать направленные градиенты во всех ячейках (рис. 5.149):

In[2]: from skimage import data, color, feature
    import skimage.data

    image = color.rgb2gray(data.chelsea())
    hog_vec, hog_vis = feature.hog(image, visualise=True)

    fig, ax = plt.subplots(1, 2, figsize=(12, 6),
        subplot_kw=dict(xticks=[], yticks=[]))
    ax[0].imshow(image, cmap='gray')
    ax[0].set_title('input image')

¹ Для установки его в вашей системе выполните следующую команду:
conda install scikit-image