---
source_image: page_410.png
page_number: 410
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.07
tokens: 7481
characters: 1885
timestamp: 2025-12-24T01:01:57.521135
finish_reason: stop
---

In[4]: from sklearn.metrics import accuracy_score
    accuracy_score(y, y_model)

Out[4]: 1.0

Как видим, показатель точности равен 1.0, то есть наша модель правильно пометила 100% точек! Но действительно ли это правильная оценка ожидаемой точности? Действительно ли нам попалась модель, которая будет работать правильно в 100% случаев?

Как вы могли догадаться, ответ на этот вопрос — нет. На самом деле этот подход имеет фундаментальный изъян: обучение и оценка модели выполняются на одних и тех же данных! Более того, модель ближайшего соседа — оцениватель, работающий путем обучения на примерах (instance-based estimator), попросту сохраняющий обучающие данные и предсказывающий метки путем сравнения новых данных с этими сохраненными точками. За исключением некоторых специально сконструированных случаев его точность будет всегда равна 100%!

Хороший способ проверки модели: отложенные данные

Для более точного выяснения рабочих характеристик модели воспользуемся так называемыми отложенными наборами данных (holdout sets), то есть отложим некоторое подмножество данных из обучающей последовательности модели, после чего используем его для проверки качества работы модели. Это разделение в Scikit-Learn можно произвести с помощью утилиты train_test_split:

In[5]: from sklearn.cross_validation import train_test_split

# Разделяем данные: по 50% в каждом из наборов
X1, X2, y1, y2 = train_test_split(X, y, random_state=0, train_size=0.5)

# Обучаем модель на одном из наборов данных
model.fit(X1, y1)

# Оцениваем работу модели на другом наборе
y2_model = model.predict(X2)
accuracy_score(y2, y2_model)

Out[5]: 0.90666666666666662

Мы получили более логичный результат: классификатор на основе метода ближайшего соседа демонстрирует точность около 90% на этом отложенном наборе данных. Отложенный набор данных схож с неизвестными данными, поскольку модель «не видела» их ранее.