---
source_image: page_554.png
page_number: 554
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.69
tokens: 7551
characters: 2022
timestamp: 2025-12-24T01:05:40.248990
finish_reason: stop
---

которой размер обучающей последовательности максимален для каждого испытания перекрестной проверки:

In[11]: from sklearn.grid_search import GridSearchCV
    from sklearn.cross_validation import LeaveOneOut

    bandwidths = 10 ** np.linspace(-1, 1, 100)
    grid = GridSearchCV(KernelDensity(kernel='gaussian'),
        {'bandwidth': bandwidths},
        cv=LeaveOneOut(len(x)))
    grid.fit(x[:, None]);

Теперь можно узнать вариант ширины ядра, максимизирующий оценку эффективности модели (которая в этом случае по умолчанию представляет собой логарифмическую функцию правдоподобия):

In[12]: grid.best_params_

Out[12]: {'bandwidth': 1.1233240329780276}

Оптимальная ширина ядра оказалась очень близка к той, которую мы использовали выше в примере, где ширина была равно 1.0 (это ширина ядра по умолчанию объекта scipy.stats.norm).

Пример: KDE на сфере

Вероятно, чаще всего KDE используется для визуального представления распределений точек. Например, KDE встроен в библиотеку визуализации Seaborn (которую мы обсуждали в разделе «Визуализация с помощью пакета Seaborn» главы 4) и применяется там автоматически для визуализации точек в одномерном и двумерном пространствах.

В этом разделе мы рассмотрим несколько более сложный сценарий использования KDE для визуализации распределений. Воспользуемся следующими географическими данными, которые можно загрузить с помощью библиотеки Scikit-Learn: географическое распределение зафиксированных наблюдений особей двух южноамериканских млекопитающих — Bradypus variegatus (бурогорлый ленивец) и Microryzomys minutus (маляя лесная рисовая крыса).

Извлечем данные с помощью библиотеки Scikit-Learn следующим образом¹:

In[13]: from sklearn.datasets import fetch_species_distributions

¹ В апреле 2017 года этот набор данных был перемещен на другой сайт, что привело к неработоспособности данного кода в текущей версии библиотеки Scikit-Learn, но соответствующие изменения планируются к внесению в самое ближайшее время и должны быть доступны на момент выхода данной книги.