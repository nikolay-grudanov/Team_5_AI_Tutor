---
source_image: page_177.png
page_number: 177
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.36
tokens: 7629
characters: 1726
timestamp: 2025-12-24T00:55:55.755689
finish_reason: stop
---

столбцов. Это можно сделать с помощью метода set_index объекта DataFrame, возвращающего мультииндексированный объект DataFrame:

In[42]: pop_flat.set_index(['state', 'year'])

Out[42]:
population
      state   year
California  2000    33871648
            2010    37253956
New York    2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561

На практике, я полагаю, этот тип перестройки индекса — один из самых удобных паттернов при работе с реальными наборами данных.

Агрегирование по мультииндексам

В библиотеке Pandas имеются встроенные методы для агрегирования данных, например mean(), sum() и max(). В случае иерархически индексированных данных им можно передать параметр level для указания подмножества данных, на котором будет вычисляться сводный показатель.

Например, вернемся к нашим медицинским данным:

In[43]: health_data

Out[43]: subject    Bob    Guido    Sue
         type      HR     Temp     HR     Temp     HR     Temp
         year visit
2013  1        31.0   38.7    32.0   36.7    35.0   37.2
      2        44.0   37.7    50.0   35.0    29.0   36.7
2014  1        30.0   37.4    39.0   37.8    61.0   36.9
      2        47.0   37.8    48.0   37.3    51.0   36.5

Допустим, нужно усреднить результаты измерений показателей по двум визитам в течение года. Сделать это можно путем указания уровня индекса, который мы хотели бы исследовать, в данном случае года (year):

In[44]: data_mean = health_data.mean(level='year')
data_mean

Out[44]: subject    Bob    Guido    Sue
         type      HR     Temp     HR     Temp     HR     Temp
         year
2013      37.5   38.2    41.0   35.85   32.0   36.95
2014      38.5   37.6    43.5   37.55   56.0   36.70