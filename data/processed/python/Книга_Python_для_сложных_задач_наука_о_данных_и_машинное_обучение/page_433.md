---
source_image: page_433.png
page_number: 433
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.24
tokens: 7544
characters: 2052
timestamp: 2025-12-24T01:02:30.180518
finish_reason: stop
---

methods), которые мы рассмотрим в разделе «Заглянем глубже: метод опорных векторов» текущей главы.

Внесение отсутствующих данных

Еще одна часто встречающаяся задача в проектировании признаков — обработка отсутствующих данных. Мы уже обсуждали этот вопрос в объектах DataFrame в разделе «Обработка отсутствующих данных» главы 3 и видели, что отсутствующие данные часто помечаются значением NaN. Например, наш набор данных может выглядеть следующим образом:

In[14]: from numpy import nan
    X = np.array([[ nan, 0,   3  ],
                  [ 3,   7,   9  ],
                  [ 3,   5,   2  ],
                  [ 4,   nan, 6  ],
                  [ 8,   8,   1  ]])
    y = np.array([14, 16, -1,  8, -5])

При использовании для подобных данных типичной модели машинного обучения необходимо сначала заменить отсутствующие данные каким-либо подходящим значением. Это действие называется заполнением (imputation) пропущенных значений, и методики его выполнения варьируются от простых (например, замены пропущенных значений средним значением по столбцу) до сложных (например, с использованием восстановления матриц (matrix completion) или ошибкоустойчивого алгоритма для обработки подобных данных).

Сложные подходы, как правило, очень сильно зависят от конкретной прикладной задачи, и мы не станем углубляться в них. Для реализации стандартного подхода к заполнению пропущенных значений (с использованием среднего значения, медианы или часто встречающегося значения) библиотека Scikit-Learn предоставляет класс Imputer:

In[15]: from sklearn.preprocessing import Imputer
    imp = Imputer(strategy='mean')
    X2 = imp.fit_transform(X)
    X2

Out[15]: array([[ 4.5,  0. ,  3. ],
                [ 3. ,  7. ,  9. ],
                [ 3. ,  5. ,  2. ],
                [ 4. ,  5. ,  6. ],
                [ 8. ,  8. ,  1. ]])

В результате мы получили данные, в которых два пропущенные значения заменены на среднее значение остальных элементов соответствующего столбца. Эти данные можно передать, например, непосредственно оценивателю LinearRegression: