---
source_image: page_207.png
page_number: 207
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.78
tokens: 7573
characters: 1865
timestamp: 2025-12-24T00:56:39.560532
finish_reason: stop
---

набора данных, преобразованную ради дальнейшей их перекомпоновки. При подобном преобразовании форма выходных данных совпадает с формой входных. Распространенный пример — центрирование данных путем вычитания среднего значения по группам:

In[23]: df.groupby('key').transform(lambda x: x - x.mean())

Out[23]:   data1  data2
      0    -1.5     1.0
      1    -1.5    -3.5
      2    -1.5    -3.0
      3     1.5    -1.0
      4     1.5     3.5
      5     1.5     3.0

Метод apply(). Метод apply() позволяет применять произвольную функцию к результатам группировки. В качестве параметра эта функция должна получать объект DataFrame, а возвращать или объект библиотеки Pandas (например, DataFrame, Series), или скалярное значение, в зависимости от возвращаемого значения будет вызвана соответствующая операция объединения.

Например, функция apply(), нормирующая первый столбец на сумму значений второго:

In[24]: def norm_by_data2(x):
    # x – объект DataFrame сгруппированных значений
    x['data1'] /= x['data2'].sum()
    return x
print(df); print(df.groupby('key').apply(norm_by_data2))

df
  key  data1  data2
0  A      0      5
1  B      1      0
2  C      2      3
3  A      3      3
4  B      4      7
5  C      5      9

df.groupby('key').apply(norm_by_data2)
  key  data1  data2
0  A  0.000000  5
1  B  0.142857  0
2  C  0.166667  3
3  A  0.375000  3
4  B  0.571429  7
5  C  0.416667  9

Функция apply() в GroupBy достаточно гибка. Единственное требование, чтобы она принимала на входе объект DataFrame и возвращала объект библиотеки Pandas или скалярное значение; что вы делаете внутри, остается на ваше усмотрение!

Задание ключа разбиения

В представленных ранее простых примерах мы разбивали объект DataFrame по одному столбцу. Это лишь один из многих вариантов задания принципа формирования групп, и мы сейчас рассмотрим некоторые другие возможности.