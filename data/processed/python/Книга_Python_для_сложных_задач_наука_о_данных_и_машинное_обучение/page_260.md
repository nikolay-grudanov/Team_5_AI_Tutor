---
source_image: page_260.png
page_number: 260
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.44
tokens: 7601
characters: 2284
timestamp: 2025-12-24T00:58:12.713149
finish_reason: stop
---

выражения с применением массивов NumPy или объектов DataFrame библиотеки Pandas приводят к неявному созданию временных массивов. Например, вот это:

In[26]: x = df[(df.A < 0.5) & (df.B < 0.5)]

приблизительно соответствует следующему:

In[27]: tmp1 = df.A < 0.5
        tmp2 = df.B < 0.5
        tmp3 = tmp1 & tmp2
        x = df[tmp3]

Если размер временных объектов DataFrame существенен по сравнению с доступной оперативной памятью вашей системы (обычно несколько гигабайтов), то будет разумно воспользоваться выражениями eval() или query(). Выяснить приблизительный размер массива в байтах можно с помощью следующего оператора:

In[28]: df.values.nbytes

Out[28]: 32000

eval() будет работать быстрее, если вы не используете всю доступную в системе оперативную память. Основную роль играет отношение размера временных объектов DataFrame по сравнению с размером L1 или L2 кэша процессора в системе (в 2016 году он составляет несколько мегабайтов). eval() позволяет избежать потенциально медленного перемещения значений между различными кэшами памяти в том случае, когда это отношение намного больше 1. Я обнаружил, что на практике различие в скорости вычислений между традиционными методами и методом eval/query обычно довольно незначительно. Напротив, традиционный метод работает быстрее для маленьких массивов! Преимущество метода eval/query заключается в экономии оперативной памяти и иногда — в более понятном синтаксисе.

Мы рассмотрели большинство нюансов работы с методами eval() и query(), дополнительную информацию можно найти в документации по библиотеке Pandas. В частности, можно задавать для работы этих запросов различные синтаксические анализаторы и механизмы. Подробности — в разделе Enhancing Performance («Повышение производительности», http://pandas.pydata.org/pandas-docs/dev/enhancingperf.html).

Дополнительные источники информации

В этой главе мы охватили большую часть основ эффективного использования библиотеки Pandas для анализа данных. Чтобы изучить библиотеку Pandas глубже, я бы рекомендовал обратиться к следующим источникам информации.

Онлайн-документация библиотеки Pandas (http://pandas.pydata.org/). Это всесторонний источник документации по данному пакету. Хотя примеры в документации обычно представляют собой небольшие сгенерированные наборы