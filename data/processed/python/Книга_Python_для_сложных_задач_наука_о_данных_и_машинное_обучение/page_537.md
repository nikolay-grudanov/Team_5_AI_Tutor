---
source_image: page_537.png
page_number: 537
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 26.67
tokens: 7362
characters: 1381
timestamp: 2025-12-24T01:05:08.510008
finish_reason: stop
---

• \( E\text{-шаг} \) — для каждой точки находит веса, кодирующие вероятность ее принадлежности к каждому кластеру;
• \( M\text{-шаг} \) — для каждого кластера корректирует его расположение, нормализацию и форму на основе информации обо всех точках данных с учетом весов.

В результате каждый кластер оказывается связан не со сферой с четкой границей, а с гладкой Гауссовой моделью. Аналогично подходу максимизации математического ожидания из метода \( k \)-средних этот алгоритм иногда может промахиваться мимо наилучшего из возможных решений, поэтому на практике применяют несколько случайных наборов начальных значений.

![Вероятностные метки GMM](https://i.imgur.com/3Q5z5QG.png)

Рис. 5.128. Вероятностные метки GMM

Создадим функцию для упрощения визуализации расположений и форм кластеров метода GMM путем рисования эллипсов на основе получаемой на выходе gmm информации:

In[10]:
from matplotlib.patches import Ellipse

def draw_ellipse(position, covariance, ax=None, **kwargs):
    """Рисует эллипс с заданными расположением и ковариацией"""
    ax = ax or plt.gca()

    # Преобразуем ковариацию к главным осям координат
    if covariance.shape == (2, 2):
        U, s, Vt = np.linalg.svd(covariance)
        angle = np.degrees(np.arctan2(U[1, 0], U[0, 0]))
        width, height = 2 * np.sqrt(s)
    else:
        angle = 0
        width, height = 2 * np.sqrt(covariance)