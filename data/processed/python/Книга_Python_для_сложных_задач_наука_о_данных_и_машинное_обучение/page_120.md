---
source_image: page_120.png
page_number: 120
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 19.52
tokens: 7323
characters: 1156
timestamp: 2025-12-24T00:54:30.949376
finish_reason: stop
---

посередине» данной главы), предоставляемыми библиотекой NumPy, мы можем вычислить матрицу квадратов расстояний с помощью одной строки кода:

In[16]: dist_sq = np.sum((X[:,np.newaxis,:] - X[np.newaxis,:,:]) ** 2, axis=-1)

![Визуализация точек в примере K соседей](../images/ch2_10.png)

Рис. 2.10. Визуализация точек в примере К соседей

Эта операция довольно сложна по синтаксису и может привести вас в замешательство, если вы плохо знакомы с правилами трансляирования библиотеки NumPy. В подобных случаях полезно разбить операцию на отдельные шаги:

In[17]: # Для каждой пары точек вычисляем разности их координат
    differences = X[:, np.newaxis, :] - X[np.newaxis, :, :]
    differences.shape

Out[17]: (10, 10, 2)

In[18]: # Возведим разности координат в квадрат
    sq_differences = differences ** 2
    sq_differences.shape

Out[18]: (10, 10, 2)

In[19]: # Суммируем квадраты разностей координат
    # для получения квадрата расстояния
    dist_sq = sq_differences.sum(-1)
    dist_sq.shape

Out[19]: (10, 10)

На всякий случай для контроля проверим, что диагональ матрицы (то есть набор расстояний между каждой точкой и ей самой) состоит из нулей: