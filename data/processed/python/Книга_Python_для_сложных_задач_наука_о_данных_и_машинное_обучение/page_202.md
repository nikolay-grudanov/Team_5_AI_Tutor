---
source_image: page_202.png
page_number: 202
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 24.25
tokens: 7480
characters: 1898
timestamp: 2025-12-24T00:56:30.036743
finish_reason: stop
---

каждой группы. Мощь операции GroupBy состоит в абстрагировании этих шагов: пользователю не нужно заботиться о том, как фактически выполняются вычисления, а можно вместо этого думать об операции в целом.

В качестве примера рассмотрим использование библиотеки Pandas для выполнения показанных на рис. 3.1 вычислений. Начнем с создания входного объекта DataFrame:

In[11]: df = pd.DataFrame({'key': ['A', 'B', 'C', 'A', 'B', 'C'],
                           'data': range(6)}, columns=['key', 'data'])
    df

Out[11]:   key  data
      0    A    0
      1    B    1
      2    C    2
      3    A    3
      4    B    4
      5    C    5

Простейшую операцию «разбить, применить, объединить» можно реализовать с помощью метода groupby() объекта DataFrame, передав в него имя желаемого ключевого столбца:

In[12]: df.groupby('key')

Out[12]: <pandas.core.groupby.DataFrameGroupBy object at 0x117272160>

Обратите внимание, что возвращаемое — не набор объектов DataFrame, а объект DataFrameGroupBy. Этот объект особенный, его можно рассматривать как специальное представление объекта DataFrame, готовое к группировке, но не выполняющее никаких фактических вычислений до этапа применения агрегирования. Подобный метод «отложенного вычисления» означает возможность очень эффективной реализации распространенных агрегирующих функций, причем практически прозрачным для пользователя образом.

Для получения результата можно вызвать один из агрегирующих методов этого объекта DataFrameGroupBy, что приведет к выполнению соответствующих шагов применения/объединения:

In[13]: df.groupby('key').sum()

Out[13]:    data
      key
      A    3
      B    5
      C    7

Метод sum() — лишь один из возможных вариантов в этой команде. Здесь можно использовать практически любую распространенную агрегирующую функцию библиотек Pandas или NumPy, равно как и практически любую корректную операцию объекта DataFrame.