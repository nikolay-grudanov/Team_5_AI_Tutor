---
source_image: page_259.png
page_number: 259
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.02
tokens: 7469
characters: 1847
timestamp: 2025-12-24T00:58:04.218109
finish_reason: stop
---

Символ @ отмечает имя переменной, а не имя столбца, позволяя тем самым эффективно вычислять значение выражений с использованием двух пространств имен: пространства имен столбцов и пространства имен объектов Python. Обратите внимание, что этот символ @ поддерживается лишь методом DataFrame.eval(), но не функцией pandas.eval(), поскольку у функции pandas.eval() есть доступ только к одному пространству имен (языка Python).

Метод DataFrame.query()

У объектов DataFrame есть еще один метод, основанный на вычислении строк, именуемый query(). Рассмотрим следующее:

In[23]: result1 = df[(df.A < 0.5) & (df.B < 0.5)]
    result2 = pd.eval('df[(df.A < 0.5) & (df.B < 0.5)]')
    np.allclose(result1, result2)

Out[23]: True

Как и в случае с примером, который мы использовали при обсуждении метода DataFrame.eval(), перед нами выражение, содержащее столбцы объекта DataFrame. Однако его нельзя выразить с помощью синтаксиса метода DataFrame.eval()! Вместо него для подобных операций фильтрации можно воспользоваться методом query():

In[24]: result2 = df.query('A < 0.5 and B < 0.5')
    np.allclose(result1, result2)

Out[24]: True

Он не только обеспечивает, по сравнению с выражениями маскирования, более эффективные вычисления, но и намного понятнее и легче читается. Обратите внимание, что метод query() также позволяет использовать флаг @ для обозначения локальных переменных:

In[25]: Cmean = df['C'].mean()
    result1 = df[(df.A < Cmean) & (df.B < Cmean)]
    result2 = df.query('A < @Cmean and B < @Cmean')
    np.allclose(result1, result2)

Out[25]: True

Производительность: когда следует использовать эти функции

В процессе принятия решения применять ли эти функции обратите внимание на два момента: процессорное время и объем используемой памяти. Предсказать объем используемой памяти намного проще. Как уже упоминалось, все составные