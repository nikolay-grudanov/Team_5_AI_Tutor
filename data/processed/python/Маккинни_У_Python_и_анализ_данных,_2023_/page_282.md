---
source_image: page_282.png
page_number: 282
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.82
tokens: 8198
characters: 2237
timestamp: 2025-12-24T02:48:26.419638
finish_reason: stop
---

столбцов date и item обычно выступает в роли первичного ключа (в терминологии реляционных баз данных), благодаря которому обеспечивается целостность данных и упрощаются многие операции соединения. Иногда с данными в таком формате трудно работать; предпочтительнее иметь объект DataFrame, содержащий по одному столбцу на каждое уникальное значение item и проиндексированный временными метками в столбце date. Метод pivot объекта DataFrame именно такое преобразование и выполняет:

In [156]: pivoted = long_data.pivot(index="date", columns="item", values="value")
.....:
    values="value")

In [157]: pivoted.head()
Out[157]:
      infl   realgdp   unemp
date
1959-01-01  0.00  2710.349  5.8
1959-04-01  2.34  2778.801  5.1
1959-07-01  2.74  2775.488  5.3
1959-10-01  0.27  2785.204  5.6
1960-01-01  2.31  2847.699  5.2

Первые два аргумента — столбцы, которые будут выступать в роли индексов строк и столбцов, а последний необязательный аргумент — столбец, в котором находятся данные, вставляемые в DataFrame. Допустим, что имеется два столбца значений, форму которых требуется изменить одновременно:

In [158]: long_data["value2"] = np.random.standard_normal(len(long_data))

In [159]: long_data[:10]
Out[159]:
      date   item   value   value2
0  1959-01-01  realgdp  2710.349  0.802926
1  1959-01-01     infl   0.000  0.575721
2  1959-01-01   unemp   5.800  1.381918
3  1959-04-01  realgdp  2778.801  0.000992
4  1959-04-01     infl   2.340 -0.143492
5  1959-04-01   unemp   5.100 -0.206282
6  1959-07-01  realgdp  2775.488 -0.222392
7  1959-07-01     infl   2.740 -1.682403
8  1959-07-01   unemp   5.300  1.811659
9  1959-10-01  realgdp  2785.204 -0.351305

Опустив последний аргумент, мы получим DataFrame с иерархическими столбцами:

In [160]: pivoted = long_data.pivot(index="date", columns="item")

In [161]: pivoted.head()
Out[161]:
      value   value2
      infl   realgdp   unemp   infl   realgdp   unemp
item
date
1959-01-01  0.00  2710.349  5.8  0.575721  0.802926  1.381918
1959-04-01  2.34  2778.801  5.1 -0.143492  0.000992 -0.206282
1959-07-01  2.74  2775.488  5.3 -1.682403 -0.222392  1.811659
1959-10-01  0.27  2785.204  5.6  0.128317 -0.351305 -1.313554
1960-01-01  2.31  2847.699  5.2 -0.615939  0.498327  0.174072