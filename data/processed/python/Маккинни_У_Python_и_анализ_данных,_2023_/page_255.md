---
source_image: page_255.png
page_number: 255
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 24.75
tokens: 7563
characters: 1536
timestamp: 2025-12-24T02:46:57.215443
finish_reason: stop
---

Глава 8

Переформатирование данных: соединение, комбинирование и изменение формы

Во многих приложениях бывает, что данные разбросаны по многим файлам или базам данных либо организованы так, что их трудно проанализировать. Эта глава посвящена средствам комбинирования, соединения и реорганизации данных.

Сначала мы познакомимся с концепцией иерархического индексирования в pandas, которая широко применяется в некоторых из описываемых далее операций. А затем перейдем к деталям конкретных манипуляций данными. В главе 13 будут продемонстрированы различные применения этих средств.

8.1. ИЕРАРХИЧЕСКОЕ ИНДЕКСИРОВАНИЕ

Иерархическое индексирование — важная особенность pandas, позволяющая организовать несколько (два и более) уровней индексирования по одной оси. Под другому можно сказать, что это способ работать с многомерными данными, представив их в форме меньшей размерности. Начнем с простого примера — создадим объект Series с индексом в виде списка списков или массивов:

In [11]: data = pd.Series(np.random.uniform(size=9),
    ....: index=[["a", "a", "a", "b", "b", "c", "c", "d", "d"],
    ....: [1, 2, 3, 1, 3, 1, 2, 2, 3]])
In [12]: data
Out[12]:
   a    1    0.929616
        2    0.316376
        3    0.183919
   b    1    0.204560
        3    0.567725
   c    1    0.595545
        2    0.964515
   d    2    0.653177
        3    0.748907
dtype: float64

Здесь мы видим отформатированное представление Series с мультииндексом (MultiIndex). «Разрывы» в представлении индекса означают «взять значение вышестоящей метки».