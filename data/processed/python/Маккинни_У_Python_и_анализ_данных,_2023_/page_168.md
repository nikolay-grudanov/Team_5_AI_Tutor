---
source_image: page_168.png
page_number: 168
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.92
tokens: 7749
characters: 1497
timestamp: 2025-12-24T02:44:38.694271
finish_reason: stop
---

сутствующая позиция. В примере ниже мы записываем в элемент специальный признак отсутствия, присваивая ему значение np.nan:

In [197]: df1 = pd.DataFrame(np.arange(12.).reshape((3, 4)),
.....: columns=list("abcd"))

In [198]: df2 = pd.DataFrame(np.arange(20.).reshape((4, 5)),
.....: columns=list("abcde"))

In [199]: df2.loc[1, "b"] = np.nan

In [200]: df1
Out[200]:
    a   b   c   d
0  0.0  1.0  2.0  3.0
1  4.0  5.0  6.0  7.0
2  8.0  9.0 10.0 11.0

In [201]: df2
Out[201]:
     a   b   c   d   e
0  0.0  1.0  2.0  3.0  4.0
1  5.0  NaN  7.0  8.0  9.0
2 10.0 11.0 12.0 13.0 14.0
3 15.0 16.0 17.0 18.0 19.0

Сложение этих объектов порождает отсутствующие значения в позициях, которые имеются не в обоих операндах:

In [202]: df1 + df2
Out[202]:
     a   b   c   d   e
0  0.0  2.0  4.0  6.0  NaN
1  9.0  NaN 13.0 15.0  NaN
2 18.0 20.0 22.0 24.0  NaN
3  NaN  NaN  NaN  NaN  NaN

Теперь я вызову метод add объекта df1 и передам ему объект df2 и значение параметра fill_value. В результате все отсутствующие значения будут заменены переданным:

In [203]: df1.add(df2, fill_value=0)
Out[203]:
     a   b   c   d   e
0  0.0  2.0  4.0  6.0  4.0
1  9.0  5.0 13.0 15.0  9.0
2 18.0 20.0 22.0 24.0 14.0
3 15.0 16.0 17.0 18.0 19.0

В табл. 5.5 приведен перечень арифметических методов объектов Series и DataFrame. У каждого из них имеется вариант, начинающийся буквой r, в котором аргументы переставлены местами. Поэтому следующие два предложения эквивалентны:

In [204]: 1 / df1
Out[204]:
     a   b   c   d