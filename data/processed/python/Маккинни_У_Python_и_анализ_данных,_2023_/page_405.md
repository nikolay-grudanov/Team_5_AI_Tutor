---
source_image: page_405.png
page_number: 405
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.76
tokens: 7616
characters: 1606
timestamp: 2025-12-24T02:51:25.947377
finish_reason: stop
---

1    -0.10
1     5.00
Terms:
'Intercept' (column 0)
'I(x0 + x1)' (column 1)

В Patsy встроены и другие преобразования, находящиеся в модуле patsy.builtins. Дополнительные сведения см. в онлайновой документации.
Для категориальных данных имеется специальный класс преобразований, о котором я расскажу ниже.

Категориальные данные и Patsy
Нечисловые данные можно преобразовать для использования в матрице плана модели многими способами. Полное рассмотрение этой темы выходит за рамки книги и относится скорее к курсу математической статистики.
Когда в формуле Patsy встречаются нечисловые члены, они по умолчанию преобразуются в фиктивные переменные. Если имеется свободный член, то один из уровней будет пропущен, чтобы избежать коллинеарности:

In [51]: data = pd.DataFrame({
    ...:     'key1': ['a', 'a', 'b', 'b', 'a', 'b', 'a', 'b'],
    ...:     'key2': [0, 1, 0, 1, 0, 1, 0, 0],
    ...:     'v1': [1, 2, 3, 4, 5, 6, 7, 8],
    ...:     'v2': [-1, 0, 2.5, -0.5, 4.0, -1.2, 0.2, -1.7]
    ...: })

In [52]: y, X = patsy.dmatrices('v2 ~ key1', data)

In [53]: X
Out[53]:
DesignMatrix with shape (8, 2)
  Intercept   key1[T.b]
    1         0
    1         0
    1         1
    1         0
    1         1
    1         0
    1         1
Terms:
'Intercept' (column 0)
'key1' (column 1)

Если исключить из модели свободный член, то столбцы, соответствующие каждому значению категории, будут включены в модельную матрицу плана:

In [54]: y, X = patsy.dmatrices('v2 ~ key1 + 0', data)

In [55]: X
Out[55]:
DesignMatrix with shape (8, 2)
  key1[a]   key1[b]
    1         0
    1         0
    0         1