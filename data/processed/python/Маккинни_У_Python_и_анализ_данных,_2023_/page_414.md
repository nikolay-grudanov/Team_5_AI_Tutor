---
source_image: page_414.png
page_number: 414
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.52
tokens: 7657
characters: 2179
timestamp: 2025-12-24T02:51:46.282421
finish_reason: stop
---

Так же, как в statsmodels, мы можем обучить модель на обучающих данных с помощью метода модели fit:

In [105]: model.fit(X_train, y_train)
Out[105]: LogisticRegression()

Теперь можно вычислить предсказания для тестового набора данных методом model.predict:

In [106]: y_predict = model.predict(X_test)

In [107]: y_predict[:10]
Out[107]: array([0, 0, 0, 0, 1, 0, 1, 0, 1, 0])

Если бы мы знали истинные значения для тестового набора, то могли бы вычислить верность в процентах или еще какую-нибудь метрику ошибки:

(y_true == y_predict).mean()

На практике обучение модели гораздо сложнее. У многих моделей есть настраиваемые параметры, и существуют такие приемы, как перекрестный контроль, позволяющие избежать переобучения модели. Их использование часто повышает предсказательную способность или робастность модели на новых данных.

Идея перекрестного контроля состоит в том, чтобы разделить обучающий набор на две части с целью смоделировать предсказание на не предъявлявшихся модели данных. Взяв за основу какую-нибудь оценку верности модели, например среднеквадратическую ошибку, можно произвести подбор параметров модели путем поиска на сетке. Для некоторых моделей, в частности логистической регрессии, существуют классы оценивания, в которые перекрестный контроль уже встроен. Например, класс LogisticRegressionCV можно использовать, задав в качестве параметра мелкость сетки, на которой производится поиск регуляризующего параметра модели C:

In [108]: from sklearn.linear_model import LogisticRegressionCV

In [109]: model_cv = LogisticRegressionCV(Cs=10)

In [110]: model_cv.fit(X_train, y_train)
Out[110]: LogisticRegressionCV()

Чтобы выполнить перекрестный контроль вручную, можно воспользоваться вспомогательной функцией cross_val_score, которая отвечает за процесс разделения данных. Например, чтобы подвергнуть нашу модель перекрестному контролю, разбив обучающий набор на четыре непересекающиеся части, нужно написать:

In [111]: from sklearn.model_selection import cross_val_score

In [112]: model = LogisticRegression(C=10)

In [113]: scores = cross_val_score(model, X_train, y_train, cv=4)

In [114]: scores
Out[114]: array([0.7758, 0.7982, 0.7758, 0.7883])