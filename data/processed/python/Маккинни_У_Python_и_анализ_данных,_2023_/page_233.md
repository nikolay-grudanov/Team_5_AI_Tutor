---
source_image: page_233.png
page_number: 233
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.10
tokens: 7641
characters: 2182
timestamp: 2025-12-24T02:46:20.920624
finish_reason: stop
---

7.3. Расширение типов данных

Это сравнительно новое дополнение к pandas, которое большинству пользователей вряд ли пригодится, но я включил его для полноты картины, поскольку ниже в нескольких местах буду ссылаться на расширенных типы и использовать их.

Pandas первоначально основывалась на возможностях библиотеки NumPy, которая эффективно реализует операции с массивами и предназначена в первую очередь для работы с числовыми данными. Многие концепции, заложенные в pandas, в частности отсутствующих данных, были реализованы на базе уже имеющегося в NumPy, при этом были приложены все усилия для сохранения максимальной совместимости с библиотеками, которые одновременно использовали NumPy и pandas.

Построение на базе NumPy стало причиной ряда недостатков, в том числе:
○ обработка отсутствия данных некоторых типов, например целых и булевых, была неполной. Поэтому при наличии пропусков в таких данных pandas преобразовывала их тип в float64 и использовала для представления отсутствующих значений np.nan. Это приводило к кумулятивному эффекту из-за тонких проблем во многих алгоритмах pandas;
○ обработка наборов, содержащих много строковых данных, была вычислительно неэффективной и потребляла много памяти;
○ некоторые типы данных, в т. ч. временные интервалы, временные дельты и временные метки с часовыми поясами, невозможно было поддержать эффективно, не используя массивов объектов Python, операции с которыми обходятся дорого.

Недавно в pandas была добавлена система расширения типов, позволяющая добавлять новые типы, не поддерживаемые NumPy. С данными таких типов данных можно работать точно так же, как с данными, происходящими из массивов NumPy.

Рассмотрим пример создания объекта Series, содержащего целые числа с одним отсутствующим значением:

In [133]: s = pd.Series([1, 2, 3, None])

In [134]: s
Out[134]:
0    1.0
1    2.0
2    3.0
3    NaN
dtype: float64

In [135]: s.dtype
Out[135]: dtype('float64')

Главным образом из соображений обратной совместимости Series сохраняет унаследованное поведение: использование типа float64 и np.nan для представления отсутствующих значений. Этот объект Series можно было бы также создать, указав тип pandas.Int64Dtype: