---
source_image: page_261.png
page_number: 261
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 25.28
tokens: 7537
characters: 1619
timestamp: 2025-12-24T02:47:07.017664
finish_reason: stop
---

8.2. Комбинирование и слияние наборов данных

Данные, хранящиеся в объектах pandas, можно комбинировать различными способами.

pandas.merge
Соединяет строки объектов DataFrame по одному или нескольким ключам.
Эта операция хорошо знакома пользователям реляционных баз данных.

pandas.concat
Конкатенирует объекты, располагая их в стопку вдоль оси.

combine_first
Сращивает перекрывающиеся данные, чтобы заполнить отсутствующие в одном объекте данные значениями из другого объекта.

Я рассмотрю эти способы на многочисленных примерах. Мы будем неоднократно пользоваться ими в последующих главах.

Слияние объектов DataFrame как в базах данных

Операция слияния, или соединения, комбинирует наборы данных, соединяя строки по одному или нескольким ключам. Эта операция является одной из основных в базах данных. Функция pandas.merge — портал ко всем алгоритмам такого рода.

Начнем с простого примера:

In [38]: df1 = pd.DataFrame({"key": ["b", "b", "a", "c", "a", "a", "b"], "data1": pd.Series(range(7), dtype="Int64")})

In [39]: df2 = pd.DataFrame({"key": ["a", "b", "d"], "data2": pd.Series(range(3), dtype="Int64")})

In [40]: df1
Out[40]:
   key  data1
0   b     0
1   b     1
2   a     2
3   c     3
4   a     4
5   a     5
6   b     6

In [41]: df2
Out[41]:
   key  data2
0   a     0
1   b     1
2   d     2

Здесь я использовал расширенный тип Int64 для целых, допускающих null; он обсуждается в разделе 7.3.

Это пример соединения типа многие к одному; в объекте df1 есть несколько строк с метками a и b, а в df2 — только одна строка для каждого значения в столбце key. Вызов pandas.merge для таких объектов дает: