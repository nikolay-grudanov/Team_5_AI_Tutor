---
source_image: page_368.png
page_number: 368
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.97
tokens: 7733
characters: 1519
timestamp: 2025-12-24T02:50:17.950695
finish_reason: stop
---

Поскольку наивный сдвиг не изменяет индекс, некоторые данные отбрасываются. Но если известна частота, то ее можно передать методу shift, чтобы сдвинуть вперед временные метки, а не сами данные:

In [95]: ts.shift(2, freq="M")
Out[95]:
2000-03-31   -0.066748
2000-04-30    0.838639
2000-05-31   -0.117388
2000-06-30   -0.517795
Freq: M, dtype: float64

Можно указывать и другие частоты, что позволяет гибко смещать данные в прошлое и в будущее:

In [96]: ts.shift(3, freq="D")
Out[96]:
2000-02-03   -0.066748
2000-03-03    0.838639
2000-04-03   -0.117388
2000-05-03   -0.517795
dtype: float64

In [97]: ts.shift(1, freq="90T")
Out[97]:
2000-01-31 01:30:00   -0.066748
2000-02-29 01:30:00    0.838639
2000-03-31 01:30:00   -0.117388
2000-04-30 01:30:00   -0.517795
dtype: float64

Здесь T обозначает минуты. Отметим, что параметр freq задает смещение, применяемое к временным меткам, но истинная частота данных (если таковая присутствует) при этом не изменяется.

Сдвиг дат с помощью смещений
Смещения дат можно также использовать совместно с объектами datetime и Timestamp:

In [98]: from pandas.tseries.offsets import Day, MonthEnd

In [99]: now = datetime(2011, 11, 17)

In [100]: now + 3 * Day()
Out[100]: Timestamp('2011-11-20 00:00:00')

В случае привязанного смещения, например MonthEnd, первое сложение с ним продвинет дату до следующей даты с соответствующей привязкой:

In [101]: now + MonthEnd()
Out[101]: Timestamp('2011-11-30 00:00:00')

In [102]: now + MonthEnd(2)
Out[102]: Timestamp('2011-12-31 00:00:00')