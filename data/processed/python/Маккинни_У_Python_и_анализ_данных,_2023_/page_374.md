---
source_image: page_374.png
page_number: 374
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.07
tokens: 7912
characters: 1905
timestamp: 2025-12-24T02:50:32.946823
finish_reason: stop
---

2012-03-15 09:30:00   -0.922839
2012-03-16 09:30:00    0.312656
2012-03-19 09:30:00   -1.128497
2012-03-20 09:30:00   -0.333488
Freq: B, dtype: float64

In [144]: ts1 = ts[:7].tz_localize("Europe/London")

In [145]: ts2 = ts1[2:].tz_convert("Europe/Moscow")

In [146]: result = ts1 + ts2

In [147]: result.index
Out[147]:
DatetimeIndex(['2012-03-07 09:30:00+00:00', '2012-03-08 09:30:00+00:00',
               '2012-03-09 09:30:00+00:00', '2012-03-12 09:30:00+00:00',
               '2012-03-13 09:30:00+00:00', '2012-03-14 09:30:00+00:00',
               '2012-03-15 09:30:00+00:00'],
              dtype='datetime64[ns, UTC]', freq=None)

Операции между объектами, учитывающими и не учитывающими часовой пояс, не поддерживаются и приводят к исключению.

11.5. ПЕРИОДЫ И АРИФМЕТИКА ПЕРИОДОВ

Периоды — это промежутки времени: дни, месяцы, кварталы, годы. Этот тип данных представлен классом pandas.Period, конструктор которого принимает строку или число и поддерживаемую частоту из табл. 11.4:

In [148]: p = pd.Period("2011", freq="A-DEC")

In [149]: p
Out[149]: Period('2011', 'A-DEC')

В данном случае объект Period представляет промежуток времени от 1 января 2007 до 31 декабря 2011 включительно. Сложение и вычитание периода и целого числа дают тот же результат, что сдвиг на величину, кратную частоте периода:

In [150]: p + 5
Out[150]: Period('2016', 'A-DEC')

In [151]: p - 2
Out[151]: Period('2009', 'A-DEC')

Если у двух периодов одинаковая частота, то их разностью является количество единиц между ними, выраженное в виде смещения даты:

In [152]: pd.Period("2014", freq="A-DEC") - p
Out[152]: <3 * YearEnds: month=12>

Регулярные диапазоны периодов строятся с помощью функции period_range:

In [153]: periods = pd.period_range("2000-01-01", "2000-06-30", freq="M")

In [154]: periods
Out[154]: PeriodIndex(['2000-01', '2000-02', '2000-03', '2000-04', '2000-05', '2000-06'], dtype='period[M]')