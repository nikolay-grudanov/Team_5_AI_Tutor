---
source_image: page_319.png
page_number: 319
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 24.02
tokens: 7453
characters: 1574
timestamp: 2025-12-24T02:48:39.607397
finish_reason: stop
---

Как и в других главах, начнем с импорта NumPy и pandas:

In [12]: import numpy as np

In [13]: import pandas as pd

10.1. Как представлять себе групповые операции

Хэдли Уикхэм (Hadley Wickham), автор многих популярных пакетов на языке программирования R, предложил для групповых операций термин разделение–применение–объединение, который, как мне кажется, удачно описывает процесс. На первом этапе данные, хранящиеся в объекте pandas, будь то Series, DataFrame или что-то еще, разделяются на группы по одному или нескольким указанным вами ключам. Разделение производится вдоль одной оси объекта. Например, DataFrame можно группировать по строкам (axis="index") или по столбцам (axis="columns"). Затем к каждой группе применяется некоторая функция, которая порождает новое значение. Наконец, результаты применения всех функций объединяются в результирующий объект. Форма результирующего объекта обычно зависит от того, что именно проделывается с данными. На рис. 10.1 показан схематический пример простого группового агрегирования.

Ключи группировки могут задаваться по-разному и необязательно должны быть одного типа:
○ список или массив значений той же длины, что ось, по которой производится группировка;
○ значение, определяющее имя столбца объекта DataFrame;
○ словарь или объект Series, определяющий соответствие между значениями на оси группировки и именами групп;
○ функция, которой передается индекс оси или отдельные метки из этого индекса.

![Иллюстрация группового агрегирования](https://i.imgur.com/3Q5z5QG.png)

Рис. 10.1. Иллюстрация группового агрегирования