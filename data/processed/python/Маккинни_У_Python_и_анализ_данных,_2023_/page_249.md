---
source_image: page_249.png
page_number: 249
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.60
tokens: 7830
characters: 2032
timestamp: 2025-12-24T02:47:01.050860
finish_reason: stop
---

И последнее замечание: категориальные данные необязательно должны быть строковыми, хотя во всех примерах выше я только такие и показывал. Элементы категориального массива могут иметь любой неизменяемый тип.

Вычисления с объектами Categorical
Объекты Categorical в pandas, вообще говоря, ведут себя так же, как незакодированные данные (скажем, массив строк). Но некоторые части pandas, например функция groupby, с категориальными данными работают быстрее. Для некоторых функций также имеет значение упорядоченность.
Возьмем случайные числовые данные и воспользуемся функцией распределения по интервалам pandas.qcut. Она возвращает объект pandas.Categorical; мы уже встречались с этой функцией раньше, но опустили детали работы с категориальными данными:

In [231]: rng = np.random.default_rng(seed=12345)

In [232]: draws = rng.standard_normal(1000)

In [233]: draws[:5]
Out[233]: array([-1.4238, 1.2637, -0.8707, -0.2592, -0.0753])

Вычислим квартильное распределение этих данных по интервалам и получим некоторые статистики:

In [234]: bins = pd.qcut(draws, 4)

In [235]: bins
Out[235]:
[(-3.121, -0.675], (0.687, 3.211], (-3.121, -0.675], (-0.675, 0.0134], (-0.675, 0.0134], ..., (0.0134, 0.687], (0.0134, 0.687], (-0.675, 0.0134], (0.0134, 0.687], (-0.675, 0.0134]]
Length: 1000
Categories (4, interval[float64, right]): [(-3.121, -0.675] < (-0.675, 0.0134] < (0.0134, 0.687] < (0.687, 3.211]]

Хотя точные выборочные квартили и полезны, но не так, как отчет, содержащий имена квартилей. Для получения такого отчета можно передать функции qcut аргумент labels:

In [236]: bins = pd.qcut(draws, 4, labels=['Q1', 'Q2', 'Q3', 'Q4'])

In [237]: bins
Out[237]:
['Q1', 'Q4', 'Q1', 'Q2', 'Q2', ..., 'Q3', 'Q3', 'Q2', 'Q3', 'Q2']
Length: 1000
Categories (4, object): ['Q1' < 'Q2' < 'Q3' < 'Q4']

In [238]: bins.codes[:10]
Out[238]: array([0, 3, 0, 1, 1, 0, 0, 2, 2, 0], dtype=int8)

Категориальный объект bins с метками не содержит информацию о границах интервалов, поэтому для получения сводных статистик воспользуемся методом groupby: