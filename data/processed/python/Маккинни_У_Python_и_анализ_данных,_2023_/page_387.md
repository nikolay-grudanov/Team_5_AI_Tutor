---
source_image: page_387.png
page_number: 387
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 50.23
tokens: 8198
characters: 2173
timestamp: 2025-12-24T02:51:16.365413
finish_reason: stop
---

Передискретизация периодов
Передискретизация данных, индексированных периодами, похожа на индексирование временными метками:

In [232]: frame = pd.DataFrame(np.random.standard_normal((24, 4)),
    ....:                 index=pd.period_range("1-2000", "12-2001",
    ....:                 freq="M"),
    ....:                 columns=["Colorado", "Texas", "New York", "Ohio"])

In [233]: frame.head()
Out[233]:
      Colorado   Texas  New York   Ohio
2000-01 -1.179442  0.443171  1.395676 -0.529658
2000-02  0.787358  0.248845  0.743239  1.267746
2000-03  1.302395 -0.272154 -0.051532 -0.467740
2000-04 -1.040816  0.426419  0.312945 -1.115689
2000-05  1.234297 -1.893094 -1.661605 -0.005477

In [234]: annual_frame = frame.resample("A-DEC").mean()

In [235]: annual_frame
Out[235]:
      Colorado   Texas  New York   Ohio
2000   0.487329  0.104466  0.020495 -0.273945
2001   0.203125  0.162429  0.056146 -0.103794

Повышающая передискретизация чуть сложнее, потому что необходимо принять решение о том, в какой конец промежутка времени для новой частоты помещать значения до передискретизации, как в случае метода asfreq. Аргумент convention по умолчанию равен "start", но можно задать и значение "end":

# Q-DEC: поквартально, год заканчивается в декабре
In [236]: annual_frame.resample("Q-DEC").ffill()
Out[236]:
      Colorado   Texas  New York   Ohio
2000Q1  0.487329  0.104466  0.020495 -0.273945
2000Q2  0.487329  0.104466  0.020495 -0.273945
2000Q3  0.487329  0.104466  0.020495 -0.273945
2000Q4  0.487329  0.104466  0.020495 -0.273945
2001Q1  0.203125  0.162429  0.056146 -0.103794
2001Q2  0.203125  0.162429  0.056146 -0.103794
2001Q3  0.203125  0.162429  0.056146 -0.103794
2001Q4  0.203125  0.162429  0.056146 -0.103794

In [237]: annual_frame.resample("Q-DEC", convention="end").asfreq()
Out[237]:
      Colorado   Texas  New York   Ohio
2000Q4  0.487329  0.104466  0.020495 -0.273945
2001Q1  NaN       NaN     NaN     NaN
2001Q2  NaN       NaN     NaN     NaN
2001Q3  NaN       NaN     NaN     NaN
2001Q4  0.203125  0.162429  0.056146 -0.103794

Поскольку периоды ссылаются на промежутки времени, правила повышающей и понижающей передискретизаций более строгие: