---
source_image: page_488.png
page_number: 488
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.89
tokens: 7901
characters: 1788
timestamp: 2025-12-24T02:54:00.431000
finish_reason: stop
---

In [210]: data = np.floor(rng.uniform(0, 10000, size=50))

In [211]: bins = np.array([0, 100, 1000, 5000, 10000])

In [212]: data
Out[212]:
array([815., 1598., 3401., 4651., 2664., 8157., 1932., 1294., 916.,
       5985., 8547., 6016., 9319., 7247., 8605., 9293., 5461., 9376.,
       4949., 2737., 4517., 6650., 3308., 9034., 2570., 3398., 2588.,
       3554., 50., 6286., 2823., 680., 6168., 1763., 3043., 4408.,
       1502., 2179., 4743., 4763., 2552., 2975., 2790., 2605., 4827.,
       2119., 4956., 2462., 8384., 1801.])

Чтобы теперь для каждой точки узнать, какому интервалу она принадлежит (считая, что 1 означает интервал [0, 100]), мы можем воспользоваться методом searchsorted:

In [213]: labels = bins.searchsorted(data)

In [214]: labels
Out[214]:
array([2, 3, 3, 3, 3, 4, 3, 3, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 4,
       3, 4, 3, 3, 3, 3, 1, 4, 3, 2, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 4, 3])

В сочетании с методом groupby из библиотеки pandas этого достаточно, чтобы распределить данные по интервалам:

In [215]: pd.Series(data).groupby(labels).mean()
Out[215]:
1    50.000000
2   803.666667
3  3079.741935
4  7635.200000
dtype: float64

A.7. Написание быстрых функций для NumPy с помощью Numba

Numba (http://numba.pydata.org/) — проект с открытым исходным кодом, предназначенный для создания быстрых функций для работы с данными NumPy и похожими на них с использованием CPU, GPU и другого оборудования. Для трансляции написанного на Python кода в машинные команды применяется проект LLVM (http://llvm.org/).

Чтобы составить представление о Numba, рассмотрим функцию на чистом Python, которая вычисляет выражение (x - y).mean() в цикле for:

import numpy as np

def mean_distance(x, y):
    nx = len(x)
    result = 0.0
    count = 0