---
source_image: page_320.png
page_number: 320
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.37
tokens: 7806
characters: 2210
timestamp: 2025-12-24T02:48:53.972301
finish_reason: stop
---

Отметим, что последние три метода — просто различные способы порождения массива значений, используемого далее для разделения объекта на группы. Не пугайтесь, если это кажется слишком абстрактным. В этой главе будут приведены многочисленные примеры каждого метода. Для начала рассмотрим очень простой табличный набор данных, представленный в виде объекта DataFrame:

In [14]: df = pd.DataFrame({"key1" : ["a", "a", None, "b", "b", "a", None],
    ....:         "key2" : pd.Series([1, 2, 1, 2, 1, None, 1], dtype="Int64"),
    ....:         "data1" : np.random.standard_normal(7),
    ....:         "data2" : np.random.standard_normal(7)})

In [15]: df
Out[15]:
   key1  key2      data1      data2
0     a     1 -0.204708  0.281746
1     a     2  0.478943  0.769023
2   None     1 -0.519439  1.246435
3     b     2 -0.555730  1.007189
4     b     1  1.965781 -1.296221
5     a <NA>  1.393406  0.274992
6   None     1  0.092908  0.228913

Пусть требуется вычислить среднее по столбцу data1, используя метки групп в столбце key1. Сделать это можно несколькими способами. Первый — взять столбец data1 и вызвать метод groupby, передав ему столбец (объект Series) key1:

In [16]: grouped = df["data1"].groupby(df["key1"])

In [17]: grouped
Out[17]: <pandas.core.groupby.generic.SeriesGroupBy object at 0x7fa9270e0a00>

Переменная grouped — это объект GroupBy. Пока что он не вычислил ничего, кроме промежуточных данных о групповом ключе df['key1']. Идея в том, что этот объект хранит всю информацию, необходимую для последующего применения некоторой операции к каждой группе. Например, чтобы вычислить средние по группам, мы можем вызвать метод mean объекта GroupBy:

In [18]: grouped.mean()
Out[18]:
key1
a    0.555881
b    0.705025
Name: data1, dtype: float64

Позже, в разделе 10.2, я подробнее объясню, что происходит при вызове .mean(). Важно, что данные (объект Series) агрегированы путем разделения данных по групповому ключу, и в результате создан новый объект Series, индексированный уникальными значениями в столбце key1. Получившийся индекс назван 'key1', потому что так назывался столбец df['key1'] объекта DataFrame.

Если бы мы передали несколько массивов в виде списка, то получили бы другой результат: