---
source_image: page_386.png
page_number: 386
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.56
tokens: 8270
characters: 2243
timestamp: 2025-12-24T02:51:16.811799
finish_reason: stop
---

Если мы используем с этими данными функцию агрегирования, то на каждую группу получается только одно значение, а отсутствующие значения приводят к лакунам. Чтобы перейти к более высокой частоте без агрегирования, применяется метод asfreq:

In [227]: df_daily = frame.resample("D").asfreq()

In [228]: df_daily
Out[228]:
        Colorado    Texas   New York   Ohio
2000-01-05 -0.896431  0.927238  0.482284 -0.867130
2000-01-06   NaN      NaN      NaN      NaN
2000-01-07   NaN      NaN      NaN      NaN
2000-01-08   NaN      NaN      NaN      NaN
2000-01-09   NaN      NaN      NaN      NaN
2000-01-10   NaN      NaN      NaN      NaN
2000-01-11   NaN      NaN      NaN      NaN
2000-01-12  0.493841 -0.155434  1.397286  1.507055

Допустим, мы хотим восполнить значения для дней, отличных от среды. Для этого применимы те же способы восполнения или интерполяции, что в методах fillna и reindex:

In [229]: frame.resample("D").ffill()
Out[229]:
        Colorado    Texas   New York   Ohio
2000-01-05 -0.896431  0.927238  0.482284 -0.867130
2000-01-06 -0.896431  0.927238  0.482284 -0.867130
2000-01-07 -0.896431  0.927238  0.482284 -0.867130
2000-01-08 -0.896431  0.927238  0.482284 -0.867130
2000-01-09 -0.896431  0.927238  0.482284 -0.867130
2000-01-10 -0.896431  0.927238  0.482284 -0.867130
2000-01-11 -0.896431  0.927238  0.482284 -0.867130
2000-01-12  0.493841 -0.155434  1.397286  1.507055

Можно восполнить отсутствующие значения не во всех последующих периодах, а только в заданном числе:

In [230]: frame.resample("D").ffill(limit=2)
Out[230]:
        Colorado    Texas   New York   Ohio
2000-01-05 -0.896431  0.927238  0.482284 -0.867130
2000-01-06 -0.896431  0.927238  0.482284 -0.867130
2000-01-07 -0.896431  0.927238  0.482284 -0.867130
2000-01-08   NaN      NaN      NaN      NaN
2000-01-09   NaN      NaN      NaN      NaN
2000-01-10   NaN      NaN      NaN      NaN
2000-01-11   NaN      NaN      NaN      NaN
2000-01-12  0.493841 -0.155434  1.397286  1.507055

Важно отметить, что новый индекс дат может не совпадать со старым:

In [231]: frame.resample("W-THU").ffill()
Out[231]:
        Colorado    Texas   New York   Ohio
2000-01-06 -0.896431  0.927238  0.482284 -0.867130
2000-01-13  0.493841 -0.155434  1.397286  1.507055