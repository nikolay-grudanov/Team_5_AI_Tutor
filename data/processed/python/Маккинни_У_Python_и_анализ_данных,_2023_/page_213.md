---
source_image: page_213.png
page_number: 213
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.67
tokens: 7602
characters: 2142
timestamp: 2025-12-24T02:45:51.820091
finish_reason: stop
---

Глава 7

Очистка и подготовка данных

Значительная часть времени программиста, занимающегося анализом и моделированием данных, уходит на подготовку данных: загрузку, очистку, преобразование и реорганизацию. Часто говорят, что это составляет 80 и даже более процентов работы аналитика. Иногда способ хранения данных в файлах или в базе не согласуется с алгоритмом обработки. Многие предпочитают писать преобразования данных из одной формы в другую на каком-нибудь универсальном языке программирования типа Python, Perl, R или Java либо с помощью имеющихся в UNIX средств обработки текста типа sed или awk. По счастью, pandas дополняет стандартную библиотеку Python высокоуровневыми, гибкими и производительными базовыми преобразованиями и алгоритмами, которые позволяют переформатировать данные без особых проблем.

Если вы наткнетесь на манипуляцию, которой нет ни в этой книге, ни вообще в библиотеке pandas, не стесняйтесь внести предложение в списке рассылки или на сайте GitHub. Вообще, многое в pandas — в части как проектирования, так и реализации — обусловлено потребностями реальных приложений.

В этой главе мы обсудим средства работы с отсутствующими и повторяющимися данными, средства обработки строк и некоторые другие преобразования данных, применяемые в процессе анализа. А следующая глава будет посвящена различным способам комбинирования и реорганизации наборов данных.

7.1. Обработка отсутствующих данных

Отсутствующие данные — типичное явление в большинстве аналитических приложений. При проектировании pandas в качестве одной из целей ставилась задача сделать работу с отсутствующими данными как можно менее болезненной. Например, при вычислении всех описательных статистик для объектов pandas отсутствующие данные не учитываются.

Способ представления отсутствующих данных в объектах pandas не идеален, но для большинства практических применений его достаточно. Для представления отсутствующих данных типа float64 в pandas используется значение с плавающей точкой NaN (не число), которое мы будем называть маркером.

In [14]: float_data = pd.Series([1.2, -3.5, np.nan, 0])

In [15]: float_data
Out[15]:
0    1.2
1   -3.5