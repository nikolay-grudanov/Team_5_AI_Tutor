---
source_image: page_347.png
page_number: 347
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.56
tokens: 7546
characters: 1066
timestamp: 2025-12-24T02:49:30.078865
finish_reason: stop
---

2    4.0
3    3.0
4    3.0
5    3.0
6    2.0
7    2.0
8    2.0
9    1.0
10   1.0
11   1.0
Name: value, dtype: float64

Рассмотрим функцию группового преобразования, полученную комбинированием простых агрегатов:

In [155]: def normalize(x):
.....:     return (x - x.mean()) / x.std()

В данном случае transform и apply дают эквивалентные результаты:

In [156]: g.transform(normalize)
Out[156]:
0   -1.161895
1   -1.161895
2   -1.161895
3   -0.387298
4   -0.387298
5   -0.387298
6    0.387298
7    0.387298
8    0.387298
9    1.161895
10   1.161895
11   1.161895
Name: value, dtype: float64

In [157]: g.apply(normalize)
Out[157]:
0   -1.161895
1   -1.161895
2   -1.161895
3   -0.387298
4   -0.387298
5   -0.387298
6    0.387298
7    0.387298
8    0.387298
9    1.161895
10   1.161895
11   1.161895
Name: value, dtype: float64

Встроенные агрегатные функции типа 'mean' или 'sum' часто работают гораздо быстрее, чем метод apply. При использовании совместно с transform они выбирают «быстрый путь». Это позволяет выполнять так называемую развернутую групповую операцию: