---
source_image: page_404.png
page_number: 404
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.92
tokens: 7674
characters: 1821
timestamp: 2025-12-24T02:51:28.976789
finish_reason: stop
---

1    -1.41421    0.78
1    -0.70711    0.76
1    0.00000    1.02
1    0.70711    -3.33
1    1.41421    0.77

Terms:
'Intercept' (column 0)
'standardize(x0)' (column 1)
'center(x1)' (column 2)

В процессе моделирования мы иногда обучаем модель на одном наборе данных, а затем тестируем на другом. В роли другого набора может выступать зарезервированная часть данных или новые данные, полученные позже. Применяя преобразования типа центрирования и стандартизации, следует быть осторожным, когда модель используется для предсказания на новых данных. Говорят, что такие преобразования обладают состоянием, потому что при преобразовании нового набора данных мы должны использовать статистики, в частности среднее и стандартное отклонение, исходного набора.

Функция patsy.build_design_matrices умеет применять преобразования к новым внебыстрочными данным, используя информацию, сохраненную для исходного внутривыборочного набора данных:

In [46]: new_data = pd.DataFrame({
    ....:     'x0': [6, 7, 8, 9],
    ....:     'x1': [3.1, -0.5, 0, 2.3],
    ....:     'y': [1, 2, 3, 4]})

In [47]: new_X = patsy.build_design_matrices([X.design_info], new_data)

In [48]: new_X
Out[48]:
[DesignMatrix with shape (4, 3)
 Intercept  standardize(x0)  center(x1)
 1         2.12132          3.87
 1         2.82843          0.27
 1         3.53553          0.77
 1         4.24264          3.07
Terms:
'Intercept' (column 0)
'standardize(x0)' (column 1)
'center(x1)' (column 2)]

Поскольку знак + в формулах Patsy не означает сложения, в случае если мы хотим сложить именованные столбцы из набора данных, необходимо обернуть операцию специальной функцией I:

In [49]: y, X = patsy.dmatrices('y ~ I(x0 + x1)', data)

In [50]: X
Out[50]:
DesignMatrix with shape (5, 2)
 Intercept  I(x0 + x1)
 1         1.01
 1         1.99
 1         3.25