---
source_image: page_327.png
page_number: 327
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.33
tokens: 7898
characters: 2153
timestamp: 2025-12-24T02:49:04.571223
finish_reason: stop
---

In [54]: columns = pd.MultiIndex.from_arrays([["US", "US", "US", "JP", "JP"], [1, 3, 5, 1, 3]], names=["cty", "tenor"])

In [55]: hier_df = pd.DataFrame(np.random.standard_normal((4, 5)), columns=columns)

In [56]: hier_df
Out[56]:
   cty    US           JP
   tenor  1   3   5   1   3
0      0.332883 -2.359419 -0.199543 -1.541996 -0.970736
1     -1.307030  0.286350  0.377984 -0.753887  0.331286
2      1.349742  0.069877  0.246674 -0.011862  1.004812
3     1.327195 -0.919262 -1.549106  0.022185  0.758363

Для группировки по уровню нужно передать номер или имя уровня в именованном параметре level:

In [57]: hier_df.groupby(level="cty", axis="columns").count()
Out[57]:
   cty    JP   US
   0      2   3
   1      2   3
   2      2   3
   3      2   3

10.2. Агрегирование данных

Под агрегированием я обычно понимаю любое преобразование данных, которое порождает скалярные значения из массива. В примерах выше мы встречали несколько таких преобразований: mean, count, min и sum. Вероятно, вам интересно, что происходит при вызове mean() для объекта GroupBy. Реализации многих стандартных операций агрегирования, в частности перечисленных в табл. 10.1, оптимизированы. Однако необязательно ограничиваться только этими методами.

Таблица 10.1. Оптимизированные методы агрегирования

<table>
  <tr>
    <th>Имя функции</th>
    <th>Описание</th>
  </tr>
  <tr>
    <td>any, all</td>
    <td>Возвращают True, если хотя бы одно или все значения, отличные от NA, «похожи на истину»</td>
  </tr>
  <tr>
    <td>count</td>
    <td>Количество отличных от NA значений в группе</td>
  </tr>
  <tr>
    <td>cummin, cummax</td>
    <td>Накопительный минимум и максимум отличных от NA значений</td>
  </tr>
  <tr>
    <td>cumsum</td>
    <td>Накопительная сумма отличных от NA значений</td>
  </tr>
  <tr>
    <td>cumprod</td>
    <td>Накопительное произведение отличных от NA значений</td>
  </tr>
  <tr>
    <td>first, last</td>
    <td>Первое и последнее отличные от NA значения</td>
  </tr>
  <tr>
    <td>mean</td>
    <td>Среднее отличных от NA значений</td>
  </tr>
  <tr>
    <td>median</td>
    <td>Медиана отличных от NA значений</td>
  </tr>
</table>