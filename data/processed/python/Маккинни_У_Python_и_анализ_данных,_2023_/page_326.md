---
source_image: page_326.png
page_number: 326
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.85
tokens: 7752
characters: 1855
timestamp: 2025-12-24T02:48:57.359776
finish_reason: stop
---

In [48]: map_series = pd.Series(mapping)

In [49]: map_series
Out[49]:
a    red
b    red
c    blue
d    blue
e    red
f    orange
dtype: object

In [50]: people.groupby(map_series, axis="columns").count()
Out[50]:
      blue   red
Joe     2     3
Steve   2     3
Wanda   1     2
Jill    2     3
Trey    2     3

Группировка с помощью функций
Использование функций Python — более абстрактный способ определения соответствия групп по сравнению со словарями или объектами Series. Функция, переданная в качестве группового ключа, будет вызвана по одному разу для каждого значения в индексе (или по одному разу для каждого значения в столбце, если используется axis="columns"), а возвращенные ей значения станут именами групп. Конкретно, рассмотрим пример объекта DataFrame из предыдущего раздела, где значениями индекса являются имена людей. Пусть требуется сгруппировать по длине имени; можно было бы вычислить массив длин строк, но лучше вместо этого просто передать функцию len:

In [51]: people.groupby(len).sum()
Out[51]:
         a         b         c         d         e
3  1.352917  0.886429 -2.001637 -0.371843  1.669025
4  0.483052 -0.153399 -2.097088 -2.250405 -2.924273
5 -1.015657 -0.539741  0.476985  3.772716 -1.020287

Использование вперемежку функций, массивов, словарей и объектов Series вполне допустимо, потому что внутри все преобразуется в массивы:

In [52]: key_list = ["one", "one", "one", "two", "two"]

In [53]: people.groupby([len, key_list]).min()
Out[53]:
         a         b         c         d         e
3 one  1.352917  0.886429 -2.001637 -0.371843  1.669025
4 two -0.860757 -0.713544 -1.265934 -2.370232 -1.860761
5 one -0.577087 -0.539741  0.476985  0.523772 -1.021228

Группировка по уровням индекса
Наконец, иерархически индексированные наборы данных можно агрегировать по одному из уровней индекса оси. Рассмотрим пример: