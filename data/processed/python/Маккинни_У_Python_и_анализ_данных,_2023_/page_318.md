---
source_image: page_318.png
page_number: 318
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.02
tokens: 7552
characters: 1910
timestamp: 2025-12-24T02:48:45.586473
finish_reason: stop
---

Глава 10

Агрегирование данных и групповые операции

Разбиение набора данных на группы и применение некоторой функции к каждой группе, будь то в целях агрегирования или преобразования, зачастую является одной из важнейших операций анализа данных. После загрузки, слияния и подготовки набора данных обычно вычисляют статистику по группам или, возможно, сводные таблицы для построения отчета или визуализации. В библиотеке pandas имеется гибкий и быстрый механизм groupby, который позволяет формировать продольные и поперечные срезы, а также агрегировать наборы данных естественным образом.

Одна из причин популярности реляционных баз данных и языка SQL (структурированного языка запросов) — простота соединения, фильтрации, преобразования и агрегирования данных. Однако в том, что касается групповых операций, языки запросов типа SQL несколько ограничены. Как мы увидим, выразительность и мощь языка Python и библиотеки pandas позволяют выполнять гораздо более сложные групповые операции, выразив их в виде написанных нами функций, которые манипулируют данными, ассоциированными с каждой группой. В этой главе мы изучим следующие возможности:

○ разделение объекта pandas на части по одному или нескольким ключам (в виде функций, массивов или имен столбцов объекта DataFrame);
○ вычисление групповых статистик, например общее количество, среднее, стандартное отклонение или определенная пользователем функция;
○ применение переменного множества функций к каждому столбцу DataFrame;
○ применение внутригрупповых преобразований или иных манипуляций, например нормировка, линейная регрессия, ранжирование или выборка подмножества;
○ вычисление сводных таблиц и перекрестное табулирование;
○ квантильный анализ и другие виды статистического анализа групп.

Частный случай механизма groupby, агрегирование временных рядов по времени, в этой книге называется передискретизацией и рассматривается отдельно в главе 11.