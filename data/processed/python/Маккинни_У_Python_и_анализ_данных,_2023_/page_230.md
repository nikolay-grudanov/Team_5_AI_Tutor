---
source_image: page_230.png
page_number: 230
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.07
tokens: 7610
characters: 1729
timestamp: 2025-12-24T02:46:09.942633
finish_reason: stop
---

Вычисление индикаторных переменных

Еще одно преобразование, часто встречающееся в статистическом моделировании и машинном обучении, — преобразование категориальной переменной в фиктивную, или индикаторную, матрицу. Если в столбце объекта DataFrame встречается k различных значений, то можно построить матрицу или объект DataFrame с k столбцами, содержащими только нули и единицы. В библиотеке pandas для этого имеется функция pandas.get_dummies, хотя нетрудно написать и свою собственную. Рассмотрим пример DataFrame:

In [115]: df = pd.DataFrame({"key": ["b", "b", "a", "c", "a", "b"], "data1": range(6)})

In [116]: df
Out[116]:
   key  data1
0    b      0
1    b      1
2    a      2
3    c      3
4    a      4
5    b      5

In [117]: pd.get_dummies(df["key"])
Out[117]:
   a   b   c
0  0   1   0
1  0   1   0
2  1   0   0
3  0   0   1
4  1   0   0
5  0   1   0

Иногда желательно добавить префикс к столбцам индикаторного объекта DataFrame, который затем можно будет соединить с другими данными. У функции pandas.get_dummies для этой цели предусмотрен аргумент prefix:

In [118]: dummies = pd.get_dummies(df["key"], prefix="key")

In [119]: df_with_dummy = df[["data1"]].join(dummies)

In [120]: df_with_dummy
Out[120]:
   data1  key_a  key_b  key_c
0      0      0      1      0
1      1      0      1      0
2      2      1      0      0
3      3      0      0      1
4      4      1      0      0
5      5      0      1      0

О методе DataFrame.join мы подробнее поговорим в следующей главе.
Если некоторая строка DataFrame принадлежит нескольким категориям, то к созданию фиктивных переменных придется применить другой подход. Рассмотрим набор данных MovieLens 1M, который будет более подробно исследован в главе 13: