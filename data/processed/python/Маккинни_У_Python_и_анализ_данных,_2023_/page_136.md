---
source_image: page_136.png
page_number: 136
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.45
tokens: 7712
characters: 1860
timestamp: 2025-12-24T02:43:41.334078
finish_reason: stop
---

блуждание достигало или превышало 10, однако нас интересует индекс первого значения 10 или −10. Его можно вычислить с помощью функции argmax, которая возвращает индекс первого максимального значения в булевом массиве (True — максимальное значение):

In [263]: (np.abs(walk) >= 10).argmax()
Out[263]: 155

Отметим, что использование здесь argmax не всегда эффективно, потому что она всегда просматривает весь массив. В данном частном случае мы знаем, что первое же встретившееся значение True является максимальным.

Моделирование сразу нескольких случайных блужданий
Если бы нам требовалось смоделировать много случайных блужданий, скажем 5000, то это можно было бы сделать путем совсем небольшой модификации приведенного выше кода. Если функциям из модуля numpy.random передать 2-кортеж, то они сгенерируют двумерный массив случайных чисел, и мы сможем вычислить нарастающие суммы по строкам, т. е. все 5000 случайных блужданий за одну операцию:

In [264]: nwalks = 5000
In [265]: nsteps = 1000
In [266]: draws = rng.integers(0, 2, size=(nwalks, nsteps)) # 0 or 1
In [267]: steps = np.where(draws > 0, 1, -1)
In [268]: walks = steps.cumsum(axis=1)

In [269]: walks
Out[269]:
array([[ 1,  2,  3, ..., 22, 23, 22],
       [ 1,  0, -1, ..., -50, -49, -48],
       [ 1,  2,  3, ...,  50,  49,  48],
       ...,
       [-1, -2, -1, ..., -10, -9, -10],
       [-1, -2, -3, ...,   8,   9,   8],
       [-1,  0,  1, ...,  -4,  -3,  -2]])

Теперь мы можем вычислить максимум и минимум по всем блужданиям:

In [270]: walks.max()
Out[270]: 114

In [271]: walks.min()
Out[271]: -120

Вычислим для этих блужданий минимальный момент первого пересечения с уровнем 30 или −30. Это не так просто, потому что не в каждом блуждании уровень 30 достигается. Проверить, так ли это, можно с помощью метода any:

In [272]: hits30 = (np.abs(walks) >= 30).any(axis=1)

In [273]: hits30