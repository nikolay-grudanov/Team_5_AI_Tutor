---
source_image: page_399.png
page_number: 399
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.46
tokens: 7670
characters: 1580
timestamp: 2025-12-24T02:51:13.452987
finish_reason: stop
---

Хотя детали «правильного» конструирования признаков выходят за рамки этой книги, я все же продемонстрирую некоторые приемы, позволяющие относительно безболезненно переключаться между манипулированием данными средствами pandas и моделированием.

Переходником между pandas и другими аналитическими библиотеками обычно являются массивы NumPy. Для преобразования объекта DataFrame в массив NumPy используется метод to_numpy:

In [12]: data = pd.DataFrame({
    ...:     'x0': [1, 2, 3, 4, 5],
    ...:     'x1': [0.01, -0.01, 0.25, -4.1, 0.],
    ...:     'y': [-1.5, 0., 3.6, 1.3, -2.]})

In [13]: data
Out[13]:
   x0   x1   y
0   1  0.01 -1.5
1   2 -0.01  0.0
2   3  0.25  3.6
3   4 -4.10  1.3
4   5  0.00 -2.0

In [14]: data.columns
Out[14]: Index(['x0', 'x1', 'y'], dtype='object')

In [15]: data.to_numpy()
Out[15]:
array([[ 1. ,  0.01, -1.5 ],
       [ 2. , -0.01,  0. ],
       [ 3. ,  0.25,  3.6 ],
       [ 4. , -4.1 ,  1.3 ],
       [ 5. ,  0.  , -2. ]])

Для обратного преобразования в DataFrame можно передать двумерный массив ndarray и факультативно имена столбцов:

In [16]: df2 = pd.DataFrame(data.to_numpy(), columns=['one', 'two', 'three'])

In [17]: df2
Out[17]:
   one   two   three
0   1.0  0.01  -1.5
1   2.0 -0.01   0.0
2   3.0  0.25   3.6
3   4.0 -4.10   1.3
4   5.0  0.00  -2.0

Метод to_numpy предназначен для использования в случае, когда данные однородны, например все имеют числовой тип. При наличии неоднородных данных получится массив ndarray объектов Python:

In [18]: df3 = data.copy()

In [19]: df3['strings'] = ['a', 'b', 'c', 'd', 'e']

In [20]: df3