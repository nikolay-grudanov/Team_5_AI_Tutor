---
source_image: page_222.png
page_number: 222
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 20.67
tokens: 7448
characters: 1287
timestamp: 2025-12-24T02:45:56.492577
finish_reason: stop
---

Можно было бы также передать функцию, выполняющую всю эту работу:

In [62]: def get_animal(x):
    ....: return meat_to_animal[x]

In [63]: data["food"].map(get_animal)
Out[63]:
0    pig
1    pig
2    pig
3    cow
4    cow
5    pig
6    cow
7    pig
8    salmon
Name: food, dtype: object

Метод map — удобное средство выполнения поэлементных преобразований и других операций очистки.

Замена значений
Восполнение отсутствующих данных методом fillna можно рассматривать как частный случай более общей замены значений. Если метод map, как мы только что видели, позволяет модифицировать подмножество значений, хранящихся в объекте, то метод replace предлагает для этого более простой и гибкий интерфейс. Рассмотрим такой объект Series:

In [64]: data = pd.Series([1., -999., 2., -999., -1000., 3.])

In [65]: data
Out[65]:
0    1.0
1   -999.0
2    2.0
3   -999.0
4  -1000.0
5    3.0
dtype: float64

Значение -999 могло бы быть маркером отсутствия данных. Чтобы заменить все такие значения теми, которые понимает pandas, воспользуемся методом replace, порождающим новый объект Series:

In [66]: data.replace(-999, np.nan)
Out[66]:
0    1.0
1    NaN
2    2.0
3    NaN
4  -1000.0
5    3.0
dtype: float64

Чтобы заменить сразу несколько значений, нужно передать их список и заменяющее значение: