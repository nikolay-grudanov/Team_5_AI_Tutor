---
source_image: page_410.png
page_number: 410
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 29.42
tokens: 7720
characters: 1625
timestamp: 2025-12-24T02:51:36.624683
finish_reason: stop
---

In [76]: data[:5]
Out[76]:
    col0    col1    col2    y
0 -0.900506 -0.189430 -1.027870 -0.599527
1  0.799252 -1.545984 -0.327397 -0.588454
2 -0.550655 -0.120254  0.329359  0.185634
3 -0.163916  0.824040  0.208275 -0.007477
4 -0.047651 -0.213147 -0.048244 -0.015374

Теперь можно использовать формульный API statsmodels и строковые формулы Patsy:

In [77]: results = smf.ols('y ~ col0 + col1 + col2', data=data).fit()

In [78]: results.params
Out[78]:
Intercept   -0.020799
col0        0.065813
col1        0.268970
col2        0.449419
dtype: float64

In [79]: results.tvalues
Out[79]:
Intercept   -0.652501
col0         1.219768
col1         6.312369
col2         6.567428
dtype: float64

Заметим, что statsmodels вернула результаты в виде Series, присоединив имена столбцов из DataFrame. Кроме того, при работе с формулами и объектами pandas не нужно использовать add_constant.

Зная оценки параметров, мы можем вычислить для них предсказанные моделью значения для новых вневыборочных данных:

In [80]: results.predict(data[:5])
Out[80]:
0  -0.592959
1  -0.531160
2   0.058636
3   0.283658
4  -0.102947
dtype: float64

В statsmodels существует еще много инструментов для анализа, диагностики и визуализации результатов линейных моделей — изучайте, сколько душе угодно. Имеются также другие виды линейных моделей, помимо метода обыкновенных наименьших квадратов.

Оценивание процессов с временными рядами
Еще один класс моделей в statsmodels предназначен для анализа временных рядов. В их числе процессы авторегрессии, фильтры Калмана и другие модели в пространстве состояний, а также многомерные авторегрессионные модели.