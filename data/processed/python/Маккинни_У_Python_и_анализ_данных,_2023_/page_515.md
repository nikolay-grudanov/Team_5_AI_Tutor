---
source_image: page_515.png
page_number: 515
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.38
tokens: 7741
characters: 2594
timestamp: 2025-12-24T02:54:33.261484
finish_reason: stop
---

В.6. СОВЕТЫ ПО ПРОДУКТИВНОЙ РАЗРАБОТКЕ КОДА С ИСПОЛЬЗОВАНИЕМ IPYTHON

Создание кода таким образом, чтобы его можно было разрабатывать, отлаживать и в конечном счете использовать интерактивно, многим может показаться сменой парадигмы. Придется несколько изменить подходы к таким процедурным деталям, как перезагрузка кода, а также сам стиль кодирования.

Поэтому реализация стратегий, описанных в этом разделе, — скорее искусство, чем наука, вы должны будете экспериментально определить наиболее эффективный для себя способ написания Python-кода. Конечная задача — структурировать код так, чтобы с ним было легко работать интерактивно и изучать результаты прогона всей программы или отдельной функции с наименьшими усилиями. Я пришел к выводу, что программу, спроектированную в расчете на IPython, использовать проще, чем аналогичную, но построенную как автономное командное приложение. Это становится особенно важно, когда возникает какая-то проблема и нужно найти ошибку в коде, написанном вами или кем-то еще несколько месяцев или лет назад.

Перезагрузка зависимостей модуля

Когда в Python-программе впервые встречается предложение import some_lib, выполняется код из модуля some_lib и все переменные, функции и импортированные модули сохраняются во вновь созданном пространстве имен модуля some_lib. При следующей обработке предложения import some_lib будет возвращена ссылка на уже существующее пространство имен модуля. При интерактивной разработке кода возникает проблема: как быть, когда, скажем, с помощью команды %run выполняется скрипт, зависящий от другого модуля, в который вы внесли изменения? Допустим, в файле test_script.py находится такой код:

import some_lib

x = 5
y = [1, 2, 3, 4]
result = some_lib.get_answer(x, y)

Если выполнить %run test_script.py, а затем изменить some_lib.py, то при следующем выполнении %run test_script.py мы получим старую версию some_lib.py из-за принятого в Python механизма однократной загрузки. Такое поведение отличается от некоторых других сред анализа данных, например MATLAB, в которых изменения кода распространяются автоматически14. Справиться с этой проблемой можно двумя способами. Во-первых, использовать функцию reload из модуля importlib стандартной библиотеки:

import some_lib
import importlib

importlib.reload(some_lib)

14 Поскольку модуль или пакет может импортироваться в нескольких местах программы, Python кеширует код модуля при первом импортировании, а не выполняет его каждый раз. В противном случае следование принципам модульности и правильной организации кода могло бы поставить под угрозу эффективность приложения.