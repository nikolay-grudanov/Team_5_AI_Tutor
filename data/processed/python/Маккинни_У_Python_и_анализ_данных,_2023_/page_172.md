---
source_image: page_172.png
page_number: 172
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.71
tokens: 7614
characters: 1688
timestamp: 2025-12-24T02:44:38.448771
finish_reason: stop
---

Техас   0.092908   0.281746   0.769023
Орегон   1.246435   1.007189   1.296221

Еще одна часто встречающаяся операция — применение функции, определенной для одномерных массивов, к каждому столбцу или строке. Именно это и делает метод apply объекта DataFrame:

In [226]: def f1(x):
.....: return x.max() - x.min()

In [227]: frame.apply(f1)
Out[227]:
b    1.802165
d    1.684034
e    2.689627
dtype: float64

Здесь функция f, вычисляющая разность между максимальным и минимальным значениями Series, вызывается один раз для каждого столбца frame. В результате получается объект Series, для которого индексом являются столбцы frame.

Если передать методу apply аргумент axis="columns", то функция будет вызываться по одному разу для каждой строки:

In [228]: frame.apply(f1, axis="columns")
Out[228]:
Utah    0.998382
Ohio    2.521511
Texas   0.676115
Oregon  2.542656
dtype: float64

Многие из наиболее распространенных статистик массивов (например, sum и mean) — методы DataFrame, поэтому применять apply в этом случае необязательно.

Функция, передаваемая методу apply, не обязана возвращать скалярное значение, она может вернуть и объект Series, содержащий несколько значений:

In [229]: def f2(x):
.....:     return pd.Series([x.min(), x.max()], index=["min", "max"])

In [230]: frame.apply(f2)
Out[230]:
      b      d      e
min -0.555730 0.281746 -1.296221
max  1.246435 1.965781  1.393406

Можно использовать и поэлементные функции Python. Допустим, требуется вычислить форматированную строку для каждого элемента frame с плавающей точкой. Это позволяет сделать метод applymap:

In [231]: def my_format(x):
.....:     return f"{x:.2f}"

In [232]: frame.applymap(my_format)
Out[232]: