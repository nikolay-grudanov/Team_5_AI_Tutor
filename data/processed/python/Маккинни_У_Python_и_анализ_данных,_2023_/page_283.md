---
source_image: page_283.png
page_number: 283
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 47.82
tokens: 7934
characters: 1878
timestamp: 2025-12-24T02:48:07.614583
finish_reason: stop
---

In [162]: pivoted["value"].head()
Out[162]:
    item   infl  realgdp  unemp
date
1959-01-01  0.00  2710.349  5.8
1959-04-01  2.34  2778.801  5.1
1959-07-01  2.74  2775.488  5.3
1959-10-01  0.27  2785.204  5.6
1960-01-01  2.31  2847.699  5.2

Отметим, что метод pivot — эквивалент создания иерархического индекса методом set_index с последующим вызовом unstack:

In [163]: unstacked = long_data.set_index(["date", "item"]).unstack(level="item")

In [164]: unstacked.head()
Out[164]:
           value                value2
           infl  realgdp  unemp      infl  realgdp  unemp
item
date
1959-01-01  0.00  2710.349  5.8  0.575721  0.802926  1.381918
1959-04-01  2.34  2778.801  5.1 -0.143492  0.000992 -0.206282
1959-07-01  2.74  2775.488  5.3 -1.682403 -0.222392  1.811659
1959-10-01  0.27  2785.204  5.6  0.128317 -0.351305 -1.313554
1960-01-01  2.31  2847.699  5.2 -0.615939  0.498327  0.174072

Поворот из «широкого» в «длинный» формат
Обратной к pivot операцией является pandas.melt. Вместо того чтобы преобразовывать один столбец в несколько в новом объекте DataFrame, она объединяет несколько столбцов в один, порождая DataFrame длиннее входного. Рассмотрим пример:

In [166]: df = pd.DataFrame({"key": ["foo", "bar", "baz"],
    ....:                 "A": [1, 2, 3],
    ....:                 "B": [4, 5, 6],
    ....:                 "C": [7, 8, 9]})

In [167]: df
Out[167]:
   key  A  B  C
0  foo  1  4  7
1  bar  2  5  8
2  baz  3  6  9

Столбец 'key' может быть индикатором группы, а остальные столбцы — значениями данных. При использовании функции pandas.melt необходимо указать, какие столбцы являются индикаторами группы (если таковые имеются). Будем считать, что в данном случае "key" — единственный индикатор группы:

In [168]: melted = pd.melt(df, id_vars="key")

In [169]: melted
Out[169]:
   key variable  value
0  foo        A      1
1  bar        A      2