---
source_image: page_343.png
page_number: 343
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.08
tokens: 7970
characters: 1877
timestamp: 2025-12-24T02:49:38.916042
finish_reason: stop
---

In [134]: close_px.tail(4)
Out[134]:
        AAPL   MSFT   XOM   SPX
2011-10-11  400.29  27.00  76.27  1195.54
2011-10-12  402.19  26.96  77.16  1207.25
2011-10-13  408.43  27.18  76.37  1203.66
2011-10-14  422.00  27.27  78.11  1224.58

Метод DataFrame info() здесь дает удобный способ получить сводную информацию о содержимом DataFrame.

Было бы интересно вычислить объект DataFrame, содержащий годовые корреляции между суточной доходностью (вычисленной по процентному изменению) и SPX. Один из способов решения этой задачи состоит в том, чтобы сначала создать функцию, которая вычисляет попарную корреляцию между каждым столбцом и столбцом "SPX":

In [135]: def spx_corr(group):
    ....:     return group.corrwith(group["SPX"])

Затем вычислим процентное изменение в close_px с помощью метода pct_change:

In [136]: rets = close_px.pct_change().dropna()

И наконец, сгруппируем процентные изменения по годам, которые можно извлечь из метки строки односторочной функцией, возвращающей атрибут year метки datetime:

In [137]: def get_year(x):
    ....:     return x.year

In [138]: by_year = rets.groupby(get_year)

In [139]: by_year.apply(spx_corr)
Out[139]:
        AAPL   MSFT   XOM   SPX
2003  0.541124  0.745174  0.661265  1.0
2004  0.374283  0.588531  0.557742  1.0
2005  0.467540  0.562374  0.631010  1.0
2006  0.428267  0.406126  0.518514  1.0
2007  0.508118  0.658770  0.786264  1.0
2008  0.681434  0.804626  0.828303  1.0
2009  0.707103  0.654902  0.797921  1.0
2010  0.710105  0.730118  0.839057  1.0
2011  0.691931  0.800996  0.859975  1.0

Разумеется, ничто не мешает вычислить корреляцию между столбцами. Ниже мы вычисляем годовую корреляцию между Apple и Microsoft:

In [140]: def corr_aapl_msft(group):
    ....:     return group["AAPL"].corr(group["MSFT"])

In [141]: by_year.apply(corr_aapl_msft)
Out[141]:
2003    0.480868
2004    0.259024
2005    0.300093