---
source_image: page_407.png
page_number: 407
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.48
tokens: 7597
characters: 1951
timestamp: 2025-12-24T02:51:29.090919
finish_reason: stop
---

1
0
1
1
0
1
1
1

Terms:
'Intercept' (column 0)
'key1' (column 1)
'key2' (column 2)

In [62]: y, X = patsy.dmatrices('v2 ~ key1 + key2 + key1:key2', data)

In [63]: X
Out[63]:
DesignMatrix with shape (8, 4)
    Intercept   key1[T.b]   key2[T.zero]   key1[T.b]:key2[T.zero]
      1           0             1                0
      1           0             0                0
      1           1             1                1
      1           1             0                0
      1           0             1                0
      1           1             0                0
      1           0             1                0
      1           1             1                1

Terms:
'Intercept' (column 0)
'key1' (column 1)
'key2' (column 2)
'key1:key2' (column 3)

Patsy предлагает и другие способы преобразования категориальных данных, в т.ч. преобразования для термов в определенном порядке. Дополнительные сведения см. в документации.

12.3. ВВЕДЕНИЕ В STATSMODELS

Statsmodels (https://www.statsmodels.org/) — написанная на Python библиотека для обучения разнообразных статистических моделей, выполнения статистических тестов, разведки и визуализации данных. В statsmodels представлены в основном «классические» статистические методы на основе частотного подхода, а байесовские методы и модели машинного обучения лучше искать в других библиотеках.
Перечислим несколько видов моделей, имеющихся в statsmodels:

○ линейные модели, обобщенные линейные модели и робастные линейные модели;
○ линейные модели со смешанными эффектами;
○ методы дисперсионного анализа (ANOVA);
○ временные ряды и модели в пространстве состояний;
○ обобщенные методы моментов.

На следующих страницах мы воспользуемся несколькими базовыми средствами statsmodels и посмотрим, как применять интерфейсы библиотеки моделирования с формулами Patsy и объектами pandas DataFrame. Если вы еще не установили statsmodels, сделайте это сейчас командой

conda install statsmodels