---
source_image: page_408.png
page_number: 408
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.92
tokens: 7682
characters: 1788
timestamp: 2025-12-24T02:51:32.603472
finish_reason: stop
---

Оценивание линейных моделей
В библиотеке statsmodels имеется несколько видов моделей линейной регрессии, от самых простых (обычный метод наименьших квадратов) до более сложных (метод наименьших квадратов с итерационным повторным взвешиванием).
Линейные модели в statsmodels имеют два основных интерфейса: на основе массивов и на основе формул. Доступ к ним производится путем импорта следующих модулей:

import statsmodels.api as sm
import statsmodels.formula.api as smf

Чтобы продемонстрировать их использование, сгенерируем линейную модель по случайным данным. Выполните следующий код в ячейке Jupyter:

# Для воспроизводимости результатов
rng = np.random.default_rng(seed=12345)

def dnorm(mean, variance, size=1):
    if isinstance(size, int):
        size = size,
    return mean + np.sqrt(variance) * rng.standard_normal(*size)

N = 100
X = np.c_[dnorm(0, 0.4, size=N),
          dnorm(0, 0.6, size=N),
          dnorm(0, 0.2, size=N)]
eps = dnorm(0, 0.1, size=N)
beta = [0.1, 0.3, 0.5]

y = np.dot(X, beta) + eps

Здесь я записал «истинную» модель с известными параметрами beta. В данном случае dnorm — вспомогательная функция для генерирования нормально распределенных данных с заданными средним и дисперсией. Таким образом, имеем:

In [66]: X[:5]
Out[66]:
array([[-0.9005, -0.1894, -1.0279],
       [ 0.7993, -1.546 , -0.3274],
       [-0.5507, -0.1203,  0.3294],
       [-0.1639,  0.824 ,  0.2083],
       [-0.0477, -0.2131, -0.0482]])

In [67]: y[:5]
Out[67]: array([-0.5995, -0.5885,  0.1856, -0.0075, -0.0154])

При обучении линейной модели обычно присутствует свободный член, как мы видели ранее при изучении Patsy. Функция sm.add_constant может добавить столбец свободного члена в существующую матрицу:

In [68]: X_model = sm.add_constant(X)

In [69]: X_model[:5]
Out[69]: