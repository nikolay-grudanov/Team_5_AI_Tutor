---
source_image: page_348.png
page_number: 348
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 27.47
tokens: 7645
characters: 1627
timestamp: 2025-12-24T02:49:34.010622
finish_reason: stop
---

10.5. Сводные таблицы и перекрестная табуляция

In [158]: g.transform('mean')
Out[158]:
0    4.5
1    5.5
2    6.5
3    4.5
4    5.5
5    6.5
6    4.5
7    5.5
8    6.5
9    4.5
10   5.5
11   6.5
Name: value, dtype: float64

In [159]: normalized = (df['value'] - g.transform('mean')) / g.transform('std')

In [160]: normalized
Out[160]:
0   -1.161895
1   -1.161895
2   -1.161895
3   -0.387298
4   -0.387298
5   -0.387298
6    0.387298
7    0.387298
8    0.387298
9    1.161895
10   1.161895
11   1.161895
Name: value, dtype: float64

Здесь мы выполняем арифметические операции между выходами нескольких операций GroupBy, вместо того чтобы написать функцию и передать ее методу groupby(...).apply. Именно это и понимается под «развертыванием».
Хотя развернутая групповая операция может включать несколько групповых агрегирований, выгода, достигаемая за счет векторизации операций, часто перевешивает.

10.5. СВОДНЫЕ ТАБЛИЦЫ И ПЕРЕКРЕСТНАЯ ТАБУЛЯЦИЯ

Сводная таблица — это средство обобщения данных, применяемое в электронных таблицах и других аналитических программах. Оно агрегирует таблицу по одному или нескольким ключам и строит другую таблицу, в которой одни групповые ключи расположены в строках, а другие — в столбцах. Библиотека pandas позволяет строить сводные таблицы с помощью описанного выше механизма groupby в сочетании с операциями изменения формы с применением иерархического индексирования. В классе DataFrame имеется метод pivot_table, а на верхнем уровне — функция pandas.pivot_table. Помимо удобного интерфейса к groupby, функция pivot_table еще умеет добавлять частичные итоги, которые называются маргинами.