---
source_image: page_401.png
page_number: 401
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.98
tokens: 7733
characters: 1815
timestamp: 2025-12-24T02:51:25.825588
finish_reason: stop
---

Out[28]:
    x0   x1   y  category_a  category_b
0   1  0.01 -1.5         1           0
1   2 -0.01  0.0         0           1
2   3  0.25  3.6         1           0
3   4 -4.10  1.3         1           0
4   5  0.00 -2.0         0           1

При аппроксимации некоторых статистических моделей с помощью индикаторных переменных возникают нюансы. Если приходится работать не только с числовыми столбцами, то, пожалуй, проще и безопаснее использовать библиотеку Patsy (тема следующего раздела).

12.2. ОПИСАНИЕ МОДЕЛЕЙ С ПОМОЩЬЮ PATSY

Patsy (https://patsy.readthedocs.io/en/latest/) — написанная на Python библиотека для описания статистических моделей (особенно линейных) с применением простого строкового «синтаксиса формул», в основу которого положены формулы из языков статистического программирования R и S (с некоторыми изменениями).

Patsy широко используется в statsmodels для задания линейных моделей, поэтому я расскажу об основных чертах, чтобы вам было проще приступить к работе с ней. Для формул в Patsy применяется такой синтаксис:

y ~ x0 + x1

Конструкция a + b — это не сложение a и b, имеется в виду, что это термы созданной для модели матрицы плана. Функция patsy.dmatrices принимает строку формулы вместе с набором данных (который может быть представлен в виде объекта DataFrame или словаря массивов) и порождает матрицы плана для линейной модели:

In [29]: data = pd.DataFrame({
    ....:     'x0': [1, 2, 3, 4, 5],
    ....:     'x1': [0.01, -0.01, 0.25, -4.1, 0.],
    ....:     'y': [-1.5, 0., 3.6, 1.3, -2.]})

In [30]: data
Out[30]:
    x0   x1   y
0   1  0.01 -1.5
1   2 -0.01  0.0
2   3  0.25  3.6
3   4 -4.10  1.3
4   5  0.00 -2.0

In [31]: import patsy

In [32]: y, X = patsy.dmatrices('y ~ x0 + x1', data)

Теперь имеем:

In [33]: y
Out[33]:
DesignMatrix with shape (5, 1)
    y
-1.5