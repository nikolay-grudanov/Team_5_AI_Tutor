---
source_image: page_425.png
page_number: 425
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 23.20
tokens: 7467
characters: 1604
timestamp: 2025-12-24T02:51:55.849405
finish_reason: stop
---

Рис. 13.3. Процентная доля пользователей Windows и прочих в первых 10 часовых поясах

Нормированную сумму можно было бы вычислить эффективнее, воспользовавшись методом transform в сочетании с groupby:

In [67]: g = count_subset.groupby("tz")

In [68]: results2 = count_subset["total"] / g["total"].transform("sum")

13.2. Набор данных MovieLens 1M

Исследовательская группа GroupLens Research (https://grouplens.org/datasets/movielens/) предлагает несколько наборов данных о рейтингах фильмов, предоставленных пользователями сайта MovieLens в конце 1990-х — начале 2000-х. Наборы содержат рейтинги фильмов, метаданные о фильмах (жанр и год выхода) и демографические данные о пользователях (возраст, почтовый индекс, пол и род занятий). Такие данные часто представляют интерес для разработки систем рекомендования, основанных на алгоритмах машинного обучения. И хотя в этой книге методы машинного обучения не рассматриваются, я все же покажу, как формировать продольные и поперечные разрезы таких наборов данных с целью привести их к нужному виду.

Набор MovieLens 1М содержит 1 млн рейтингов 4000 фильмов, проставленных 6000 пользователей. Данные распределены по трем таблицам: рейтинги, информация о пользователях и информация о фильмах. Каждую таблицу можно загрузить в отдельный объект DataFrame с помощью метода pandas.read_table. Выполните следующий код в ячейке Jupyter:

unames = ["user_id", "gender", "age", "occupation", "zip"]
users = pd.read_table("datasets/movielens/users.dat", sep="::",
    header=None, names=unames, engine="python")
rnames = ["user_id", "movie_id", "rating", "timestamp"]