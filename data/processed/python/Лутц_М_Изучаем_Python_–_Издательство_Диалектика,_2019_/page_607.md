---
source_image: page_607.png
page_number: 607
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.13
tokens: 7963
characters: 3338
timestamp: 2025-12-24T01:26:14.070193
finish_reason: stop
---

Написание кода со сложными включениями может быть веселым академическим развлечением, но ему не место в программах, которые когда-нибудь придется разбирать другим.

Поэтому вот вам мой совет: в начале работы с Python применяйте простые циклы for и включения или вызовы map в отдельных случаях, где их легко использовать. Как всегда, здесь применимо правило "сохраняйте его простым": лаконичность кода — гораздо менее важная цель, чем его читабельность. Если вы вынуждены переводить код в операторы, чтобы понять его, то вероятно там и должны быть операторы. Таким образом, старый акроним KISS по-прежнему актуален: фраза Keep It Simple (сохраняйте его простым), за которой следует либо слово, считающееся в наши дни слишком сексистским (Sir (сэр)), либо чересчур красочным для такой книги, читаемой всей семьей...

Обратная сторона: производительность, лаконичность, выразительность

Тем не менее, применительно к данному случаю в настоящее время дополнительная сложность дает солидное преимущество в плане производительности: современные тесты в Python показывают, что вызовы map могут выполняться вдвое быстрее эквивалентных циклов for, а списковые включения зачастую даже быстрее вызовов map. Разница в скорости может варьироваться в зависимости от особенностей использования и версии Python, но в целом объясняется тем фактом, что map и списковые включения выполняются со скоростью кода на языке C внутри интерпретатора, которая часто гораздо выше, чем скорость выполнения байт-кода циклов for внутри PVM.

Вдобавок списковые включения обеспечивают лаконичность кода, которая поощряется и даже предписывается, когда из такого сокращения размера не вытекает также уменьшение смысла для следующего программиста. Кроме того, многие считают выразительность включений мощным союзником. Поскольку вызовы map и списковые включения представляют собой выражения, синтаксически они также разрешены в местах, где операторы цикла for не допускаются, скажем, в теле функций lambda, внутри списковых и словарных литералов и т.п.

По указанным причинам списковые включения и вызовы map заслуживают изучения и применения для более простых видов итераций, особенно если скорость приложения является важным фактором. Однако из-за того, что циклы for делают логику более явной, они в целом рекомендуются на основании простоты и зачастую для получения более прямолинейного кода. В случае использования вы должны стараться сохранять вызовы map и списковые включения простыми; для более сложных задач взамен применяйте полные операторы.

Как уже упоминалось, выигрыш в производительности зависит от моделей вызовов, а также изменений и оптимизаций в самом Python. Например, в недавних выпусках Python было ускорено выполнение простого оператора цикла for. Тем не менее, в определенном коде списковые включения по-прежнему выполняются значительно быстрее циклов for и даже вызовов map, хотя функция map все еще может выигрывать, когда альтернативные варианты должны применять вызов функции — встроенной или какой-то другой. До тех пор, пока ситуация своевольно не изменится, самостоятельно измеряйте время выполнения альтернативных реализаций с помощью инструментов в стандартном библиотечном модуле time или более новом модуле timeit, появившемся в версии Python 2.4. В следующей главе мы подробно обсудим оба модуля и докажем приведенные выше утверждения.