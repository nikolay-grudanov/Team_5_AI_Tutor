---
source_image: page_510.png
page_number: 510
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 38.10
tokens: 7956
characters: 3191
timestamp: 2025-12-24T01:23:22.650495
finish_reason: stop
---

Другие области видимости Python: обзор

Хотя в текущем месте книги это не особенно ясно, формально в Python есть еще три области видимости — временные переменные циклов в ряде включений, переменные ссылок на исключения в некоторых обработчиках try и локальные области видимости в операторах class. Первые две являются особыми случаями, редко влияющими на реальный код, а третья подпадает под действие правила LEGB.

Большинство блоков операторов и прочих конструкций не локализуют имена, используемые внутри них, кроме перечисленных ниже ситуаций, специфичных к версиям (их переменные не доступны в окружающем коде, но не конфликтуют с ним, и затрагивают темы, которые раскрываются позже в книге).

• Переменные включений — переменная X, применяемая для ссылки на элемент текущей итерации в выражении включения вроде [X for X in I]. Поскольку они могут конфликтовать с другими именами и отражать внутреннее состояние в генераторах, в Python 3.x такие переменные являются локальными для самого выражения во всех формах включений: генератора, списка, множества и словаря. В Python 2.x они локальны в генераторных выражениях, а также во включениях множеств и словарей, но не в списковых включениях, которые отображают свои имена на область видимости за пределами выражения. Напротив, операторы цикла for никогда не локализуют свои переменные внутри блока операторов в любой версии Python. За дополнительными деталями и примерами обращайтесь в главу 20.

• Переменные исключений — переменная X, используемая для ссылки на сгенерированное исключение в конструкции обработчика оператора try наподобие except E as X. Из-за того, что они могут задерживать освобождение памяти при сборке мусора, в Python 3.x такие переменные являются локальными в этом блоке except и на самом деле уничтожаются при выходе из блока (даже если они применялись ранее в коде!). В Python 2.x указанные переменные продолжают существовать после оператора try. Дополнительные сведения приведены в главе 34.

Описанные контексты дополняют правило LEGB, а не модифицируют его. Например, переменные, присвоенные во включении, просто связываются с добавочной особой областью видимости; другие имена, на которые производятся ссылки внутри таких выражений, следуют обычному правилу поиска LEGB.

Полезно отметить, что рассматриваемый в части VI оператор class тоже создает новую локальную область видимости для имен, присваиваемых внутри верхнего уровня своего блока. Что касается def, то присваиваемые внутри class имена не конфликтуют с именами в других местах и подчиняются правилу поиска LEGB, где блок class относится к уровню L. Подобно модулям и импортированию после окончания операторов class такие имена также превращаются в атрибуты объектов класса.

Тем не менее, в отличие от функций имена class не создаются посредством вызова: обращения к объектам класса генерируют экземпляры, которые наследуют имена, присвоенные внутри class, и записывают объектное состояние в виде атрибутов. В главе 29 будет показано, что хотя правило LEGB используется для распознавания имен на верхнем уровне класса и на верхнем уровне вложенных в него функций методов, при поиске областей видимости сами классы пропускаются — их имена должны