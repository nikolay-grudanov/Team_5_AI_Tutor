---
source_image: page_658.png
page_number: 658
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.32
tokens: 8145
characters: 2541
timestamp: 2025-12-24T01:27:54.248846
finish_reason: stop
---

>>> from timer2 import total, bestof, bestoftotal
>>> total(pow, 2, 1000)[0]      # 2 ** 1000, по умолчанию 1K повторений
0.0029126689999969813
>>> total(pow, 2, 1000, _reps=1000)[0]      # 2 ** 1000, 1K повторений
0.0029414920000050415
>>> total(pow, 2, 1000, _reps=1000000)[0]    # 2 ** 1000, 1M повторений
3.00479376699999953

>>> bestof(pow, 2, 100000)[0]      # 2 ** 100K, по умолчанию 5 повторений
0.0012310569999840482
>>> bestof(pow, 2, 1000000, _reps=30)[0]    # 2 ** 1M, лучшее из 30
0.01770887500001095
>>> bestoftotal(str.upper, 'spam', _reps1=30, _reps=1000)    # Лучшее из 30,
# суммарное из 1K
(0.0001740769999969416, 'SPAM')
>>> bestof(total, str.upper, 'spam', _reps=30)    # Вложенные вызовы тоже работают
(0.00020669299999553914, (0.00017521499998451873, 'SPAM'))

Чтобы взглянуть, как теперь поддерживаются ключевые аргументы, определим функцию с большим количеством аргументов и передадим некоторые по имени:

>>> def spam(a, b, c, d): return a + b + c + d
>>> total(spam, 1, 2, c=3, d=4, _reps=1000)
(0.0004759640000031595, 10)
>>> bestof(spam, 1, 2, c=3, d=4, _reps=1000)
(2.276000003575973e-06, 10)
>>> bestoftotal(spam, 1, 2, c=3, d=4, _reps1=1000, _reps=1000)
(0.00046306799998774295, 10)
>>> bestoftotal(spam, *(1, 2), _reps1=1000, _reps=1000, **dict(c=3, d=4))
(0.0004585180000162836, 10)

Использование аргументов с передачей только по ключевым словам в Python 3.x

И последний момент: чтобы упростить код модуля для измерения времени, мы также можем применять аргументы с передачей только по ключевым словам Python 3.x. Как выяснилось в главе 18, аргументы с передачей только по ключевым словам идеально подходят для конфигурационных параметров, таких как аргумент _reps наших функций. Они должны записываться после * и перед ** в заголовке функции, а в вызове функции обязаны передаваться по ключевому слову и находиться перед ** при их наличии. Ниже представлена альтернативная версия предыдущего модуля, использующая аргументы с передачей только по ключевым словам. Несмотря на более простой вид, она компилируется и выполняется только в Python 3.x, но не Python 2.x:

# Файл timer3.py (только Python 3.x)
"""
Используется в точности как timer2.py, но для получения более простого кода применяет аргументы с передачей только по ключевым словам и стандартными значениями Python 3.x.
Выносить вызов range() за пределы тестов в Python 3.x нет нужды, т.к. он всегда дает генератор; данная версия не будет работать в Python 2.x.
"""

import time, sys
timer = time.clock if sys.platform[:3] == 'win' else time.time