---
source_image: page_767.png
page_number: 767
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.65
tokens: 7796
characters: 1775
timestamp: 2025-12-24T01:31:21.509455
finish_reason: stop
---

tests += -1.2345, -1.2, -0.2345
tests += -(2 ** 32), -(2**32 + .2345)
tests += (2 ** 100), -(2 ** 100)
for test in tests:
    print('%s [%s]' % (money(test, 17), test))
import sys
if len(sys.argv) == 1:
    selftest()
else:
    print(money(float(sys.argv[1]), int(sys.argv[2])))

Код в файле работает одинаково в Python 2.x и 3.x. Когда файл запускается напрямую, он тестирует сам себя, но за счет указания параметров в командной строке можно управлять поведением тестирования. Запустите сценарий formats.py напрямую без аргументов командной строки, чтобы просмотреть вывод его кода самотестирования — из-за большого объема ниже приведена только часть вывода:

c:\code> python formats.py
0
1
12
123
1,234
12,345
123,456
1,234,567
...и так далее...

Для тестирования со специфическими строками передавайте их в командной строке вместе с минимальной шириной поля; код __main__ сценария передаст их функции money, которая в свою очередь запустит commas:

C:\code> python formats.py 999999999 0
$999,999,999.00
C:\code> python formats.py -999999999 0
$-999,999,999.00
C:\code> python formats.py 123456789012345 0
$123,456,789,012,345.00
C:\code> python formats.py -123456789012345 25
$ -123,456,789,012,345.00
C:\code> python formats.py 123.456 0
$123.46
C:\code> python formats.py -123.454 0
$-123.45

Как и ранее, поскольку код снабжен возможностью работы в двойном режиме, мы также можем импортировать его инструменты обычным образом, чтобы применять их как библиотечные компоненты в сценариях, модулях и интерактивной подсказке:

>>> from formats import money, commas
>>> money(123.456)
'$123.46'
>>> money(-9999999.99, 15)
'$ -9,999,999.99'
>>> X = 9999999999999999999999999999999
>>> '%s (%s)' % (commas(X), X)
'99,999,999,999,999,999,999 (9999999999999999999999999999999)'