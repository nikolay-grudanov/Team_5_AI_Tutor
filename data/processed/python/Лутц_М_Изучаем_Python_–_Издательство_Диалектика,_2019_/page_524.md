---
source_image: page_524.png
page_number: 524
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 42.17
tokens: 7903
characters: 3087
timestamp: 2025-12-24T01:23:54.468692
finish_reason: stop
---

стандартных значениях аргументов и атрибутах функций. Некоторые могут включить в данный список и изменяемые стандартные аргументы (хотя другие могут пожелать, чтобы это не делалось).

Мы кратко обсудим альтернативы и коснемся атрибутов функций позже в главе, а полную историю об аргументах и стандартных значениях представим в главе 18. Тем не менее, в следующем разделе предлагается введение, которое поможет оценить, каким образом стандартные значения участвуют в сохранении состояния.

Замыкания также могут создаваться, когда определение class вкладывается в оператор def: значения локальных имен объемлющей функции сохраняются за счет ссылок внутри класса или одного из его функций методов. Дополнительные сведения о вложенных классах ищите в главе 29. Как вы увидите в примерах далее в книге (скажем, при обсуждении декораторов в главе 39), внешний оператор def в таком коде исполняет похожую роль: он становится фабрикой классов и обеспечивает сохранение состояния для вложенного класса.

Сохранение состояния из объемлющей области видимости с помощью стандартных значений

В ранних версиях Python (до Python 2.2) разновидность кода из предыдущего раздела потерпела бы неудачу, потому что вложенные операторы def ничего не делали в отношении областей видимости. В показанном ниже коде ссылка на переменную внутри f2 инициировала бы поиск только в локальной (f2), далее в глобальной (код вне f1) и затем во встроенной области видимости. Из-за того, что поиск пропускал области видимости объемлющих функций, результатом была ошибка. В качестве обходного приема программисты обычно применяли стандартные значения аргументов для передачи и запоминания объектов в объемлющей области видимости:

def f1():
    x = 88
    def f2(x=x):
        # Запоминает X из объемлющей области видимости
        # посредством стандартных значений
        print(x)
    f2()
f1()                # Выводит 88

Такой стиль написания кода подходит для всех выпусков Python и вы будете по-прежнему встречать данный шаблон в существующем коде Python. На самом деле, как вскоре будет показано, он все еще обязателен для переменных цикла и потому заслуживает изучения даже в наши дни. Если кратко, то синтаксис arg=val в заголовке def означает, что аргумент arg по умолчанию получит значение val, когда никакого реального значения для arg в вызове не передается. Здесь этот синтаксис используется для явной установки подлежащего сохранению состояния из объемлющей области видимости.

В частности, в модифицированной функции f2, показанной выше, x=x означает, что аргумент x по умолчанию получит значение переменной x из объемлющей области видимости — поскольку аргумент x оценивается до того, как Python переходит внутрь вложенного оператора def, он по-прежнему ссылается на x в f1. В сущности, стандартное значение аргумента запоминает, каким было значение x в f1: объектом 88.

Все это довольно-таки сложно и полностью зависит от того, когда происходит оценка стандартного значения. В действительности правило поиска во вложенных областях видимости было добавлено в Python для того, чтобы сделать стандартные