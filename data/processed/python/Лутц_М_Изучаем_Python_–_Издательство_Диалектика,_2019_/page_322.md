---
source_image: page_322.png
page_number: 322
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.20
tokens: 7800
characters: 2713
timestamp: 2025-12-24T01:17:22.918576
finish_reason: stop
---

венным двоичным файлом, как те, что встречались ранее. Чтобы разобрать значения в нормальные объекты Python, мы просто читаем строку из файла и распаковываем ее с применением той же самой строки формата. Python извлекает значения в стандартные объекты — целые числа и строку:

```python
>>> F = open('data.bin', 'rb')
>>> data = F.read()        # Получение упакованных двоичных данных
>>> data
b'\x00\x00\x00\x07spam\x00\x08'
>>> values = struct.unpack('>i4sh', data) # Преобразование в объекты Python
>>> values
(7, b'spam', 8)
```

Файлы двоичных данных — это развитые и отчасти низкоуровневые инструменты, которые мы не будем здесь раскрывать более подробно; дополнительную информацию можно получить в главе 37, где рассматривается модуль struct, в руководстве по библиотеке Python или интерактивно с помощью функции help, передав ей импортированный модуль struct. Также важно отметить, что вы можете использовать двоичные режимы 'wb' и 'rb' для обработки более простого двоичного файла, хранящего изображение или аудиозапись, как единого целого, не распаковывая его содержимое; в таких случаях ваш код может передавать его без разбора другим файлам либо инструментам.

Диспетчеры контекстов для файлов

Вас также заинтересует обсуждение поддержки диспетчеров контекстов для файлов в главе 34, которая появилась в версиях Python 3.0 и 2.6. Хотя такая поддержка больше относится к средствам обработки исключений, чем к самим файлам, она позволяет поместить код обработки файла внутрь уровня логики, который гарантирует, что файл будет закрыт (а его буферы вывода сброшены на диск в случае необходимости) автоматически при выходе вместо того, чтобы полагаться на автоматическое закрытие во время сборки мусора:

```python
with open(r'C:\code\data.txt') as myfile:    # Детали приводятся в главе 34
    for line in myfile:
        ...обработка строк файла...
```

Оператор try/finally, также обсуждаемый в главе 34, способен предоставить аналогичную функциональность, но за счет дополнительного кода — точнее трех добавочных строк (тем не менее, мы часто можем избежать обоих вариантов и разрешить Python закрывать файлы автоматически):

```python
myfile = open(r'C:\code\data.txt')
try:
    for line in myfile:
        ...обработка строк файла...
finally:
    myfile.close()
```

Схема диспетчера контекста with обеспечивает освобождение системных ресурсов во всех версиях Python и может оказаться более удобной для гарантирования сброса буферов выходных файлов; однако в отличие от более универсального оператора try она также ограничена объектами, которые поддерживают ее протокол. Но поскольку оба варианта требуют большего объема информации, чем получено к настоящему моменту, мы рассмотрим их позже в книге.