---
source_image: page_791.png
page_number: 791
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 31.58
tokens: 7825
characters: 2715
timestamp: 2025-12-24T01:31:55.921364
finish_reason: stop
---

File "<pyshell#0>", line 1, in <module>
    import recur1
File "C:\Code\recur1.py", line 2, in <module>
    import recur2    # Запустить модуль recur2 сейчас, когда он не существует
File "C:\Code\recur2.py", line 2, in <module>
    from recur1 import Y    # Ошибка: имя Y пока не существует
ImportError: cannot import name 'Y' from 'recur1' (C:\Code\recur1.py)
Трассировка (самый последний вызов указан последним):
    Файл "<pyshell#0>", строка 1, в <модуль>
        import recur1
    Файл "C:\Code\recur1.py", строка 2, in <модуль>
        import recur2    # Запустить модуль recur2 сейчас, когда он не существует
    Файл "C:\Code\recur2.py", строка 2, in <модуль>
        from recur1 import Y    # Ошибка: имя Y пока не существует
Ошибка импортирования: не удалось импортировать имя Y из recur1
(C:\Code\recur1.py)

Python избегает повторного выполнения операторов модуля recur1, когда он рекурсивно импортируется из recur2 (иначе операции импортирования отправляли бы сценарий в бесконечный цикл, который мог бы требовать нажатия <Ctrl+C> или чего-то более радикального), но пространство имен модуля recur1 является незавершенным, когда он импортируется в модуле recur2.

Каково решение? Не используйте from в рекурсивных операциях импортирования (правда, не используйте!). В противном случае, хотя Python не допустит зациклования, ваши программы снова станут зависимыми от порядка следования операторов в модулях. В действительности есть два способа выйти из этого затруднительного положения.

• Обычно вы всегда можете устранить циклы при импортировании вроде продемонстрированного выше за счет аккуратного проектирования — доведение до максимума сцепления и минимизация связности модулей будут хорошими начальными шагами.

• Если вы не в состоянии полностью разорвать циклы, тогда отложите доступ к именам модулей с применением операторов import и уточнения с помощью атрибутов (вместо from и прямых имен) или запускайте операторы from либо внутри функций (вместо верхнего уровня модуля), либо ближе к концу файла, чтобы отсрочить их выполнение.

Дополнительные соображения относительно этой проблемы вы найдете в упражнениях в конце настоящей главы.

Резюме

В главе был представлен обзор ряда более сложных концепций, связанных с модулями. Вы изучили методики сокрытия данных, включение новых языковых средств с помощью модуля __future__, переменную режима использования __name__, транзитивные перезагрузки, импортирование по строкам с именами и т.д. Мы также исследовали и подвели итоги по проблемам, связанным с проектированием модулей, написали несколько более значительных программ и рассмотрели распространенные заблуждения, касающиеся модулей, чтобы помочь вам избежать их при написании своего кода.