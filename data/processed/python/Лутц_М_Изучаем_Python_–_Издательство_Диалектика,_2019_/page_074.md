---
source_image: page_074.png
page_number: 74
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.83
tokens: 7977
characters: 3227
timestamp: 2025-12-24T01:09:13.500225
finish_reason: stop
---

няет большинство кода CPython, хотя модули расширений С обычно должны быть перекомпилированы, и система PyPy имеет ряд незначительных, но тонких языковых отличий, в том числе семантику сборки мусора, которая позволяет избежать нескольких распространенных паттернов кодирования. Например, ее схема без подсчета ссылок означает, что временные файлы можно не закрывать и не сбрасывать выходные буферы немедленно, но в ряде случаев могут требоваться вызовы функций закрытия вручную.

Взамен ваш код может выполняться намного быстрее. В текущий момент заявлено, что PyPy дает ускорение в 7,6 раза по сравнению с CPython, что подтверждается целым диапазоном эталонных тестовых программ (http://speed.pyru.org/). В отдельных случаях способность PyPy получить преимущества от возможностей динамической оптимизации может сделать код Python таким же быстрым, как код C, а временами и быстрее. Сказанное особенно справедливо для громоздких алгоритмических и численных программ, которые иначе могли быть переписаны на C.

Например, в одном простом эталонном тесте, который мы увидим в главе 21, PyPy оказывается в 10 раз быстрее, чем CPython 2.7, и в 100 раз быстрее, чем CPython 3.x. Несмотря на то что другие эталонные тесты будут варьироваться, такое ускорение может стать неоспоримым преимуществом во многих предметных областях и возможно даже в большей степени, нежели самые передовые языковые средства. Не менее важно и то, что пространство памяти в PyPy также оптимизировано — один из опубликованных эталонных тестов потребовал 247 Мбайт и 10,3 секунды на завершение по сравнению с 684 Мбайт и 89 секунд в случае CPython.

Цепочка инструментов PyPy также достаточно общая, чтобы поддерживать дополнительные языки, включая Pyrolog (интерпретатор Prolog, написанный на Python с использованием транслятора PyPy. В текущий момент веб-сайт PyPy находится по адресу http://pyru.org. Обзор производительности доступен по ссылке http://www.pyru.org/performance.html.

Инструменты оптимизации выполнения

CPython и большинство альтернатив, рассмотренных в предыдущем разделе, реализуют язык Python похожими способами: путем компиляции исходного кода в байт-код и выполнения байт-кода на подходящей виртуальной машине. Некоторые системы, такие как гибрид Cython, транслятор Shed Skin C++ и JIT-компиляторы в PyPy и Psyco, взамен пытаются оптимизировать базовую модель выполнения. Знание этих систем на данном этапе вашей карьеры в области Python обязательным не является, но быстрый взгляд на их место в модели выполнения может помочь прояснить модель в целом.

Cython: гибрид Python/C

Система Cython (основанная на работе в рамках проекта Pyrex) представляет собой гибридный язык, который объединяет код Python с возможностью вызова функций C и использования объявлений типов C для переменных, параметров и атрибутов классов. Код Cython может компилироваться в код C, где применяется API-интерфейс Python/C, который затем можно скомпилировать полностью. Несмотря на отсутствие полной совместимости со стандартным языком Python, система Cython может быть полезной при построении оболочек для внешних библиотек C и написании кода эффективных расширений C для Python. Текущее состояние и детали системы доступны на веб-сайте http://cython.org.