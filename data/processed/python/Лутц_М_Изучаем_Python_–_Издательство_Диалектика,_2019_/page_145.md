---
source_image: page_145.png
page_number: 145
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 33.80
tokens: 7912
characters: 2861
timestamp: 2025-12-24T01:11:29.148399
finish_reason: stop
---

Списковые включения

В дополнение к операциям над последовательностями и списковым методам в Python имеется более сложная операция, известная как выражение спискового включения (list comprehension), которая оказывается мощным способом обработки структур, подобных нашей матрице. Предположим, например, что необходимо извлечь второй столбец из матрицы. Получать строки легко посредством простой индексации, потому что матрица хранится по строкам, но получить столбец почти так же легко с помощью спискового включения:

```python
>>> col2 = [row[1] for row in M]    # Собирать элементы в столбце 2
>>> col2
[2, 5, 8]
>>> M                                # Матрица не изменилась
[[1, 2, 3], [4, 5, 6], [7, 8, 9]]
```

Списковые включения происходят от системы обозначения множеств; они являются способом построения нового списка за счет выполнения выражения на каждом элементе в последовательности, по одному за раз, слева направо. Списковые включения записываются в квадратных скобках (намекая на тот факт, что они создают список) и состоят из выражения и циклической конструкции, которые разделяют имя переменной (здесь row). Предыдущее списковое включение означает "предоставить row[1] из каждой строки матрицы M в новом списке". Результатом будет новый список, содержащий столбец 2 матрицы.

На практике списковые включения могут быть более сложными:

```python
>>> [row[1] + 1 for row in M]      # Добавить 1 к каждому элементу в столбце 2
[3, 6, 9]
>>> [row[1] for row in M if row[1] % 2 == 0]   # Отфильтровать нечетные элементы
[2, 8]
```

Первая операция добавляет 1 к каждому элементу по мере их накопления, а вторая использует конструкцию if для фильтрации нечетных чисел из результата с применением выражения целочисленного деления (%). Списковые включения создают новые списки результатов, но они могут использоваться для прохода по любому итерируемому объекту — термин, который мы конкретизируем позже. Например, ниже списковые включения применяются для прохода по жестко закодированному списку координат и по строке:

```python
>>> diag = [M[i][i] for i in [0, 1, 2]]    # Собирать диагональ из матрицы
>>> diag
[1, 5, 9]
>>> doubles = [c * 2 for c in 'spam']     # Повторить символы в строке
>>> doubles
['ss', 'pp', 'aa', 'mm']
```

Такие выражения также могут использоваться для сбора множества значений при условии их помещения во вложенную коллекцию. Ниже демонстрируется применение range — встроенной функции, которая генерирует последовательные целые числа и в Python 3.x для отображения всех своих значений требует наличия окружающего вызова list (в Python 2.x одновременно создается физический список):

```python
>>> list(range(4))                      # 0..3 (в Python 3.x требуется вызов list())
[0, 1, 2, 3]
>>> list(range(-6, 7, 2))               # от -6 до +6 с шагом 2
# (в Python 3.x нужен вызов list())
[-6, -4, -2, 0, 2, 4, 6]
```