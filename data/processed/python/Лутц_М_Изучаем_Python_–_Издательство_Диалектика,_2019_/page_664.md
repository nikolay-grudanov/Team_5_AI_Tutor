---
source_image: page_664.png
page_number: 664
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.88
tokens: 7998
characters: 2586
timestamp: 2025-12-24T01:27:57.076469
finish_reason: stop
---

Для указания кода настройки в режиме командной строки применяется строка после флага -s (или несколько в случае многострочного кода настройки), а в режиме вызовов API-интерфейса — аргумент setup. В итоге тесты можно ориентировать более четко, как показано ниже, где инициализация списка выносится в код настройки, чтобы измерять время только итерации. Но запомните в качестве эмпирического правила, что чем больше кода вы включаете в тестируемый оператор, тем более применимыми обычно будут результаты тестирования к реалистичному коду:

c:\code> python -m timeit -n 1000 -r 3 "L = [1,2,3,4,5]" "M = [x + 1 for x in L]"
1000 loops, best of 3: 0.956 usec per loop

c:\code> python -m timeit -n 1000 -r 3 -s "L = [1,2,3,4,5]" "M = [x + 1 for x in L]"
1000 loops, best of 3: 0.775 usec per loop

Ниже демонстрируется настройка в режиме API-вызовов. Здесь измеряется время выполнения варианта, основанного на сортировке, из примера нахождения минимального значения, который рассматривался в главе 18 — упорядоченные диапазоны сортируются гораздо быстрее случайных чисел, и они сортируются быстрее, чем линейно просматриваются в коде примера в Python 3.7 (расположенные рядом строки объединяются):

>>> from timeit import repeat
>>> min(repeat(number=1000, repeat=3,
setup='from mins import min1, min2, min3\n'
    'vals=list(range(1000))',
stmt= 'min3(*vals)'))
0.017538969001179794

>>> min(repeat(number=1000, repeat=3,
setup='from mins import min1, min2, min3\n'
    'import random\nvals=[random.random() for i in range(1000)]',
stmt= 'min3(*vals)'))
0.13474658399900363

С помощью модуля timeit вы можете запрашивать только суммарное время, использовать API-интерфейс класса модуля, применять вызываемые объекты времени вместо строк, принимать автоматические счетчики циклов, а также использовать методики на основе классов, дополнительные переключатели командной строки и варианты аргументов API-интерфейса, описать которые в книге попросту не хватит места — детали ищите в руководстве по библиотеке Python:

c:\code> py -3
>>> import timeit
>>> timeit.timeit(stmt='[x ** 2 for x in range(1000)]', number=1000)
# Суммарное время
0.4288552190000008

>>> timeit.Timer(stmt='[x ** 2 for x in range(1000)]').timeit(1000)
# API-интерфейс класса модуля
0.4739268729999999

>>> timeit.repeat(stmt='[x ** 2 for x in range(1000)]', number=1000, repeat=3)
[0.43331713899999613, 0.4261321769999995, 0.42656452599999994]

>>> def testcase():
    y = [x ** 2 for x in range(1000)] # Вызываемые объекты или строки кода
>>> min(timeit.repeat(stmt=testcase, number=1000, repeat=3))
0.43041660699999795