---
source_image: page_491.png
page_number: 491
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 35.27
tokens: 7807
characters: 2673
timestamp: 2025-12-24T01:22:44.494424
finish_reason: stop
---

if found:
    print('at index', i)
else:
    print(X, 'not found')
C:\book\tests> python power.py
at index 5

В том виде, как есть, пример совершенно не следует обычным методикам написания кода Python. Выполните приведенные далее шаги, чтобы улучшить его (при внесении всех изменений вы можете либо набирать код интерактивно, либо сохранять его в файле сценария, запускаемом в командной строке системы — применение файла гораздо упрощает выполнение упражнения).

а) Сначала перепишите код с конструкцией else цикла while, чтобы избавиться от флага found и финального оператора if.

б) Затем перепишите код для использования цикла for с конструкцией else, чтобы избавиться от явной логики индексации списка. (Подсказка: для получения индекса элемента применяйте списковый метод index — L.index(X) возвращает смещение первого элемента X в списке L.)

в) Далее полностью устраните цикл, переписав код с использованием простого выражения с операцией членства in. (За дополнительными сведениями обращайтесь в главу 8 или наберите для тестирования 2 in [1,2,3].)

г) Наконец примените цикл for и списковый метод append для генерации списка степеней 2 (L) вместо жесткого кодирования спискового литерала.

Ниже приведены более глубокие рассуждения.

д) Как вы думаете, улучшит ли производительность перенос выражения 2 ** X за пределы циклов? Каким образом вы представили бы это в коде?

е) Как мы видели в первом упражнении, Python содержит инструмент map (функция, список), который также способен генерировать список степеней 2: map(lambda x: 2 ** x, range(7)). Попробуйте набрать этот код в интерактивной подсказке; мы опишем lambda более формально в следующей части книги, в частности, в главе 19. Поможет ли здесь списковое включение (см. главу 14)?

5. Сопровождение кода. Если вы еще таким не занимались, тогда поэкспериментируйте с внесением изменений в код, которые предлагались во врезке "Изменение цветов PyDoc" ранее в главе. Значительный объем работ при создании реального программного обеспечения связан с изменением существующего кода, так что чем раньше вы начнете делать это, тем лучше. Для справки отредактированная мною копия PyDoc находится в пакете примеров для книги по имени mypydoc.py. Чтобы выяснить ее отличия, можете запустить утилиту сравнения файлов (fc в Windows) с оригинальным пакетом pydoc.py из Python 3.3 (он также включен в состав на случай его радикального изменения в последующих версиях Python). Если PyDoc легче настраивается к моменту чтения этих строк, то настройте цвета согласно текущему соглашению; если процедура предусматривает изменение CSS-файла, то будем надеяться, что она окажется хорошо документированной в руководствах Python.