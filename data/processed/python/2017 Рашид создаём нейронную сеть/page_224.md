---
source_image: page_224.png
page_number: 224
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.18
tokens: 6727
characters: 2024
timestamp: 2025-12-24T02:14:48.987969
finish_reason: stop
---

набор входит также множество форм написания цифры “4”. Одни из них искусственно сжаты, другие растянуты, некоторые повернуты, в одних верхушка цифры разомкнута, в других сомкнута.

Разве не будет полезно создать дополнительные варианты написания и использовать их в качестве тренировочных примеров? Как это сделать? Нам трудно собрать коллекцию из тысячи дополнительных примеров рукописного написания той или иной цифры. Вернее, мы могли бы попытаться, но это стоило бы нам огромных усилий.

Но ведь ничто не мешает нам взять существующие примеры и создать на их основе новые, повернув цифры по часовой стрелке или против, скажем, на 10 градусов. В этом случае мы могли бы создать по два дополнительных примера для каждого из уже имеющихся. Мы могли бы создать гораздо больше примеров, вращая образцы на разные углы, но мы ограничимся углами +10 и −10 градусов, чтобы посмотреть, как работает эта идея.

И вновь большую помощь в этом нам окажут расширения и библиотеки Python. Функция scipy.ndimage.interpolation.rotate() поворачивает изображение, представленное массивом, на заданный угол, а это именно то, что нам нужно. Описание функции можно найти здесь:

https://docs.scipy.org/doc/scipy-0.16.0/reference/generated/scipy.ndimage.interpolation.rotate.html

Вспомните, что наши входные значения представляют собой одномерный список длиной 784 элемента, поскольку мы спроектировали нашу нейронную сеть таким образом, чтобы она принимала длинный список входных сигналов. Мы должны реорганизовать этот список в массив размерностью 28×28, чтобы повернуть изображение, а затем проделать обратную операцию по преобразованию массива в список из 784 входных сигналов, которые мы подадим на вход нейронной сети.

В приведенном ниже коде показан пример использования функции scipy.ndimage.interpolation.rotate() в предположении, что у нас уже имеется массив scaled_input, о котором шла речь ранее.

# создание повернутых на некоторый угол вариантов изображений

# повернуть на 10 градусов против часовой стрелки
inputs_plus10_img =