---
source_image: page_327.png
page_number: 327
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 42.19
tokens: 11886
characters: 2317
timestamp: 2025-12-24T01:49:43.082064
finish_reason: stop
---

Поговорим

Протоколы как неформальные интерфейсы

Протоколы — не изобретение Python. Авторы языка Smalltalk, пустившие в оборот также выражение «объектно-ориентированный», использовали слово «протокол» как синоним того, что сейчас называется интерфейсом. В некоторых средах программирования на Smalltalk программистам разрешалось помечать группу методов как протокол, но только в целях документирования и навигации — сам язык эту концепцию не поддерживал. Поэтому я полагаю, что «неформальный интерфейс» — разумное краткое объяснение существа «протокола» в выступлении перед аудиторией, больше знакомой с формальными (и поддержанными компилятором) интерфейсами.

Протоколы естественно возникают в любом языке с динамической типизацией, когда контроль типов производится во время выполнения, потому что в объявлениях переменных и сигнатур методов нет никакой статической информации о типе. Ruby — еще один важный объектно-ориентированный язык, в котором имеется динамическая типизация и используются протоколы.

В документации по Python протокол можно узнать по выражениям типа «объект, похожий на файл». Это сокращение фразы «нечто, что ведет себя в достаточной степени похоже на файл благодаря реализации тех частей интерфейса файла, которые существенны в данном контексте».

Кто-то решит, что реализация лишь части протокола — признак небрежного программирования, но у такого подхода есть преимущество — простота. В разделе 3.3 главы «Модель данных» (http://bit.ly/pydocs-smn) читаем такую рекомендацию:

При реализации класса, имитирующего встроенный тип, важно не заходить слишком далеко, а ограничиться лишь тем, что имеет смысл для моделируемого объекта. Например, для некоторых последовательностей вполне достаточно извлечения отдельных элементов, тогда как получение среза бессмысленно.

— Глава «Модель данных» справочного руководства по языку Python

Если мы можем обойтись без кодирования ненужных методов только для того, чтобы удовлетворить требованиям какого-то перенасыщенного функциональностью контракта, а компилятор при этом не будет ругаться, то становится проще следовать принципу KISS8 (http://en.wikipedia.org/wiki/KISS_principle). Мы еще вернемся к протоколам и интерфейсам в главе 11, которая, в основном, этой теме и посвящена.

8 Keep it simple, stupid — Будь проще, глупышка. — Прим. перев.