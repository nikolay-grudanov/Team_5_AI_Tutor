---
source_image: page_149.png
page_number: 149
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 59.14
tokens: 11998
characters: 2517
timestamp: 2025-12-24T01:41:56.095311
finish_reason: stop
---

Сортировка Unicode-текстов

ртировке9. Поэтому «cajá» сортируется так же, как «саја» и, следовательно, предшествует «сайу».

Отсортированный список fruits должен выглядеть так:

['açaí', 'acerola', 'atemoia', 'cajá', 'caju']

Стандартный способ сортировки не-ASCII текстов в Python — функция locale.strxfrm, которая, как написано в документации по модулю locale (http://bit.ly/1IqyCRf), «преобразует строку, так чтобы ее можно было использовать в сравнениях с учетом локали».

Чтобы можно было воспользоваться функцией locale.strxfrm, необходимо сначала установить локаль, отвечающую нуждам приложения, и надеяться, что ОС ее поддерживает. В системах на базе GNU/Linux (Ubuntu 14.04) при выборе локали pt_BR нужный результат дает последовательность команд в примере 4.19.

Пример 4.19. Использование функции locale.strxfrm в качестве ключа сортировки

```python
>>> import locale
>>> locale.setlocale(locale.LC_COLLATE, 'pt_BR.UTF-8')
'pt_BR.UTF-8'
>>> fruits = ['caju', 'atemoia', 'cajá', 'açaí', 'acerola']
>>> sorted_fruits = sorted(fruits, key=locale.strxfrm)
>>> sorted_fruits
['açaí', 'acerola', 'atemoia', 'cajá', 'caju']
```

Таким образом, до использования locale.strxfrm в качестве значения параметра key необходимо вызвать setlocale(LC_COLLATE, «ваша_локаль»).

Однако есть несколько подводных камней.

• Поскольку установка локали — глобальное действие, вызывать setlocale в библиотеке не рекомендуется. Приложение или каркас должны установить локаль в начале работы процесса и затем уже не менять.
• Локаль должна быть установлена в ОС, иначе вызов setlocale возбуждает исключение locale.Error: unsupported locale setting.
• Необходимо точно знать, как пишется имя локали. В системах, производных от Unix, имена неплохо стандартизованы и следуют соглашению 'код_языка.кодировка', но в Windows синтаксис сложнее: название языка-Диалект языка_Название региона.кодовая_страница. Отметим, что части «Название языка», «Диалект языка» и «Название региона» могут содержать пробелы, но каждая часть, кроме первой, должна начинаться специальным символом: дефисом, знаком подчеркивания и точкой. Все части, кроме названия языка, необязательны. Например, English_United States.850 означает: Название языка — «English», регион — «United States», кодовая страница — «850». Названия языков и регионов, которые Windows понимает,

9 Диакритические знаки оказывают влияние на сортировку в тех редких случаях, когда слова только ими и отличаются, в таком случае слово с диакритическим знаком предшествует слову без такого.