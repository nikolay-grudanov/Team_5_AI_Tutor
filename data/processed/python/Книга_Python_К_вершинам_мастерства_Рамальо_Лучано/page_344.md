---
source_image: page_344.png
page_number: 344
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 53.36
tokens: 11940
characters: 2424
timestamp: 2025-12-24T01:50:37.151648
finish_reason: stop
---

Глава 11. Интерфейсы: от протоколов до абстрактных базовых...

namedtuple): field_names может быть как одной строкой, в которой идентификаторы разделены пробелами или запятыми, так и последовательностью идентификаторов. Возникает соблазн воспользоваться функцией isinstance, но в примере 11.7 показано, как сделать это с помощью динамической типизации5.

Пример 11.7. Применение динамической типизации для обработки строки или итерируемого объекта, содержащего строки

try:
    field_names = field_names.replace(',', ' ').split()  # Заменяем запятые пробелами и разбиваем образовавшуюся строку, получая список имён.
except AttributeError:
    pass  # Теперь предполагаем, что field_names уже является итерируемым объектом, содержащим имена.
field_names = tuple(field_names)  # Чтобы убедиться в его итерируемости и заодно получить внутреннюю копию, создаем кортеж из того, что имеем.

(1) Предполагаем, что это строка (проще попросить прощения, чем испрашивать разрешение).
(2) Заменяем запятые пробелами и разбиваем образовавшуюся строку, получая список имён.
(3) Увы, field_names не крякает, как str... то ли метода .replace нет, то ли он возвращает нечто такое, к чему нельзя применить .split.
(4) Теперь предполагаем, что field_names уже является итерируемым объектом, содержащим имена.
(5) Чтобы убедиться в его итерируемости и заодно получить внутреннюю копию, создаем кортеж из того, что имеем.

Наконец, в своем эссе Алекс неоднократно подчеркивает, что не нужно усердствовать в создании ABC. Эпидемия ABC имела бы катастрофические последствия, вынуждая выполнять ненужные церемонии в языке, завоевавшем популярность своей практичностью и pragmatичностью. В своей рецензии на эту книгу Алекс написал:

ABC предназначены для инкапсуляции очень общих концепций, абстракций, характерных для каркаса, — таких вещей, как «последовательность» или «точное число». [Читателям], скорее всего, не придется писать новые ABC, а лишь правильно использовать существующие. В 99.9 % случаев этого будет достаточно для получения всех преимуществ без риска спроектировать что-то не то.

Ну а теперь посмотрим, как гусиная типизация выглядит на практике.

Создание подкласса ABC

Следуя совету Мартелли, мы воспользуемся существующим ABC collections.MutableSequence, перед тем как изобретать свой собственный. В примере 11.8 класс FrenchDeck2 явно объявлен подклассом collections.MutableSequence.

5 Этот фрагмент взят из примера 21.2.