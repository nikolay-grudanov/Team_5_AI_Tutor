---
source_image: page_227.png
page_number: 227
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 37.40
tokens: 11742
characters: 1563
timestamp: 2025-12-24T01:45:08.256168
finish_reason: stop
---

Декораторы в стандартной библиотеке

Одиночная диспетчеризация и обобщенные функции

Пусть требуется написать инструмент для отладки веб-приложений. Мы хотим, чтобы он умел генерировать HTML-представления объектов Python разного типа.

Можно было бы начать с такой функции:

import html

def htmlize(obj):
    content = html.escape(repr(obj))
    return '<pre>{}</pre>'.format(content)

Она будет работать для любого типа Python, но нам хотелось бы, чтобы для некоторых типов генерировались специальные представления:

• str: заменять внутренние символы новой строки строкой '<br>\n' и использовать теги <p> вместо <pre>;
• int: показывать число в десятичном и шестнадцатеричном виде;
• list: выводить HTML-список, в котором каждый элемент отформатирован в соответствии со своим типом.

Желательное поведение показано в примере 7.20.

Пример 7.20. Функция htmlize генерирует HTML-представление объектов разных типов

>>> htmlize({1, 2, 3}) ①
'<pre>{1, 2, 3}</pre>'
>>> htmlize(abs)
'<pre>&lt;built-in function abs&gt;</pre>'
>>> htmlize('Heimlich & Co.\n- a game') ②
'<p>Heimlich &amp; Co.<br>\n- a game</p>'
>>> htmlize(42) ③
'<pre>42 (0x2a)</pre>'
>>> print(htmlize(['alpha', 66, {3, 2, 1}])) ④
<ul>
<li><p>alpha</p></li>
<li><pre>66 (0x42)</pre></li>
<li><pre>{1, 2, 3}</pre></li>
</ul>

① По умолчанию HTML-представление объекта помещается между тегами <pre> и </pre>.

② Объекты типа str обертываются тегами <p> и </p>, а разрыв строки обозначается тегом <br>.

③ Число типа int показывается в десятичном и шестнадцатеричном виде между тегами <pre> и </pre>.