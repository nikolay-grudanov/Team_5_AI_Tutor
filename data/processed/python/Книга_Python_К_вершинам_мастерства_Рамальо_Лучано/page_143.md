---
source_image: page_143.png
page_number: 143
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 39.15
tokens: 11809
characters: 1976
timestamp: 2025-12-24T01:41:15.191319
finish_reason: stop
---

Нормализация Unicode для правильного сравнения

>>> name(micro), name(micro_kc)
('MICRO SIGN', 'GREEK SMALL LETTER MU')

В то время как '1/2' — разумная замена для '½', а знак «микро» действительно совпадает со строчной греческой буквой мю, преобразование '4²' в '42' изменяет смысл. Приложение могло бы сохранить '4²' как '4<sup>2</sup>', но функция normalize ничего не знает о форматировании. Поэтому формы NFKC и NFKD могут терять или искажать информацию, но в то же время дают удобное промежуточное представление для поиска и индексирования: пользователям понравится, что поиск по запросу '1/2 inch' находит также документы, содержащие строку '½ inch'.

Формы нормализации NFKC и NFKD следует применять с осторожностью и только в особых случаях, например для поиска и индексирования, а не для постоянного хранения, поскольку выполняемые ими преобразования могут приводить к потере данных.

Для подготовки текста к поиску или индексированию полезна еще одна операция: сворачивание регистра. Это и есть тема следующего раздела.

Сворачивание регистра

Сворачивание регистра — это, по существу, перевод всего текста в нижний регистр с некоторыми дополнительными преобразованиями. Для этой цели предназначен метод str.casefold() (появился в версии Python 3.3).

Если строка s содержит только символы из набора latin1, то s.casefold() дает такой же результат, как s.lower(), с двумя исключениями: знак «микро» 'μ' заменяется строчной греческой буквой мю (в большинстве шрифтов они выглядят одинаково), а немецкая «эсцет» (ß) преобразуется в «ss»:

>>> micro = 'μ'
>>> name(micro)
'MICRO SIGN'
>>> micro_cf = micro.casefold()
>>> name(micro_cf)
'GREEK SMALL LETTER MU'
>>> micro, micro_cf
('μ', 'μ')
>>> eszett = 'ß'
>>> name(eszett)
'LATIN SMALL LETTER SHARP S'
>>> eszett_cf = eszett.casefold()
>>> eszett, eszett_cf
('ß', 'ss')

В версии Python 3.4 существует 116 кодовых позиций, для которых str.casefold() и str.lower() дают различные результаты. Это 0,11 % от всех 110 122