---
source_image: page_238.png
page_number: 238
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 49.17
tokens: 11756
characters: 1913
timestamp: 2025-12-24T01:45:40.013007
finish_reason: stop
---

ваться из других областей видимости. Вопрос: как вычислять свободные переменные? Самое простое, что сразу приходит в голову: «динамическая область видимости». Это означает, что при вычислении свободных переменных просматривается окружение, в котором функция вызывается.

Если бы в Python были динамические области видимости, но не было замыканий, то функцию avg — аналогичную той, что приведена в примере 7.9, — можно было бы написать так:

```python
>>> ### это не настоящий сеанс оболочки Python! ###
>>> avg = make_averager()
>>> series = [] # 1
>>> avg(10)
10.0
>>> avg(11) # 2
10.5
>>> avg(12)
11.0
>>> series = [1] # 3
>>> avg(5)
3.0
```

1 Перед тем как использовать avg, мы должны сами определить список series = [], поскольку averager (внутри make_averager) ссылается на список по этому имени.
2 За кулисами series используется для хранения усредняемых значений.
3 При выполнении присваивания series = [1] предыдущий список затирается. Это может произойти случайно, если одновременно вычисляются два независимых средних.

Функции должны быть черными ящиками, их реализация должна быть скрыта от пользователя. Но если в функции имеются динамические переменные, то при использовании динамических областей видимости программист обязан знать внутреннее устройство функции, чтобы правильно настроить ее окружение.

С другой стороны, динамическую область видимости проще реализовать, и, наверное, именно поэтому Джон Маккарти (John McCarthy) выбрал такой путь при создании Lisp, первого языка, в котором появились полноправные функции. Статья Пола Грэхема (Paul Graham) «The Roots of Lisp» (http://www.paulgraham.com/rootsoflisp.html) содержит доступное объяснение оригинальной статьи Маккарти о языке Lisp «Recursive Functions of Symbolic Expressions and Their Computation by Machine, Part I» (Рекурсивные функции символьских выражений и их вычисление машиной, часть I) (http://bit.ly/mccarthy_recursive). Pa-