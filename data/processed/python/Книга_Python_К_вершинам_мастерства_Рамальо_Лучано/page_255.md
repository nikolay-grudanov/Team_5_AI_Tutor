---
source_image: page_255.png
page_number: 255
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 47.68
tokens: 11839
characters: 2158
timestamp: 2025-12-24T01:46:33.905357
finish_reason: stop
---

Параметры функций как ссылки

няемый объект и вы его изменили, то изменение отразится и на всех последующих вызовах функции.

Если после выполнения кода из примера 8.13 проинспектировать объект HauntedBus.__init__, то мы обнаружим школьников-призраков в его атрибуте __defaults__:

```python
>>> dir(HauntedBus.__init__) # doctest: +ELLIPSIS
['__annotations__', '__call__', ..., '__defaults__', ...]
>>> HauntedBus.__init__.__defaults__
(['Carrie', 'Dave'],)
```

Наконец, можно убедиться, что bus2.passengers — синоним первого элемента атрибута HauntedBus.__init__.__defaults__:

```python
>>> HauntedBus.__init__.__defaults__[0] is bus2.passengers
True
```

Описанная проблема и есть причина того, почему для параметров, принимающих изменяемые значения, часто по умолчанию задается значение None. В примере 8.8 __init__ проверяет, верно ли, что аргумент passengers совпадает с None, и, если это так, присваивает атрибуту self.passengers вновь созданный пустой список. В следующем разделе объясняется, что если passengers не совпадает с None, то правильное решение заключается в том, чтобы присвоить self.passengers копию этого атрибута.

Защитное программирование при наличии изменяемых параметров

При написании функции, принимающей изменяемый параметр, нужно тщательно обдумать, ожидает ли вызывающая сторона, что переданный аргумент может быть изменен.

Например, если функция принимает словарь и модифицирует его в процессе обработки, должен ли этот побочный эффект быть виден вне самой функции? Ответ зависит от контекста. Так или иначе, необходимо согласовать предположения автора функции и вызывающей программы.

Приведем еще один, последний, пример автобуса — класс TwilightBus, который нарушает ожидания, разделяя список пассажиров со своими клиентами. Прежде чем переходить к реализации, посмотрите, как работает класс TwilightBus с точки зрения его клиента.

Пример 8.14. Пассажиры, вышедшие из автобуса TwilightBus, бесследно исчезают

```python
>>> basketball_team = ['Sue', 'Tina', 'Maya', 'Diana', 'Pat'] ①
>>> bus = TwilightBus(basketball_team) ②
>>> bus.drop('Tina') ③
>>> bus.drop('Pat')
>>> basketball_team ④
['Sue', 'Maya', 'Diana']
```