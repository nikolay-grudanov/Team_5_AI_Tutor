---
source_image: page_068.png
page_number: 68
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.33
tokens: 11820
characters: 2179
timestamp: 2025-12-24T01:37:39.328580
finish_reason: stop
---

Когда список не подходит

Тип list гибкий и простой в использовании, но не всегда оптимален. Например, если требуется сохранить 10 миллионов чисел с плавающей точкой, то тип array будет гораздо эффективнее, поскольку в нем хранятся не полные объекты float, а только упакованные байты, представляющие их машинные значения, — как в массиве в языке C. С другой стороны, если вы часто добавляете и удаляете элементы из того или другого конца списка, т. е. используете его как структуру данных FIFO или LIFO, то лучше взять тип deque (двусторонняя очередь).

Если в программе много проверок на вхождение (например, item in my_collection), то, возможно, в качестве типа my_collection стоит взять set, особенно если количество элементов велико. Множества оптимизированы для быстрой проверки вхождения. Однако они не упорядочены и потому не являются последовательностями. Мы будем рассматривать множества в главе 3.

Массивы

Если список содержит только числа, то тип array.array эффективнее, чем list: он поддерживает все операции над изменяемыми последовательностями (включая .pop, .insert и .extend), а также дополнительные методы для быстрой загрузки и сохранения, например .frombytes и .tofile.

Массив Python занимает столько же памяти, сколько массив C. При создании экземпляра array задается код типа — буква, определяющая, какой тип C использовать для хранения элементов. Например, код типа b соответствует типу signed char. Если создать массив array('b'), то каждый элемент будет храниться в одном байте и интерпретироваться как число от -128 до 127. Если последовательность чисел велика, то это позволяет сэкономить много памяти. А Python не даст записать в массив число, не соответствующее заданному типу.

В примере 2.20 демонстрируется создание, сохранение и загрузка массива, содержащего 10 миллионов случайных чисел с плавающей точкой.

Пример 2.20. Создание, сохранение и загрузка большого массива чисел с плавающей точкой

>>> from array import array
>>> from random import random
>>> floats = array('d', (random() for i in range(10**7)))
>>> floats[-1]
0.07802343889111107
>>> fp = open('floats.bin', 'wb')
>>> floats.tofile(fp)
>>> fp.close()
>>> floats2 = array('d')