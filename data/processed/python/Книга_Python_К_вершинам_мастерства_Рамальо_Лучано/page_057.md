---
source_image: page_057.png
page_number: 57
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.89
tokens: 11776
characters: 1834
timestamp: 2025-12-24T01:37:02.475633
finish_reason: stop
---

Использование + и * для последовательностей

Остерегайтесь выражений вида a * n, где a — последовательность, содержащая изменяемые элементы, потому что результат может оказаться неожиданным. Например, при попытке инициализировать список списков my_list = [[ ]] * 3 получится список, содержащий три ссылки на один и тот же внутренний список, хотя вы, скорее всего, хотели не этого.

В следующем разделе мы рассмотрим ловушки, которые подстерегают нас при попытке использовать * для инициализации списка списков.

Построение списка списков

Иногда требуется создать список, содержащий несколько вложенных списков, например, чтобы распределить студентов по группам или представить клетки на игровой доске. Лучше всего это делать с помощью спискового включения, как показано в примере 2.12.

Пример 2.12. Список, содержащий три списка длины 3, может представлять поле для игры в крестики и нолики

>>> board = [['_'] * 3 for i in range(3)] ①
>>> board
[['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']]
>>> board[1][2] = 'X' ②
>>> board
[['_', '_', '_'], ['_', '_', 'X'], ['_', '_', '_']]

① Создать список из трех списков по три элемента в каждом. Взглянуть на его структуру.
② Поместить крестик в строку 1 столбец 2 и проверить, что получилось.

Соблазнительный, но ошибочный короткий путь показан в примере 2.13.

Пример 2.13. Список, содержащий три ссылки на один и тот же список, бесполезен

>>> weird_board = [['_'] * 3] * 3 ①
>>> weird_board
[['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']]
>>> weird_board[1][2] = 'O' ②
>>> weird_board
[['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']]

① Внешний список содержит три ссылки на один и тот же внутренний список. Пока не сделано никаких изменений, все кажется нормальным.
② Поместив нолик в строку 1 столбец 2, мы обнаруживаем, что все строки ссылаются на один и тот же объект.