---
source_image: page_485.png
page_number: 485
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 69.29
tokens: 12129
characters: 2931
timestamp: 2025-12-24T01:57:48.711638
finish_reason: stop
---

Дополнительная литература

Затем мы рассмотрели контекстные менеджеры и семантику предложения with, не ограничиваясь его типичным применением для автоматического закрытия файлов. Мы реализовали свой контекстный менеджер: класс LookingGlass с методами __enter__ и __exit__, и показали, как обрабатывать исключения в методе __exit__. Ключевой момент, который Раймонд Хэттингер отметил в тезисах к докладу на конференции PyCon US 2013, заключается в том, что блок with — это не только средство для управления ресурсами, но и инструмент, позволяющий выделить общий код инициализации и очистки, да и вообще любую пару операций, которые должны быть выполнены до и после какой-то другой процедуры (слайд 21 «What Makes Python Awesome?», http://bit.ly/1MM9pCm).

Наконец, мы дали обзор функций в модуле contextlib из стандартной библиотеки. Один из них, декоратор @contextmanager, дает возможность реализовать контекстный менеджер с помощью простого генератора с одним предложением yield — что, конечно, более лаконично, чем кодирование класса, содержащего по меньшей мере два метода. Мы переписали класс LookingGlass в виде генераторной функции looking_glass и обсудили, как обрабатывать исключения при использовании @contextmanager.

Декоратор @contextmanager — элегантный и практически полезный инструмент, который сводит воедино три совершенно разных механизма Python: декоратор функции, генератор и предложение with.

Дополнительная литература

В главе 8 «Составные предложения» (http://bit.ly/1MMa1YB) справочного руководства по языку Python имеется все, что можно сказать о части else в предложениях if, for, while и try. По поводу использования try/except в духе Python — с else или без — Раймонд Хэттингер дал блестящий ответ на вопрос «Хорошо ли использовать try-except-else в Python?» (http://bit.ly/1MMa2Mp) на сайте StackOverflow. В книге Алекса Мартелли «Python in a Nutshell», издание 2 (O'Reilly), имеется глава об исключениях, а в ней — великолепное обсуждение стиля программирования EAFP с отсылкой к одному из пионеров вычислительной техники Грэйсу Хопперу, придумавшему фразу: «Проще попросить прощения, чем испрашивать разрешение».

В главе 4 «Встроенные типы» руководства по стандартной библиотеке Python есть раздел, посвященный типам контекстных менеджеров (http://bit.ly/1MMacTS). Специальные методы __enter__ и __exit__ документированы также в разделе 3.3.8 «Контекстные менеджеры и предложение with» справочного руководства по языку Python (http://bit.ly/1MMab2e). Идея контекстных менеджеров впервые была изложена в документе «PEP 343 — The 'with' Statement» (https://www.python.org/dev/peps/pep-0343/). Это непростое чтение, потому что в документе обсуждаются в основном особые случаи и приводятся возражения против альтернативных предложений. Но такова природа PEP.

Раймонд Хэттингер в тезисах к докладу на конференции PyCon US 2013 (http://bit.ly/1MM9pCm) назвал предложение with «призовым средством языка».