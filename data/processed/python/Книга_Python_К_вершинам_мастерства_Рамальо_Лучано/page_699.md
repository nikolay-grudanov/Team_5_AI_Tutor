---
source_image: page_699.png
page_number: 699
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 66.39
tokens: 11975
characters: 2649
timestamp: 2025-12-24T02:07:27.685942
finish_reason: stop
---

Дополнительная литература

сложнее решения на основе декоратора класса, зато его можно инкапсулировать в модуле, так что пользователю останется только унаследовать совсем простому, на поверхностный взгляд, классу (model.Entity), ничего не зная о том, что это экземпляр специального метакласса (model.EntityMeta). Конечный результат напоминает API объектно-ориентированного отображения в Django и SQLAlchemy, где метаклассы используются, но пользователь о них не знает.

Затем мы реализовали второй метакласс, добавив в model.EntityMeta новую возможность: метод __prepare__, который предоставляет контейнер OrderedDict для отображения имен на атрибуты. Он сохраняет порядок связывания атрибутов в теле конструируемого класса, так что методы __new__ и __init__ могут воспользоваться этой информацией. В примере мы реализовали атрибут класса _field_names, что позволило написать метод Entity.field_names(), с помощью которого пользователь может получить дескрипторы Validated в порядке их появления в исходном коде.

В последнем разделе был дан краткий обзор атрибутов и методов, имеющихся во всех классах Python.

Метаклассы могут вызвать восторг и восхищение, но иногда используются во вред программистами, которые стараются быть слишком умными. В заключение еще раз приведем слова Алекса Мартелли из вставного эссе «Водоплавающие птицы и ABC» в главе 11:

И не определяйте свои ABC (или метаклассы) в производственном коде... Если вам кажется, что без этого не обойтись, держу пари, что это, скорее всего, желание поскорее забить гвоздь, раз уж в руках молоток, — вам (и тем, кому предстоит сопровождать вашу программу) будет куда комфортнее иметь дело с прямоугольным и простым кодом, где нет таких глубин.

Мудрые слова человека, который не только в совершенстве владеет метапрограммированием в Python, но и является высококвалифицированным программистом и работает над самыми крупными и важными проектами на Python, существующими в мире.

Дополнительная литература

Основными справочными материалами к этой главе являются раздел 3.3.3 «Настройка создания класса» (http://bit.ly/1HGwGnI) главы «Модель данных» справочного руководства по языку Python, документация по классу type (https://docs.python.org/3/library/functions.html#type) в разделе «Встроенные функции» и раздел 4.13 «Специальные атрибуты» (http://bit.ly/1cPOodb) главы «Встроенные типы» справочного руководства по стандартной библиотеке. Кроме того, в документации по модулю types из стандартной библиотеки (http://bit.ly/1HGwF3b) рассматриваются две новые функции в Python 3.3, призванныеказать помощь в метапрограммировании классов: types.new_class(...) и types.prepare_class(...).