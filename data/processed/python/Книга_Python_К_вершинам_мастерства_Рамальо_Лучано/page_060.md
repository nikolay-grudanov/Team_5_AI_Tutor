---
source_image: page_060.png
page_number: 60
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 48.45
tokens: 11915
characters: 2112
timestamp: 2025-12-24T01:37:23.006416
finish_reason: stop
---

Глава 2. Массив последовательностей

вынужден копировать всю конечную последовательность, чтобы создать новую с добавленными элементами3.

Мы рассмотрели типичные случаи использования оператора +=. А в следующем разделе обсудим интригующий случай, показывающий, что в действительности означает «неизменяемость» в контексте кортежей.

Головоломка: присваивание A +=

Попробуйте, не прибегая к оболочке, ответить на вопрос: что получится в результате вычисления двух выражений в примере 2.14?4

Пример 2.14. Загадка

>>> t = (1, 2, [30, 40])
>>> t[2] += [50, 60]

Что произойдет в результате? Какой ответ кажется вам правильным?

a. t принимает значение (1, 2, [30, 40, 50, 60]).
b. Возбуждается исключение TypeError с сообщением о том, что объект 'tuple' не поддерживает присваивание.
c. Ни то, ни другое.
d. И то, и другое.

Я был почти уверен, что правильный ответ b, но на самом деле правилен ответ d: И то, и другое! В примере 2.15 показан как этот код выполняется в оболочке для версии Python 3.4 (на самом деле, в Python 2.7 происходит то же самое).5

Пример 2.15. Неожиданный результат: элемент t[2] изменился и возбуждено исключение

>>> t = (1, 2, [30, 40])
>>> t[2] += [50, 60]
Traceback (most recent call last):
  File «<stdin>», line 1, in <module>
TypeError: 'tuple' object does not support item assignment
>>> t
(1, 2, [30, 40, 50, 60])

Сайт Online Python Tutor (http://www.pythontutor.com/) — прекрасный инструмент для наглядной демонстрации работы Python. На рис. 2.3 приведены два

3 Тип str — исключение из этого правила. Поскольку построение строки с помощью оператора += в цикле — весьма распространенная операция, в CPython этот случай оптимизирован. Экземпляры str создаются с запасом памяти, чтобы при конкатенации не приходилось каждый раз копировать всю строку.
4 Спасибо Леонардо Рохаэлю и Сезару Каваками, которые предложили эту задачу на Бразильской конференции по языку Python 2013 года.
5 Один читатель указал, что операцию из этого примера можно без ошибок выполнить с помощью выражения t[2].extend([50, 60]). Я это знаю, но цель примера — обсудить странное поведение оператора +=.