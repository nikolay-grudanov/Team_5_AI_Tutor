---
source_image: page_299.png
page_number: 299
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 28.66
tokens: 11638
characters: 1458
timestamp: 2025-12-24T01:48:06.735793
finish_reason: stop
---

ГЛАВА 10.
Рубим, перемешиваем и нарезаем последовательности

Не проверяйте, утка ли это; проверяйте, что оно крякает, как утка, ходит, как утка и т. д. и т. п. — в зависимости от того, какая часть поведения утки важна в ваших языковых игрищах (comp.lang.python, 26 июля 2000).

— Алекс Мартелли

В этой главе мы напишем класс Vector для представления многомерного вектора — заметный шаг вперед по сравнению с классом двумерного вектора Vector2d из главы 9. Класс Vector будет вести себя, как стандартная плоская неизменяемая последовательность в Python. Ее элементами будут числа с плавающей точкой, и окончательная версия будет поддерживать следующие возможности:

• базовый протокол последовательности: методы __len__ и __getitem__;
• безопасное представление экземпляров со многими элементами;
• поддержка операции среза, в результате которой получается новый экземпляр Vector;
• хэширование агрегата с учетом значений всех содержащихся в нем элементов;
• расширение языка форматирования.

Мы также реализуем доступ к динамическим атрибутам с помощью метода __getattr__ — как замену доступных только для чтения свойств в классе Vector2d, — хотя для типов последовательностей такая функциональность нетипична.

Демонстрация кода будет прерываться обсуждением самой идеи протокола как неформального интерфейса. Мы поговорим о связи протоколов и динамической типизации, а также о ее практических следствиях для создания пользовательских типов.

Итак, начнем.