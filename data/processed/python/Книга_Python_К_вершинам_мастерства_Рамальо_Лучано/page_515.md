---
source_image: page_515.png
page_number: 515
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 48.98
tokens: 11990
characters: 2728
timestamp: 2025-12-24T01:58:51.516486
finish_reason: stop
---

Пример: применение сопрограмм для моделирования...

Прежде чем приступить к примеру, скажу несколько слов о моделировании.

О моделировании дискретных событий

Моделирование дискретных событий (discrete event simulation – DES) — методика, предполагающая, что система моделируется в виде хронологической последовательности событий. В DES часы модельного времени сдвигаются не на одинаковое приращение, а сразу к модельному времени следующего моделируемого события. Например, если моделируется работа такси на верхнем уровне, то первое событие — посадка пассажира, а следующая — высадка. Неважно, сколько времени заняла поездка — 5 или 50 минут: когда наступает событие высадки, часы сдвигаются к времени окончания поездки за одну операцию. В DES работу такси в течение целого года можно смоделировать менее чем за секунду. Этим оно отличается от непрерывного моделирования, когда часы сдвигаются на фиксированный — и обычно небольшой — интервал.

Интуитивно понятно, что игры со сменой хода — примеры моделирования дискретных событий: состояние игры изменяется только после хода игрока, а пока игрок обдумывает следующий ход, часы модельного времени стоят. С другой стороны, игры реального времени представляют собой непрерывное моделирование, когда часы модельного времени постоянно идут, а состояние игры обновляется много раз в секунду, так что игроки-тугодумы оказываются в невыгодном положении.

Оба вида моделирования можно запрограммировать как с помощью нескольких потоков, так и в одном потоке, применяя событийно-ориентированные методы программирования, например, обратные вызовы или сопрограммы, управляемые циклом обработки событий. Непрерывное моделирование, пожалуй, более естественно реализуется с помощью потоков, которые позволяют выполнять несколько действий реально в одно и то же время. С другой стороны, сопрограммы предлагают идеальную абстракцию для DES. SimPy11 — написанный на Python пакет DES, в котором каждый моделируемый процесс представлен одной сопрограммой.

В моделировании процессом называют действия модельной сущности, а не процесс в смысле ОС. Моделируемый процесс можно реализовать в виде процесса ОС, но обычно для этой цели применяют сопрограмму или поток.

Если вас интересует моделирование, то стоит изучить пакет SimPy. Но в этом разделе я опишу очень простую модель DES, для реализации которой хватит возможностей стандартной библиотеки. Моя цель — помочь вам развить интуицию, необходимую для программирования параллельных действий с помощью сопрограмм. Чтение следующего раздела потребует сосредоточения, но наградой ста-

11 См. официальную документацию по Simpy (http://bit.ly/1HG4AOz) — не путайте с хорошо известным пакетом SymPy (http://bit.ly/1HG3Kl) для символьных вычислений.