---
source_image: page_438.png
page_number: 438
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 40.42
tokens: 11903
characters: 2248
timestamp: 2025-12-24T01:55:06.491625
finish_reason: stop
---

Глава 14. Итерируемые объекты, итераторы и генераторы

1 Обходим self.words.
2 Отдаем текущее слово.
3 Этот return не нужен; функция может просто «провалиться» и вернет управление автоматически. В любом случае генераторная функция не возбуждает исключение StopIteration: когда значений не остается, она просто выходит⁴.
4 Нет нужды в отдельном классе итератора!

Вот и еще одна реализация Sentence, которая проходит все тесты из примера 14.2.

В классе Sentence в примере 14.4 метод __iter__ конструировал и возвращал объект SentenceIterator. В примере же 14.5 итератор фактически является объектом-генератором, который строится автоматически при вызове метода __iter__, потому что __iter__ здесь — генераторная функция.
Подробное объяснение генераторных функций приведено ниже.

Как работает генераторная функция

Любая функция в Python, в теле которой встречается ключевое слово yield, называется генераторной функцией — при вызове она возвращает объект-генератор. Иными словами, генераторная функция — это фабрика генераторов.

Единственное синтаксическое различие между простой и генераторной функцией — тот факт, что в теле последней встречается ключевое слово yield. Некоторые считают, что для генераторных функций следовало бы ввести новое ключевое слово gen вместо def, но Гвидо не согласен. Его аргументы приведены в документе «PEP 255 — Simple Generators» (https://www.python.org/dev/peps/pep-0255/).⁵

Вот простейшая функция для демонстрации поведения генератора⁶:

>>> def gen_123(): # 1
... yield 1 # 2
... yield 2
... yield 3
...
>>> gen_123 # doctest: +ELLIPSIS

⁴ Рецензируя этот код, Алекс Мартелли отметил, что тело этого метода можно было бы свести просто к return iter(self.words). Он, конечно, прав: результатом вызова __iter__ и в этом случае был бы итератор, как и положено. Но я воспользовался здесь циклом for с ключевым словом yield, чтобы ввести синтаксис функции-генератора, который будет подробно рассмотрен в следующем разделе.
⁵ Иногда я включаю префикс или суффикс gen в имя генераторной функции, но это не общеупотребительная практика. И, разумеется, нельзя это делать при реализации итерируемого объекта: обязательный специальный метод должен называться __iter__ — и никак иначе.
⁶ Спасибо за пример Дэвиду Квасту.