---
source_image: page_145.png
page_number: 145
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.95
tokens: 11769
characters: 1905
timestamp: 2025-12-24T01:41:14.693969
finish_reason: stop
---

Нормализация Unicode для правильного сравнения

from unicodedata import normalize

def nfc_equal(str1, str2):
    return normalize('NFC', str1) == normalize('NFC', str2)

def fold_equal(str1, str2):
    return (normalize('NFC', str1).casefold() == normalize('NFC', str2).casefold())

Помимо нормализации и сворачивания регистра (то и другое — части стандарта Unicode), иногда бывают полезны более глубокие преобразования, например 'café' 'cafe'. В следующем разделе мы покажем, когда это необходимо и как делается.

Экстремальная «нормализация»: удаление диакритических знаков

Секретный рецепт поиска Google скрывает много разных хитростей, один из них — полное игнорирование диакритических знаков (акцентов, седилей и т. д.), по крайней мере, в некоторых контекстах. Удаление диакритических знаков, строго говоря, не является нормализацией, потому что зачастую при этом меняется смысл слов и поиск может находить не то, что нужно. Но жизнь есть жизнь: многие ленятся ставить диакритические знаки или не знают, как это нужно делать, да и правила правописания время от времени меняются. Игнорирование диакритики помогает справиться с этими проблемами.

Но даже если оставить поиск в стороне, удаление диакритических знаков делает URL-адреса более удобочитаемыми, по крайней мере, в языках на основе латиницы. Взгляните на URL статьи википедии о городе Сан-Паулу:

http://en.wikipedia.org/wiki/S%C3%A3o_Paulo

Часть %C3%A3 — результат URL-кодирования представления буквы «ã» (а с тильдой) в кодировке UTF-8. Показанный ниже URL гораздо понятнее, пусть даже правописание в нем хромает:

http://en.wikipedia.org/wiki/Sao_Paulo

Для удаления всех диакритических знаков из str можно воспользоваться функцией из примера 4.14.

Пример 4.14. Функция для удаления всех модифицирующих символов (модуль sanitize.py)

import unicodedata
import string

def shave_marks(txt):
    """Удалить все диакритические знаки""""