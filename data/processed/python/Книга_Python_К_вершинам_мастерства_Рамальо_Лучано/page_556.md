---
source_image: page_556.png
page_number: 556
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.38
tokens: 12054
characters: 2967
timestamp: 2025-12-24T02:00:54.467070
finish_reason: stop
---

Глава 17. Параллелизм и будущие объекты

переключиться на другой поток. Затем мы обсудили запуск нескольких процессов с помощью класса concurrent.futures.ProcessPoolExecutor, что позволяет обойти ограничение GIL и задействовать несколько процессорных ядер для выполнения криптографических алгоритмов, достигая тем самым более чем двукратного ускорения при использовании четырех рабочих процессов.

В следующем разделе мы изучили, как работает класс concurrent.futures.ThreadPoolExecutor на учебном примере, где запускались задачи, которые просто спали несколько секунд, ничего не делая, а затем печатали свое состояние и временную метку.

Далее мы вернулись к примерам загрузки изображений флагов. Чтобы добавить в них индикатор хода выполнения и корректную обработку ошибок, нам пришлось углубиться в детали генераторной функции future.as_completed, и в результате мы открыли для себя общий прием: сохранение будущих объектов в словаре вместе с дополнительной информацией в момент передачи исполнителю и использование этой информации впоследствии — когда итератор as_completed отдает завершенный будущий объект.

В заключение нашего обзора методов распараллеливания с помощью нескольких потоков и процессов мы напомнили о существовании низкоуровневых, но и более гибких модулей threading и multiprocessing, предоставляющих традиционные средства работы с потоками и процессами в Python.

Дополнительная литература

Автором пакета concurrent.futures является Брайан Куинлан (Brian Quinlan), который презентовал его в обширном докладе под названием «Будущее уже близко!» (http://bit.ly/1JJuZJy) на конференции PyCon Australia 2010. Доклад Куинлана не сопровождается слайдами; он демонстрирует возможности библиотеки, вводя код прямо в оболочке Python. В качестве пояснительного примера на презентации был показан короткий ролик, созданный автором веб-комикса и программистом Рэнделлом Манро (Randall Munroe), в котором он непреднамеренно организовал DoS-атаку на сайт Google Maps, чтобы построить цветную карту времени поездок на автомобиле в своем городе. Формальное введение в библиотеку содержится в документе «PEP 3148 — futures — execute computations asynchronously» (https://www.python.org/dev/peps/pep-3148/). В нем Куинлан пишет, что на библиотеку concurrent.futures «большое влияние оказал пакет java.util.concurrent для Java».

В книге Jan Palach «Parallel Programming with Python» (Packt) рассматривается несколько инструментов параллельного программирования, в том числе модули concurrent.futures, threading и multiprocessing. Но он не ограничивается стандартной библиотекой, а обсуждает также пакет Celery (http://bit.ly/1JIv1kA), где реализована очередь задач для распределения работы между потоками и процессами, которые могут выполняться даже на разных машинах. В сообществе Django система Celery, пожалуй, чаще всего применяется для разгрузки веб-сервера за счет передачи вычислительно трудоемких задач, например генерации PDF-файлов, другим процессам.