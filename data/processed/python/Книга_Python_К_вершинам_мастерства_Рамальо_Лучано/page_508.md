---
source_image: page_508.png
page_number: 508
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.84
tokens: 11935
characters: 2452
timestamp: 2025-12-24T01:58:34.776157
finish_reason: stop
---

Из этого эксперимента следует вынести важный урок: если субгенератор никогда не завершается, то делегирующий генератор будет навечно блокирован в yield from. Программа при этом может продолжать работать, поскольку yield from (как и обычный yield) передает управление клиентскому коду (т. е. вызывающей стороне делегирующего генератора). Но какая-то задача при этом останется незаконченной.

Пример 16.17 показывает простейшую конфигурацию yield from, когда имеется только один делегирующий генератор и один субгенератор. Но поскольку делегирующий генератор работает как канал, мы можем соединить любое их число, сформировав конвейер: один делегирующий генератор использует yield from, чтобы вызвать субгенератор, который сам является делегирующим генератором и вызывает следующий субгенератор с помощью yield from и так далее. Эта цепочка должна заканчиваться простым генератором, в котором используется обычный yield, или произвольным итерируемым объектом, как в примере 16.16.

Любая цепочка yield from должна управляться клиентом, который вызывает next(...) или .send(...) для самого внешнего делегирующего генератора. Это может быть неявный вызов, например цикл for. Теперь рассмотрим формальное описание конструкции yield from так, как оно изложено в документе PEP 380.

Семантика yield from

Работая над документом PEP 380, Грэг Ивинг (Greg Ewing) — его автор — вынужден был отвечать на вопросы по поводу сложности предлагаемой семантики. И один из его ответов звучал так: «почти вся важная для человека информация содержится в одном абзаце в начале документа». А затем он процитировал часть документа PEP 380, которая в то время выглядела так:

Когда итератор является другим генератором, эффект получается таким же, как если бы тело субгенератора было текстуально встроено в месте, где находится выражение yield from. Более того, субгенератору разрешено выполнять предложение return, содержащее значение, и это значение становится значением выражения yield from.8

Этих утешительных слов в PEP больше нет, потому что они не покрывают все возможные случаи. Но в качестве первого приближения сойдет.

В одобренном варианте PEP 380 поведение yield from объясняется в шести пунктах раздела «Предложение» (https://www.python.org/dev/peps/pep-0380/#proposal). Ниже я воспроизвел их почти буквально, только заменил неод-

8 Сообщение в списке рассылки Python-Dev: «PEP 380 (yield from a subgenerator) comments» (http://bit.ly/1JH0rTu) (21 марта 2009).