---
source_image: page_309.png
page_number: 309
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.55
tokens: 11862
characters: 2125
timestamp: 2025-12-24T01:48:52.767892
finish_reason: stop
---

Vector, попытка № 3: доступ к динамическим атрибутам

Traceback (most recent call last):
    ...
TypeError: Vector indices must be integers

1 Если индекс — целое число, то извлекается ровно одна компонента типа float.
2 Если задан индекс типа slice, то создается новый объект Vector.
3 Если длина среза len == 1, то все равно создается новый объект Vector.
4 Класс Vector не поддерживает многомерное индексирование, поэтому при задании кортежа индексов или срезов возбуждается исключение.

Vector, попытка № 3: доступ к динамическим атрибутам

При переходе от класса Vector2d к Vector мы потеряли возможность обращаться к компонентам вектора по имени, например: v.x, v.y. Теперь мы имеем дело с векторами, имеющими сколь угодно много компонент. Тем не менее, иногда удобно обращаться к нескольким первым компонентам по именам, состоящим из одной буквы, например, x, y, z вместо v[0], v[1] и v[2].

Ниже показан альтернативный синтаксис для чтения первых четырех компонент вектора, который мы хотели бы поддержать:

>>> v = Vector(range(10))
>>> v.x
0.0
>>> v.y, v.z, v.t
(1.0, 2.0, 3.0)

В классе Vector2d мы предоставляли доступ для чтения компонент x и y с помощью декоратора @property (пример 9.7). Мы могли бы завести и в Vector четыре свойства, но это утомительно. Специальный метод __getattr__ позволяет сделать это по-другому и лучше.

Метод __getattr__ вызывается интерпретатором, если поиск атрибута завершается неудачно. Иначе говоря, анализируя выражение my_obj.x, Python проверяет, есть ли у объекта my_obj атрибут с именем x; если нет, поиск повторяется в классе (my_obj.__class__), а затем вверх по иерархии наследования3. Если атрибут x все равно не найден, то вызывается метод __getattr__, определенный в классе my_obj, причем ему передается self и имя атрибута в виде строки (например, 'x').

В примере 10.8 приведен код метода __getattr__. Он проверяет, является ли искомый атрибут одной из букв xyzt, и, если да, то возвращает соответствующую компоненту вектора.

3 На самом деле, поиск атрибутов устроен сложнее. Технические детали мы обсудим в части IV, а пока достаточно и этого упрощенного объяснения.