---
source_image: page_264.png
page_number: 264
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.81
tokens: 11925
characters: 2155
timestamp: 2025-12-24T01:47:02.005897
finish_reason: stop
---

Глава 8. Ссылки на объекты, изменяемость и повторное...

объектом frozenset, конструкция fs[:] не работает. Но fs.copy() дает точно такой же эффект: обманывает нас и возвращает ссылку на тот же объект, а вовсе не на его копию (см. пример 8.21).6

Пример 8.21. Строковые литералы могут создавать разделяемые объекты

```python
>>> t1 = (1, 2, 3)
>>> t3 = (1, 2, 3) # ①
>>> t3 is t1 # ②
False
>>> s1 = 'ABC'
>>> s2 = 'ABC' # ③
>>> s2 is s1 # ④
True
```

① Создание нового кортежа с нуля.
② t1 и t3 равны, но не тождественны.
③ Создание второй строки str с нуля.
④ Сюрприз: s1 и s2 ссылаются на один и тот же объект str!

Разделение строковых литералов — это техника оптимизации, называемая интернированием. В CPython тот же прием используется для небольших целых чисел, чтобы избежать ненужного дублирования «популярных» чисел, например: 0, -1 и 42. Отметим, что CPython не интернирует все строки и целые числа подряд, а критерии, которым он руководствуется, остаются недокументированной деталью реализации.

Никогда не полагайтесь на интернирование объектов str и int! Для сравнения на равенство используйте только оператор ==, а не is. Интернирование предназначено исключительно для внутренних нужд интерпретатора.

Трюки, обсуждаемые в этом разделе, в том числе поведение метода frozenset. copy(), — это «ложь во спасение»: они экономят память и ускоряют работу интерпретатора. Не думайте о них, никаких хлопот они не доставят, потому что относятся только к неизменяемым объектам. Пожалуй, наилучшее применение этим мелочам — пари со знакомыми питонистами.

Резюме

У каждого объекта в Python есть идентификатор, тип и значение. И только значение объекта может изменяться со временем7.

6 Невинную ложь — тот факт, что метод copy ничего не копирует, — можно объяснить совместимостью интерфейсов: при этом класс frozenset оказывается лучше совместим с set. Как бы то ни было, конечному пользователю безразлично, являются два идентичных неизменяемых объекта одним и тем же объектом или разными.
7 На самом деле, тип объекта тоже можно изменить, просто присвоив другой класс его атрибуту __class__, но это неприкрытое зло, и я жалею, что написал эту сноску.