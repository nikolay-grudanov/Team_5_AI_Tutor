---
source_image: page_202.png
page_number: 202
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 43.76
tokens: 11840
characters: 2219
timestamp: 2025-12-24T01:44:05.327439
finish_reason: stop
---

Пример 6.8 отличает только тем, что список функций-стратегий строится путем просмотра специального модуля promotions. Отметим, что для работы этого кода необходимо импортировать модуль promotions, а также модуль inspect, в котором находятся высокоуровневые функции интроспекции (предложения импорта опущены, потому что обычно они находятся в начале файла).

Пример 6.8. Список promos строится путем интроспекции нового модуля promotions

promos = [func for name, func in inspect.getmembers(promotions, inspect.isfunction)]

def best_promo(order):
    """Выбрать максимально возможную скидку
    """
    return max(promo(order) for promo in promos)

Функция inspect.getmembers возвращает атрибуты объекта — в данном случае модуля promotions — возможно, отфильтрованные предикатом (булевой функцией). Мы пользуемся предикатом inspect.isfunction, чтобы получить только имеющиеся в модуле функции.

Код в примере 6.8 работает независимо от имен функций, важно лишь, чтобы модуль promotions содержал только функции вычисления скидки для переданного заказа. Конечно, это некое неявное предположение: если кто-нибудь включит в модуль promotions функцию с другой сигнатурой, то при попытке применить ее к заказу best_promo завершится с ошибкой.

Можно было бы отбирать функции более строго, например, анализируя их аргументы. Но цель примера 6.8 — не предложить полное решение, а показать один из возможных путей использования интроспекции модуля.

Есть и более явный подход к динамическому отбору функций вычисления скидки — воспользоваться декоратором. В главе 7, посвященной декораторам функций, мы покажем такой способ реализации Стратегии для нашего Интернет-магазина.

В следующем разделе мы обсудим паттерн Команда, который часто реализуют с помощью классов с единственным методом, хотя достаточно и обычной функции.

Паттерн Команда

Команда — еще один паттерн проектирования, который можно упростить с помощью передачи функций в качестве аргументов. На рис. 6.2 показана диаграмма классов для этого паттерна.

Цель Команды — разорвать связь между объектом, инициировавшим операцию (Инициатором) и объектом, который ее реализует (Получателем). В примере из «Паттернов проектирования» инициаторами являются пункты меню в