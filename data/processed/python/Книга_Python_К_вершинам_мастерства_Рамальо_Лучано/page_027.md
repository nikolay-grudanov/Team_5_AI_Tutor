---
source_image: page_027.png
page_number: 27
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.64
tokens: 11857
characters: 2273
timestamp: 2025-12-24T01:36:00.132934
finish_reason: stop
---

Как используются специальные методы

Говоря о специальных методах, нужно все время помнить, что они предназначены для вызова интерпретатором, а не вами. Вы пишете не my_object.__len__(), а len(my_object), и, если my_object — экземпляр определенного пользователем класса, то Python вызовет реализованный вами метод экземпляра __len__.

Однако для встроенных классов, например list, str, bytearray и т. д., интерпретатор поступает проще: реализация функции len() в CPython возвращает значение поля ob_size C-структуры PyVarObject, которой представляется любой встроенный объект в памяти. Это гораздо быстрее, чем вызов метода.

Как правило, специальный метод вызывается неявно. Например, предложение for i in x: подразумевает вызов функции iter(x), которая, в свою очередь, может вызывать метод x.__iter__() , если он реализован.

Обычно в вашей программе не должно быть много прямых обращений к специальным методам. Если вы не пользуетесь метапрограммированием, то чаще будете реализовывать специальные методы, чем явно вызывать их. Единственный специальный метод, которые регулярно вызывается из пользовательского кода напрямую, — __init__, он служит для инициализации суперкласса из вашей реализации __init__.

Если необходимо обратиться к специальному методу, то обычно лучше вызвать соответствующую встроенную функцию (например, len, iter, str и т. д.). Она вызывает нужный специальный метод и нередко предоставляет дополнительный сервис. К тому же для встроенных типов это быстрее, чем вызов метода. См. раздел «Познакомимся с функцией iter поближе» главы 14.

Старайтесь не создавать собственные атрибуты с именами вида __foo__, потому что в будущем подобные имена могут получить специальный смысл, даже если в текущей версии это не так.

Эмуляция числовых типов

Несколько специальных методов позволяют объектам иметь операторы, например +. Подробно мы рассмотрим этот вопрос в главе 13, а пока проиллюстрируем использование таких методов на еще одном простом примере.

Мы реализуем класс для представления двумерных векторов, обычных евклидовых векторов, применяемых в математике и физике (рис. 1.1).

Для представления двумерных векторов можно использовать встроенный класс complex, но наш класс допускает обобщение на n-мерные векторы. Мы займемся этим в главе 14.