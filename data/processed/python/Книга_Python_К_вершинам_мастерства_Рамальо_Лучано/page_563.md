---
source_image: page_563.png
page_number: 563
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 30.38
tokens: 11711
characters: 1642
timestamp: 2025-12-24T02:00:46.395350
finish_reason: stop
---

Сравнение потока и сопрограммы

• Почему пакету asyncio суждено оказать огромное влияние на экосистему Python.

Начнем с простого примера, который позволит сравнить библиотеки threading и asyncio.

Сравнение потока и сопрограммы

В ходе дискуссии о потоках и GIL Мишель Симионато привел простой и забавный пример (http://bit.ly/1Ox3vWA) использования модуля multiprocessing для вывода анимированного индикатора, составленного из ASCII-символов «|/-\», который крутится на консоли во время длительного вычисления.

Я модифицировал пример Симионато, сначала воспользовавшись модулем threading, а затем сопрограммой на основе asyncio, так чтобы вы могли сравнить оба варианта и понять, как можно добиться конкурентного поведения без потоков.

Поскольку оба примера 18.1 и 18.2 порождают анимированный вывод, увидеть, что происходит, можно, только запустив их. Если вы находитесь в метро (или в другом месте, где нет сети WiFi), взгляните на рис. 18.1 и представьте, что косая черта \ перед словом «thinking» крутится.

![Скриншот терминала с выводом примеров spinner_thread.py и spinner_asyncio.py](https://i.imgur.com/3Q5z5QG.png)

Рис. 18.1. Скрипты spinner_thread.py и spinner_asyncio.py порождают похожие результаты: repr-представление объекта spinner и текст Answer: 42. На снимке экрана скрипт spinner_asyncio.py еще работает, поэтому отображается сообщение \ thinking!; когда скрипт завершится, эту строку заменит Answer: 42

Сначала рассмотрим скрипт spinner_thread.py (пример 18.1).

Пример 18.1. spinner_thread.py: анимация текстового индикатора с помощью потока

import threading
import itertools
import time
import sys

class Signal: