---
source_image: page_421.png
page_number: 421
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 58.76
tokens: 12145
characters: 2892
timestamp: 2025-12-24T01:54:35.159218
finish_reason: stop
---

Поговорим

функции с одиночной диспетчеризацией» главы 7). В книге David Beazley, Brian K. Jones «Python Cookbook», издание 3 (O'Reilly), есть рецепт 9.20 «Реализация множественной диспетчеризации с помощью аннотаций функций», в котором приемы метапрограммирования — с привлечением метакласса — используются для реализации основанной на типе диспетчеризации посредством аннотаций функций. Во втором издании книги Martelli, Ravenscroft, Ascher «Python Cookbook» имеется интересный рецепт (2.13, принадлежит Эрику Максу Фрэнсису), где показано, как перегрузить оператор << для имитации синтаксиса потоков ввода-вывода (iostream) в C++. В обеих книгах есть и другие примеры перегрузки операторов, я выбрал только самые примечательные.

Функция functools.total_ordering, представляющая собой декоратор класса (поддерживается, начиная с версии Python 2.7), автоматически генерирует недостающие методы для всех операторов сравнения в любом классе, где есть хотя бы два из них. См. документацию по модулю functools (http://bit.ly/1C12IWf).

Если вам интересно узнать о диспетчеризации операторных методов в языках с динамической типизацией, почитайте две основополагающие работы: Дэн Инголлс (Dan Ingalls) (один из разработчиков Smalltalk) «A Simple Technique for Handling Multiple Polymorphism» (http://bit.ly/1FVhejw) и Курт Дж. Гебель, Ральф Джонсон (Kurt J. Hebel, Ralph Johnson) «Arithmetic and Double Dispatching in Smalltalk-80» (http://bit.ly/1QrnuuD) (Джонсон впоследствии стал знаменит как один из авторов книги «Паттерны проектирования»). В обеих статьях глубоко проработан вопрос о полиморфизме в языках с динамической типизацией, к каковым относятся Smalltalk, Python и Ruby. В Python для обработки операторов не применяется двойная диспетчеризация, описанная в этих статьях. Используемый в Python алгоритм на основе прямого и инверсного операторов проще поддержать в пользовательских классах, чем двойную диспетчеризацию, но он требует специального внимания со стороны интерпретатора. Напротив, классическая двойная диспетчеризация — это общая техника, применяемая как в Python, так и в любом другом объектно-ориентированном языке, — и не только в контексте инфиксных операторов. На самом деле, Инголлс, Гебель и Джонсон иллюстрируют ее на самых разных примерах.

Статья «The C Family of Languages: Interview with Dennis Ritchie, Bjarne Stroustrup, and James Gosling» (http://www.gotw.ca/publications/c_family_interview.htm), из которой взят эпиграф к этой главе, а также две цитаты на врезке «Поговорим», была опубликована в журналах «Java Report», 5(7), июль 2000 и «C++ Report», 12(7), июль-август, 2000. Это очень увлекательное чтение для всех, кто интересуется проектированием языков программирования.

Поговорим

Перегрузка операторов: за и против

Джеймс Гослинг, процитированный в эпиграфе к этой главе, сознательно решил не включать перегрузку операторов в язык Java. В том же