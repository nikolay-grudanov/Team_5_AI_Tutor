---
source_image: page_646.png
page_number: 646
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 62.59
tokens: 11974
characters: 2605
timestamp: 2025-12-24T02:05:05.123802
finish_reason: stop
---

Глава 19. Динамические атрибуты и свойства

Есть много причин заменить конструкторы фабриками18. Популярное обоснование — ограничить количество экземпляров, возвращая не новые, а созданные ранее (как в паттерне Одиночка). Сюда же примыкает кэширование объектов, конструирование которых обходится дорого. Иногда также удобно возвращать объекты разных типов в зависимости от переданных аргументов.

Писать конструктор проще, но реализация фабрики повышает гибкость ценой дополнительного кода. В языках, где есть оператор new, проектировщик API должен заранее решить, ограничиться ли простым конструктором или потратить время на фабрику. Если первоначальное решение оказалось неверным, то исправление может обойтись дорого — из-за того, что new — оператор.

Иногда удобнее пойти другим путем и заменить простую функцию классом.

В Python классы и функции во многих ситуациях взаимозаменяемы. И не только из-за отсутствия оператора new, но и потому что имеется специальный метод __new__ который позволяет преобразовать класс в фабрику, порождающую объекты разных видов (как мы видели в разделе «Гибкое создание объектов с помощью метода __new__» этой главы) или возвращающую ранее созданные экземпляры, вместо того чтобы каждый раз создавать новые.

Дуализм функции и класса было бы использовать еще проще, если бы в документе «PEP 8 — Style Guide for Python Code» (http://bit.ly/1HGvYH7) не рекомендовалось применять ВерблюжьюНотацию (CamelCase) для имен классов. С другой стороны, в стандартной библиотеке имеются десятки классов с именами, составленными только из строчных букв (например, property, str, defaultdict и т. д.). Так что, возможно, использование таких имен классов — вовсе не ошибка. Впрочем, как бы ни смотреть на эту проблему, разнобой в употреблении строчных и заглавных букв в именах классов из стандартной библиотеки Python представляет трудность для пользователей.

Хотя вызов функции не отличается от вызова класса, знать, что есть что, полезно, поскольку у классов есть дополнительная возможность: наследование. Поэтому лично я всегда применяю ВерблюжьюНотацию для имен своих классов и хотел бы, чтобы все классы в стандартной библиотеке следовали этому соглашению. Это я о вас, collections.OrderedDict и collections.defaultdict.

18 Упоминаемые мной причины приведены в статье Джонатана Амстердама (Jonathan Amsterdam) из журнала «Dr. Dobbs Journal» под названием «Java's new Considered Harmful» (http://utm.io/1cPP4PN), а также в разделе «Consider static factory methods instead of constructors» удостоенной наград книги Джошуа Блоха (Joshua Bloch) «Effective Java» (Addison-Wesley).