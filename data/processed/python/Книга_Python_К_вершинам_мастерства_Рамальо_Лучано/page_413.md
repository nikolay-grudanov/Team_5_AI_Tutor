---
source_image: page_413.png
page_number: 413
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.37
tokens: 11802
characters: 1877
timestamp: 2025-12-24T01:53:46.497972
finish_reason: stop
---

Операторы сравнения

Прогнав тесты из примера 13.12 для новой реализации Vector.__eq__, мы получим следующие результаты.

Пример 13.14. Те же сравнения, что в примере 13.12, последний результат изменился

```python
>>> va = Vector([1.0, 2.0, 3.0])
>>> vb = Vector(range(1, 4))
>>> va == vb # ①
True
>>> vc = Vector([1, 2])
>>> from vector2d_v3 import Vector2d
>>> v2d = Vector2d(1, 2)
>>> vc == v2d # ②
True
>>> t3 = (1, 2, 3)
>>> va == t3 # ③
False
```

① Тот же результат, что и раньше. Как и ожидалось.
② Тот же результат, что и раньше. Но почему? Объяснение последует ниже.
③ Другой результат — то, что мы и хотели. Но почему это работает? Читайте дальше...

Из трех результатов в примере 13.14 первый не вызывает удивления, а два других объясняются тем, что метод __eq__ из примера 13.13 вернул NotImplemented. Рассмотрим шаг за шагом, что происходит при сравнении Vector и Vector2d.

1. Для вычисления vc == v2d Python вызывает Vector.__eq__(vc, v2d).
2. Метод Vector.__eq__(vc, v2d) видит, что v2d не принадлежит классу Vector и возвращает NotImplemented.
3. Получив результат NotImplemented, Python вызывает Vector2d.__eq__(v2d, vc).
4. Vector2d.__eq__(v2d, vc) преобразует оба операнда в кортежи и сравнивает их, результат оказывается равен True (код метода Vector2d.__eq__ приведен в примере 9.9).

При сравнении же Vector и tuple производятся следующие шаги.

1. Для вычисления va == t3 Python вызывает Vector.__eq__(va, t3).
2. Метод Vector.__eq__(va, t3) видит, что t3 не принадлежит классу Vector и возвращает NotImplemented.
3. Получив результат NotImplemented, Python вызывает tuple.__eq__(t3, va).
4. tuple.__eq__(t3, va) ничего не знает о классе Vector, поэтому возвращает NotImplemented.
5. Оператор == рассматривается как особый случай: если инверсный вызов вернул NotImplemented, то Python в качестве последнего средства сравнивает идентификаторы объектов.