---
source_image: page_480.png
page_number: 480
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 45.21
tokens: 11780
characters: 1983
timestamp: 2025-12-24T01:57:16.119030
finish_reason: stop
---

• Хранение блокировок, условных переменных и семафоров в модуле threading; см. раздел 17.1.10 «Использование блокировок, условных переменных и семафоров в предложении with» (http://bit.ly/1MM8guu).
• Настройка среды для арифметических операций с объектами Decimal; см. документацию по методу decimal.localcontext (http://bit.ly/1MM8eTw).
• Внесение временных изменений в объекты для тестирования; см. функцию unittest.mock.patch (http://bit.ly/1MM8imk).

В стандартную библиотеку входят также утилиты contextlib, рассматриваемые далее.

Утилиты contextlib

Прежде чем начинать писать собственные классы контекстных менеджеров, прочитайте раздел 29.6 «contextlib — утилиты для контекстов, вводимых блоками with» (http://bit.ly/1HGqZpJ) руководства по стандартной библиотеке Python. Помимо уже упоминавшейся функции redirect_stdout, модуль contextlib содержит другие классы и функции. Перечислим наиболее употребительные.

closing
Функция для построения контекстных менеджеров из объектов, которые предоставляют метод close(), но не реализуют протокол __enter__/__exit__.

suppress
Контекстный менеджер для временного игнорирования заданных исключений.

@contextmanager
Декоратор, который позволяет построить контекстный менеджер из простой генераторной функции, вместо того чтобы создавать класс и реализовывать протокол.

ContextDecorator
Базовый класс для определения контекстных менеджеров на основе классов, которые можно использовать также в качестве декораторов функций, так что вся функция будет работать внутри управляемого контекста.

ExitStack
Контекстный менеджер, который позволяет составлять композицию из переменного числа контекстных менеджеров. По выходе из блока with объект ExitStack вызывает методы __exit__ запомненных контекстных менеджеров в порядке LIFO (последним вошел, первым обслугжен). Этот класс применяется, когда заранее неизвестно количество открываемых блоков with, например, в случае, когда одновременно открываются все файлы из произвольного списка.