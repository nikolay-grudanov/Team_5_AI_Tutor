---
source_image: page_328.png
page_number: 328
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 44.83
tokens: 11926
characters: 2524
timestamp: 2025-12-24T01:49:46.671631
finish_reason: stop
---

Истоки «утиной» типизации

Я полагаю, что популяризации термина «duck typing» (утиная типизация) больше других способствовало сообщество Ruby, обращавшееся с проповедью к поклонникам Java. Но это выражение встречалось в обсуждениях Python еще до того, как Ruby и Python стали «популярными». Согласно википедии, один из первых примеров аналогии с уткой в объектно-ориентированном программировании — сообщение в списке рассылки Python, отправленное Алексом Мартелли 26 июля 2000 года и касавшееся полиморфизма (с заголовком Re: Type checking in python?) (http://bit.ly/1QOuTPx). Именно из него взята цитата, ставшая эпиграфом к данной главе. Если вам любопытны литературные корни термина «утиная типизация», а также применения этой объектно-ориентированной концепции во многих языках, почитайте статью википедии «Duck typing» (http://en.wikipedia.org/wiki/Duck_typing).

Безопасный format повышенного удобства

При реализации метода __format__ мы не принимали никаких мер предосторожности на случай экземпляров Vector с очень большим числом компонент, хотя в методе __repr__ применили для этой цели библиотеку reprlib. Обоснованием служит тот факт, что функция repr() предназначена для отладки и протоколирования, поэтому любой ценой должна вывести хоть какое-то полезное представление, тогда как __format__ предназначен для конечного пользователя, который, вероятно, хочет видеть вектор целиком. Если вы полагаете, что это опасно, то можете продолжить расширение миниязыка спецификации формата.

Я бы сделал это так: по умолчанию для любого форматированного вектора выводится разумное, хотя и ограниченное количество компонент, скажем 30. Если элементов больше, то поведение по умолчанию может быть аналогично тому, что делает reprlib: отбросить дополнительные компоненты, заменив их многоточием. Но если спецификатор формата заканчивается специальным кодом *, означающим «все», то ограничения на размер не действуют. Таким образом, пользователь, который не знает о проблеме очень длинного представления, не станет жертвой случайности. Однако если ограничение начинает мешать, то наличие ... должно натолкнуть пользователя на мысль поискать в документации, где он узнает о коде форматирования *.

Если реализуете эту идею, отправьте запрос на включение своего кода в репозиторий книги «Fluent Python» на GitHub (https://github.com/fluentpython/example-code)!

Как вычислить сумму в духе Python

Не существует однозначного ответа на вопрос «Что соответствует духу Python?», как и ответа на вопрос «Что такое красота?». Я часто