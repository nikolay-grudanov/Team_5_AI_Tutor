---
source_image: page_288.png
page_number: 288
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.01
tokens: 11776
characters: 1876
timestamp: 2025-12-24T01:47:54.596329
finish_reason: stop
---

Атрибут __slots__, унаследованный от суперкласса, не оказывает никакого влияния. Python принимает в расчет только атрибуты __slots__, определенные в самом классе.

Для того чтобы определить __slots__, мы создаем атрибут класса с таким именем и присваиваем ему итерируемый объект, содержащий строковые идентификаторы атрибутов экземпляра. Я предпочитаю использовать для этой цели кортеж, потому что тем самым явно даю понять, что определение __slots__ не может изменяться.

Пример 9.11. vector2d_v3_slots.py: по сравнению с версией vector2d добавился только атрибут __slots__

class Vector2d:
    __slots__ = ('__x', '__y')
    typecode = 'd'
    # прочие методы (в книге опущены)

Определяя в классе атрибут __slots__, мы говорим интерпретатору: «Это все атрибуты экземпляра в данном классе». Тогда Python помещает их в кортежеподобную структуру в каждом экземпляре, что позволяет избежать накладных расходов на хранение словаря __dict__. При наличии миллионов одновременно активных экземпляров экономия памяти может оказаться весьма существенной.

При работе с миллионами объектов, содержащих числовые данные, следует использовать массивы NumPy (см. раздел «NumPy и SciPy» в главе 2), которые не только эффективно расходуют память, но и располагают оптимизированными функциями, в том числе применяемыми к массиву в целом. Я проектировал класс Vector2d только для того, чтобы было на чем обсуждать специальные методы, т. к. стараюсь по возможности избегать бессмысленных примеров с foo и bar.

В примере 9.12 показаны результаты двух запусков скрипта, который просто строит с помощью спискового включения список, содержащий 10 000 000 экземпляров Vector2d. Скрипт mem_test.py принимает имя модуля, содержащего вариант класса Vector2d. При первом прогоне я взял класс vector2d_v3.Vector2d (из примера 9.7), а при втором — класс vector2d_v3_slots.Vector2d с атрибутом __slots__.