---
source_image: page_287.png
page_number: 287
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 54.90
tokens: 12096
characters: 2776
timestamp: 2025-12-24T01:48:03.204345
finish_reason: stop
---

Экономия памяти с помощью атрибута класса __slots__

По сути дела, это то же самое, что два подчерка, только делает прозрачным то, что два подчерка скрывают7.

Одиночный начальный подчерк в именах атрибутах не означает ничего особенного для интерпретатора Python, но в среде программистов, пишущих на этом языке, бытует соглашение о том, что не надо обращаться к таким атрибутам извне самого класса8. Нетрудно уважать право на приватность объекта, который помечает свои атрибуты одиночным знаком _, равно как и соблюдать соглашение о том, что переменные с именами, состоящими только из заглавных букв (ALL_CAPS), должны считаться константами.

Атрибуты с одиночным подчерком в начале в некоторых уголках документации Python называются «защищенными»9. Практика «защиты» атрибутов соглашением вида self._x широко распространена, но название «защищенный» не столь употребительно. Некоторые даже называют такие атрибуты «закрытыми».

Подведем итог: компоненты класса Vector2d «закрыты», а экземпляры Vector2d «неизменяемы». Устрашающие кавычки поставлены, потому что на самом деле не существует способа сделать их по-настоящему закрытыми и неизменяемыми10.

Но вернемся к классу Vector2d. В последнем разделе мы рассмотрим специальный атрибут (не метод) __slots__, который влияет на внутреннее хранение данных в объекте, что может заметно сократить потребление памяти, но почти не сказывается на открытом интерфейсе класса.

Экономия памяти с помощью атрибута класса __slots__

По умолчанию Python хранит атрибуты экземпляра в словаре __dict__, принадлежащем самому экземпляру. В разделе «Практические последствия механизма работы dict» главы 3 мы видели, что со словарями сопряжены значительные накладные расходы из-за того, что для обеспечения быстрого доступа используется хэш-таблица. Если имеются миллионы экземпляров, а количество атрибутов у каждого мало, то атрибут класса __slots__ позволит сэкономить очень много памяти за счет того, что интерпретатору разрешено хранить атрибуты экземпляра не в словаре, а в кортеже.

7 Из «Руководства по стилю программирования в Paste» (http://pythonpaste.org/StyleGuide.html).
8 В модулях одиночный подчерк в начале имени верхнего уровня имеет специальный смысл: если написать from mymod import *, то имена с префиксом _ не будут импортироваться из mymod.
Но ничто не мешает явно написать from mymod import _privatefunc. Это объясняется в «Учебном пособии по Python» в разделе 6.1 «Еще о модулях» (http://bit.ly/1Gt95rp).
9 Один такой пример — документация по модулю gettext (http://bit.ly/1Gt9cDg).
10 Если такое состояние дел вас угнетает и вызывает желание сделать Python больше похожим в этом отношении на Java, не читайте мои высказывания по поводу относительности возможностей модификатора private в Java во врезке «Поговорим».