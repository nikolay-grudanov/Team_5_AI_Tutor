---
source_image: page_117.png
page_number: 117
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 41.65
tokens: 11909
characters: 2505
timestamp: 2025-12-24T01:39:57.151268
finish_reason: stop
---

Резюме

Как работают множества — практические следствия

Типы set и frozenset также реализованы с помощью хэш-таблиц с тем отличием, что в каждой ячейке хранится только ссылка на элемент (как если бы это был ключ словаря, но без сопровождающего его значения). На самом деле, до того как тип set был добавлен в язык, мы часто использовали словари с фиктивными значениями, просто чтобы быстро проверить вхождение ключа.

Все сказанное в разделе «Практические последствия механизма работы dict» о том, как хэш-таблица определяет поведение словаря, относится и к множеству. Не занимаясь повторением, ограничимся сводкой основных положений:

• элементы множества должны быть хэшируемыми объектами;
• множествам сопутствуют значительные накладные расходы в части памяти;
• проверка принадлежности множеству очень эффективна;
• упорядочение элементов зависит от порядка вставки;
• добавление новых элементов в множество может привести к изменению порядка существующих.

Резюме

Словари — краеугольный камень Python. Помимо базового класса dict, в стандартной библиотеке имеются удобные, готовые к применению специализированные отображения, например defaultdict, OrderedDict, ChainMap и Counter, все они определены в модуле collections. Там же находится предназначенный для расширения класс UserDict.

Два весьма полезных метода, имеющихся в большинстве отображений, — setdefault и update. Метод setdefault используется для модификации элементов, содержащих изменяемые значения, например в словаре dict значений типа list, чтобы избежать повторных операций поиска того же ключа. Метод update облегчает массовую вставку или перезапись элементов, когда новые элементы берутся из другого отображения, из итерируемого объекта, порождающего пары (key, value), или из именованных аргументов. Конструкторы отображений также пользуются методом update, что позволяет инициализировать отображение другим отображением, итерируемым объектом или именованными аргументами.

В API отображений имеется метод __missing__, который позволяет определить, что должно происходить в случае отсутствия ключа.

Модуль collections.abc содержит абстрактные базовые классы Mapping и MutableMapping для справки и контроля типов. Малоизвестный класс MappingProxyType из модуля types позволяет создавать неизменяемые отображения. Существуют также абстрактные базовые классы Set и MutableSet.

Реализация хэш-таблицы, лежащей в основе классов dict и set, работает очень быстро. А понимание ее логики объясняет, почему элементы кажутся неупорядо-