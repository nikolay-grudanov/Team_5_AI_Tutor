---
source_image: page_084.png
page_number: 84
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 51.11
tokens: 11991
characters: 2441
timestamp: 2025-12-24T01:38:36.970761
finish_reason: stop
---

Аргумент key — истинный бриллиант

Необязательный аргумент key метода list.sort и функций sorted, max и min — отличная идея. В других языках вы должны передавать функцию сравнения с двумя аргументами, как, например, ныне нерекомендуемая функция cmp(a, b) в Python 2. Но использовать key и проще, и эффективнее. Проще — потому что нужно определить функцию всего с одним аргументом, которая извлекает или вычисляет критерий, с помощью которого сортируются объекты; это легче, чем написать функцию с двумя аргументами, возвращающую -1, 0 или 1. А эффективнее — потому что функция key вызывается только один раз для каждого элемента, тогда как функция сравнения с двумя аргументами — всякий раз, как алгоритму сортировки необходимо сравнить два элемента. Разумеется, Python тоже должен сравнивать ключи во время сортировки, но это сравнение производится в оптимизированном коде на C, а не в написанной вами функции Python.

Кстати, аргумент key даже позволяет сортировать списки, содержащие числа и похожие на числа строки. Нужно только решить, как интерпретировать все объекты: как целые числа или как строки:

```python
>>> l = [28, 14, '28', 5, '9', '1', 0, 6, '23', 19]
>>> sorted(l, key=int)
[0, '1', 5, 6, '9', 14, 19, '23', 28, '28']
>>> sorted(l, key=str)
[0, '1', 14, 19, '23', 28, '28', 5, 6, '9']
```

Oracle, Google и таинственный Timbot

В функции sorted и методе list.sort используется адаптивный алгоритм Timsort, который переключается с сортировки вставками на сортировку слиянием в зависимости от того, как упорядочены данные. Это эффективно, потому что в реальных данных часто встречаются уже отсортированные участки. На эту тему есть статья в википедии (http://en.wikipedia.org/wiki/Timsort).

Алгоритм Timsort впервые был реализован в CPython в 2002 году. Начиная с 2009 года, Timsort используется также для сортировки массивов в стандартном компиляторе Java и в Android, этот факт стал широко известен, потому что корпорация Oracle использовала относящийся к Timsort код как доказательство нарушения Google прав интеллектуальной собственности компании Sun. См. «Oracle v. Google – Day 14 Filings» (http://bit.ly/1Vm6Ool).

Алгоритм Timsort изобрел Тим Питерс, разработчик ядра Python, настолько плодовитый, что его считали даже искусственным интеллектом — Timbot. Об этой конспирологической теории можно прочитать на страничке Python Humor (https://www.python.org/doc/humor/#id9). Тим также автор «Дзен Python»: import this.