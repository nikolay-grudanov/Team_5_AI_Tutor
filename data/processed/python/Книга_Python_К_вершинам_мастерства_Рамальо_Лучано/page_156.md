---
source_image: page_156.png
page_number: 156
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 44.57
tokens: 11795
characters: 1882
timestamp: 2025-12-24T01:41:59.397475
finish_reason: stop
---

находящегося в так называемой нижней части суррогатных пар — пространстве кодов, которым не сопоставлены символы, зарезервированном для внутренних нужд приложений. При кодировании такие позиции преобразуются обратно в значения байтов, которые были заменены. См. пример 4.24.

Пример 4.24. Использование обработчика ошибок surrogateescape

```python
>>> os.listdir('.')
['abc.txt', 'digits-of-ω.txt']
>>> os.listdir(b'.')
[b'abc.txt', b'digits-of-\xcf\x80.txt']
>>> pi_name_bytes = os.listdir(b'.')[1]
>>> pi_name_str = pi_name_bytes.decode('ascii', 'surrogateescape')
>>> pi_name_str
'digits-of-\udccf\udc80.txt'
>>> pi_name_str.encode('ascii', 'surrogateescape')
b'digits-of-\xcf\x80.txt'
```

1 Вывести список файлов в каталоге, который содержит файл с именем, включающим символы не из набора ASCII.
2 Сделаем вид, что не знаем кодировку и получим имена файлов в виде bytes.
3 pi_names_bytes — имя файла, содержащее символ «пи».
4 Декодируем его в str, применяя кодек 'ascii' с обработчиком ошибок 'surrogateescape'.
5 Любой символ, не принадлежащий ASCII, заменяется суррогатной кодовой позицией: '\xcf\x80' преобразуется в '\udccf\udc80'.
6 Кодируем обратно в байты ASCII: все суррогатные кодовые позиции заменяются исходными байтами.

На этом заканчивается рассказ о типах str и bytes. Если вы вытерпели до конца, примите поздравления!

Резюме

Мы начали эту главы с опровержения утверждения 1 символ == 1 байт. В мире, перешедшем на Unicode (а 80 % сайтов уже пользуются кодировкой UTF-8), необходимо разделять понятия текстовой строки и двоичной последовательности, которой такая строка представлена в файле. И Python 3 поддерживает такое разделение.

После краткого обзора двоичных типов последовательностей — bytes, bytearray и memoryview — мы перешли к кодированию и декодированию, привели репрезентативную выборку кодеков и объяснили, как предотвратить или обработать пе-