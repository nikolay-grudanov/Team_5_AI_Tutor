---
source_image: page_112.png
page_number: 112
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 62.65
tokens: 12260
characters: 2352
timestamp: 2025-12-24T01:40:03.827914
finish_reason: stop
---

внимание, что хэши чисел 1 и 1.0 одинаковы, но для чисел 1.0001, 1.0002 и 1.0003 они очень сильно различаются.

Пример 3.16. Сравнение битовых представлений чисел 1, 1.0001, 1.0002 и 1.0003 в 32-разрядной сборке Python (биты, в которых соседние числа различаются, обозначены знаком !, а справа показано, сколько битов различается)

32-bit Python build

<table>
  <tr>
    <th>1</th>
    <td>00000000000000000000000000000001</td>
    <td>!= 0</td>
  </tr>
  <tr>
    <th>1.0</th>
    <td>00000000000000000000000000000001</td>
    <td></td>
  </tr>
  <tr>
    <th>1.0</th>
    <td>00000000000000000000000000000001</td>
    <td>!!! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! = 16</td>
  </tr>
  <tr>
    <th>1.0001</th>
    <td>00101110101101010000101011011101</td>
    <td></td>
  </tr>
  <tr>
    <th>1.0001</th>
    <td>00101110101101010000101011011101</td>
    <td>!!! !!!! !!!!! !!!!! !! ! ! = 20</td>
  </tr>
  <tr>
    <th>1.0002</th>
    <td>01011101011010100001010110111001</td>
    <td></td>
  </tr>
  <tr>
    <th>1.0002</th>
    <td>01011101011010100001010110111001</td>
    <td>!! ! !!!! ! ! ! ! ! ! ! ! ! ! ! ! ! = 17</td>
  </tr>
  <tr>
    <th>1.0003</th>
    <td>00001100000111110010000010010110</td>
    <td></td>
  </tr>
</table>

Код, с помощью которого получен этот результат, имеется в приложении А. Большая его часть относится к форматированию, но для полноты он все же приведен в примере А.3.

Начиная с версии Python 3.3, в хэши объектов str, bytes и datetime добавлена случайная затравка. Внутри процесса Python это константа, но при каждом запуске интерпретатора она меняется. Смысл случайной затравки — защититься от DOS-атак. Детали описаны в документации в примечании к специальному методу __hash__ (http://bit.ly/1FESm0m).

Получив первоначальное представление о хэш-значениях объектов, мы можем углубиться в алгоритм, благодаря которому работают хэш-таблицы.

Алгоритм работы хэш-таблицы

Для выборки значения с помощью выражения my_dict[search_key] Python обращается к функции hash(search_key), чтобы получить хэш-значение search_key, и использует несколько младших битов полученного числа как смещение ячейки относительно начала хэш-таблицы (сколько именно битов зависит от текущего размера таблицы). Если найденная ячейка пуста, возбуждается исключение KeyError. В противном случае в найденной ячейке есть какой-то элемент — пара