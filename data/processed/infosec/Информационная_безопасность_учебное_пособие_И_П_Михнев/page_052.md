---
source_image: page_052.png
page_number: 52
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 34.79
tokens: 11844
characters: 2171
timestamp: 2025-12-24T00:13:42.479374
finish_reason: stop
---

Архитектура IPSec является открытой, что позволяет использовать для защиты передаваемых данных новые криптографические алгоритмы, например, соответствующие национальным стандартам. Для этого необходимо, чтобы взаимодействующие стороны поддерживали эти алгоритмы, и они были бы стандартным образом зарегистрированы в описании параметров соединения.

Процесс защищенной передачи данных регулируется правилами безопасности, принятыми в системе. Параметры создаваемого туннеля описывает информационная структура, называемая контекст защиты или ассоциация безопасности (от англ. «Security Association», сокр. SA). Как уже отмечалось выше, IPSec является набором протоколов, и состав контекста защиты может различаться. В зависимости от конкретного протокола в него входит:

- IP-адрес получателя;
- указание на протоколы безопасности, используемые при передаче данных;
- ключи, необходимые для шифрования и формирования имитовставки (если это требуется);
- указание на метод форматирования, определяющий, каким образом создаются заголовки;
- индекс параметров защиты (от англ. «Security Parameter Index», сокр. SPI) — идентификатор, позволяющий найти нужный SA.

Обычно контекст защиты является однонаправленным, а для передачи данных по туннелю в обе стороны задействуются два SA. Каждый хост имеет свою базу контекстов защиты, из которой выбирается нужный элемент либо на основании значения SPI, либо по IP-адресу получателя.

Два протокола, входящие в состав IPSec, это:

1) протокол аутентифицирующего заголовка — АН (от англ. «Authentication Header»), обеспечивающий проверку целостности и аутентификацию передаваемых данных; последняя версия протокола описана в документе RFC 4302 (предыдущие — RFC 1826, 2402);

2) протокол инкапсулирующей защиты данных — ESP (от англ. «Encapsulating Security Payload»), обеспечивающий конфиденциальность и, дополнительно, проверку целостности и аутентификацию; описан в RFC 4303 (предыдущие версии — RFC 1827, 2406).

Оба эти протокола имеют два режима работы — транспортный и туннельный, последний определен в качестве основного. Туннельный режим используется, если хотя бы один из соединяющихся узлов является шлюзом безопасности. В