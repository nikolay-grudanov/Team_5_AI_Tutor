---
source_image: page_049.png
page_number: 49
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 32.17
tokens: 11780
characters: 2068
timestamp: 2025-12-24T00:13:32.014801
finish_reason: stop
---

1. Клиент посылает серверу запрос на установление защищенного соединения, в котором передает, в частности, следующие параметры:
- дату и текущее время;
- сгенерированную клиентом случайную последовательность;
- перечень поддерживаемых клиентом алгоритмов шифрования, хеширования и сжатия (если сжатие используется).

2. Сервер обрабатывает запрос от клиента и передает ему согласованный набор параметров:
- идентификатор SSL-сессии;
- идентификаторы криптографических алгоритмов из числа предложенных клиентом, которые будут использоваться в данной сессии (если по какой-либо причине предложенные алгоритмы или их параметры не удовлетворяют требованиям сервера, сессия закрывается);
- цифровой сертификат сервера формата X.509;
- случайную последовательность (RAND_SERV).

3. Клиент проверяет полученный сертификат и соответствие роли ключа его назначению, описанному в сертификате. При отрицательном результате проверки сессия закрывается, а при положительном клиент выполняет следующие действия:
- генерирует случайную 48-байтную последовательность, называемую Pre_MasterSecret, предназначенную для расчета общего секретного ключа;
- шифрует значение Pre_MasterSecret с использованием открытого ключа сервера, взятого из сертификата, и посылает криптограмму серверу;
- с помощью согласованной с сервером хэш-функции формирует общий секретный ключ (MasterSecret), используя в качестве параметров последовательность Pre_MasterSecret, посланную ранее серверу случайную последовательность RAND_CL и полученную от него случайную последовательность RAND_SERV;
- используя значение MasterSecret, вычисляет криптографические параметры SSL-сессии: формирует общие с сервером сеансовые секретные ключи для симметричного шифрования и вычисления хэш-функций;
- переходит в режим защищенного взаимодействия.

4. Сервер, используя свой секретный ключ, расшифровывает полученное значение Pre_MasterSecret и выполняет те же операции, что и клиент:
- с помощью согласованной с клиентом хэш-функции формирует общий секретный мастер-ключ (MasterSecret), используя в качестве параметров