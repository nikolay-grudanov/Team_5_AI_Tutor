---
source_image: page_041.png
page_number: 41
model: model-run-olm-ocr
prompt_type: olmocr_technical
processing_time: 36.08
tokens: 11850
characters: 1829
timestamp: 2025-12-24T00:13:14.221816
finish_reason: stop
---

2.5. Хэш-функции

В рассмотренных алгоритмах формирования ЭЦП длина подписи получается равной или даже большей, чем длина самого сообщения. Очевидно, что удостоверять подобным образом большой документ неудобно. Поэтому подписывается, как правило, не само сообщение, а его «дайджест» — значение фиксированной длины, зависящее от подписываемого сообщения. Для формирования дайджеста используется хэш-функция (от англ. «hash function») — односторонняя функция, преобразующая строку произвольной длины в строку фиксированной длины. В криптографии используются хэш-функции 2 классов:
- хэш-функции без ключа;
- хэш-функции с ключом.

2.5.1. Алгоритм SHA-1

Алгоритм SHA (Secure Hash Algorithm) разработан в США как часть стандарта SHS (Secure Hash Standard), опубликованного в 1993 году. Но в нем были обнаружены уязвимости, которые привели к необходимости модифицировать алгоритм. Через два года была опубликована новая версия — SHA-1, получившая на сегодняшний день широкое распространение.

Получая на входе сообщение произвольной длины менее 264 бит, SHA-1 формирует 160-битное выходное сообщение (дайджест). Вначале преобразуемое сообщение \( M \) дополняется до длины, кратной 512 битам. Заполнитель формируется следующим образом: в конец преобразуемого сообщения добавляется 1, потом — столько нулей, сколько необходимо для получения сообщения, которое на 64 бита короче, чем кратное 512, после чего добавляют 64-битное представление длины исходного сообщения. Например, если сообщение длиной 800 бит, то 801-й бит = 1, потом добавляем нули до 960 бит, после чего в оставшихся 64-разрядах записывается число «800», в итоге хэшируем 1024-битное сообщение.

Перед началом преобразований инициализируется пять 32-битных переменных:

\[
A = 0x67452301; \\
B = 0xEFCDAB89; \\
C = 0x98BADCFE; \\
D = 0x10325476; \\
E = 0xC3D2E1F0.
\]